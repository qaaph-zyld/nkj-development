(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,46932,31178,37806,21476,47414,74008,64978,72846,e=>{"use strict";let t;e.s(["motion",()=>ir],46932);var n=e.i(71645);let a=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],r=new Set(a),i=e=>180*e/Math.PI,s=e=>l(i(Math.atan2(e[1],e[0]))),o={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:s,rotateZ:s,skewX:e=>i(Math.atan(e[1])),skewY:e=>i(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},l=e=>((e%=360)<0&&(e+=360),e),c=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),u=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),h={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:c,scaleY:u,scale:e=>(c(e)+u(e))/2,rotateX:e=>l(i(Math.atan2(e[6],e[5]))),rotateY:e=>l(i(Math.atan2(-e[2],e[0]))),rotateZ:s,rotate:s,skewX:e=>i(Math.atan(e[4])),skewY:e=>i(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function d(e){return+!!e.includes("scale")}function p(e,t){let n,a;if(!e||"none"===e)return d(t);let r=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);if(r)n=h,a=r;else{let t=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=o,a=t}if(!a)return d(t);let i=n[t],s=a[1].split(",").map(f);return"function"==typeof i?i(s):s[i]}function f(e){return parseFloat(e.trim())}let m=e=>t=>"string"==typeof t&&t.startsWith(e),g=m("--"),x=m("var(--"),y=e=>!!x(e)&&b.test(e.split("/*")[0].trim()),b=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu;function v(e){let{top:t,left:n,right:a,bottom:r}=e;return{x:{min:n,max:a},y:{min:t,max:r}}}let w=(e,t,n)=>e+(t-e)*n;function N(e){return void 0===e||1===e}function k(e){let{scale:t,scaleX:n,scaleY:a}=e;return!N(t)||!N(n)||!N(a)}function S(e){return k(e)||C(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function C(e){var t,n;return(t=e.x)&&"0%"!==t||(n=e.y)&&"0%"!==n}function T(e,t,n,a,r){return void 0!==r&&(e=a+r*(e-a)),a+n*(e-a)+t}function I(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;e.min=T(e.min,t,n,a,r),e.max=T(e.max,t,n,a,r)}function E(e,t){let{x:n,y:a}=t;I(e.x,n.translate,n.scale,n.originPoint),I(e.y,a.translate,a.scale,a.originPoint)}function _(e,t){e.min=e.min+t,e.max=e.max+t}function A(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,i=w(e.min,e.max,r);I(e,t,n,i,a)}function R(e,t){A(e.x,t.x,t.scaleX,t.scale,t.originX),A(e.y,t.y,t.scaleY,t.scale,t.originY)}function D(e,t){return v(function(e,t){if(!t)return e;let n=t({x:e.left,y:e.top}),a=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:a.y,right:a.x}}(e.getBoundingClientRect(),t))}let M=new Set(["width","height","top","left","right","bottom",...a]),F=(e,t,n)=>n>t?t:n<e?e:n,O={test:e=>"number"==typeof e,parse:parseFloat,transform:e=>e},P={...O,transform:e=>F(0,1,e)},j={...O,default:1},L=e=>({test:t=>"string"==typeof t&&t.endsWith(e)&&1===t.split(" ").length,parse:parseFloat,transform:t=>"".concat(t).concat(e)}),z=L("deg"),B=L("%"),V=L("px"),U=L("vh"),W=L("vw"),G={...B,parse:e=>B.parse(e)/100,transform:e=>B.transform(100*e)},H=e=>t=>t.test(e),q=[O,V,B,z,W,U,{test:e=>"auto"===e,parse:e=>e}],K=e=>q.find(H(e));e.i(47167);let X=()=>{},Y=()=>{},Z=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),Q=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u,J=e=>e===O||e===V,$=new Set(["x","y","z"]),ee=a.filter(e=>!$.has(e)),et={width:(e,t)=>{let{x:n}=e,{paddingLeft:a="0",paddingRight:r="0"}=t;return n.max-n.min-parseFloat(a)-parseFloat(r)},height:(e,t)=>{let{y:n}=e,{paddingTop:a="0",paddingBottom:r="0"}=t;return n.max-n.min-parseFloat(a)-parseFloat(r)},top:(e,t)=>{let{top:n}=t;return parseFloat(n)},left:(e,t)=>{let{left:n}=t;return parseFloat(n)},bottom:(e,t)=>{let{y:n}=e,{top:a}=t;return parseFloat(a)+(n.max-n.min)},right:(e,t)=>{let{x:n}=e,{left:a}=t;return parseFloat(a)+(n.max-n.min)},x:(e,t)=>{let{transform:n}=t;return p(n,"x")},y:(e,t)=>{let{transform:n}=t;return p(n,"y")}};et.translateX=et.x,et.translateY=et.y;let en=e=>e,ea={},er=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],ei={value:null,addProjectionMetrics:null};function es(e,t){let n=!1,a=!0,r={delta:0,timestamp:0,isProcessing:!1},i=()=>n=!0,s=er.reduce((e,n)=>(e[n]=function(e,t){let n=new Set,a=new Set,r=!1,i=!1,s=new WeakSet,o={delta:0,timestamp:0,isProcessing:!1},l=0;function c(t){s.has(t)&&(u.schedule(t),e()),l++,t(o)}let u={schedule:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=i&&r?n:a;return t&&s.add(e),o.has(e)||o.add(e),e},cancel:e=>{a.delete(e),s.delete(e)},process:e=>{if(o=e,r){i=!0;return}r=!0,[n,a]=[a,n],n.forEach(c),t&&ei.value&&ei.value.frameloop[t].push(l),l=0,n.clear(),r=!1,i&&(i=!1,u.process(e))}};return u}(i,t?n:void 0),e),{}),{setup:o,read:l,resolveKeyframes:c,preUpdate:u,update:h,preRender:d,render:p,postRender:f}=s,m=()=>{let i=ea.useManualTiming?r.timestamp:performance.now();n=!1,ea.useManualTiming||(r.delta=a?1e3/60:Math.max(Math.min(i-r.timestamp,40),1)),r.timestamp=i,r.isProcessing=!0,o.process(r),l.process(r),c.process(r),u.process(r),h.process(r),d.process(r),p.process(r),f.process(r),r.isProcessing=!1,n&&t&&(a=!1,e(m))};return{schedule:er.reduce((t,i)=>{let o=s[i];return t[i]=function(t){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return!n&&(n=!0,a=!0,r.isProcessing||e(m)),o.schedule(t,i,s)},t},{}),cancel:e=>{for(let t=0;t<er.length;t++)s[er[t]].cancel(e)},state:r,steps:s}}let{schedule:eo,cancel:el,state:ec,steps:eu}=es("undefined"!=typeof requestAnimationFrame?requestAnimationFrame:en,!0),eh=new Set,ed=!1,ep=!1,ef=!1;function em(){if(ep){let e=Array.from(eh).filter(e=>e.needsMeasurement),t=new Set(e.map(e=>e.element)),n=new Map;t.forEach(e=>{let t=function(e){let t=[];return ee.forEach(n=>{let a=e.getValue(n);void 0!==a&&(t.push([n,a.get()]),a.set(+!!n.startsWith("scale")))}),t}(e);t.length&&(n.set(e,t),e.render())}),e.forEach(e=>e.measureInitialState()),t.forEach(e=>{e.render();let t=n.get(e);t&&t.forEach(t=>{var n;let[a,r]=t;null==(n=e.getValue(a))||n.set(r)})}),e.forEach(e=>e.measureEndState()),e.forEach(e=>{void 0!==e.suspendedScrollY&&window.scrollTo(0,e.suspendedScrollY)})}ep=!1,ed=!1,eh.forEach(e=>e.complete(ef)),eh.clear()}function eg(){eh.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(ep=!0)})}class ex{scheduleResolve(){this.state="scheduled",this.isAsync?(eh.add(this),ed||(ed=!0,eo.read(eg),eo.resolveKeyframes(em))):(this.readKeyframes(),this.complete())}readKeyframes(){let{unresolvedKeyframes:e,name:t,element:n,motionValue:a}=this;if(null===e[0]){let r=null==a?void 0:a.get(),i=e[e.length-1];if(void 0!==r)e[0]=r;else if(n&&t){let a=n.readValue(t,i);null!=a&&(e[0]=a)}void 0===e[0]&&(e[0]=i),a&&void 0===r&&a.set(e[0])}for(let t=1;t<e.length;t++)null!=e[t]||(e[t]=e[t-1])}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),eh.delete(this)}cancel(){"scheduled"===this.state&&(eh.delete(this),this.state="pending")}resume(){"pending"===this.state&&this.scheduleResolve()}constructor(e,t,n,a,r,i=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=n,this.motionValue=a,this.element=r,this.isAsync=i}}let ey=e=>/^0[^.\s]+$/u.test(e),eb=e=>Math.round(1e5*e)/1e5,ev=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu,ew=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,eN=(e,t)=>n=>!!("string"==typeof n&&ew.test(n)&&n.startsWith(e)||t&&null!=n&&Object.prototype.hasOwnProperty.call(n,t)),ek=(e,t,n)=>a=>{if("string"!=typeof a)return a;let[r,i,s,o]=a.match(ev);return{[e]:parseFloat(r),[t]:parseFloat(i),[n]:parseFloat(s),alpha:void 0!==o?parseFloat(o):1}},eS={...O,transform:e=>Math.round(F(0,255,e))},eC={test:eN("rgb","red"),parse:ek("red","green","blue"),transform:e=>{let{red:t,green:n,blue:a,alpha:r=1}=e;return"rgba("+eS.transform(t)+", "+eS.transform(n)+", "+eS.transform(a)+", "+eb(P.transform(r))+")"}},eT={test:eN("#"),parse:function(e){let t="",n="",a="",r="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),a=e.substring(5,7),r=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),a=e.substring(3,4),r=e.substring(4,5),t+=t,n+=n,a+=a,r+=r),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(a,16),alpha:r?parseInt(r,16)/255:1}},transform:eC.transform},eI={test:eN("hsl","hue"),parse:ek("hue","saturation","lightness"),transform:e=>{let{hue:t,saturation:n,lightness:a,alpha:r=1}=e;return"hsla("+Math.round(t)+", "+B.transform(eb(n))+", "+B.transform(eb(a))+", "+eb(P.transform(r))+")"}},eE={test:e=>eC.test(e)||eT.test(e)||eI.test(e),parse:e=>eC.test(e)?eC.parse(e):eI.test(e)?eI.parse(e):eT.parse(e),transform:e=>"string"==typeof e?e:e.hasOwnProperty("red")?eC.transform(e):eI.transform(e),getAnimatableNone:e=>{let t=eE.parse(e);return t.alpha=0,eE.transform(t)}},e_=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu,eA="number",eR="color",eD=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function eM(e){let t=e.toString(),n=[],a={color:[],number:[],var:[]},r=[],i=0,s=t.replace(eD,e=>(eE.test(e)?(a.color.push(i),r.push(eR),n.push(eE.parse(e))):e.startsWith("var(")?(a.var.push(i),r.push("var"),n.push(e)):(a.number.push(i),r.push(eA),n.push(parseFloat(e))),++i,"${}")).split("${}");return{values:n,split:s,indexes:a,types:r}}function eF(e){return eM(e).values}function eO(e){let{split:t,types:n}=eM(e),a=t.length;return e=>{let r="";for(let i=0;i<a;i++)if(r+=t[i],void 0!==e[i]){let t=n[i];t===eA?r+=eb(e[i]):t===eR?r+=eE.transform(e[i]):r+=e[i]}return r}}let eP=e=>"number"==typeof e?0:eE.test(e)?eE.getAnimatableNone(e):e,ej={test:function(e){var t,n;return isNaN(e)&&"string"==typeof e&&((null==(t=e.match(ev))?void 0:t.length)||0)+((null==(n=e.match(e_))?void 0:n.length)||0)>0},parse:eF,createTransformer:eO,getAnimatableNone:function(e){let t=eF(e);return eO(e)(t.map(eP))}},eL=new Set(["brightness","contrast","saturate","opacity"]);function ez(e){let[t,n]=e.slice(0,-1).split("(");if("drop-shadow"===t)return e;let[a]=n.match(ev)||[];if(!a)return e;let r=n.replace(a,""),i=+!!eL.has(t);return a!==n&&(i*=100),t+"("+i+r+")"}let eB=/\b([a-z-]*)\(.*?\)/gu,eV={...ej,getAnimatableNone:e=>{let t=e.match(eB);return t?t.map(ez).join(" "):e}},eU={...O,transform:Math.round},eW={borderWidth:V,borderTopWidth:V,borderRightWidth:V,borderBottomWidth:V,borderLeftWidth:V,borderRadius:V,radius:V,borderTopLeftRadius:V,borderTopRightRadius:V,borderBottomRightRadius:V,borderBottomLeftRadius:V,width:V,maxWidth:V,height:V,maxHeight:V,top:V,right:V,bottom:V,left:V,padding:V,paddingTop:V,paddingRight:V,paddingBottom:V,paddingLeft:V,margin:V,marginTop:V,marginRight:V,marginBottom:V,marginLeft:V,backgroundPositionX:V,backgroundPositionY:V,rotate:z,rotateX:z,rotateY:z,rotateZ:z,scale:j,scaleX:j,scaleY:j,scaleZ:j,skew:z,skewX:z,skewY:z,distance:V,translateX:V,translateY:V,translateZ:V,x:V,y:V,z:V,perspective:V,transformPerspective:V,opacity:P,originX:G,originY:G,originZ:V,zIndex:eU,fillOpacity:P,strokeOpacity:P,numOctaves:eU},eG={...eW,color:eE,backgroundColor:eE,outlineColor:eE,fill:eE,stroke:eE,borderColor:eE,borderTopColor:eE,borderRightColor:eE,borderBottomColor:eE,borderLeftColor:eE,filter:eV,WebkitFilter:eV},eH=e=>eG[e];function eq(e,t){let n=eH(e);return n!==eV&&(n=ej),n.getAnimatableNone?n.getAnimatableNone(t):void 0}let eK=new Set(["auto","none","0"]);class eX extends ex{readKeyframes(){let{unresolvedKeyframes:e,element:t,name:n}=this;if(!t||!t.current)return;super.readKeyframes();for(let n=0;n<e.length;n++){let a=e[n];if("string"==typeof a&&y(a=a.trim())){let r=function e(t,n){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;Y(a<=4,'Max CSS variable fallback depth detected in property "'.concat(t,'". This may indicate a circular fallback dependency.'),"max-css-var-depth");let[r,i]=function(e){let t=Q.exec(e);if(!t)return[,];let[,n,a,r]=t;return["--".concat(null!=n?n:a),r]}(t);if(!r)return;let s=window.getComputedStyle(n).getPropertyValue(r);if(s){let e=s.trim();return Z(e)?parseFloat(e):e}return y(i)?e(i,n,a+1):i}(a,t.current);void 0!==r&&(e[n]=r),n===e.length-1&&(this.finalKeyframe=a)}}if(this.resolveNoneKeyframes(),!M.has(n)||2!==e.length)return;let[a,r]=e,i=K(a),s=K(r);if(i!==s)if(J(i)&&J(s))for(let t=0;t<e.length;t++){let n=e[t];"string"==typeof n&&(e[t]=parseFloat(n))}else et[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){let{unresolvedKeyframes:e,name:t}=this,n=[];for(let t=0;t<e.length;t++){var a;(null===e[t]||("number"==typeof(a=e[t])?0===a:null===a||"none"===a||"0"===a||ey(a)))&&n.push(t)}n.length&&function(e,t,n){let a,r=0;for(;r<e.length&&!a;){let t=e[r];"string"==typeof t&&!eK.has(t)&&eM(t).values.length&&(a=e[r]),r++}if(a&&n)for(let r of t)e[r]=eq(n,a)}(e,n,t)}measureInitialState(){let{element:e,unresolvedKeyframes:t,name:n}=this;if(!e||!e.current)return;"height"===n&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=et[n](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;let a=t[t.length-1];void 0!==a&&e.getValue(n,a).jump(a,!1)}measureEndState(){var e;let{element:t,name:n,unresolvedKeyframes:a}=this;if(!t||!t.current)return;let r=t.getValue(n);r&&r.jump(this.measuredOrigin,!1);let i=a.length-1,s=a[i];a[i]=et[n](t.measureViewportBox(),window.getComputedStyle(t.current)),null!==s&&void 0===this.finalKeyframe&&(this.finalKeyframe=s),(null==(e=this.removedTransforms)?void 0:e.length)&&this.removedTransforms.forEach(e=>{let[n,a]=e;t.getValue(n).set(a)}),this.resolveNoneKeyframes()}constructor(e,t,n,a,r){super(e,t,n,a,r,!0)}}let eY=e=>!!(e&&e.getVelocity);function eZ(){t=void 0}let eQ={now:()=>(void 0===t&&eQ.set(ec.isProcessing||ea.useManualTiming?ec.timestamp:performance.now()),t),set:e=>{t=e,queueMicrotask(eZ)}};function eJ(e,t){-1===e.indexOf(t)&&e.push(t)}function e$(e,t){let n=e.indexOf(t);n>-1&&e.splice(n,1)}class e0{add(e){return eJ(this.subscriptions,e),()=>e$(this.subscriptions,e)}notify(e,t,n){let a=this.subscriptions.length;if(a)if(1===a)this.subscriptions[0](e,t,n);else for(let r=0;r<a;r++){let a=this.subscriptions[r];a&&a(e,t,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}constructor(){this.subscriptions=[]}}let e1={current:void 0};class e2{setCurrent(e){this.current=e,this.updatedAt=eQ.now(),null===this.canTrackVelocity&&void 0!==e&&(this.canTrackVelocity=!isNaN(parseFloat(this.current)))}setPrevFrameValue(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.current;this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new e0);let n=this.events[e].add(t);return"change"===e?()=>{n(),eo.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(let e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,n){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;null==(e=this.events.change)||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return e1.current&&e1.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){var e;let t=eQ.now();if(!this.canTrackVelocity||void 0===this.prevFrameValue||t-this.updatedAt>30)return 0;let n=Math.min(this.updatedAt-this.prevUpdatedAt,30);return e=parseFloat(this.current)-parseFloat(this.prevFrameValue),n?1e3/n*e:0}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,t;null==(e=this.dependents)||e.clear(),null==(t=this.events.destroy)||t.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}constructor(e,t={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=e=>{let t=eQ.now();if(this.updatedAt!==t&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(e),this.current!==this.prev){var n;if(null==(n=this.events.change)||n.notify(this.current),this.dependents)for(let e of this.dependents)e.dirty()}},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}}function e3(e,t){return new e2(e,t)}let e4=[...q,eE,ej],{schedule:e5}=es(queueMicrotask,!1),e6={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},e8={};for(let e in e6)e8[e]={isEnabled:t=>e6[e].some(e=>!!t[e])};let e9=()=>({translate:0,scale:1,origin:0,originPoint:0}),e7=()=>({x:e9(),y:e9()}),te=()=>({min:0,max:0}),tt=()=>({x:te(),y:te()}),tn="undefined"!=typeof window,ta={current:null},tr={current:!1},ti=new WeakMap;function ts(e){return null!==e&&"object"==typeof e&&"function"==typeof e.start}function to(e){return"string"==typeof e||Array.isArray(e)}let tl=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],tc=["initial",...tl];function tu(e){return ts(e.animate)||tc.some(t=>to(e[t]))}function th(e){return!!(tu(e)||e.variants)}function td(e){let t=[{},{}];return null==e||e.values.forEach((e,n)=>{t[0][n]=e.get(),t[1][n]=e.getVelocity()}),t}function tp(e,t,n,a){if("function"==typeof t){let[r,i]=td(a);t=t(void 0!==n?n:e.custom,r,i)}if("string"==typeof t&&(t=e.variants&&e.variants[t]),"function"==typeof t){let[r,i]=td(a);t=t(void 0!==n?n:e.custom,r,i)}return t}let tf=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class tm{scrapeMotionValuesFromProps(e,t,n){return{}}mount(e){var t;this.current=e,ti.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((e,t)=>this.bindToMotionValue(t,e)),tr.current||function(){if(tr.current=!0,tn)if(window.matchMedia){let e=window.matchMedia("(prefers-reduced-motion)"),t=()=>ta.current=e.matches;e.addEventListener("change",t),t()}else ta.current=!1}(),this.shouldReduceMotion="never"!==this.reducedMotionConfig&&("always"===this.reducedMotionConfig||ta.current),null==(t=this.parent)||t.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var e;for(let t in this.projection&&this.projection.unmount(),el(this.notifyUpdate),el(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),null==(e=this.parent)||e.removeChild(this),this.events)this.events[t].clear();for(let e in this.features){let t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),null!=this.enteringChildren||(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){let n;this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();let a=r.has(e);a&&this.onBindTransform&&this.onBindTransform();let i=t.on("change",t=>{this.latestValues[e]=t,this.props.onUpdate&&eo.preRender(this.notifyUpdate),a&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});window.MotionCheckAppearSync&&(n=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{i(),n&&n(),t.owner&&t.stop()})}sortNodePosition(e){return this.current&&this.sortInstanceNodePosition&&this.type===e.type?this.sortInstanceNodePosition(this.current,e.current):0}updateFeatures(){let e="animation";for(e in e8){let t=e8[e];if(!t)continue;let{isEnabled:n,Feature:a}=t;if(!this.features[e]&&a&&n(this.props)&&(this.features[e]=new a(this)),this.features[e]){let t=this.features[e];t.isMounted?t.update():(t.mount(),t.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):tt()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let t=0;t<tf.length;t++){let n=tf[t];this.propEventSubscriptions[n]&&(this.propEventSubscriptions[n](),delete this.propEventSubscriptions[n]);let a=e["on"+n];a&&(this.propEventSubscriptions[n]=this.on(n,a))}this.prevMotionValues=function(e,t,n){for(let a in t){let r=t[a],i=n[a];if(eY(r))e.addValue(a,r);else if(eY(i))e.addValue(a,e3(r,{owner:e}));else if(i!==r)if(e.hasValue(a)){let t=e.getValue(a);!0===t.liveStyle?t.jump(r):t.hasAnimated||t.set(r)}else{let t=e.getStaticValue(a);e.addValue(a,e3(void 0!==t?t:r,{owner:e}))}}for(let a in n)void 0===t[a]&&e.removeValue(a);return t}(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){let t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){let n=this.values.get(e);t!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);let t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return void 0===n&&void 0!==t&&(n=e3(null===t?void 0:t,{owner:this}),this.addValue(e,n)),n}readValue(e,t){var n;let a=void 0===this.latestValues[e]&&this.current?null!=(n=this.getBaseTargetFromProps(this.props,e))?n:this.readValueFromInstance(this.current,e,this.options):this.latestValues[e];if(null!=a){if("string"==typeof a&&(Z(a)||ey(a)))a=parseFloat(a);else{let n;n=a,!e4.find(H(n))&&ej.test(t)&&(a=eq(e,t))}this.setBaseTarget(e,eY(a)?a.get():a)}return eY(a)?a.get():a}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){let t,{initial:n}=this.props;if("string"==typeof n||"object"==typeof n){var a;let r=tp(this.props,n,null==(a=this.presenceContext)?void 0:a.custom);r&&(t=r[e])}if(n&&void 0!==t)return t;let r=this.getBaseTargetFromProps(this.props,e);return void 0===r||eY(r)?void 0!==this.initialValues[e]&&void 0===t?void 0:this.baseTarget[e]:r}on(e,t){return this.events[e]||(this.events[e]=new e0),this.events[e].add(t)}notify(e){for(var t=arguments.length,n=Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];this.events[e]&&this.events[e].notify(...n)}scheduleRenderMicrotask(){e5.render(this.render)}constructor({parent:e,props:t,presenceContext:n,reducedMotionConfig:a,blockInitialAnimation:r,visualState:i},s={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=ex,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{let e=eQ.now();this.renderScheduledAt<e&&(this.renderScheduledAt=e,eo.render(this.render,!1,!0))};let{latestValues:o,renderState:l}=i;this.latestValues=o,this.baseTarget={...o},this.initialValues=t.initial?{...o}:{},this.renderState=l,this.parent=e,this.props=t,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=a,this.options=s,this.blockInitialAnimation=!!r,this.isControllingVariants=tu(t),this.isVariantNode=th(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);let{willChange:c,...u}=this.scrapeMotionValuesFromProps(t,{},this);for(let e in u){let t=u[e];void 0!==o[e]&&eY(t)&&t.set(o[e])}}}class tg extends tm{sortInstanceNodePosition(e,t){return 2&e.compareDocumentPosition(t)?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,t){let{vars:n,style:a}=t;delete n[e],delete a[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);let{children:e}=this.props;eY(e)&&(this.childSubscription=e.on("change",e=>{this.current&&(this.current.textContent="".concat(e))}))}constructor(){super(...arguments),this.KeyframeResolver=eX}}let tx=(e,t)=>t&&"number"==typeof e?t.transform(e):e,ty={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},tb=a.length;function tv(e,t,n){let{style:i,vars:s,transformOrigin:o}=e,l=!1,c=!1;for(let e in t){let n=t[e];if(r.has(e)){l=!0;continue}if(g(e)){s[e]=n;continue}{let t=tx(n,eW[e]);e.startsWith("origin")?(c=!0,o[e]=t):i[e]=t}}if(!t.transform&&(l||n?i.transform=function(e,t,n){let r="",i=!0;for(let s=0;s<tb;s++){let o=a[s],l=e[o];if(void 0===l)continue;let c=!0;if(!(c="number"==typeof l?l===+!!o.startsWith("scale"):0===parseFloat(l))||n){let e=tx(l,eW[o]);if(!c){i=!1;let t=ty[o]||o;r+="".concat(t,"(").concat(e,") ")}n&&(t[o]=e)}}return r=r.trim(),n?r=n(t,i?"":r):i&&(r="none"),r}(t,e.transform,n):i.transform&&(i.transform="none")),c){let{originX:e="50%",originY:t="50%",originZ:n=0}=o;i.transformOrigin="".concat(e," ").concat(t," ").concat(n)}}function tw(e,t,n,a){let r,{style:i,vars:s}=t,o=e.style;for(r in i)o[r]=i[r];for(r in null==a||a.applyProjectionStyles(o,n),s)o.setProperty(r,s[r])}let tN={};function tk(e,t){let{layout:n,layoutId:a}=t;return r.has(e)||e.startsWith("origin")||(n||void 0!==a)&&(!!tN[e]||"opacity"===e)}function tS(e,t,n){let{style:a}=e,r={};for(let s in a){var i;(eY(a[s])||t.style&&eY(t.style[s])||tk(s,e)||(null==n||null==(i=n.getValue(s))?void 0:i.liveStyle)!==void 0)&&(r[s]=a[s])}return r}class tC extends tg{readValueFromInstance(e,t){var n;if(r.has(t))return(null==(n=this.projection)?void 0:n.isProjecting)?d(t):((e,t)=>{let{transform:n="none"}=getComputedStyle(e);return p(n,t)})(e,t);{let n=window.getComputedStyle(e),a=(g(t)?n.getPropertyValue(t):n[t])||0;return"string"==typeof a?a.trim():a}}measureInstanceViewportBox(e,t){let{transformPagePoint:n}=t;return D(e,n)}build(e,t,n){tv(e,t,n.transformTemplate)}scrapeMotionValuesFromProps(e,t,n){return tS(e,t,n)}constructor(){super(...arguments),this.type="html",this.renderInstance=tw}}let tT=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),tI={offset:"stroke-dashoffset",array:"stroke-dasharray"},tE={offset:"strokeDashoffset",array:"strokeDasharray"};function t_(e,t,n,a,r){var i,s;let{attrX:o,attrY:l,attrScale:c,pathLength:u,pathSpacing:h=1,pathOffset:d=0,...p}=t;if(tv(e,p,a),n){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};let{attrs:f,style:m}=e;f.transform&&(m.transform=f.transform,delete f.transform),(m.transform||f.transformOrigin)&&(m.transformOrigin=null!=(i=f.transformOrigin)?i:"50% 50%",delete f.transformOrigin),m.transform&&(m.transformBox=null!=(s=null==r?void 0:r.transformBox)?s:"fill-box",delete f.transformBox),void 0!==o&&(f.x=o),void 0!==l&&(f.y=l),void 0!==c&&(f.scale=c),void 0!==u&&function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=!(arguments.length>4)||void 0===arguments[4]||arguments[4];e.pathLength=1;let i=r?tI:tE;e[i.offset]=V.transform(-a);let s=V.transform(t),o=V.transform(n);e[i.array]="".concat(s," ").concat(o)}(f,u,h,d,!1)}let tA=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),tR=e=>"string"==typeof e&&"svg"===e.toLowerCase();function tD(e,t,n){let r=tS(e,t,n);for(let n in e)(eY(e[n])||eY(t[n]))&&(r[-1!==a.indexOf(n)?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n]=e[n]);return r}class tM extends tg{getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(r.has(t)){let e=eH(t);return e&&e.default||0}return t=tA.has(t)?t:tT(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,n){return tD(e,t,n)}build(e,t,n){t_(e,t,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(e,t,n,a){for(let n in tw(e,t,void 0,a),t.attrs)e.setAttribute(tA.has(n)?n:tT(n),t.attrs[n])}mount(e){this.isSVGTag=tR(e.tagName),super.mount(e)}constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=tt}}let tF=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function tO(e){if("string"!=typeof e||e.includes("-"));else if(tF.indexOf(e)>-1||/[A-Z]/u.test(e))return!0;return!1}var tP=e.i(43476);e.s(["LayoutGroupContext",()=>tj],31178);let tj=(0,n.createContext)({}),tL=(0,n.createContext)({strict:!1});e.s(["MotionConfigContext",()=>tz],37806);let tz=(0,n.createContext)({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),tB=(0,n.createContext)({});function tV(e){return Array.isArray(e)?e.join(" "):e}let tU=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function tW(e,t,n){for(let a in t)eY(t[a])||tk(a,n)||(e[a]=t[a])}let tG=()=>({...tU(),attrs:{}}),tH=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function tq(e){return e.startsWith("while")||e.startsWith("drag")&&"draggable"!==e||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||tH.has(e)}let tK=e=>!tq(e);try{!function(e){"function"==typeof e&&(tK=t=>t.startsWith("on")?!tq(t):e(t))}((()=>{let e=Error("Cannot find module '@emotion/is-prop-valid'");throw e.code="MODULE_NOT_FOUND",e})().default)}catch(e){}e.s(["PresenceContext",()=>tX],21476);let tX=(0,n.createContext)(null);function tY(e){let t=(0,n.useRef)(null);return null===t.current&&(t.current=e()),t.current}function tZ(e){return eY(e)?e.get():e}e.s(["useConstant",()=>tY],47414);let tQ=e=>(t,a)=>{let r=(0,n.useContext)(tB),i=(0,n.useContext)(tX),s=()=>(function(e,t,n,a){let{scrapeMotionValuesFromProps:r,createRenderState:i}=e;return{latestValues:function(e,t,n,a){let r={},i=a(e,{});for(let e in i)r[e]=tZ(i[e]);let{initial:s,animate:o}=e,l=tu(e),c=th(e);t&&c&&!l&&!1!==e.inherit&&(void 0===s&&(s=t.initial),void 0===o&&(o=t.animate));let u=!!n&&!1===n.initial,h=(u=u||!1===s)?o:s;if(h&&"boolean"!=typeof h&&!ts(h)){let t=Array.isArray(h)?h:[h];for(let n=0;n<t.length;n++){let a=tp(e,t[n]);if(a){let{transitionEnd:e,transition:t,...n}=a;for(let e in n){let t=n[e];if(Array.isArray(t)){let e=u?t.length-1:0;t=t[e]}null!==t&&(r[e]=t)}for(let t in e)r[t]=e[t]}}}return r}(t,n,a,r),renderState:i()}})(e,t,r,i);return a?s():tY(s)},tJ=tQ({scrapeMotionValuesFromProps:tS,createRenderState:tU}),t$=tQ({scrapeMotionValuesFromProps:tD,createRenderState:tG}),t0=Symbol.for("motionComponentSymbol");function t1(e){return e&&"object"==typeof e&&Object.prototype.hasOwnProperty.call(e,"current")}let t2="data-"+tT("framerAppearId"),t3=(0,n.createContext)({});e.s(["useIsomorphicLayoutEffect",()=>t4],74008);let t4=tn?n.useLayoutEffect:n.useEffect;function t5(e){var t,a;let{forwardMotionProps:r=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;i&&function(e){for(let t in e)e8[t]={...e8[t],...e[t]}}(i);let o=tO(e)?t$:tJ;function l(t,a){var i;let l,c={...(0,n.useContext)(tz),...t,layoutId:function(e){let{layoutId:t}=e,a=(0,n.useContext)(tj).id;return a&&void 0!==t?a+"-"+t:t}(t)},{isStatic:u}=c,h=function(e){let{initial:t,animate:a}=function(e,t){if(tu(e)){let{initial:t,animate:n}=e;return{initial:!1===t||to(t)?t:void 0,animate:to(n)?n:void 0}}return!1!==e.inherit?t:{}}(e,(0,n.useContext)(tB));return(0,n.useMemo)(()=>({initial:t,animate:a}),[tV(t),tV(a)])}(t),d=o(t,u);if(!u&&tn){(0,n.useContext)(tL).strict;let t=function(e){let{drag:t,layout:n}=e8;if(!t&&!n)return{};let a={...t,...n};return{MeasureLayout:(null==t?void 0:t.isEnabled(e))||(null==n?void 0:n.isEnabled(e))?a.MeasureLayout:void 0,ProjectionNode:a.ProjectionNode}}(c);l=t.MeasureLayout,h.visualElement=function(e,t,a,r,i){var s,o,l,c;let{visualElement:u}=(0,n.useContext)(tB),h=(0,n.useContext)(tL),d=(0,n.useContext)(tX),p=(0,n.useContext)(tz).reducedMotion,f=(0,n.useRef)(null);r=r||h.renderer,!f.current&&r&&(f.current=r(e,{visualState:t,parent:u,props:a,presenceContext:d,blockInitialAnimation:!!d&&!1===d.initial,reducedMotionConfig:p}));let m=f.current,g=(0,n.useContext)(t3);m&&!m.projection&&i&&("html"===m.type||"svg"===m.type)&&function(e,t,n,a){let{layoutId:r,layout:i,drag:s,dragConstraints:o,layoutScroll:l,layoutRoot:c,layoutCrossfade:u}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:function e(t){if(t)return!1!==t.options.allowProjection?t.projection:e(t.parent)}(e.parent)),e.projection.setOptions({layoutId:r,layout:i,alwaysMeasureLayout:!!s||o&&t1(o),visualElement:e,animationType:"string"==typeof i?i:"both",initialPromotionConfig:a,crossfade:u,layoutScroll:l,layoutRoot:c})}(f.current,a,i,g);let x=(0,n.useRef)(!1);(0,n.useInsertionEffect)(()=>{m&&x.current&&m.update(a,d)});let y=a[t2],b=(0,n.useRef)(!!y&&!(null==(s=(o=window).MotionHandoffIsComplete)?void 0:s.call(o,y))&&(null==(l=(c=window).MotionHasOptimisedAnimation)?void 0:l.call(c,y)));return t4(()=>{m&&(x.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),m.scheduleRenderMicrotask(),b.current&&m.animationState&&m.animationState.animateChanges())}),(0,n.useEffect)(()=>{m&&(!b.current&&m.animationState&&m.animationState.animateChanges(),b.current&&(queueMicrotask(()=>{var e,t;null==(e=(t=window).MotionHandoffMarkAsComplete)||e.call(t,y)}),b.current=!1),m.enteringChildren=void 0)}),m}(e,d,c,s,t.ProjectionNode)}return(0,tP.jsxs)(tB.Provider,{value:h,children:[l&&h.visualElement?(0,tP.jsx)(l,{visualElement:h.visualElement,...c}):null,function(e,t,a,r,i){let{latestValues:s}=r,o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=(tO(e)?function(e,t,a,r){let i=(0,n.useMemo)(()=>{let n=tG();return t_(n,t,tR(r),e.transformTemplate,e.style),{...n.attrs,style:{...n.style}}},[t]);if(e.style){let t={};tW(t,e.style,e),i.style={...t,...i.style}}return i}:function(e,t){let a={},r=function(e,t){let a=e.style||{},r={};return tW(r,a,e),Object.assign(r,function(e,t){let{transformTemplate:a}=e;return(0,n.useMemo)(()=>{let e=tU();return tv(e,t,a),Object.assign({},e.vars,e.style)},[t])}(e,t)),r}(e,t);return e.drag&&!1!==e.dragListener&&(a.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=!0===e.drag?"none":"pan-".concat("x"===e.drag?"y":"x")),void 0===e.tabIndex&&(e.onTap||e.onTapStart||e.whileTap)&&(a.tabIndex=0),a.style=r,a})(t,s,i,e),c=function(e,t,n){let a={};for(let r in e)("values"!==r||"object"!=typeof e.values)&&(tK(r)||!0===n&&tq(r)||!t&&!tq(r)||e.draggable&&r.startsWith("onDrag"))&&(a[r]=e[r]);return a}(t,"string"==typeof e,o),u=e!==n.Fragment?{...c,...l,ref:a}:{},{children:h}=t,d=(0,n.useMemo)(()=>eY(h)?h.get():h,[h]);return(0,n.createElement)(e,{...u,children:d})}(e,t,(i=h.visualElement,(0,n.useCallback)(e=>{e&&d.onMount&&d.onMount(e),i&&(e?i.mount(e):i.unmount()),a&&("function"==typeof a?a(e):t1(a)&&(a.current=e))},[i])),d,u,r)]})}l.displayName="motion.".concat("string"==typeof e?e:"create(".concat(null!=(a=null!=(t=e.displayName)?t:e.name)?a:"",")"));let c=(0,n.forwardRef)(l);return c[t0]=e,c}function t6(e,t,n){let a=e.getProps();return tp(a,t,void 0!==n?n:a.custom,e)}function t8(e,t){var n,a;return null!=(a=null!=(n=null==e?void 0:e[t])?n:null==e?void 0:e.default)?a:e}let t9=e=>Array.isArray(e);function t7(e,t){let n=e.getValue("willChange");if(eY(n)&&n.add)return n.add(t);if(!n&&ea.WillChange){let n=new ea.WillChange("auto");e.addValue("willChange",n),n.add(t)}}function ne(e){e.duration=0,e.type}let nt=(e,t)=>n=>t(e(n)),nn=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(nt)},na=e=>1e3*e,nr={layout:0,mainThread:0,waapi:0};function ni(e,t,n){return(n<0&&(n+=1),n>1&&(n-=1),n<1/6)?e+(t-e)*6*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function ns(e,t){return n=>n>0?t:e}let no=(e,t,n)=>{let a=e*e,r=n*(t*t-a)+a;return r<0?0:Math.sqrt(r)},nl=[eT,eC,eI];function nc(e){let t=nl.find(t=>t.test(e));if(X(!!t,"'".concat(e,"' is not an animatable color. Use the equivalent color code instead."),"color-not-animatable"),!t)return!1;let n=t.parse(e);return t===eI&&(n=function(e){let{hue:t,saturation:n,lightness:a,alpha:r}=e;t/=360,a/=100;let i=0,s=0,o=0;if(n/=100){let e=a<.5?a*(1+n):a+n-a*n,r=2*a-e;i=ni(r,e,t+1/3),s=ni(r,e,t),o=ni(r,e,t-1/3)}else i=s=o=a;return{red:Math.round(255*i),green:Math.round(255*s),blue:Math.round(255*o),alpha:r}}(n)),n}let nu=(e,t)=>{let n=nc(e),a=nc(t);if(!n||!a)return ns(e,t);let r={...n};return e=>(r.red=no(n.red,a.red,e),r.green=no(n.green,a.green,e),r.blue=no(n.blue,a.blue,e),r.alpha=w(n.alpha,a.alpha,e),eC.transform(r))},nh=new Set(["none","hidden"]);function nd(e,t){return n=>w(e,t,n)}function np(e){return"number"==typeof e?nd:"string"==typeof e?y(e)?ns:eE.test(e)?nu:ng:Array.isArray(e)?nf:"object"==typeof e?eE.test(e)?nu:nm:ns}function nf(e,t){let n=[...e],a=n.length,r=e.map((e,n)=>np(e)(e,t[n]));return e=>{for(let t=0;t<a;t++)n[t]=r[t](e);return n}}function nm(e,t){let n={...e,...t},a={};for(let r in n)void 0!==e[r]&&void 0!==t[r]&&(a[r]=np(e[r])(e[r],t[r]));return e=>{for(let t in a)n[t]=a[t](e);return n}}let ng=(e,t)=>{let n=ej.createTransformer(t),a=eM(e),r=eM(t);return a.indexes.var.length===r.indexes.var.length&&a.indexes.color.length===r.indexes.color.length&&a.indexes.number.length>=r.indexes.number.length?nh.has(e)&&!r.values.length||nh.has(t)&&!a.values.length?function(e,t){return nh.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}(e,t):nn(nf(function(e,t){let n=[],a={color:0,var:0,number:0};for(let i=0;i<t.values.length;i++){var r;let s=t.types[i],o=e.indexes[s][a[s]],l=null!=(r=e.values[o])?r:0;n[i]=l,a[s]++}return n}(a,r),r.values),n):(X(!0,"Complex values '".concat(e,"' and '").concat(t,"' too different to mix. Ensure all colors are of the same type, and that each contains the same quantity of number and color values. Falling back to instant transition."),"complex-values-different"),ns(e,t))};function nx(e,t,n){return"number"==typeof e&&"number"==typeof t&&"number"==typeof n?w(e,t,n):np(e)(e,t)}let ny=e=>{let t=t=>{let{timestamp:n}=t;return e(n)};return{start:function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return eo.update(t,e)},stop:()=>el(t),now:()=>ec.isProcessing?ec.timestamp:eQ.now()}},nb=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,a="",r=Math.max(Math.round(t/n),2);for(let t=0;t<r;t++)a+=Math.round(1e4*e(t/(r-1)))/1e4+", ";return"linear(".concat(a.substring(0,a.length-2),")")};function nv(e){let t=0,n=e.next(t);for(;!n.done&&t<2e4;)t+=50,n=e.next(t);return t>=2e4?1/0:t}function nw(e,t,n){var a,r;let i=Math.max(t-5,0);return a=n-e(i),(r=t-i)?1e3/r*a:0}let nN={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1};function nk(e,t){return e*Math.sqrt(1-t*t)}let nS=["duration","bounce"],nC=["stiffness","damping","mass"];function nT(e,t){return t.some(t=>void 0!==e[t])}function nI(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nN.visualDuration,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:nN.bounce,a="object"!=typeof t?{visualDuration:t,keyframes:[0,1],bounce:n}:t,{restSpeed:r,restDelta:i}=a,s=a.keyframes[0],o=a.keyframes[a.keyframes.length-1],l={done:!1,value:s},{stiffness:c,damping:u,mass:h,duration:d,velocity:p,isResolvedFromDuration:f}=function(e){let t={velocity:nN.velocity,stiffness:nN.stiffness,damping:nN.damping,mass:nN.mass,isResolvedFromDuration:!1,...e};if(!nT(e,nC)&&nT(e,nS))if(e.visualDuration){let n=2*Math.PI/(1.2*e.visualDuration),a=n*n,r=2*F(.05,1,1-(e.bounce||0))*Math.sqrt(a);t={...t,mass:nN.mass,stiffness:a,damping:r}}else{let n=function(e){let t,n,{duration:a=nN.duration,bounce:r=nN.bounce,velocity:i=nN.velocity,mass:s=nN.mass}=e;X(a<=na(nN.maxDuration),"Spring duration must be 10 seconds or less","spring-duration-limit");let o=1-r;o=F(nN.minDamping,nN.maxDamping,o),a=F(nN.minDuration,nN.maxDuration,a/1e3),o<1?(t=e=>{let t=e*o,n=t*a;return .001-(t-i)/nk(e,o)*Math.exp(-n)},n=e=>{let n=e*o*a,r=Math.pow(o,2)*Math.pow(e,2)*a,s=Math.exp(-n),l=nk(Math.pow(e,2),o);return(n*i+i-r)*s*(-t(e)+.001>0?-1:1)/l}):(t=e=>-.001+Math.exp(-e*a)*((e-i)*a+1),n=e=>a*a*(i-e)*Math.exp(-e*a));let l=function(e,t,n){let a=n;for(let n=1;n<12;n++)a-=e(a)/t(a);return a}(t,n,5/a);if(a=na(a),isNaN(l))return{stiffness:nN.stiffness,damping:nN.damping,duration:a};{let e=Math.pow(l,2)*s;return{stiffness:e,damping:2*o*Math.sqrt(s*e),duration:a}}}(e);(t={...t,...n,mass:nN.mass}).isResolvedFromDuration=!0}return t}({...a,velocity:-((a.velocity||0)/1e3)}),m=p||0,g=u/(2*Math.sqrt(c*h)),x=o-s,y=Math.sqrt(c/h)/1e3,b=5>Math.abs(x);if(r||(r=b?nN.restSpeed.granular:nN.restSpeed.default),i||(i=b?nN.restDelta.granular:nN.restDelta.default),g<1){let t=nk(y,g);e=e=>o-Math.exp(-g*y*e)*((m+g*y*x)/t*Math.sin(t*e)+x*Math.cos(t*e))}else if(1===g)e=e=>o-Math.exp(-y*e)*(x+(m+y*x)*e);else{let t=y*Math.sqrt(g*g-1);e=e=>{let n=Math.exp(-g*y*e),a=Math.min(t*e,300);return o-n*((m+g*y*x)*Math.sinh(a)+t*x*Math.cosh(a))/t}}let v={calculatedDuration:f&&d||null,next:t=>{let n=e(t);if(f)l.done=t>=d;else{let a=0===t?m:0;g<1&&(a=0===t?na(m):nw(e,t,n));let s=Math.abs(o-n)<=i;l.done=Math.abs(a)<=r&&s}return l.value=l.done?o:n,l},toString:()=>{let e=Math.min(nv(v),2e4),t=nb(t=>v.next(e*t).value,e,30);return e+"ms "+t},toTransition:()=>{}};return v}function nE(e){let t,n,{keyframes:a,velocity:r=0,power:i=.8,timeConstant:s=325,bounceDamping:o=10,bounceStiffness:l=500,modifyTarget:c,min:u,max:h,restDelta:d=.5,restSpeed:p}=e,f=a[0],m={done:!1,value:f},g=i*r,x=f+g,y=void 0===c?x:c(x);y!==x&&(g=y-f);let b=e=>-g*Math.exp(-e/s),v=e=>y+b(e),w=e=>{let t=b(e),n=v(e);m.done=Math.abs(t)<=d,m.value=m.done?y:n},N=e=>{let a;if(a=m.value,void 0!==u&&a<u||void 0!==h&&a>h){var r;t=e,n=nI({keyframes:[m.value,(r=m.value,void 0===u?h:void 0===h||Math.abs(u-r)<Math.abs(h-r)?u:h)],velocity:nw(v,e,m.value),damping:o,stiffness:l,restDelta:d,restSpeed:p})}};return N(0),{calculatedDuration:null,next:e=>{let a=!1;return(n||void 0!==t||(a=!0,w(e),N(e)),void 0!==t&&e>=t)?n.next(e-t):(a||w(e),m)}}}nI.applyToOptions=e=>{let t=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments.length>2?arguments[2]:void 0,a=n({...e,keyframes:[0,t]}),r=Math.min(nv(a),2e4);return{type:"keyframes",ease:e=>a.next(r*e).value/t,duration:r/1e3}}(e,100,nI);return e.ease=t.ease,e.duration=na(t.duration),e.type="keyframes",e};let n_=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e;function nA(e,t,n,a){return e===t&&n===a?en:r=>0===r||1===r?r:n_(function(e,t,n,a,r){let i,s,o=0;do(i=n_(s=t+(n-t)/2,a,r)-e)>0?n=s:t=s;while(Math.abs(i)>1e-7&&++o<12)return s}(r,0,1,e,n),t,a)}let nR=nA(.42,0,1,1),nD=nA(0,0,.58,1),nM=nA(.42,0,.58,1),nF=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,nO=e=>t=>1-e(1-t),nP=nA(.33,1.53,.69,.99),nj=nO(nP),nL=nF(nj),nz=e=>(e*=2)<1?.5*nj(e):.5*(2-Math.pow(2,-10*(e-1))),nB=e=>1-Math.sin(Math.acos(e)),nV=nO(nB),nU=nF(nB),nW=e=>Array.isArray(e)&&"number"==typeof e[0],nG={linear:en,easeIn:nR,easeInOut:nM,easeOut:nD,circIn:nB,circInOut:nU,circOut:nV,backIn:nj,backInOut:nL,backOut:nP,anticipate:nz},nH=e=>{if(nW(e)){Y(4===e.length,"Cubic bezier arrays must contain four numerical values.","cubic-bezier-length");let[t,n,a,r]=e;return nA(t,n,a,r)}return"string"==typeof e?(Y(void 0!==nG[e],"Invalid easing type '".concat(e,"'"),"invalid-easing-type"),nG[e]):e},nq=(e,t,n)=>{let a=t-e;return 0===a?1:(n-e)/a};function nK(e){var t;let{duration:n=300,keyframes:a,times:r,ease:i="easeInOut"}=e,s=Array.isArray(i)&&"number"!=typeof i[0]?i.map(nH):nH(i),o={done:!1,value:a[0]},l=function(e,t){let{clamp:n=!0,ease:a,mixer:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=e.length;if(Y(i===t.length,"Both input and output ranges must be the same length","range-length"),1===i)return()=>t[0];if(2===i&&t[0]===t[1])return()=>t[1];let s=e[0]===e[1];e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());let o=function(e,t,n){let a=[],r=n||ea.mix||nx,i=e.length-1;for(let n=0;n<i;n++){let i=r(e[n],e[n+1]);t&&(i=nn(Array.isArray(t)?t[n]||en:t,i)),a.push(i)}return a}(t,a,r),l=o.length,c=n=>{if(s&&n<e[0])return t[0];let a=0;if(l>1)for(;a<e.length-2&&!(n<e[a+1]);a++);let r=nq(e[a],e[a+1],n);return o[a](r)};return n?t=>c(F(e[0],e[i-1],t)):c}((t=r&&r.length===a.length?r:function(e){let t=[0];return!function(e,t){let n=e[e.length-1];for(let a=1;a<=t;a++){let r=nq(0,t,a);e.push(w(n,1,r))}}(t,e.length-1),t}(a),t.map(e=>e*n)),a,{ease:Array.isArray(s)?s:a.map(()=>s||nM).splice(0,a.length-1)});return{calculatedDuration:n,next:e=>(o.value=l(e),o.done=e>=n,o)}}let nX=e=>null!==e;function nY(e,t,n){let{repeat:a,repeatType:r="loop"}=t,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=e.filter(nX),o=i<0||a&&"loop"!==r&&a%2==1?0:s.length-1;return o&&void 0!==n?n:s[o]}let nZ={decay:nE,inertia:nE,tween:nK,keyframes:nK,spring:nI};function nQ(e){"string"==typeof e.type&&(e.type=nZ[e.type])}class nJ{get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}constructor(){this.updateFinished()}}let n$=e=>e/100;class n0 extends nJ{initAnimation(){let{options:e}=this;nQ(e);let{type:t=nK,repeat:n=0,repeatDelay:a=0,repeatType:r,velocity:i=0}=e,{keyframes:s}=e,o=t||nK;o!==nK&&"number"!=typeof s[0]&&(this.mixKeyframes=nn(n$,nx(s[0],s[1])),s=[0,100]);let l=o({...e,keyframes:s});"mirror"===r&&(this.mirroredGenerator=o({...e,keyframes:[...s].reverse(),velocity:-i})),null===l.calculatedDuration&&(l.calculatedDuration=nv(l));let{calculatedDuration:c}=l;this.calculatedDuration=c,this.resolvedDuration=c+a,this.totalDuration=this.resolvedDuration*(n+1)-a,this.generator=l}updateTime(e){let t=Math.round(e-this.startTime)*this.playbackSpeed;null!==this.holdTime?this.currentTime=this.holdTime:this.currentTime=t}tick(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{generator:n,totalDuration:a,mixKeyframes:r,mirroredGenerator:i,resolvedDuration:s,calculatedDuration:o}=this;if(null===this.startTime)return n.next(0);let{delay:l=0,keyframes:c,repeat:u,repeatType:h,repeatDelay:d,type:p,onUpdate:f,finalKeyframe:m}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-a/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);let g=this.currentTime-l*(this.playbackSpeed>=0?1:-1),x=this.playbackSpeed>=0?g<0:g>a;this.currentTime=Math.max(g,0),"finished"===this.state&&null===this.holdTime&&(this.currentTime=a);let y=this.currentTime,b=n;if(u){let e=Math.min(this.currentTime,a)/s,t=Math.floor(e),n=e%1;!n&&e>=1&&(n=1),1===n&&t--,(t=Math.min(t,u+1))%2&&("reverse"===h?(n=1-n,d&&(n-=d/s)):"mirror"===h&&(b=i)),y=F(0,1,n)*s}let v=x?{done:!1,value:c[0]}:b.next(y);r&&(v.value=r(v.value));let{done:w}=v;x||null===o||(w=this.playbackSpeed>=0?this.currentTime>=a:this.currentTime<=0);let N=null===this.holdTime&&("finished"===this.state||"running"===this.state&&w);return N&&p!==nE&&(v.value=nY(c,this.options,m,this.speed)),f&&f(v.value),N&&this.finish(),v}then(e,t){return this.finished.then(e,t)}get duration(){return this.calculatedDuration/1e3}get time(){return this.currentTime/1e3}set time(e){var t;e=na(e),this.currentTime=e,null===this.startTime||null!==this.holdTime||0===this.playbackSpeed?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),null==(t=this.driver)||t.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(eQ.now());let t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=this.currentTime/1e3)}play(){var e,t;if(this.isStopped)return;let{driver:n=ny,startTime:a}=this.options;this.driver||(this.driver=n(e=>this.tick(e))),null==(e=(t=this.options).onPlay)||e.call(t);let r=this.driver.now();"finished"===this.state?(this.updateFinished(),this.startTime=r):null!==this.holdTime?this.startTime=r-this.holdTime:this.startTime||(this.startTime=null!=a?a:r),"finished"===this.state&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(eQ.now()),this.holdTime=this.currentTime}complete(){"running"!==this.state&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,t;this.notifyFinished(),this.teardown(),this.state="finished",null==(e=(t=this.options).onComplete)||e.call(t)}cancel(){var e,t;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),null==(e=(t=this.options).onCancel)||e.call(t)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null,nr.mainThread--}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var t;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),null==(t=this.driver)||t.stop(),e.observe(this)}constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var e,t;let{motionValue:n}=this.options;n&&n.updatedAt!==eQ.now()&&this.tick(eQ.now()),this.isStopped=!0,"idle"!==this.state&&(this.teardown(),null==(e=(t=this.options).onStop)||e.call(t))},nr.mainThread++,this.options=e,this.initAnimation(),this.play(),!1===e.autoplay&&this.pause()}}function n1(e){let t;return()=>(void 0===t&&(t=e()),t)}let n2=n1(()=>void 0!==window.ScrollTimeline),n3={},n4=function(e,t){let n=n1(e);return()=>{var e;return null!=(e=n3[t])?e:n()}}(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch(e){return!1}return!0},"linearEasing"),n5=e=>{let[t,n,a,r]=e;return"cubic-bezier(".concat(t,", ").concat(n,", ").concat(a,", ").concat(r,")")},n6={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:n5([0,.65,.55,1]),circOut:n5([.55,0,1,.45]),backIn:n5([.31,.01,.66,-.59]),backOut:n5([.33,1.53,.69,.99])};function n8(e){return"function"==typeof e&&"applyToOptions"in e}class n9 extends nJ{play(){this.isStopped||(this.animation.play(),"finished"===this.state&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,t;null==(e=(t=this.animation).finish)||e.call(t)}cancel(){try{this.animation.cancel()}catch(e){}}stop(){if(this.isStopped)return;this.isStopped=!0;let{state:e}=this;"idle"!==e&&"finished"!==e&&(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){if(!this.isPseudoElement){var e,t;null==(e=(t=this.animation).commitStyles)||e.call(t)}}get duration(){var e,t;return Number((null==(t=this.animation.effect)||null==(e=t.getComputedTiming)?void 0:e.call(t).duration)||0)/1e3}get time(){return(Number(this.animation.currentTime)||0)/1e3}set time(e){this.finishedTime=null,this.animation.currentTime=na(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return null!==this.finishedTime?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline(e){let{timeline:t,observe:n}=e;if(this.allowFlatten){var a;null==(a=this.animation.effect)||a.updateTiming({easing:"linear"})}return(this.animation.onfinish=null,t&&n2())?(this.animation.timeline=t,en):n(this)}constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;let{element:t,name:n,keyframes:a,pseudoElement:r,allowFlatten:i=!1,finalKeyframe:s,onComplete:o}=e;this.isPseudoElement=!!r,this.allowFlatten=i,this.options=e,Y("string"!=typeof e.type,'Mini animate() doesn\'t support "type" as a string.',"mini-spring");let l=function(e){let{type:t,...n}=e;return n8(t)&&n4()?t.applyToOptions(n):(null!=n.duration||(n.duration=300),null!=n.ease||(n.ease="easeOut"),n)}(e);this.animation=function(e,t,n){let{delay:a=0,duration:r=300,repeat:i=0,repeatType:s="loop",ease:o="easeOut",times:l}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,u={[t]:n};l&&(u.offset=l);let h=function e(t,n){if(t)return"function"==typeof t?n4()?nb(t,n):"ease-out":nW(t)?n5(t):Array.isArray(t)?t.map(t=>e(t,n)||n6.easeOut):n6[t]}(o,r);Array.isArray(h)&&(u.easing=h),ei.value&&nr.waapi++;let d={delay:a,duration:r,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:i+1,direction:"reverse"===s?"alternate":"normal"};c&&(d.pseudoElement=c);let p=e.animate(u,d);return ei.value&&p.finished.finally(()=>{nr.waapi--}),p}(t,n,a,l,r),!1===l.autoplay&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!r){let e=nY(a,this.options,s,this.speed);this.updateMotionValue?this.updateMotionValue(e):function(e,t,n){t.startsWith("--")?e.style.setProperty(t,n):e.style[t]=n}(t,n,e),this.animation.cancel()}null==o||o(),this.notifyFinished()}}}let n7={anticipate:nz,backInOut:nL,circInOut:nU};class ae extends n9{updateMotionValue(e){var t;let{motionValue:n,onUpdate:a,onComplete:r,element:i,...s}=this.options;if(!n)return;if(void 0!==e)return void n.set(e);let o=new n0({...s,autoplay:!1}),l=na(null!=(t=this.finishedTime)?t:this.time);n.setWithVelocity(o.sample(l-10).value,o.sample(l).value,10),o.stop()}constructor(e){!function(e){"string"==typeof e.ease&&e.ease in n7&&(e.ease=n7[e.ease])}(e),nQ(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}}let at=(e,t)=>"zIndex"!==t&&!!("number"==typeof e||Array.isArray(e)||"string"==typeof e&&(ej.test(e)||"0"===e)&&!e.startsWith("url(")),an=new Set(["opacity","clipPath","filter","transform"]),aa=n1(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));class ar extends nJ{onKeyframesResolved(e,t,n,a){this.keyframeResolver=void 0;let{name:r,type:i,velocity:s,delay:o,isHandoff:l,onUpdate:c}=n;this.resolvedAt=eQ.now(),!function(e,t,n,a){let r=e[0];if(null===r)return!1;if("display"===t||"visibility"===t)return!0;let i=e[e.length-1],s=at(r,t),o=at(i,t);return X(s===o,"You are trying to animate ".concat(t,' from "').concat(r,'" to "').concat(i,'". "').concat(s?i:r,'" is not an animatable value.'),"value-not-animatable"),!!s&&!!o&&(function(e){let t=e[0];if(1===e.length)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}(e)||("spring"===n||n8(n))&&a)}(e,r,i,s)&&((ea.instantAnimations||!o)&&(null==c||c(nY(e,n,t))),e[0]=e[e.length-1],ne(n),n.repeat=0);let u={startTime:a?this.resolvedAt&&this.resolvedAt-this.createdAt>40?this.resolvedAt:this.createdAt:void 0,finalKeyframe:t,...n,keyframes:e},h=!l&&function(e){var t;let{motionValue:n,name:a,repeatDelay:r,repeatType:i,damping:s,type:o}=e;if(!((null==n||null==(t=n.owner)?void 0:t.current)instanceof HTMLElement))return!1;let{onUpdate:l,transformTemplate:c}=n.owner.getProps();return aa()&&a&&an.has(a)&&("transform"!==a||!c)&&!l&&!r&&"mirror"!==i&&0!==s&&"inertia"!==o}(u)?new ae({...u,element:u.motionValue.owner.current}):new n0(u);h.finished.then(()=>this.notifyFinished()).catch(en),this.pendingTimeline&&(this.stopTimeline=h.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=h}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){if(!this._animation){var e;null==(e=this.keyframeResolver)||e.resume(),ef=!0,eg(),em(),ef=!1}return this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),null==(e=this.keyframeResolver)||e.cancel()}constructor({autoplay:e=!0,delay:t=0,type:n="keyframes",repeat:a=0,repeatDelay:r=0,repeatType:i="loop",keyframes:s,name:o,motionValue:l,element:c,...u}){var h;super(),this.stop=()=>{var e,t;this._animation&&(this._animation.stop(),null==(t=this.stopTimeline)||t.call(this)),null==(e=this.keyframeResolver)||e.cancel()},this.createdAt=eQ.now();let d={autoplay:e,delay:t,type:n,repeat:a,repeatDelay:r,repeatType:i,name:o,motionValue:l,element:c,...u},p=(null==c?void 0:c.KeyframeResolver)||ex;this.keyframeResolver=new p(s,(e,t,n)=>this.onKeyframesResolved(e,t,d,!n),o,l,c),null==(h=this.keyframeResolver)||h.scheduleResolve()}}let ai=e=>null!==e,as={type:"spring",stiffness:500,damping:25,restSpeed:10},ao={type:"keyframes",duration:.8},al={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},ac=function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0;return o=>{let l=t8(a,e)||{},c=l.delay||a.delay||0,{elapsed:u=0}=a;u-=na(c);let h={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity(),...l,delay:-u,onUpdate:e=>{t.set(e),l.onUpdate&&l.onUpdate(e)},onComplete:()=>{o(),l.onComplete&&l.onComplete()},name:e,motionValue:t,element:s?void 0:i};!function(e){let{when:t,delay:n,delayChildren:a,staggerChildren:r,staggerDirection:i,repeat:s,repeatType:o,repeatDelay:l,from:c,elapsed:u,...h}=e;return!!Object.keys(h).length}(l)&&Object.assign(h,((e,t)=>{let{keyframes:n}=t;return n.length>2?ao:r.has(e)?e.startsWith("scale")?{type:"spring",stiffness:550,damping:0===n[1]?2*Math.sqrt(550):30,restSpeed:10}:as:al})(e,h)),h.duration&&(h.duration=na(h.duration)),h.repeatDelay&&(h.repeatDelay=na(h.repeatDelay)),void 0!==h.from&&(h.keyframes[0]=h.from);let d=!1;if(!1!==h.type&&(0!==h.duration||h.repeatDelay)||(ne(h),0===h.delay&&(d=!0)),(ea.instantAnimations||ea.skipAnimations)&&(d=!0,ne(h),h.delay=0),h.allowFlatten=!l.type&&!l.ease,d&&!s&&void 0!==t.get()){let e=function(e,t,n){let{repeat:a,repeatType:r="loop"}=t,i=e.filter(ai),s=a&&"loop"!==r&&a%2==1?0:i.length-1;return i[s]}(h.keyframes,l);if(void 0!==e)return void eo.update(()=>{h.onUpdate(e),h.onComplete()})}return l.isSync?new n0(h):new ar(h)}};function au(e,t){let{delay:n=0,transitionOverride:a,type:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{transition:i=e.getDefaultTransition(),transitionEnd:s,...o}=t;a&&(i=a);let l=[],c=r&&e.animationState&&e.animationState.getState()[r];for(let t in o){var u;let a=e.getValue(t,null!=(u=e.latestValues[t])?u:null),r=o[t];if(void 0===r||c&&function(e,t){let{protectedKeys:n,needsAnimating:a}=e,r=n.hasOwnProperty(t)&&!0!==a[t];return a[t]=!1,r}(c,t))continue;let s={delay:n,...t8(i||{},t)},h=a.get();if(void 0!==h&&!a.isAnimating&&!Array.isArray(r)&&r===h&&!s.velocity)continue;let d=!1;if(window.MotionHandoffAnimation){let n=e.props[t2];if(n){let e=window.MotionHandoffAnimation(n,t,eo);null!==e&&(s.startTime=e,d=!0)}}t7(e,t),a.start(ac(t,a,r,e.shouldReduceMotion&&M.has(t)?{type:!1}:s,e,d));let p=a.animation;p&&l.push(p)}return s&&Promise.all(l).then(()=>{eo.update(()=>{s&&function(e,t){let{transitionEnd:n={},transition:a={},...r}=t6(e,t)||{};for(let t in r={...r,...n}){var i;let n=t9(i=r[t])?i[i.length-1]||0:i;e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,e3(n))}}(e,s)})}),l}function ah(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,i=Array.from(e).sort((e,t)=>e.sortNodePosition(t)).indexOf(t),s=e.size,o=(s-1)*a;return"function"==typeof n?n(i,s):1===r?i*a:o-i*a}function ad(e,t){var n;let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t6(e,t,"exit"===a.type?null==(n=e.presenceContext)?void 0:n.custom:void 0),{transition:i=e.getDefaultTransition()||{}}=r||{};a.transitionOverride&&(i=a.transitionOverride);let s=r?()=>Promise.all(au(e,r,a)):()=>Promise.resolve(),o=e.variantChildren&&e.variantChildren.size?function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,{delayChildren:r=0,staggerChildren:s,staggerDirection:o}=i;return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,s=arguments.length>6?arguments[6]:void 0,o=[];for(let l of e.variantChildren)l.notify("AnimationStart",t),o.push(ad(l,t,{...s,delay:n+("function"==typeof a?0:a)+ah(e.variantChildren,l,a,r,i)}).then(()=>l.notify("AnimationComplete",t)));return Promise.all(o)}(e,t,n,r,s,o,a)}:()=>Promise.resolve(),{when:l}=i;if(!l)return Promise.all([s(),o(a.delay)]);{let[e,t]="beforeChildren"===l?[s,o]:[o,s];return e().then(()=>t())}}function ap(e,t){if(!Array.isArray(t))return!1;let n=t.length;if(n!==e.length)return!1;for(let a=0;a<n;a++)if(t[a]!==e[a])return!1;return!0}let af=tc.length,am=[...tl].reverse(),ag=tl.length;function ax(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function ay(){return{animate:ax(!0),whileInView:ax(),whileHover:ax(),whileTap:ax(),whileDrag:ax(),whileFocus:ax(),exit:ax()}}class ab{update(){}constructor(e){this.isMounted=!1,this.node=e}}let av=0,aw={x:!1,y:!1};function aN(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{passive:!0};return e.addEventListener(t,n,a),()=>e.removeEventListener(t,n)}let ak=e=>"mouse"===e.pointerType?"number"!=typeof e.button||e.button<=0:!1!==e.isPrimary;function aS(e){return{point:{x:e.pageX,y:e.pageY}}}function aC(e,t,n,a){return aN(e,t,e=>ak(e)&&n(e,aS(e)),a)}function aT(e){return e.max-e.min}function aI(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;e.origin=a,e.originPoint=w(t.min,t.max,e.origin),e.scale=aT(n)/aT(t),e.translate=w(n.min,n.max,e.origin)-e.originPoint,(e.scale>=.9999&&e.scale<=1.0001||isNaN(e.scale))&&(e.scale=1),(e.translate>=-.01&&e.translate<=.01||isNaN(e.translate))&&(e.translate=0)}function aE(e,t,n,a){aI(e.x,t.x,n.x,a?a.originX:void 0),aI(e.y,t.y,n.y,a?a.originY:void 0)}function a_(e,t,n){e.min=n.min+t.min,e.max=e.min+aT(t)}function aA(e,t,n){e.min=t.min-n.min,e.max=e.min+aT(t)}function aR(e,t,n){aA(e.x,t.x,n.x),aA(e.y,t.y,n.y)}function aD(e){return[e("x"),e("y")]}let aM=e=>{let{current:t}=e;return t?t.ownerDocument.defaultView:null},aF=(e,t)=>Math.abs(e-t);class aO{updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),el(this.updatePoint)}constructor(e,t,{transformPagePoint:n,contextWindow:a=window,dragSnapToOrigin:r=!1,distanceThreshold:i=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;let e=aL(this.lastMoveEventInfo,this.history),t=null!==this.startEvent,n=function(e,t){return Math.sqrt(aF(e.x,t.x)**2+aF(e.y,t.y)**2)}(e.offset,{x:0,y:0})>=this.distanceThreshold;if(!t&&!n)return;let{point:a}=e,{timestamp:r}=ec;this.history.push({...a,timestamp:r});let{onStart:i,onMove:s}=this.handlers;t||(i&&i(this.lastMoveEvent,e),this.startEvent=this.lastMoveEvent),s&&s(this.lastMoveEvent,e)},this.handlePointerMove=(e,t)=>{this.lastMoveEvent=e,this.lastMoveEventInfo=aP(t,this.transformPagePoint),eo.update(this.updatePoint,!0)},this.handlePointerUp=(e,t)=>{this.end();let{onEnd:n,onSessionEnd:a,resumeAnimation:r}=this.handlers;if(this.dragSnapToOrigin&&r&&r(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;let i=aL("pointercancel"===e.type?this.lastMoveEventInfo:aP(t,this.transformPagePoint),this.history);this.startEvent&&n&&n(e,i),a&&a(e,i)},!ak(e))return;this.dragSnapToOrigin=r,this.handlers=t,this.transformPagePoint=n,this.distanceThreshold=i,this.contextWindow=a||window;let s=aP(aS(e),this.transformPagePoint),{point:o}=s,{timestamp:l}=ec;this.history=[{...o,timestamp:l}];let{onSessionStart:c}=t;c&&c(e,aL(s,this.history)),this.removeListeners=nn(aC(this.contextWindow,"pointermove",this.handlePointerMove),aC(this.contextWindow,"pointerup",this.handlePointerUp),aC(this.contextWindow,"pointercancel",this.handlePointerUp))}}function aP(e,t){return t?{point:t(e.point)}:e}function aj(e,t){return{x:e.x-t.x,y:e.y-t.y}}function aL(e,t){let{point:n}=e;return{point:n,delta:aj(n,az(t)),offset:aj(n,t[0]),velocity:function(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,a=null,r=az(e);for(;n>=0&&(a=e[n],!(r.timestamp-a.timestamp>na(.1)));)n--;if(!a)return{x:0,y:0};let i=(r.timestamp-a.timestamp)/1e3;if(0===i)return{x:0,y:0};let s={x:(r.x-a.x)/i,y:(r.y-a.y)/i};return s.x===1/0&&(s.x=0),s.y===1/0&&(s.y=0),s}(t,.1)}}function az(e){return e[e.length-1]}function aB(e,t,n){return{min:void 0!==t?e.min+t:void 0,max:void 0!==n?e.max+n-(e.max-e.min):void 0}}function aV(e,t){let n=t.min-e.min,a=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,a]=[a,n]),{min:n,max:a}}function aU(e,t,n){return{min:aW(e,t),max:aW(e,n)}}function aW(e,t){return"number"==typeof e?e:e[t]||0}let aG=new WeakMap;class aH{start(e){let{snapToCursor:t=!1,distanceThreshold:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{presenceContext:a}=this.visualElement;if(a&&!1===a.isPresent)return;let r=e=>{let{dragSnapToOrigin:n}=this.getProps();n?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(aS(e).point)},i=(e,t)=>{let{drag:n,dragPropagation:a,onDragStart:r}=this.getProps();if(n&&!a&&(this.openDragLock&&this.openDragLock(),this.openDragLock=function(e){if("x"===e||"y"===e)if(aw[e])return null;else return aw[e]=!0,()=>{aw[e]=!1};return aw.x||aw.y?null:(aw.x=aw.y=!0,()=>{aw.x=aw.y=!1})}(n),!this.openDragLock))return;this.latestPointerEvent=e,this.latestPanInfo=t,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),aD(e=>{let t=this.getAxisMotionValue(e).get()||0;if(B.test(t)){let{projection:n}=this.visualElement;if(n&&n.layout){let a=n.layout.layoutBox[e];a&&(t=aT(a)*(parseFloat(t)/100))}}this.originPoint[e]=t}),r&&eo.postRender(()=>r(e,t)),t7(this.visualElement,"transform");let{animationState:i}=this.visualElement;i&&i.setActive("whileDrag",!0)},s=(e,t)=>{this.latestPointerEvent=e,this.latestPanInfo=t;let{dragPropagation:n,dragDirectionLock:a,onDirectionLock:r,onDrag:i}=this.getProps();if(!n&&!this.openDragLock)return;let{offset:s}=t;if(a&&null===this.currentDirection){this.currentDirection=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}(s),null!==this.currentDirection&&r&&r(this.currentDirection);return}this.updateAxis("x",t.point,s),this.updateAxis("y",t.point,s),this.visualElement.render(),i&&i(e,t)},o=(e,t)=>{this.latestPointerEvent=e,this.latestPanInfo=t,this.stop(e,t),this.latestPointerEvent=null,this.latestPanInfo=null},l=()=>aD(e=>{var t;return"paused"===this.getAnimationState(e)&&(null==(t=this.getAxisMotionValue(e).animation)?void 0:t.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new aO(e,{onSessionStart:r,onStart:i,onMove:s,onSessionEnd:o,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,distanceThreshold:n,contextWindow:aM(this.visualElement)})}stop(e,t){let n=e||this.latestPointerEvent,a=t||this.latestPanInfo,r=this.isDragging;if(this.cancel(),!r||!a||!n)return;let{velocity:i}=a;this.startAnimation(i);let{onDragEnd:s}=this.getProps();s&&eo.postRender(()=>s(n,a))}cancel(){this.isDragging=!1;let{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;let{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,n){let{drag:a}=this.getProps();if(!n||!aq(e,a,this.currentDirection))return;let r=this.getAxisMotionValue(e),i=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(i=function(e,t,n){let{min:a,max:r}=t;return void 0!==a&&e<a?e=n?w(a,e,n.min):Math.max(e,a):void 0!==r&&e>r&&(e=n?w(r,e,n.max):Math.min(e,r)),e}(i,this.constraints[e],this.elastic[e])),r.set(i)}resolveConstraints(){var e;let{dragConstraints:t,dragElastic:n}=this.getProps(),a=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):null==(e=this.visualElement.projection)?void 0:e.layout,r=this.constraints;t&&t1(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&a?this.constraints=function(e,t){let{top:n,left:a,bottom:r,right:i}=t;return{x:aB(e.x,a,i),y:aB(e.y,n,r)}}(a.layoutBox,t):this.constraints=!1,this.elastic=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.35;return!1===e?e=0:!0===e&&(e=.35),{x:aU(e,"left","right"),y:aU(e,"top","bottom")}}(n),r!==this.constraints&&a&&this.constraints&&!this.hasMutatedConstraints&&aD(e=>{!1!==this.constraints&&this.getAxisMotionValue(e)&&(this.constraints[e]=function(e,t){let n={};return void 0!==t.min&&(n.min=t.min-e.min),void 0!==t.max&&(n.max=t.max-e.min),n}(a.layoutBox[e],this.constraints[e]))})}resolveRefConstraints(){var e;let{dragConstraints:t,onMeasureDragConstraints:n}=this.getProps();if(!t||!t1(t))return!1;let a=t.current;Y(null!==a,"If `dragConstraints` is set as a React ref, that ref must be passed to another component's `ref` prop.","drag-constraints-ref");let{projection:r}=this.visualElement;if(!r||!r.layout)return!1;let i=function(e,t,n){let a=D(e,n),{scroll:r}=t;return r&&(_(a.x,r.offset.x),_(a.y,r.offset.y)),a}(a,r.root,this.visualElement.getTransformPagePoint()),s=(e=r.layout.layoutBox,{x:aV(e.x,i.x),y:aV(e.y,i.y)});if(n){let e=n(function(e){let{x:t,y:n}=e;return{top:n.min,right:t.max,bottom:n.max,left:t.min}}(s));this.hasMutatedConstraints=!!e,e&&(s=v(e))}return s}startAnimation(e){let{drag:t,dragMomentum:n,dragElastic:a,dragTransition:r,dragSnapToOrigin:i,onDragTransitionEnd:s}=this.getProps(),o=this.constraints||{};return Promise.all(aD(s=>{if(!aq(s,t,this.currentDirection))return;let l=o&&o[s]||{};i&&(l={min:0,max:0});let c={type:"inertia",velocity:n?e[s]:0,bounceStiffness:a?200:1e6,bounceDamping:a?40:1e7,timeConstant:750,restDelta:1,restSpeed:10,...r,...l};return this.startAxisValueAnimation(s,c)})).then(s)}startAxisValueAnimation(e,t){let n=this.getAxisMotionValue(e);return t7(this.visualElement,e),n.start(ac(e,n,0,t,this.visualElement,!1))}stopAnimation(){aD(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){aD(e=>{var t;return null==(t=this.getAxisMotionValue(e).animation)?void 0:t.pause()})}getAnimationState(e){var t;return null==(t=this.getAxisMotionValue(e).animation)?void 0:t.state}getAxisMotionValue(e){let t="_drag".concat(e.toUpperCase()),n=this.visualElement.getProps();return n[t]||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){aD(t=>{let{drag:n}=this.getProps();if(!aq(t,n,this.currentDirection))return;let{projection:a}=this.visualElement,r=this.getAxisMotionValue(t);if(a&&a.layout){let{min:n,max:i}=a.layout.layoutBox[t];r.set(e[t]-w(n,i,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;let{drag:e,dragConstraints:t}=this.getProps(),{projection:n}=this.visualElement;if(!t1(t)||!n||!this.constraints)return;this.stopAnimation();let a={x:0,y:0};aD(e=>{let t=this.getAxisMotionValue(e);if(t&&!1!==this.constraints){let n=t.get();a[e]=function(e,t){let n=.5,a=aT(e),r=aT(t);return r>a?n=nq(t.min,t.max-a,e.min):a>r&&(n=nq(e.min,e.max-r,t.min)),F(0,1,n)}({min:n,max:n},this.constraints[e])}});let{transformTemplate:r}=this.visualElement.getProps();this.visualElement.current.style.transform=r?r({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),aD(t=>{if(!aq(t,e,null))return;let n=this.getAxisMotionValue(t),{min:r,max:i}=this.constraints[t];n.set(w(r,i,a[t]))})}addListeners(){if(!this.visualElement.current)return;aG.set(this.visualElement,this);let e=aC(this.visualElement.current,"pointerdown",e=>{let{drag:t,dragListener:n=!0}=this.getProps();t&&n&&this.start(e)}),t=()=>{let{dragConstraints:e}=this.getProps();t1(e)&&e.current&&(this.constraints=this.resolveRefConstraints())},{projection:n}=this.visualElement,a=n.addEventListener("measure",t);n&&!n.layout&&(n.root&&n.root.updateScroll(),n.updateLayout()),eo.read(t);let r=aN(window,"resize",()=>this.scalePositionWithinConstraints()),i=n.addEventListener("didUpdate",e=>{let{delta:t,hasLayoutChanged:n}=e;this.isDragging&&n&&(aD(e=>{let n=this.getAxisMotionValue(e);n&&(this.originPoint[e]+=t[e].translate,n.set(n.get()+t[e].translate))}),this.visualElement.render())});return()=>{r(),e(),a(),i&&i()}}getProps(){let e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:n=!1,dragPropagation:a=!1,dragConstraints:r=!1,dragElastic:i=.35,dragMomentum:s=!0}=e;return{...e,drag:t,dragDirectionLock:n,dragPropagation:a,dragConstraints:r,dragElastic:i,dragMomentum:s}}constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=tt(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}}function aq(e,t,n){return(!0===t||t===e)&&(null===n||n===e)}let aK=e=>(t,n)=>{e&&eo.postRender(()=>e(t,n))};var aX=n;function aY(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=(0,n.useContext)(tX);if(null===t)return[!0,null];let{isPresent:a,onExitComplete:r,register:i}=t,s=(0,n.useId)();(0,n.useEffect)(()=>{if(e)return i(s)},[e]);let o=(0,n.useCallback)(()=>e&&r&&r(s),[s,r,e]);return!a&&r?[!1,o]:[!0]}e.s(["usePresence",()=>aY],64978);let aZ={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function aQ(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}let aJ={correct:(e,t)=>{if(!t.target)return e;if("string"==typeof e)if(!V.test(e))return e;else e=parseFloat(e);let n=aQ(e,t.target.x),a=aQ(e,t.target.y);return"".concat(n,"% ").concat(a,"%")}},a$=!1;class a0 extends aX.Component{componentDidMount(){let{visualElement:e,layoutGroup:t,switchLayoutGroup:n,layoutId:a}=this.props,{projection:r}=e;for(let e in a2)tN[e]=a2[e],g(e)&&(tN[e].isCSSVariable=!0);r&&(t.group&&t.group.add(r),n&&n.register&&a&&n.register(r),a$&&r.root.didUpdate(),r.addEventListener("animationComplete",()=>{this.safeToRemove()}),r.setOptions({...r.options,onExitComplete:()=>this.safeToRemove()})),aZ.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){let{layoutDependency:t,visualElement:n,drag:a,isPresent:r}=this.props,{projection:i}=n;return i&&(i.isPresent=r,a$=!0,a||e.layoutDependency!==t||void 0===t||e.isPresent!==r?i.willUpdate():this.safeToRemove(),e.isPresent!==r&&(r?i.promote():i.relegate()||eo.postRender(()=>{let e=i.getStack();e&&e.members.length||this.safeToRemove()}))),null}componentDidUpdate(){let{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),e5.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){let{visualElement:e,layoutGroup:t,switchLayoutGroup:n}=this.props,{projection:a}=e;a$=!0,a&&(a.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(a),n&&n.deregister&&n.deregister(a))}safeToRemove(){let{safeToRemove:e}=this.props;e&&e()}render(){return null}}function a1(e){let[t,n]=aY(),a=(0,aX.useContext)(tj);return(0,tP.jsx)(a0,{...e,layoutGroup:a,switchLayoutGroup:(0,aX.useContext)(t3),isPresent:t,safeToRemove:n})}let a2={borderRadius:{...aJ,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:aJ,borderTopRightRadius:aJ,borderBottomLeftRadius:aJ,borderBottomRightRadius:aJ,boxShadow:{correct:(e,t)=>{let{treeScale:n,projectionDelta:a}=t,r=ej.parse(e);if(r.length>5)return e;let i=ej.createTransformer(e),s=+("number"!=typeof r[0]),o=a.x.scale*n.x,l=a.y.scale*n.y;r[0+s]/=o,r[1+s]/=l;let c=w(o,l,.5);return"number"==typeof r[2+s]&&(r[2+s]/=c),"number"==typeof r[3+s]&&(r[3+s]/=c),i(r)}}};function a3(e){return"object"==typeof e&&null!==e}function a4(e){return a3(e)&&"ownerSVGElement"in e}let a5=(e,t)=>e.depth-t.depth;class a6{add(e){eJ(this.children,e),this.isDirty=!0}remove(e){e$(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(a5),this.isDirty=!1,this.children.forEach(e)}constructor(){this.children=[],this.isDirty=!1}}let a8=["TopLeft","TopRight","BottomLeft","BottomRight"],a9=a8.length,a7=e=>"string"==typeof e?parseFloat(e):e,re=e=>"number"==typeof e||V.test(e);function rt(e,t){return void 0!==e[t]?e[t]:e.borderRadius}let rn=rr(0,.5,nV),ra=rr(.5,.95,en);function rr(e,t,n){return a=>a<e?0:a>t?1:n(nq(e,t,a))}function ri(e,t){e.min=t.min,e.max=t.max}function rs(e,t){ri(e.x,t.x),ri(e.y,t.y)}function ro(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function rl(e,t,n,a,r){return e-=t,e=a+1/n*(e-a),void 0!==r&&(e=a+1/r*(e-a)),e}function rc(e,t,n,a,r){let[i,s,o]=n;!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:e;if(B.test(t)&&(t=parseFloat(t),t=w(s.min,s.max,t/100)-s.min),"number"!=typeof t)return;let o=w(i.min,i.max,a);e===i&&(o-=t),e.min=rl(e.min,t,n,o,r),e.max=rl(e.max,t,n,o,r)}(e,t[i],t[s],t[o],t.scale,a,r)}let ru=["x","scaleX","originX"],rh=["y","scaleY","originY"];function rd(e,t,n,a){rc(e.x,t,ru,n?n.x:void 0,a?a.x:void 0),rc(e.y,t,rh,n?n.y:void 0,a?a.y:void 0)}function rp(e){return 0===e.translate&&1===e.scale}function rf(e){return rp(e.x)&&rp(e.y)}function rm(e,t){return e.min===t.min&&e.max===t.max}function rg(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function rx(e,t){return rg(e.x,t.x)&&rg(e.y,t.y)}function ry(e){return aT(e.x)/aT(e.y)}function rb(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class rv{add(e){eJ(this.members,e),e.scheduleRender()}remove(e){if(e$(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){let e=this.members[this.members.length-1];e&&this.promote(e)}}relegate(e){let t,n=this.members.findIndex(t=>e===t);if(0===n)return!1;for(let e=n;e>=0;e--){let n=this.members[e];if(!1!==n.isPresent){t=n;break}}return!!t&&(this.promote(t),!0)}promote(e,t){let n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,t&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);let{crossfade:a}=e.options;!1===a&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{let{options:t,resumingFrom:n}=e;t.onExitComplete&&t.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}constructor(){this.members=[]}}let rw={nodes:0,calculatedTargetDeltas:0,calculatedProjections:0},rN=["","X","Y","Z"],rk=0;function rS(e,t,n,a){let{latestValues:r}=t;r[e]&&(n[e]=r[e],t.setStaticValue(e,0),a&&(a[e]=0))}function rC(e){let{attachResizeListener:t,defaultParent:n,measureScroll:a,checkIsScrollRoot:r,resetTransform:i}=e;return class{addEventListener(e,t){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new e0),this.eventHandlers.get(e).add(t)}notifyListeners(e){for(var t=arguments.length,n=Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];let r=this.eventHandlers.get(e);r&&r.notify(...n)}hasListeners(e){return this.eventHandlers.has(e)}mount(e){if(this.instance)return;this.isSVG=a4(e)&&!(a4(e)&&"svg"===e.tagName),this.instance=e;let{layoutId:n,layout:a,visualElement:r}=this.options;if(r&&!r.current&&r.mount(e),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(a||n)&&(this.isLayoutDirty=!0),t){let n,a=0,r=()=>this.root.updateBlockedByResize=!1;eo.read(()=>{a=window.innerWidth}),t(e,()=>{let e=window.innerWidth;e!==a&&(a=e,this.root.updateBlockedByResize=!0,n&&n(),n=function(e,t){let n=eQ.now(),a=t=>{let{timestamp:r}=t,i=r-n;i>=250&&(el(a),e(i-250))};return eo.setup(a,!0),()=>el(a)}(r,250),aZ.hasAnimatedSinceResize&&(aZ.hasAnimatedSinceResize=!1,this.nodes.forEach(rF)))})}n&&this.root.registerSharedNode(n,this),!1!==this.options.animate&&r&&(n||a)&&this.addEventListener("didUpdate",e=>{let{delta:t,hasLayoutChanged:n,hasRelativeLayoutChanged:a,layout:i}=e;if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}let s=this.options.transition||r.getDefaultTransition()||rU,{onLayoutAnimationStart:o,onLayoutAnimationComplete:l}=r.getProps(),c=!this.targetLayout||!rx(this.targetLayout,i),u=!n&&a;if(this.options.layoutRoot||this.resumeFrom||u||n&&(c||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);let e={...t8(s,"layout"),onPlay:o,onComplete:l};(r.shouldReduceMotion||this.options.layoutRoot)&&(e.delay=0,e.type=!1),this.startAnimation(e),this.setAnimationOrigin(t,u)}else n||rF(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=i})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);let e=this.getStack();e&&e.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),el(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){!this.isUpdateBlocked()&&(this.isUpdating=!0,this.nodes&&this.nodes.forEach(rj),this.animationId++)}getTransformTemplate(){let{visualElement:e}=this.options;return e&&e.getProps().transformTemplate}willUpdate(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&function e(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;let{visualElement:n}=t.options;if(!n)return;let a=n.props[t2];if(window.MotionHasOptimisedAnimation(a,"transform")){let{layout:e,layoutId:n}=t.options;window.MotionCancelOptimisedAnimation(a,"transform",eo,!(e||n))}let{parent:r}=t;r&&!r.hasCheckedOptimisedAppear&&e(r)}(this),this.root.isUpdating||this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let e=0;e<this.path.length;e++){let t=this.path[e];t.shouldResetTransform=!0,t.updateScroll("snapshot"),t.options.layoutRoot&&t.willUpdate(!1)}let{layoutId:t,layout:n}=this.options;if(void 0===t&&!n)return;let a=this.getTransformTemplate();this.prevTransformTemplateValue=a?a(this.latestValues,""):void 0,this.updateSnapshot(),e&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(rR);return}if(this.animationId<=this.animationCommitId)return void this.nodes.forEach(rD);this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(rM),this.nodes.forEach(rT),this.nodes.forEach(rI)):this.nodes.forEach(rD),this.clearAllSnapshots();let e=eQ.now();ec.delta=F(0,1e3/60,e-ec.timestamp),ec.timestamp=e,ec.isProcessing=!0,eu.update.process(ec),eu.preRender.process(ec),eu.render.process(ec),ec.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,e5.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(rA),this.sharedNodes.forEach(rL)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,eo.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){eo.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){!this.snapshot&&this.instance&&(this.snapshot=this.measure(),!this.snapshot||aT(this.snapshot.measuredBox.x)||aT(this.snapshot.measuredBox.y)||(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let e=0;e<this.path.length;e++)this.path[e].updateScroll();let e=this.layout;this.layout=this.measure(!1),this.layoutCorrected=tt(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);let{visualElement:t}=this.options;t&&t.notify("LayoutMeasure",this.layout.layoutBox,e?e.layoutBox:void 0)}updateScroll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"measure",t=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===e&&(t=!1),t&&this.instance){let t=r(this.instance);this.scroll={animationId:this.root.animationId,phase:e,isRoot:t,offset:a(this.instance),wasRoot:this.scroll?this.scroll.isRoot:t}}}resetTransform(){if(!i)return;let e=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,t=this.projectionDelta&&!rf(this.projectionDelta),n=this.getTransformTemplate(),a=n?n(this.latestValues,""):void 0,r=a!==this.prevTransformTemplateValue;e&&this.instance&&(t||S(this.latestValues)||r)&&(i(this.instance,a),this.shouldResetTransform=!1,this.scheduleRender())}measure(){var e;let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0],n=this.measurePageBox(),a=this.removeElementScroll(n);return t&&(a=this.removeTransform(a)),rH((e=a).x),rH(e.y),{animationId:this.root.animationId,measuredBox:n,layoutBox:a,latestValues:{},source:this.id}}measurePageBox(){var e;let{visualElement:t}=this.options;if(!t)return tt();let n=t.measureViewportBox();if(!((null==(e=this.scroll)?void 0:e.wasRoot)||this.path.some(rK))){let{scroll:e}=this.root;e&&(_(n.x,e.offset.x),_(n.y,e.offset.y))}return n}removeElementScroll(e){var t;let n=tt();if(rs(n,e),null==(t=this.scroll)?void 0:t.wasRoot)return n;for(let t=0;t<this.path.length;t++){let a=this.path[t],{scroll:r,options:i}=a;a!==this.root&&r&&i.layoutScroll&&(r.wasRoot&&rs(n,e),_(n.x,r.offset.x),_(n.y,r.offset.y))}return n}applyTransform(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=tt();rs(n,e);for(let e=0;e<this.path.length;e++){let a=this.path[e];!t&&a.options.layoutScroll&&a.scroll&&a!==a.root&&R(n,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),S(a.latestValues)&&R(n,a.latestValues)}return S(this.latestValues)&&R(n,this.latestValues),n}removeTransform(e){let t=tt();rs(t,e);for(let e=0;e<this.path.length;e++){let n=this.path[e];if(!n.instance||!S(n.latestValues))continue;k(n.latestValues)&&n.updateSnapshot();let a=tt();rs(a,n.measurePageBox()),rd(t,n.latestValues,n.snapshot?n.snapshot.layoutBox:void 0,a)}return S(this.latestValues)&&rd(t,this.latestValues),t}setTargetDelta(e){this.targetDelta=e,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(e){this.options={...this.options,...e,crossfade:void 0===e.crossfade||e.crossfade}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ec.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(){var e,t,n,a;let r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=i.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=i.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=i.isSharedProjectionDirty);let s=!!this.resumingFrom||this!==i;if(!(r||s&&this.isSharedProjectionDirty||this.isProjectionDirty||(null==(e=this.parent)?void 0:e.isProjectionDirty)||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;let{layout:o,layoutId:l}=this.options;if(this.layout&&(o||l)){if(this.resolvedRelativeTargetAt=ec.timestamp,!this.targetDelta&&!this.relativeTarget){let e=this.getClosestProjectingParent();e&&e.layout&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget=tt(),this.relativeTargetOrigin=tt(),aR(this.relativeTargetOrigin,this.layout.layoutBox,e.layout.layoutBox),rs(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(this.relativeTarget||this.targetDelta){if((this.target||(this.target=tt(),this.targetWithTransforms=tt()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target)?(this.forceRelativeParentToResolveTarget(),t=this.target,n=this.relativeTarget,a=this.relativeParent.target,a_(t.x,n.x,a.x),a_(t.y,n.y,a.y)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):rs(this.target,this.layout.layoutBox),E(this.target,this.targetDelta)):rs(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;let e=this.getClosestProjectingParent();e&&!!e.resumingFrom==!!this.resumingFrom&&!e.options.layoutScroll&&e.target&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget=tt(),this.relativeTargetOrigin=tt(),aR(this.relativeTargetOrigin,this.target,e.target),rs(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}ei.value&&rw.calculatedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||k(this.parent.latestValues)||C(this.parent.latestValues)))if(this.parent.isProjecting())return this.parent;else return this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var e;let t=this.getLead(),n=!!this.resumingFrom||this!==t,a=!0;if((this.isProjectionDirty||(null==(e=this.parent)?void 0:e.isProjectionDirty))&&(a=!1),n&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(a=!1),this.resolvedRelativeTargetAt===ec.timestamp&&(a=!1),a)return;let{layout:r,layoutId:i}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(r||i))return;rs(this.layoutCorrected,this.layout.layoutBox);let s=this.treeScale.x,o=this.treeScale.y;!function(e,t,n){let a,r,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=n.length;if(s){t.x=t.y=1;for(let o=0;o<s;o++){r=(a=n[o]).projectionDelta;let{visualElement:s}=a.options;(!s||!s.props.style||"contents"!==s.props.style.display)&&(i&&a.options.layoutScroll&&a.scroll&&a!==a.root&&R(e,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),r&&(t.x*=r.x.scale,t.y*=r.y.scale,E(e,r)),i&&S(a.latestValues)&&R(e,a.latestValues))}t.x<1.0000000000001&&t.x>.999999999999&&(t.x=1),t.y<1.0000000000001&&t.y>.999999999999&&(t.y=1)}}(this.layoutCorrected,this.treeScale,this.path,n),t.layout&&!t.target&&(1!==this.treeScale.x||1!==this.treeScale.y)&&(t.target=t.layout.layoutBox,t.targetWithTransforms=tt());let{target:l}=t;if(!l){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}this.projectionDelta&&this.prevProjectionDelta?(ro(this.prevProjectionDelta.x,this.projectionDelta.x),ro(this.prevProjectionDelta.y,this.projectionDelta.y)):this.createProjectionDeltas(),aE(this.projectionDelta,this.layoutCorrected,l,this.latestValues),this.treeScale.x===s&&this.treeScale.y===o&&rb(this.projectionDelta.x,this.prevProjectionDelta.x)&&rb(this.projectionDelta.y,this.prevProjectionDelta.y)||(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",l)),ei.value&&rw.calculatedProjections++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(){var e;let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(null==(e=this.options.visualElement)||e.scheduleRender(),t){let e=this.getStack();e&&e.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=e7(),this.projectionDelta=e7(),this.projectionDeltaWithTransform=e7()}setAnimationOrigin(e){let t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=this.snapshot,r=a?a.latestValues:{},i={...this.latestValues},s=e7();this.relativeParent&&this.relativeParent.options.layoutRoot||(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!n;let o=tt(),l=(a?a.source:void 0)!==(this.layout?this.layout.source:void 0),c=this.getStack(),u=!c||c.members.length<=1,h=!!(l&&!u&&!0===this.options.crossfade&&!this.path.some(rV));this.animationProgress=0,this.mixTargetDelta=n=>{let a=n/1e3;if(rz(s.x,e.x,a),rz(s.y,e.y,a),this.setTargetDelta(s),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout){var c,d,p,f,m,g;aR(o,this.layout.layoutBox,this.relativeParent.layout.layoutBox),p=this.relativeTarget,f=this.relativeTargetOrigin,m=o,g=a,rB(p.x,f.x,m.x,g),rB(p.y,f.y,m.y,g),t&&(c=this.relativeTarget,d=t,rm(c.x,d.x)&&rm(c.y,d.y))&&(this.isProjectionDirty=!1),t||(t=tt()),rs(t,this.relativeTarget)}l&&(this.animationValues=i,function(e,t,n,a,r,i){var s,o,l,c;r?(e.opacity=w(0,null!=(s=n.opacity)?s:1,rn(a)),e.opacityExit=w(null!=(o=t.opacity)?o:1,0,ra(a))):i&&(e.opacity=w(null!=(l=t.opacity)?l:1,null!=(c=n.opacity)?c:1,a));for(let r=0;r<a9;r++){let i="border".concat(a8[r],"Radius"),s=rt(t,i),o=rt(n,i);(void 0!==s||void 0!==o)&&(s||(s=0),o||(o=0),0===s||0===o||re(s)===re(o)?(e[i]=Math.max(w(a7(s),a7(o),a),0),(B.test(o)||B.test(s))&&(e[i]+="%")):e[i]=o)}(t.rotate||n.rotate)&&(e.rotate=w(t.rotate||0,n.rotate||0,a))}(i,r,this.latestValues,a,h,u)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=a},this.mixTargetDelta(1e3*!!this.options.layoutRoot)}startAnimation(e){var t,n,a;this.notifyListeners("animationStart"),null==(t=this.currentAnimation)||t.stop(),null==(a=this.resumingFrom)||null==(n=a.currentAnimation)||n.stop(),this.pendingAnimation&&(el(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=eo.update(()=>{aZ.hasAnimatedSinceResize=!0,nr.layout++,this.motionValue||(this.motionValue=e3(0)),this.currentAnimation=function(e,t,n){let a=eY(e)?e:e3(e);return a.start(ac("",a,t,n)),a.animation}(this.motionValue,[0,1e3],{...e,velocity:0,isSync:!0,onUpdate:t=>{this.mixTargetDelta(t),e.onUpdate&&e.onUpdate(t)},onStop:()=>{nr.layout--},onComplete:()=>{nr.layout--,e.onComplete&&e.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);let e=this.getStack();e&&e.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(1e3),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){let e=this.getLead(),{targetWithTransforms:t,target:n,layout:a,latestValues:r}=e;if(t&&n&&a){if(this!==e&&this.layout&&a&&rq(this.options.animationType,this.layout.layoutBox,a.layoutBox)){n=this.target||tt();let t=aT(this.layout.layoutBox.x);n.x.min=e.target.x.min,n.x.max=n.x.min+t;let a=aT(this.layout.layoutBox.y);n.y.min=e.target.y.min,n.y.max=n.y.min+a}rs(t,n),R(t,r),aE(this.projectionDeltaWithTransform,this.layoutCorrected,t,r)}}registerSharedNode(e,t){this.sharedNodes.has(e)||this.sharedNodes.set(e,new rv),this.sharedNodes.get(e).add(t);let n=t.options.initialPromotionConfig;t.promote({transition:n?n.transition:void 0,preserveFollowOpacity:n&&n.shouldPreserveFollowOpacity?n.shouldPreserveFollowOpacity(t):void 0})}isLead(){let e=this.getStack();return!e||e.lead===this}getLead(){var e;let{layoutId:t}=this.options;return t&&(null==(e=this.getStack())?void 0:e.lead)||this}getPrevLead(){var e;let{layoutId:t}=this.options;return t?null==(e=this.getStack())?void 0:e.prevLead:void 0}getStack(){let{layoutId:e}=this.options;if(e)return this.root.sharedNodes.get(e)}promote(){let{needsReset:e,transition:t,preserveFollowOpacity:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=this.getStack();a&&a.promote(this,n),e&&(this.projectionDelta=void 0,this.needsReset=!0),t&&this.setOptions({transition:t})}relegate(){let e=this.getStack();return!!e&&e.relegate(this)}resetSkewAndRotation(){let{visualElement:e}=this.options;if(!e)return;let t=!1,{latestValues:n}=e;if((n.z||n.rotate||n.rotateX||n.rotateY||n.rotateZ||n.skewX||n.skewY)&&(t=!0),!t)return;let a={};n.z&&rS("z",e,a,this.animationValues);for(let t=0;t<rN.length;t++)rS("rotate".concat(rN[t]),e,a,this.animationValues),rS("skew".concat(rN[t]),e,a,this.animationValues);for(let t in e.render(),a)e.setStaticValue(t,a[t]),this.animationValues&&(this.animationValues[t]=a[t]);e.scheduleRender()}applyProjectionStyles(e,t){if(!this.instance||this.isSVG)return;if(!this.isVisible){e.visibility="hidden";return}let n=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,e.visibility="",e.opacity="",e.pointerEvents=tZ(null==t?void 0:t.pointerEvents)||"",e.transform=n?n(this.latestValues,""):"none";return}let a=this.getLead();if(!this.projectionDelta||!this.layout||!a.target){this.options.layoutId&&(e.opacity=void 0!==this.latestValues.opacity?this.latestValues.opacity:1,e.pointerEvents=tZ(null==t?void 0:t.pointerEvents)||""),this.hasProjected&&!S(this.latestValues)&&(e.transform=n?n({},""):"none",this.hasProjected=!1);return}e.visibility="";let r=a.animationValues||a.latestValues;this.applyTransformsToTarget();let i=function(e,t,n){let a="",r=e.x.translate/t.x,i=e.y.translate/t.y,s=(null==n?void 0:n.z)||0;if((r||i||s)&&(a="translate3d(".concat(r,"px, ").concat(i,"px, ").concat(s,"px) ")),(1!==t.x||1!==t.y)&&(a+="scale(".concat(1/t.x,", ").concat(1/t.y,") ")),n){let{transformPerspective:e,rotate:t,rotateX:r,rotateY:i,skewX:s,skewY:o}=n;e&&(a="perspective(".concat(e,"px) ").concat(a)),t&&(a+="rotate(".concat(t,"deg) ")),r&&(a+="rotateX(".concat(r,"deg) ")),i&&(a+="rotateY(".concat(i,"deg) ")),s&&(a+="skewX(".concat(s,"deg) ")),o&&(a+="skewY(".concat(o,"deg) "))}let o=e.x.scale*t.x,l=e.y.scale*t.y;return(1!==o||1!==l)&&(a+="scale(".concat(o,", ").concat(l,")")),a||"none"}(this.projectionDeltaWithTransform,this.treeScale,r);n&&(i=n(r,i)),e.transform=i;let{x:s,y:o}=this.projectionDelta;if(e.transformOrigin="".concat(100*s.origin,"% ").concat(100*o.origin,"% 0"),a.animationValues){var l,c;e.opacity=a===this?null!=(c=null!=(l=r.opacity)?l:this.latestValues.opacity)?c:1:this.preserveOpacity?this.latestValues.opacity:r.opacityExit}else e.opacity=a===this?void 0!==r.opacity?r.opacity:"":void 0!==r.opacityExit?r.opacityExit:0;for(let t in tN){if(void 0===r[t])continue;let{correct:n,applyTo:s,isCSSVariable:o}=tN[t],l="none"===i?r[t]:n(r[t],a);if(s){let t=s.length;for(let n=0;n<t;n++)e[s[n]]=l}else o?this.options.visualElement.renderState.vars[t]=l:e[t]=l}this.options.layoutId&&(e.pointerEvents=a===this?tZ(null==t?void 0:t.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(e=>{var t;return null==(t=e.currentAnimation)?void 0:t.stop()}),this.root.nodes.forEach(rR),this.root.sharedNodes.clear()}constructor(e={},t=null==n?void 0:n()){this.id=rk++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,ei.value&&(rw.nodes=rw.calculatedTargetDeltas=rw.calculatedProjections=0),this.nodes.forEach(rE),this.nodes.forEach(rO),this.nodes.forEach(rP),this.nodes.forEach(r_),ei.addProjectionMetrics&&ei.addProjectionMetrics(rw)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=e,this.root=t?t.root||t:this,this.path=t?[...t.path,t]:[],this.parent=t,this.depth=t?t.depth+1:0;for(let e=0;e<this.path.length;e++)this.path[e].shouldResetTransform=!0;this.root===this&&(this.nodes=new a6)}}}function rT(e){e.updateLayout()}function rI(e){var t;let n=(null==(t=e.resumeFrom)?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&n&&e.hasListeners("didUpdate")){let{layoutBox:t,measuredBox:a}=e.layout,{animationType:r}=e.options,i=n.source!==e.layout.source;"size"===r?aD(e=>{let a=i?n.measuredBox[e]:n.layoutBox[e],r=aT(a);a.min=t[e].min,a.max=a.min+r}):rq(r,n.layoutBox,t)&&aD(a=>{let r=i?n.measuredBox[a]:n.layoutBox[a],s=aT(t[a]);r.max=r.min+s,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[a].max=e.relativeTarget[a].min+s)});let s=e7();aE(s,t,n.layoutBox);let o=e7();i?aE(o,e.applyTransform(a,!0),n.measuredBox):aE(o,t,n.layoutBox);let l=!rf(s),c=!1;if(!e.resumeFrom){let a=e.getClosestProjectingParent();if(a&&!a.resumeFrom){let{snapshot:r,layout:i}=a;if(r&&i){let s=tt();aR(s,n.layoutBox,r.layoutBox);let o=tt();aR(o,t,i.layoutBox),rx(s,o)||(c=!0),a.options.layoutRoot&&(e.relativeTarget=o,e.relativeTargetOrigin=s,e.relativeParent=a)}}}e.notifyListeners("didUpdate",{layout:t,snapshot:n,delta:o,layoutDelta:s,hasLayoutChanged:l,hasRelativeLayoutChanged:c})}else if(e.isLead()){let{onExitComplete:t}=e.options;t&&t()}e.options.transition=void 0}function rE(e){ei.value&&rw.nodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function r_(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function rA(e){e.clearSnapshot()}function rR(e){e.clearMeasurements()}function rD(e){e.isLayoutDirty=!1}function rM(e){let{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function rF(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function rO(e){e.resolveTargetDelta()}function rP(e){e.calcProjection()}function rj(e){e.resetSkewAndRotation()}function rL(e){e.removeLeadSnapshot()}function rz(e,t,n){e.translate=w(t.translate,0,n),e.scale=w(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function rB(e,t,n,a){e.min=w(t.min,n.min,a),e.max=w(t.max,n.max,a)}function rV(e){return e.animationValues&&void 0!==e.animationValues.opacityExit}let rU={duration:.45,ease:[.4,0,.1,1]},rW=e=>"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),rG=rW("applewebkit/")&&!rW("chrome/")?Math.round:en;function rH(e){e.min=rG(e.min),e.max=rG(e.max)}function rq(e,t,n){return"position"===e||"preserve-aspect"===e&&!(.2>=Math.abs(ry(t)-ry(n)))}function rK(e){var t;return e!==e.root&&(null==(t=e.scroll)?void 0:t.wasRoot)}let rX=rC({attachResizeListener:(e,t)=>aN(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),rY={current:void 0},rZ=rC({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!rY.current){let e=new rX({});e.mount(window),e.setOptions({layoutScroll:!0}),rY.current=e}return rY.current},resetTransform:(e,t)=>{e.style.transform=void 0!==t?t:"none"},checkIsScrollRoot:e=>"fixed"===window.getComputedStyle(e).position});function rQ(e,t){let n=function(e,t,n){if(e instanceof EventTarget)return[e];if("string"==typeof e){let t=document.querySelectorAll(e);return t?Array.from(t):[]}return Array.from(e)}(e),a=new AbortController;return[n,{passive:!0,...t,signal:a.signal},()=>a.abort()]}function rJ(e){return!("touch"===e.pointerType||aw.x||aw.y)}function r$(e,t,n){let{props:a}=e;e.animationState&&a.whileHover&&e.animationState.setActive("whileHover","Start"===n);let r=a["onHover"+n];r&&eo.postRender(()=>r(t,aS(t)))}function r0(e){return a3(e)&&"offsetHeight"in e}e.s(["isHTMLElement",()=>r0],72846);let r1=(e,t)=>!!t&&(e===t||r1(e,t.parentElement)),r2=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]),r3=new WeakSet;function r4(e){return t=>{"Enter"===t.key&&e(t)}}function r5(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}function r6(e){return ak(e)&&!(aw.x||aw.y)}function r8(e,t,n){let{props:a}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&a.whileTap&&e.animationState.setActive("whileTap","Start"===n);let r=a["onTap"+("End"===n?"":n)];r&&eo.postRender(()=>r(t,aS(t)))}let r9=new WeakMap,r7=new WeakMap,ie=e=>{let t=r9.get(e.target);t&&t(e)},it=e=>{e.forEach(ie)},ia={some:0,all:1},ir=function(e,t){if("undefined"==typeof Proxy)return t5;let n=new Map,a=(n,a)=>t5(n,a,e,t);return new Proxy((e,t)=>a(e,t),{get:(r,i)=>"create"===i?a:(n.has(i)||n.set(i,t5(i,void 0,e,t)),n.get(i))})}({animation:{Feature:class extends ab{updateAnimationControlsSubscription(){let{animate:e}=this.node.getProps();ts(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){let{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),null==(e=this.unmountControls)||e.call(this)}constructor(e){super(e),e.animationState||(e.animationState=function(e){let t=t=>Promise.all(t.map(t=>{let{animation:n,options:a}=t;return function(e,t){let n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e.notify("AnimationStart",t),Array.isArray(t))n=Promise.all(t.map(t=>ad(e,t,a)));else if("string"==typeof t)n=ad(e,t,a);else{let r="function"==typeof t?t6(e,t,a.custom):t;n=Promise.all(au(e,r,a))}return n.then(()=>{e.notify("AnimationComplete",t)})}(e,n,a)})),n=ay(),a=!0,r=t=>(n,a)=>{var r;let i=t6(e,a,"exit"===t?null==(r=e.presenceContext)?void 0:r.custom:void 0);if(i){let{transition:e,transitionEnd:t,...a}=i;n={...n,...a,...t}}return n};function i(i){let{props:s}=e,o=function e(t){if(!t)return;if(!t.isControllingVariants){let n=t.parent&&e(t.parent)||{};return void 0!==t.props.initial&&(n.initial=t.props.initial),n}let n={};for(let e=0;e<af;e++){let a=tc[e],r=t.props[a];(to(r)||!1===r)&&(n[a]=r)}return n}(e.parent)||{},l=[],c=new Set,u={},h=1/0;for(let t=0;t<ag;t++){var d,p;let f=am[t],m=n[f],g=void 0!==s[f]?s[f]:o[f],x=to(g),y=f===i?m.isActive:null;!1===y&&(h=t);let b=g===o[f]&&g!==s[f]&&x;if(b&&a&&e.manuallyAnimateOnMount&&(b=!1),m.protectedKeys={...u},!m.isActive&&null===y||!g&&!m.prevProp||ts(g)||"boolean"==typeof g)continue;let v=(d=m.prevProp,"string"==typeof(p=g)?p!==d:!!Array.isArray(p)&&!ap(p,d)),w=v||f===i&&m.isActive&&!b&&x||t>h&&x,N=!1,k=Array.isArray(g)?g:[g],S=k.reduce(r(f),{});!1===y&&(S={});let{prevResolvedValues:C={}}=m,T={...C,...S},I=t=>{w=!0,c.has(t)&&(N=!0,c.delete(t)),m.needsAnimating[t]=!0;let n=e.getValue(t);n&&(n.liveStyle=!1)};for(let e in T){let t=S[e],n=C[e];if(!u.hasOwnProperty(e))(t9(t)&&t9(n)?ap(t,n):t===n)?void 0!==t&&c.has(e)?I(e):m.protectedKeys[e]=!0:null!=t?I(e):c.add(e)}m.prevProp=g,m.prevResolvedValues=S,m.isActive&&(u={...u,...S}),a&&e.blockInitialAnimation&&(w=!1);let E=b&&v,_=!E||N;w&&_&&l.push(...k.map(t=>{let n={type:f};if("string"==typeof t&&a&&!E&&e.manuallyAnimateOnMount&&e.parent){let{parent:a}=e,r=t6(a,t);if(a.enteringChildren&&r){let{delayChildren:t}=r.transition||{};n.delay=ah(a.enteringChildren,e,t)}}return{animation:t,options:n}}))}if(c.size){let t={};if("boolean"!=typeof s.initial){let n=t6(e,Array.isArray(s.initial)?s.initial[0]:s.initial);n&&n.transition&&(t.transition=n.transition)}c.forEach(n=>{let a=e.getBaseTarget(n),r=e.getValue(n);r&&(r.liveStyle=!0),t[n]=null!=a?a:null}),l.push({animation:t})}let f=!!l.length;return a&&(!1===s.initial||s.initial===s.animate)&&!e.manuallyAnimateOnMount&&(f=!1),a=!1,f?t(l):Promise.resolve()}return{animateChanges:i,setActive:function(t,a){var r;if(n[t].isActive===a)return Promise.resolve();null==(r=e.variantChildren)||r.forEach(e=>{var n;return null==(n=e.animationState)?void 0:n.setActive(t,a)}),n[t].isActive=a;let s=i(t);for(let e in n)n[e].protectedKeys={};return s},setAnimateFunction:function(n){t=n(e)},getState:()=>n,reset:()=>{n=ay(),a=!0}}}(e))}}},exit:{Feature:class extends ab{update(){if(!this.node.presenceContext)return;let{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;let a=this.node.animationState.setActive("exit",!e);t&&!e&&a.then(()=>{t(this.id)})}mount(){let{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}constructor(){super(...arguments),this.id=av++}}},inView:{Feature:class extends ab{startObserver(){this.unmount();let{viewport:e={}}=this.node.getProps(),{root:t,margin:n,amount:a="some",once:r}=e,i={root:t?t.current:void 0,rootMargin:n,threshold:"number"==typeof a?a:ia[a]},s=e=>{let{isIntersecting:t}=e;if(this.isInView===t||(this.isInView=t,r&&!t&&this.hasEnteredView))return;t&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",t);let{onViewportEnter:n,onViewportLeave:a}=this.node.getProps(),i=t?n:a;i&&i(e)};var o=this.node.current;let l=function(e){let{root:t,...n}=e,a=t||document;r7.has(a)||r7.set(a,{});let r=r7.get(a),i=JSON.stringify(n);return r[i]||(r[i]=new IntersectionObserver(it,{root:t,...n})),r[i]}(i);return r9.set(o,s),l.observe(o),()=>{r9.delete(o),l.unobserve(o)}}mount(){this.startObserver()}update(){if("undefined"==typeof IntersectionObserver)return;let{props:e,prevProps:t}=this.node;["amount","margin","root"].some(function(e){let{viewport:t={}}=e,{viewport:n={}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e=>t[e]!==n[e]}(e,t))&&this.startObserver()}unmount(){}constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}}},tap:{Feature:class extends ab{mount(){let{current:e}=this.node;e&&(this.unmount=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},[a,r,i]=rQ(e,n),s=e=>{let a=e.currentTarget;if(!r6(e))return;r3.add(a);let i=t(a,e),s=(e,t)=>{window.removeEventListener("pointerup",o),window.removeEventListener("pointercancel",l),r3.has(a)&&r3.delete(a),r6(e)&&"function"==typeof i&&i(e,{success:t})},o=e=>{s(e,a===window||a===document||n.useGlobalTarget||r1(a,e.target))},l=e=>{s(e,!1)};window.addEventListener("pointerup",o,r),window.addEventListener("pointercancel",l,r)};return a.forEach(e=>{((n.useGlobalTarget?window:e).addEventListener("pointerdown",s,r),r0(e))&&(e.addEventListener("focus",e=>((e,t)=>{let n=e.currentTarget;if(!n)return;let a=r4(()=>{if(r3.has(n))return;r5(n,"down");let e=r4(()=>{r5(n,"up")});n.addEventListener("keyup",e,t),n.addEventListener("blur",()=>r5(n,"cancel"),t)});n.addEventListener("keydown",a,t),n.addEventListener("blur",()=>n.removeEventListener("keydown",a),t)})(e,r)),r2.has(e.tagName)||-1!==e.tabIndex||e.hasAttribute("tabindex")||(e.tabIndex=0))}),i}(e,(e,t)=>(r8(this.node,t,"Start"),(e,t)=>{let{success:n}=t;return r8(this.node,e,n?"End":"Cancel")}),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}},focus:{Feature:class extends ab{onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch(t){e=!0}e&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){this.isActive&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=nn(aN(this.node.current,"focus",()=>this.onFocus()),aN(this.node.current,"blur",()=>this.onBlur()))}unmount(){}constructor(){super(...arguments),this.isActive=!1}}},hover:{Feature:class extends ab{mount(){let{current:e}=this.node;e&&(this.unmount=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},[a,r,i]=rQ(e,n),s=e=>{if(!rJ(e))return;let{target:n}=e,a=t(n,e);if("function"!=typeof a||!n)return;let i=e=>{rJ(e)&&(a(e),n.removeEventListener("pointerleave",i))};n.addEventListener("pointerleave",i,r)};return a.forEach(e=>{e.addEventListener("pointerenter",s,r)}),i}(e,(e,t)=>(r$(this.node,t,"Start"),e=>r$(this.node,e,"End"))))}unmount(){}}},pan:{Feature:class extends ab{onPointerDown(e){this.session=new aO(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:aM(this.node)})}createPanHandlers(){let{onPanSessionStart:e,onPanStart:t,onPan:n,onPanEnd:a}=this.node.getProps();return{onSessionStart:aK(e),onStart:aK(t),onMove:n,onEnd:(e,t)=>{delete this.session,a&&eo.postRender(()=>a(e,t))}}}mount(){this.removePointerDownListener=aC(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}constructor(){super(...arguments),this.removePointerDownListener=en}}},drag:{Feature:class extends ab{mount(){let{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||en}unmount(){this.removeGroupControls(),this.removeListeners()}constructor(e){super(e),this.removeGroupControls=en,this.removeListeners=en,this.controls=new aH(e)}},ProjectionNode:rZ,MeasureLayout:a1},layout:{ProjectionNode:rZ,MeasureLayout:a1}},(e,t)=>tO(e)?new tM(t):new tC(t,{allowProjection:e!==n.Fragment}))},29612,e=>{"use strict";e.s(["default",()=>a]);var t=e.i(43476),n=e.i(46932);function a(){return(0,t.jsxs)("section",{className:"relative min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 via-blue-900 to-slate-800 overflow-hidden",children:[(0,t.jsx)("div",{className:"absolute inset-0 opacity-10",children:(0,t.jsx)("div",{className:"absolute inset-0 bg-repeat",style:{backgroundImage:"url(\"data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E\")"}})}),(0,t.jsx)("div",{className:"relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:(0,t.jsxs)(n.motion.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,ease:"easeOut"},children:[(0,t.jsxs)("h1",{className:"text-5xl md:text-7xl font-bold text-white mb-6 leading-tight",children:[(0,t.jsx)("span",{className:"block",children:"NKJ"}),(0,t.jsx)("span",{className:"block bg-gradient-to-r from-primary-400 to-automotive-electric bg-clip-text text-transparent",children:"Development"})]}),(0,t.jsx)(n.motion.p,{className:"text-xl md:text-2xl text-slate-300 mb-8 max-w-3xl mx-auto leading-relaxed",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},children:"Transforming Automotive Supply Chains with AI-Powered Analytics and Predictive Intelligence"}),(0,t.jsxs)(n.motion.div,{className:"flex flex-col sm:flex-row gap-4 justify-center items-center mb-12",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.4},children:[(0,t.jsx)("button",{className:"bg-primary-500 hover:bg-primary-600 text-white font-semibold py-4 px-8 rounded-lg transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105",children:"Explore Solutions"}),(0,t.jsx)("button",{className:"border-2 border-white text-white hover:bg-white hover:text-slate-900 font-semibold py-4 px-8 rounded-lg transition-all duration-300",children:"Schedule Demo"})]}),(0,t.jsxs)(n.motion.div,{className:"grid grid-cols-1 md:grid-cols-3 gap-8 max-w-4xl mx-auto",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.6},children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-3xl md:text-4xl font-bold text-automotive-electric mb-2",children:"94.7%"}),(0,t.jsx)("div",{className:"text-slate-300",children:"Production Efficiency"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-3xl md:text-4xl font-bold text-automotive-electric mb-2",children:"99.2%"}),(0,t.jsx)("div",{className:"text-slate-300",children:"Quality Score"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-3xl md:text-4xl font-bold text-automotive-electric mb-2",children:"30%"}),(0,t.jsx)("div",{className:"text-slate-300",children:"Cost Reduction"})]})]})]})}),(0,t.jsx)(n.motion.div,{className:"absolute bottom-8 left-1/2 transform -translate-x-1/2",initial:{opacity:0},animate:{opacity:1},transition:{duration:1,delay:1},children:(0,t.jsx)("div",{className:"w-6 h-10 border-2 border-white rounded-full flex justify-center",children:(0,t.jsx)(n.motion.div,{className:"w-1 h-3 bg-white rounded-full mt-2",animate:{y:[0,12,0]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"}})})})]})}},56125,e=>{"use strict";e.s(["default",()=>r]);var t=e.i(43476),n=e.i(71645),a=e.i(46932);function r(e){let{end:r,duration:i=2,prefix:s="",suffix:o="",className:l="",decimals:c=0}=e,[u,h]=(0,n.useState)(0);return(0,n.useEffect)(()=>{let e,t,n=a=>{e||(e=a);let s=Math.min((a-e)/(1e3*i),1);h(r*(1-Math.pow(1-s,4))),s<1&&(t=requestAnimationFrame(n))};return t=requestAnimationFrame(n),()=>{t&&cancelAnimationFrame(t)}},[r,i]),(0,t.jsxs)(a.motion.span,{className:"font-bold tabular-nums ".concat(l),initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5,ease:"easeOut"},children:[s,0===c?Math.floor(u).toLocaleString():u.toFixed(c),o]})}},64177,e=>{"use strict";let t;e.s(["default",()=>rU],64177);var n=e.i(43476),a=e.i(46932),r=e.i(56125);function i(e){let{title:t,value:i,prefix:s="",suffix:o="",trend:l="neutral",trendValue:c,icon:u,className:h="",decimals:d=0}=e;return(0,n.jsxs)(a.motion.div,{className:"bg-white rounded-lg shadow-lg p-6 border border-automotive-chrome hover:shadow-xl transition-shadow duration-300 ".concat(h),initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},whileHover:{scale:1.02},children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,n.jsx)("h3",{className:"text-sm font-medium text-automotive-steel uppercase tracking-wide",children:t}),u&&(0,n.jsx)("div",{className:"text-primary-500 text-2xl",children:u})]}),(0,n.jsx)("div",{className:"mb-2",children:(0,n.jsx)(r.default,{end:i,prefix:s,suffix:o,decimals:d,className:"text-3xl font-bold text-automotive-carbon"})}),void 0!==c&&(0,n.jsxs)("div",{className:"flex items-center text-sm ".concat((()=>{switch(l){case"up":return"text-automotive-success";case"down":return"text-automotive-danger";default:return"text-automotive-steel"}})()),children:[(0,n.jsx)("span",{className:"mr-1",children:(()=>{switch(l){case"up":return"";case"down":return"";default:return""}})()}),(0,n.jsxs)("span",{className:"font-medium",children:[Math.abs(c),"% vs last month"]})]})]})}var s=e.i(71645);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e){return e+.5|0}let c=(e,t,n)=>Math.max(Math.min(e,n),t);function u(e){return c(l(2.55*e),0,255)}function h(e){return c(l(255*e),0,255)}function d(e){return c(l(e/2.55)/100,0,1)}function p(e){return c(l(100*e),0,100)}let f={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},m=[..."0123456789ABCDEF"],g=e=>m[15&e],x=e=>m[(240&e)>>4]+m[15&e],y=e=>(240&e)>>4==(15&e),b=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function v(e,t,n){let a=t*Math.min(n,1-n),r=function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t+e/30)%12;return n-a*Math.max(Math.min(r-3,9-r,1),-1)};return[r(0),r(8),r(4)]}function w(e,t,n){let a=function(a){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(a+e/60)%6;return n-n*t*Math.max(Math.min(r,4-r,1),0)};return[a(5),a(3),a(1)]}function N(e,t,n){let a,r=v(e,1,.5);for(t+n>1&&(a=1/(t+n),t*=a,n*=a),a=0;a<3;a++)r[a]*=1-t-n,r[a]+=t;return r}function k(e){let t,n,a,r=e.r/255,i=e.g/255,s=e.b/255,o=Math.max(r,i,s),l=Math.min(r,i,s),c=(o+l)/2;o!==l&&(a=o-l,n=c>.5?a/(2-o-l):a/(o+l),t=60*(t=r===o?(i-s)/a+6*(i<s):i===o?(s-r)/a+2:(r-i)/a+4)+.5);return[0|t,n||0,c]}function S(e,t,n,a){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,n,a)).map(h)}function C(e){return(e%360+360)%360}let T={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},I={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"},E=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/,_=e=>e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055,A=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function R(e,t,n){if(e){let a=k(e);a[t]=Math.max(0,Math.min(a[t]+a[t]*n,0===t?360:1)),e.r=(a=S(v,a,void 0,void 0))[0],e.g=a[1],e.b=a[2]}}function D(e,t){return e?Object.assign(t||{},e):e}function M(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=h(e[3]))):(t=D(e,{r:0,g:0,b:0,a:1})).a=h(t.a),t}class F{get valid(){return this._valid}get rgb(){var e=D(this._rgb);return e&&(e.a=d(e.a)),e}set rgb(e){this._rgb=M(e)}rgbString(){var e;return this._valid?(e=this._rgb)&&(e.a<255?"rgba(".concat(e.r,", ").concat(e.g,", ").concat(e.b,", ").concat(d(e.a),")"):"rgb(".concat(e.r,", ").concat(e.g,", ").concat(e.b,")")):void 0}hexString(){var e,t;let n,a;return this._valid?(t=y((n=e=this._rgb).r)&&y(n.g)&&y(n.b)&&y(n.a)?g:x,e?"#"+t(e.r)+t(e.g)+t(e.b)+(a=e.a,a<255?t(a):""):void 0):void 0}hslString(){return this._valid?function(e){if(!e)return;let t=k(e),n=t[0],a=p(t[1]),r=p(t[2]);return e.a<255?"hsla(".concat(n,", ").concat(a,"%, ").concat(r,"%, ").concat(d(e.a),")"):"hsl(".concat(n,", ").concat(a,"%, ").concat(r,"%)")}(this._rgb):void 0}mix(e,t){if(e){let n,a=this.rgb,r=e.rgb,i=t===n?.5:t,s=2*i-1,o=a.a-r.a,l=((s*o==-1?s:(s+o)/(1+s*o))+1)/2;n=1-l,a.r=255&l*a.r+n*r.r+.5,a.g=255&l*a.g+n*r.g+.5,a.b=255&l*a.b+n*r.b+.5,a.a=i*a.a+(1-i)*r.a,this.rgb=a}return this}interpolate(e,t){return e&&(this._rgb=function(e,t,n){let a=A(d(e.r)),r=A(d(e.g)),i=A(d(e.b));return{r:h(_(a+n*(A(d(t.r))-a))),g:h(_(r+n*(A(d(t.g))-r))),b:h(_(i+n*(A(d(t.b))-i))),a:e.a+n*(t.a-e.a)}}(this._rgb,e._rgb,t)),this}clone(){return new F(this.rgb)}alpha(e){return this._rgb.a=h(e),this}clearer(e){let t=this._rgb;return t.a*=1-e,this}greyscale(){let e=this._rgb,t=l(.3*e.r+.59*e.g+.11*e.b);return e.r=e.g=e.b=t,this}opaquer(e){let t=this._rgb;return t.a*=1+e,this}negate(){let e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return R(this._rgb,2,e),this}darken(e){return R(this._rgb,2,-e),this}saturate(e){return R(this._rgb,1,e),this}desaturate(e){return R(this._rgb,1,-e),this}rotate(e){var t,n;return t=this._rgb,(n=k(t))[0]=C(n[0]+e),t.r=(n=S(v,n,void 0,void 0))[0],t.g=n[1],t.b=n[2],this}constructor(e){let n;if(e instanceof F)return e;let a=typeof e;"object"===a?n=M(e):"string"===a&&(n=function(e){var t,n=e.length;return"#"===e[0]&&(4===n||5===n?t={r:255&17*f[e[1]],g:255&17*f[e[2]],b:255&17*f[e[3]],a:5===n?17*f[e[4]]:255}:(7===n||9===n)&&(t={r:f[e[1]]<<4|f[e[2]],g:f[e[3]]<<4|f[e[4]],b:f[e[5]]<<4|f[e[6]],a:9===n?f[e[7]]<<4|f[e[8]]:255})),t}(e)||function(e){t||((t=function(){let e,t,n,a,r,i={},s=Object.keys(I),o=Object.keys(T);for(e=0;e<s.length;e++){for(t=0,a=r=s[e];t<o.length;t++)n=o[t],r=r.replace(n,T[n]);n=parseInt(I[a],16),i[r]=[n>>16&255,n>>8&255,255&n]}return i}()).transparent=[0,0,0,0]);let n=t[e.toLowerCase()];return n&&{r:n[0],g:n[1],b:n[2],a:4===n.length?n[3]:255}}(e)||function(e){return"r"===e.charAt(0)?function(e){let t,n,a,r=E.exec(e),i=255;if(r){if(r[7]!==t){let e=+r[7];i=r[8]?u(e):c(255*e,0,255)}return t=+r[1],n=+r[3],a=+r[5],t=255&(r[2]?u(t):c(t,0,255)),{r:t,g:n=255&(r[4]?u(n):c(n,0,255)),b:a=255&(r[6]?u(a):c(a,0,255)),a:i}}}(e):function(e){let t,n=b.exec(e),a=255;if(!n)return;n[5]!==t&&(a=n[6]?u(+n[5]):h(+n[5]));let r=C(+n[2]),i=n[3]/100,s=n[4]/100;return{r:(t="hwb"===n[1]?S(N,r,i,s):"hsv"===n[1]?S(w,r,i,s):S(v,r,i,s))[0],g:t[1],b:t[2],a:a}}(e)}(e)),this._rgb=n,this._valid=!!n}}function O(){}let P=(()=>{let e=0;return()=>e++})();function j(e){return null==e}function L(e){if(Array.isArray&&Array.isArray(e))return!0;let t=Object.prototype.toString.call(e);return"[object"===t.slice(0,7)&&"Array]"===t.slice(-6)}function z(e){return null!==e&&"[object Object]"===Object.prototype.toString.call(e)}function B(e){return("number"==typeof e||e instanceof Number)&&isFinite(+e)}function V(e,t){return B(e)?e:t}function U(e,t){return void 0===e?t:e}let W=(e,t)=>"string"==typeof e&&e.endsWith("%")?parseFloat(e)/100*t:+e;function G(e,t,n){if(e&&"function"==typeof e.call)return e.apply(n,t)}function H(e,t,n,a){let r,i,s;if(L(e))if(i=e.length,a)for(r=i-1;r>=0;r--)t.call(n,e[r],r);else for(r=0;r<i;r++)t.call(n,e[r],r);else if(z(e))for(r=0,i=(s=Object.keys(e)).length;r<i;r++)t.call(n,e[s[r]],s[r])}function q(e,t){let n,a,r,i;if(!e||!t||e.length!==t.length)return!1;for(n=0,a=e.length;n<a;++n)if(r=e[n],i=t[n],r.datasetIndex!==i.datasetIndex||r.index!==i.index)return!1;return!0}function K(e){if(L(e))return e.map(K);if(z(e)){let t=Object.create(null),n=Object.keys(e),a=n.length,r=0;for(;r<a;++r)t[n[r]]=K(e[n[r]]);return t}return e}function X(e){return -1===["__proto__","prototype","constructor"].indexOf(e)}function Y(e,t,n,a){if(!X(e))return;let r=t[e],i=n[e];z(r)&&z(i)?Z(r,i,a):t[e]=K(i)}function Z(e,t,n){let a,r=L(t)?t:[t],i=r.length;if(!z(e))return e;let s=(n=n||{}).merger||Y;for(let t=0;t<i;++t){if(!z(a=r[t]))continue;let i=Object.keys(a);for(let t=0,r=i.length;t<r;++t)s(i[t],e,a,n)}return e}function Q(e,t){return Z(e,t,{merger:J})}function J(e,t,n){if(!X(e))return;let a=t[e],r=n[e];z(a)&&z(r)?Q(a,r):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=K(r))}let $={"":e=>e,x:e=>e.x,y:e=>e.y};function ee(e,t){return($[t]||($[t]=function(e){let t=function(e){let t=e.split("."),n=[],a="";for(let e of t)(a+=e).endsWith("\\")?a=a.slice(0,-1)+".":(n.push(a),a="");return n}(e);return e=>{for(let n of t){if(""===n)break;e=e&&e[n]}return e}}(t)))(e)}function et(e){return e.charAt(0).toUpperCase()+e.slice(1)}let en=e=>void 0!==e,ea=e=>"function"==typeof e,er=(e,t)=>{if(e.size!==t.size)return!1;for(let n of e)if(!t.has(n))return!1;return!0},ei=Math.PI,es=2*ei,eo=es+ei,el=1/0,ec=ei/180,eu=ei/2,eh=ei/4,ed=2*ei/3,ep=Math.log10,ef=Math.sign;function em(e,t,n){return Math.abs(e-t)<n}function eg(e){let t=Math.round(e),n=Math.pow(10,Math.floor(ep(e=em(e,t,e/1e3)?t:e))),a=e/n;return(a<=1?1:a<=2?2:a<=5?5:10)*n}function ex(e){return"symbol"!=typeof e&&("object"!=typeof e||null===e||!!(Symbol.toPrimitive in e||"toString"in e||"valueOf"in e))&&!isNaN(parseFloat(e))&&isFinite(e)}function ey(e,t,n){let a,r,i;for(a=0,r=e.length;a<r;a++)isNaN(i=e[a][n])||(t.min=Math.min(t.min,i),t.max=Math.max(t.max,i))}function eb(e){return ei/180*e}function ev(e){if(!B(e))return;let t=1,n=0;for(;Math.round(e*t)/t!==e;)t*=10,n++;return n}function ew(e,t){let n=t.x-e.x,a=t.y-e.y,r=Math.sqrt(n*n+a*a),i=Math.atan2(a,n);return i<-.5*ei&&(i+=es),{angle:i,distance:r}}function eN(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function ek(e,t){return(e-t+eo)%es-ei}function eS(e){return(e%es+es)%es}function eC(e,t,n,a){let r=eS(e),i=eS(t),s=eS(n),o=eS(i-r),l=eS(s-r),c=eS(r-i),u=eS(r-s);return r===i||r===s||a&&i===s||o>l&&c<u}function eT(e,t,n){return Math.max(t,Math.min(n,e))}function eI(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-6;return e>=Math.min(t,n)-a&&e<=Math.max(t,n)+a}function eE(e,t,n){let a;n=n||(n=>e[n]<t);let r=e.length-1,i=0;for(;r-i>1;)n(a=i+r>>1)?i=a:r=a;return{lo:i,hi:r}}let e_=(e,t,n,a)=>eE(e,n,a?a=>{let r=e[a][t];return r<n||r===n&&e[a+1][t]===n}:a=>e[a][t]<n),eA=(e,t,n)=>eE(e,n,a=>e[a][t]>=n),eR=["push","pop","shift","splice","unshift"];function eD(e,t){let n=e._chartjs;if(!n)return;let a=n.listeners,r=a.indexOf(t);-1!==r&&a.splice(r,1),a.length>0||(eR.forEach(t=>{delete e[t]}),delete e._chartjs)}function eM(e){let t=new Set(e);return t.size===e.length?e:Array.from(t)}let eF="undefined"==typeof window?function(e){return e()}:window.requestAnimationFrame;function eO(e,t){let n=[],a=!1;return function(){for(var r=arguments.length,i=Array(r),s=0;s<r;s++)i[s]=arguments[s];n=i,a||(a=!0,eF.call(window,()=>{a=!1,e.apply(t,n)}))}}let eP=e=>"start"===e?"left":"end"===e?"right":"center",ej=(e,t,n)=>"start"===e?t:"end"===e?n:(t+n)/2;function eL(e,t,n){let a=t.length,r=0,i=a;if(e._sorted){let{iScale:s,vScale:o,_parsed:l}=e,c=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null,u=s.axis,{min:h,max:d,minDefined:p,maxDefined:f}=s.getUserBounds();if(p){if(r=Math.min(e_(l,u,h).lo,n?a:e_(t,u,s.getPixelForValue(h)).lo),c){let e=l.slice(0,r+1).reverse().findIndex(e=>!j(e[o.axis]));r-=Math.max(0,e)}r=eT(r,0,a-1)}if(f){let e=Math.max(e_(l,s.axis,d,!0).hi+1,n?0:e_(t,u,s.getPixelForValue(d),!0).hi+1);if(c){let t=l.slice(e-1).findIndex(e=>!j(e[o.axis]));e+=Math.max(0,t)}i=eT(e,r,a)-r}else i=a-r}return{start:r,count:i}}function ez(e){let{xScale:t,yScale:n,_scaleRanges:a}=e,r={xmin:t.min,xmax:t.max,ymin:n.min,ymax:n.max};if(!a)return e._scaleRanges=r,!0;let i=a.xmin!==t.min||a.xmax!==t.max||a.ymin!==n.min||a.ymax!==n.max;return Object.assign(a,r),i}let eB=e=>0===e||1===e,eV=(e,t,n)=>-(Math.pow(2,10*(e-=1))*Math.sin((e-t)*es/n)),eU=(e,t,n)=>Math.pow(2,-10*e)*Math.sin((e-t)*es/n)+1,eW={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>-Math.cos(e*eu)+1,easeOutSine:e=>Math.sin(e*eu),easeInOutSine:e=>-.5*(Math.cos(ei*e)-1),easeInExpo:e=>0===e?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>1===e?1:-Math.pow(2,-10*e)+1,easeInOutExpo:e=>eB(e)?e:e<.5?.5*Math.pow(2,10*(2*e-1)):.5*(-Math.pow(2,-10*(2*e-1))+2),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>eB(e)?e:eV(e,.075,.3),easeOutElastic:e=>eB(e)?e:eU(e,.075,.3),easeInOutElastic:e=>eB(e)?e:e<.5?.5*eV(2*e,.1125,.45):.5+.5*eU(2*e-1,.1125,.45),easeInBack:e=>e*e*(2.70158*e-1.70158),easeOutBack:e=>(e-=1)*e*(2.70158*e+1.70158)+1,easeInOutBack(e){let t=1.70158;return(e/=.5)<1?.5*(e*e*(((t*=1.525)+1)*e-t)):.5*((e-=2)*e*(((t*=1.525)+1)*e+t)+2)},easeInBounce:e=>1-eW.easeOutBounce(1-e),easeOutBounce:e=>e<.36363636363636365?7.5625*e*e:e<.7272727272727273?7.5625*(e-=.5454545454545454)*e+.75:e<.9090909090909091?7.5625*(e-=.8181818181818182)*e+.9375:7.5625*(e-=.9545454545454546)*e+.984375,easeInOutBounce:e=>e<.5?.5*eW.easeInBounce(2*e):.5*eW.easeOutBounce(2*e-1)+.5};function eG(e){if(e&&"object"==typeof e){let t=e.toString();return"[object CanvasPattern]"===t||"[object CanvasGradient]"===t}return!1}function eH(e){return eG(e)?e:new F(e)}function eq(e){return eG(e)?e:new F(e).saturate(.5).darken(.1).hexString()}let eK=["x","y","borderWidth","radius","tension"],eX=["color","borderColor","backgroundColor"],eY=new Map;function eZ(e,t,n){return(function(e,t){let n=e+JSON.stringify(t=t||{}),a=eY.get(n);return a||(a=new Intl.NumberFormat(e,t),eY.set(n,a)),a})(t,n).format(e)}let eQ={values:e=>L(e)?e:""+e,numeric(e,t,n){let a;if(0===e)return"0";let r=this.chart.options.locale,i=e;if(n.length>1){var s,o;let t,r=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(r<1e-4||r>1e15)&&(a="scientific"),s=e,Math.abs(t=(o=n).length>3?o[2].value-o[1].value:o[1].value-o[0].value)>=1&&s!==Math.floor(s)&&(t=s-Math.floor(s)),i=t}let l=ep(Math.abs(i)),c=isNaN(l)?1:Math.max(Math.min(-1*Math.floor(l),20),0),u={notation:a,minimumFractionDigits:c,maximumFractionDigits:c};return Object.assign(u,this.options.ticks.format),eZ(e,r,u)},logarithmic(e,t,n){return 0===e?"0":[1,2,3,5,10,15].includes(n[t].significand||e/Math.pow(10,Math.floor(ep(e))))||t>.8*n.length?eQ.numeric.call(this,e,t,n):""}};var eJ={formatters:eQ};let e$=Object.create(null),e0=Object.create(null);function e1(e,t){if(!t)return e;let n=t.split(".");for(let t=0,a=n.length;t<a;++t){let a=n[t];e=e[a]||(e[a]=Object.create(null))}return e}function e2(e,t,n){return"string"==typeof t?Z(e1(e,t),n):Z(e1(e,""),t)}var e3=new class{set(e,t){return e2(this,e,t)}get(e){return e1(this,e)}describe(e,t){return e2(e0,e,t)}override(e,t){return e2(e$,e,t)}route(e,t,n,a){let r=e1(this,e),i=e1(this,n),s="_"+t;Object.defineProperties(r,{[s]:{value:r[t],writable:!0},[t]:{enumerable:!0,get(){let e=this[s],t=i[a];return z(e)?Object.assign({},t,e):U(e,t)},set(e){this[s]=e}}})}apply(e){e.forEach(e=>e(this))}constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=e=>e.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(e,t)=>eq(t.backgroundColor),this.hoverBorderColor=(e,t)=>eq(t.borderColor),this.hoverColor=(e,t)=>eq(t.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}}({_scriptable:e=>!e.startsWith("on"),_indexable:e=>"events"!==e,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>"onProgress"!==e&&"onComplete"!==e&&"fn"!==e}),e.set("animations",{colors:{type:"color",properties:eX},numbers:{type:"number",properties:eK}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>0|e}}}})},function(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:eJ.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&"callback"!==e&&"parser"!==e,_indexable:e=>"borderDash"!==e&&"tickBorderDash"!==e&&"dash"!==e}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:e=>"backdropPadding"!==e&&"callback"!==e,_indexable:e=>"backdropPadding"!==e})}]);function e4(e,t,n,a,r){let i=t[r];return i||(i=t[r]=e.measureText(r).width,n.push(r)),i>a&&(a=i),a}function e5(e,t,n){let a=e.currentDevicePixelRatio,r=0!==n?Math.max(n/2,.5):0;return Math.round((t-r)*a)/a+r}function e6(e,t){(t||e)&&((t=t||e.getContext("2d")).save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore())}function e8(e,t,n,a){e9(e,t,n,a,null)}function e9(e,t,n,a,r){let i,s,o,l,c,u,h,d,p=t.pointStyle,f=t.rotation,m=t.radius,g=(f||0)*ec;if(p&&"object"==typeof p&&("[object HTMLImageElement]"===(i=p.toString())||"[object HTMLCanvasElement]"===i)){e.save(),e.translate(n,a),e.rotate(g),e.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),e.restore();return}if(!isNaN(m)&&!(m<=0)){switch(e.beginPath(),p){default:r?e.ellipse(n,a,r/2,m,0,0,es):e.arc(n,a,m,0,es),e.closePath();break;case"triangle":u=r?r/2:m,e.moveTo(n+Math.sin(g)*u,a-Math.cos(g)*m),g+=ed,e.lineTo(n+Math.sin(g)*u,a-Math.cos(g)*m),g+=ed,e.lineTo(n+Math.sin(g)*u,a-Math.cos(g)*m),e.closePath();break;case"rectRounded":c=.516*m,s=Math.cos(g+eh)*(l=m-c),h=Math.cos(g+eh)*(r?r/2-c:l),o=Math.sin(g+eh)*l,d=Math.sin(g+eh)*(r?r/2-c:l),e.arc(n-h,a-o,c,g-ei,g-eu),e.arc(n+d,a-s,c,g-eu,g),e.arc(n+h,a+o,c,g,g+eu),e.arc(n-d,a+s,c,g+eu,g+ei),e.closePath();break;case"rect":if(!f){l=Math.SQRT1_2*m,u=r?r/2:l,e.rect(n-u,a-l,2*u,2*l);break}g+=eh;case"rectRot":h=Math.cos(g)*(r?r/2:m),s=Math.cos(g)*m,o=Math.sin(g)*m,d=Math.sin(g)*(r?r/2:m),e.moveTo(n-h,a-o),e.lineTo(n+d,a-s),e.lineTo(n+h,a+o),e.lineTo(n-d,a+s),e.closePath();break;case"crossRot":g+=eh;case"cross":h=Math.cos(g)*(r?r/2:m),s=Math.cos(g)*m,o=Math.sin(g)*m,d=Math.sin(g)*(r?r/2:m),e.moveTo(n-h,a-o),e.lineTo(n+h,a+o),e.moveTo(n+d,a-s),e.lineTo(n-d,a+s);break;case"star":h=Math.cos(g)*(r?r/2:m),s=Math.cos(g)*m,o=Math.sin(g)*m,d=Math.sin(g)*(r?r/2:m),e.moveTo(n-h,a-o),e.lineTo(n+h,a+o),e.moveTo(n+d,a-s),e.lineTo(n-d,a+s),g+=eh,h=Math.cos(g)*(r?r/2:m),s=Math.cos(g)*m,o=Math.sin(g)*m,d=Math.sin(g)*(r?r/2:m),e.moveTo(n-h,a-o),e.lineTo(n+h,a+o),e.moveTo(n+d,a-s),e.lineTo(n-d,a+s);break;case"line":s=r?r/2:Math.cos(g)*m,o=Math.sin(g)*m,e.moveTo(n-s,a-o),e.lineTo(n+s,a+o);break;case"dash":e.moveTo(n,a),e.lineTo(n+Math.cos(g)*(r?r/2:m),a+Math.sin(g)*m);break;case!1:e.closePath()}e.fill(),t.borderWidth>0&&e.stroke()}}function e7(e,t,n){return n=n||.5,!t||e&&e.x>t.left-n&&e.x<t.right+n&&e.y>t.top-n&&e.y<t.bottom+n}function te(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function tt(e){e.restore()}function tn(e,t,n,a,r){if(!t)return e.lineTo(n.x,n.y);if("middle"===r){let a=(t.x+n.x)/2;e.lineTo(a,t.y),e.lineTo(a,n.y)}else"after"===r!=!!a?e.lineTo(t.x,n.y):e.lineTo(n.x,t.y);e.lineTo(n.x,n.y)}function ta(e,t,n,a){if(!t)return e.lineTo(n.x,n.y);e.bezierCurveTo(a?t.cp1x:t.cp2x,a?t.cp1y:t.cp2y,a?n.cp2x:n.cp1x,a?n.cp2y:n.cp1y,n.x,n.y)}function tr(e,t,n,a,r){let i,s,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},l=L(t)?t:[t],c=o.strokeWidth>0&&""!==o.strokeColor;for(e.save(),e.font=r.string,o.translation&&e.translate(o.translation[0],o.translation[1]),j(o.rotation)||e.rotate(o.rotation),o.color&&(e.fillStyle=o.color),o.textAlign&&(e.textAlign=o.textAlign),o.textBaseline&&(e.textBaseline=o.textBaseline),i=0;i<l.length;++i)s=l[i],o.backdrop&&function(e,t){let n=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=n}(e,o.backdrop),c&&(o.strokeColor&&(e.strokeStyle=o.strokeColor),j(o.strokeWidth)||(e.lineWidth=o.strokeWidth),e.strokeText(s,n,a,o.maxWidth)),e.fillText(s,n,a,o.maxWidth),function(e,t,n,a,r){if(r.strikethrough||r.underline){let i=e.measureText(a),s=t-i.actualBoundingBoxLeft,o=t+i.actualBoundingBoxRight,l=n-i.actualBoundingBoxAscent,c=n+i.actualBoundingBoxDescent,u=r.strikethrough?(l+c)/2:c;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=r.decorationWidth||2,e.moveTo(s,u),e.lineTo(o,u),e.stroke()}}(e,n,a,s,o),a+=Number(r.lineHeight);e.restore()}function ti(e,t){let{x:n,y:a,w:r,h:i,radius:s}=t;e.arc(n+s.topLeft,a+s.topLeft,s.topLeft,1.5*ei,ei,!0),e.lineTo(n,a+i-s.bottomLeft),e.arc(n+s.bottomLeft,a+i-s.bottomLeft,s.bottomLeft,ei,eu,!0),e.lineTo(n+r-s.bottomRight,a+i),e.arc(n+r-s.bottomRight,a+i-s.bottomRight,s.bottomRight,eu,0,!0),e.lineTo(n+r,a+s.topRight),e.arc(n+r-s.topRight,a+s.topRight,s.topRight,0,-eu,!0),e.lineTo(n+s.topLeft,a)}let ts=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,to=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/,tl=e=>+e||0;function tc(e,t){let n={},a=z(t),r=a?Object.keys(t):t,i=z(e)?a?n=>U(e[n],e[t[n]]):t=>e[t]:()=>e;for(let e of r)n[e]=tl(i(e));return n}function tu(e){return tc(e,{top:"y",right:"x",bottom:"y",left:"x"})}function th(e){return tc(e,["topLeft","topRight","bottomLeft","bottomRight"])}function td(e){let t=tu(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function tp(e,t){e=e||{},t=t||e3.font;let n=U(e.size,t.size);"string"==typeof n&&(n=parseInt(n,10));let a=U(e.style,t.style);a&&!(""+a).match(to)&&(console.warn('Invalid font style specified: "'+a+'"'),a=void 0);let r={family:U(e.family,t.family),lineHeight:function(e,t){let n=(""+e).match(ts);if(!n||"normal"===n[1])return 1.2*t;switch(e=+n[2],n[3]){case"px":return e;case"%":e/=100}return t*e}(U(e.lineHeight,t.lineHeight),n),size:n,style:a,weight:U(e.weight,t.weight),string:""};return r.string=!r||j(r.size)||j(r.family)?null:(r.style?r.style+" ":"")+(r.weight?r.weight+" ":"")+r.size+"px "+r.family,r}function tf(e,t,n,a){let r,i,s,o=!0;for(r=0,i=e.length;r<i;++r)if(void 0!==(s=e[r])&&(void 0!==t&&"function"==typeof s&&(s=s(t),o=!1),void 0!==n&&L(s)&&(s=s[n%s.length],o=!1),void 0!==s))return a&&!o&&(a.cacheable=!1),s}function tm(e,t){return Object.assign(Object.create(e),t)}function tg(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[""],n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:()=>e[0],i=n||e;return void 0===a&&(a=tC("_fallback",e)),new Proxy({[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:i,_fallback:a,_getTarget:r,override:n=>tg([n,...e],t,i,a)},{deleteProperty:(t,n)=>(delete t[n],delete t._keys,delete e[0][n],!0),get:(n,a)=>tw(n,a,()=>(function(e,t,n,a){let r;for(let i of t)if(void 0!==(r=tC(tb(i,e),n)))return tv(e,r)?tk(n,a,e,r):r})(a,t,e,n)),getOwnPropertyDescriptor:(e,t)=>Reflect.getOwnPropertyDescriptor(e._scopes[0],t),getPrototypeOf:()=>Reflect.getPrototypeOf(e[0]),has:(e,t)=>tT(e).includes(t),ownKeys:e=>tT(e),set(e,t,n){let a=e._storage||(e._storage=r());return e[t]=a[t]=n,delete e._keys,!0}})}function tx(e,t,n,a){return new Proxy({_cacheable:!1,_proxy:e,_context:t,_subProxy:n,_stack:new Set,_descriptors:ty(e,a),setContext:t=>tx(e,t,n,a),override:r=>tx(e.override(r),t,n,a)},{deleteProperty:(t,n)=>(delete t[n],delete e[n],!0),get:(e,t,n)=>tw(e,t,()=>(function(e,t,n){let{_proxy:a,_context:r,_subProxy:i,_descriptors:s}=e,o=a[t];return ea(o)&&s.isScriptable(t)&&(o=function(e,t,n,a){let{_proxy:r,_context:i,_subProxy:s,_stack:o}=n;if(o.has(e))throw Error("Recursion detected: "+Array.from(o).join("->")+"->"+e);o.add(e);let l=t(i,s||a);return o.delete(e),tv(e,l)&&(l=tk(r._scopes,r,e,l)),l}(t,o,e,n)),L(o)&&o.length&&(o=function(e,t,n,a){let{_proxy:r,_context:i,_subProxy:s,_descriptors:o}=n;if(void 0!==i.index&&a(e))return t[i.index%t.length];if(z(t[0])){let n=t,a=r._scopes.filter(e=>e!==n);for(let l of(t=[],n)){let n=tk(a,r,e,l);t.push(tx(n,i,s&&s[e],o))}}return t}(t,o,e,s.isIndexable)),tv(t,o)&&(o=tx(o,r,i&&i[t],s)),o})(e,t,n)),getOwnPropertyDescriptor:(t,n)=>t._descriptors.allKeys?Reflect.has(e,n)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,n),getPrototypeOf:()=>Reflect.getPrototypeOf(e),has:(t,n)=>Reflect.has(e,n),ownKeys:()=>Reflect.ownKeys(e),set:(t,n,a)=>(e[n]=a,delete t[n],!0)})}function ty(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{scriptable:!0,indexable:!0},{_scriptable:n=t.scriptable,_indexable:a=t.indexable,_allKeys:r=t.allKeys}=e;return{allKeys:r,scriptable:n,indexable:a,isScriptable:ea(n)?n:()=>n,isIndexable:ea(a)?a:()=>a}}let tb=(e,t)=>e?e+et(t):t,tv=(e,t)=>z(t)&&"adapters"!==e&&(null===Object.getPrototypeOf(t)||t.constructor===Object);function tw(e,t,n){if(Object.prototype.hasOwnProperty.call(e,t)||"constructor"===t)return e[t];let a=n();return e[t]=a,a}let tN=(e,t)=>!0===e?t:"string"==typeof e?ee(t,e):void 0;function tk(e,t,n,a){var r;let i=t._rootScopes,s=(r=t._fallback,ea(r)?r(n,a):r),o=[...e,...i],l=new Set;l.add(a);let c=tS(l,o,n,s||n,a);return null!==c&&(void 0===s||s===n||null!==(c=tS(l,o,s,c,a)))&&tg(Array.from(l),[""],i,s,()=>(function(e,t,n){let a=e._getTarget();t in a||(a[t]={});let r=a[t];return L(r)&&z(n)?n:r||{}})(t,n,a))}function tS(e,t,n,a,r){for(;n;)n=function(e,t,n,a,r){for(let s of t){let t=tN(n,s);if(t){var i;e.add(t);let s=(i=t._fallback,ea(i)?i(n,r):i);if(void 0!==s&&s!==n&&s!==a)return s}else if(!1===t&&void 0!==a&&n!==a)return null}return!1}(e,t,n,a,r);return n}function tC(e,t){for(let n of t){if(!n)continue;let t=n[e];if(void 0!==t)return t}}function tT(e){let t=e._keys;return t||(t=e._keys=function(e){let t=new Set;for(let n of e)for(let e of Object.keys(n).filter(e=>!e.startsWith("_")))t.add(e);return Array.from(t)}(e._scopes)),t}function tI(e,t,n,a){let r,i,s,{iScale:o}=e,{key:l="r"}=this._parsing,c=Array(a);for(r=0;r<a;++r)s=t[i=r+n],c[r]={r:o.parse(ee(s,l),i)};return c}let tE=Number.EPSILON||1e-14,t_=(e,t)=>t<e.length&&!e[t].skip&&e[t],tA=e=>"x"===e?"y":"x";function tR(e,t,n){return Math.max(Math.min(e,n),t)}function tD(){return"undefined"!=typeof window&&"undefined"!=typeof document}function tM(e){let t=e.parentNode;return t&&"[object ShadowRoot]"===t.toString()&&(t=t.host),t}function tF(e,t,n){let a;return"string"==typeof e?(a=parseInt(e,10),-1!==e.indexOf("%")&&(a=a/100*t.parentNode[n])):a=e,a}let tO=e=>e.ownerDocument.defaultView.getComputedStyle(e,null),tP=["top","right","bottom","left"];function tj(e,t,n){let a={};n=n?"-"+n:"";for(let r=0;r<4;r++){let i=tP[r];a[i]=parseFloat(e[t+"-"+i+n])||0}return a.width=a.left+a.right,a.height=a.top+a.bottom,a}function tL(e,t){if("native"in e)return e;let{canvas:n,currentDevicePixelRatio:a}=t,r=tO(n),i="border-box"===r.boxSizing,s=tj(r,"padding"),o=tj(r,"border","width"),{x:l,y:c,box:u}=function(e,t){let n,a,r,i=e.touches,s=i&&i.length?i[0]:e,{offsetX:o,offsetY:l}=s,c=!1;if(r=e.target,(o>0||l>0)&&(!r||!r.shadowRoot))n=o,a=l;else{let e=t.getBoundingClientRect();n=s.clientX-e.left,a=s.clientY-e.top,c=!0}return{x:n,y:a,box:c}}(e,n),h=s.left+(u&&o.left),d=s.top+(u&&o.top),{width:p,height:f}=t;return i&&(p-=s.width+o.width,f-=s.height+o.height),{x:Math.round((l-h)/p*n.width/a),y:Math.round((c-d)/f*n.height/a)}}let tz=e=>Math.round(10*e)/10;function tB(e,t,n){let a=t||1,r=Math.floor(e.height*a),i=Math.floor(e.width*a);e.height=Math.floor(e.height),e.width=Math.floor(e.width);let s=e.canvas;return s.style&&(n||!s.style.height&&!s.style.width)&&(s.style.height="".concat(e.height,"px"),s.style.width="".concat(e.width,"px")),(e.currentDevicePixelRatio!==a||s.height!==r||s.width!==i)&&(e.currentDevicePixelRatio=a,s.height=r,s.width=i,e.ctx.setTransform(a,0,0,a,0,0),!0)}let tV=function(){let e=!1;try{let t={get passive(){return e=!0,!1}};tD()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch(e){}return e}();function tU(e,t){let n=tO(e).getPropertyValue(t),a=n&&n.match(/^(\d+)(\.\d+)?px$/);return a?+a[1]:void 0}function tW(e,t,n,a){return{x:e.x+n*(t.x-e.x),y:e.y+n*(t.y-e.y)}}function tG(e,t,n,a){return{x:e.x+n*(t.x-e.x),y:"middle"===a?n<.5?e.y:t.y:"after"===a?n<1?e.y:t.y:n>0?t.y:e.y}}function tH(e,t,n,a){let r={x:e.cp2x,y:e.cp2y},i={x:t.cp1x,y:t.cp1y},s=tW(e,r,n),o=tW(r,i,n),l=tW(i,t,n),c=tW(s,o,n),u=tW(o,l,n);return tW(c,u,n)}function tq(e,t,n){var a;return e?(a=n,{x:e=>t+t+a-e,setWidth(e){a=e},textAlign:e=>"center"===e?e:"right"===e?"left":"right",xPlus:(e,t)=>e-t,leftForLtr:(e,t)=>e-t}):{x:e=>e,setWidth(e){},textAlign:e=>e,xPlus:(e,t)=>e+t,leftForLtr:(e,t)=>e}}function tK(e,t){let n,a;("ltr"===t||"rtl"===t)&&(a=[(n=e.canvas.style).getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",t,"important"),e.prevTextDirection=a)}function tX(e,t){void 0!==t&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function tY(e){return"angle"===e?{between:eC,compare:ek,normalize:eS}:{between:eI,compare:(e,t)=>e-t,normalize:e=>e}}function tZ(e){let{start:t,end:n,count:a,loop:r,style:i}=e;return{start:t%a,end:n%a,loop:r&&(n-t+1)%a==0,style:i}}function tQ(e,t,n){let a,r,i;if(!n)return[e];let{property:s,start:o,end:l}=n,c=t.length,{compare:u,between:h,normalize:d}=tY(s),{start:p,end:f,loop:m,style:g}=function(e,t,n){let a,{property:r,start:i,end:s}=n,{between:o,normalize:l}=tY(r),c=t.length,{start:u,end:h,loop:d}=e;if(d){for(u+=c,h+=c,a=0;a<c&&o(l(t[u%c][r]),i,s);++a)u--,h--;u%=c,h%=c}return h<u&&(h+=c),{start:u,end:h,loop:d,style:e.style}}(e,t,n),x=[],y=!1,b=null,v=()=>y||h(o,i,a)&&0!==u(o,i),w=()=>!y||0===u(l,a)||h(l,i,a);for(let e=p,n=p;e<=f;++e)(r=t[e%c]).skip||(a=d(r[s]))!==i&&(y=h(a,o,l),null===b&&v()&&(b=0===u(a,o)?e:n),null!==b&&w()&&(x.push(tZ({start:b,end:e,loop:m,count:c,style:g})),b=null),n=e,i=a);return null!==b&&x.push(tZ({start:b,end:f,loop:m,count:c,style:g})),x}function tJ(e,t){let n=[],a=e.segments;for(let r=0;r<a.length;r++){let i=tQ(a[r],e.points,t);i.length&&n.push(...i)}return n}function t$(e,t,n,a){return a&&a.setContext&&n?function(e,t,n,a){let r=e._chart.getContext(),i=t0(e.options),{_datasetIndex:s,options:{spanGaps:o}}=e,l=n.length,c=[],u=i,h=t[0].start,d=h;function p(e,t,a,r){let i=o?-1:1;if(e!==t){for(e+=l;n[e%l].skip;)e-=i;for(;n[t%l].skip;)t+=i;e%l!=t%l&&(c.push({start:e%l,end:t%l,loop:a,style:r}),u=r,h=t%l)}}for(let e of t){let t,i=n[(h=o?h:e.start)%l];for(d=h+1;d<=e.end;d++){let o=n[d%l];(function(e,t){if(!t)return!1;let n=[],a=function(e,t){return eG(t)?(n.includes(t)||n.push(t),n.indexOf(t)):t};return JSON.stringify(e,a)!==JSON.stringify(t,a)})(t=t0(a.setContext(tm(r,{type:"segment",p0:i,p1:o,p0DataIndex:(d-1)%l,p1DataIndex:d%l,datasetIndex:s}))),u)&&p(h,d-1,e.loop,u),i=o,u=t}h<d-1&&p(h,d-1,e.loop,u)}return c}(e,t,n,a):t}function t0(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function t1(e,t,n){return e.options.clip?e[n]:t[n]}function t2(e,t){let n=t._clip;if(n.disabled)return!1;let a=function(e,t){let{xScale:n,yScale:a}=e;return n&&a?{left:t1(n,t,"left"),right:t1(n,t,"right"),top:t1(a,t,"top"),bottom:t1(a,t,"bottom")}:t}(t,e.chartArea);return{left:!1===n.left?0:a.left-(!0===n.left?0:n.left),right:!1===n.right?e.width:a.right+(!0===n.right?0:n.right),top:!1===n.top?0:a.top-(!0===n.top?0:n.top),bottom:!1===n.bottom?e.height:a.bottom+(!0===n.bottom?0:n.bottom)}}var t3=new class{_notify(e,t,n,a){let r=t.listeners[a],i=t.duration;r.forEach(a=>a({chart:e,initial:t.initial,numSteps:i,currentStep:Math.min(n-t.start,i)}))}_refresh(){this._request||(this._running=!0,this._request=eF.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),t=0;this._charts.forEach((n,a)=>{let r;if(!n.running||!n.items.length)return;let i=n.items,s=i.length-1,o=!1;for(;s>=0;--s)(r=i[s])._active?(r._total>n.duration&&(n.duration=r._total),r.tick(e),o=!0):(i[s]=i[i.length-1],i.pop());o&&(a.draw(),this._notify(a,n,e,"progress")),i.length||(n.running=!1,this._notify(a,n,e,"complete"),n.initial=!1),t+=i.length}),this._lastDate=e,0===t&&(this._running=!1)}_getAnims(e){let t=this._charts,n=t.get(e);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,n)),n}listen(e,t,n){this._getAnims(e).listeners[t].push(n)}add(e,t){t&&t.length&&this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){let t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((e,t)=>Math.max(e,t._duration),0),this._refresh())}running(e){if(!this._running)return!1;let t=this._charts.get(e);return!!t&&!!t.running&&!!t.items.length}stop(e){let t=this._charts.get(e);if(!t||!t.items.length)return;let n=t.items,a=n.length-1;for(;a>=0;--a)n[a].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}};let t4="transparent",t5={boolean:(e,t,n)=>n>.5?t:e,color(e,t,n){let a=eH(e||t4),r=a.valid&&eH(t||t4);return r&&r.valid?r.mix(a,n).hexString():t},number:(e,t,n)=>e+(t-e)*n};class t6{active(){return this._active}update(e,t,n){if(this._active){this._notify(!1);let a=this._target[this._prop],r=n-this._start,i=this._duration-r;this._start=n,this._duration=Math.floor(Math.max(i,e.duration)),this._total+=r,this._loop=!!e.loop,this._to=tf([e.to,t,a,e.from]),this._from=tf([e.from,a,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){let t,n=e-this._start,a=this._duration,r=this._prop,i=this._from,s=this._loop,o=this._to;if(this._active=i!==o&&(s||n<a),!this._active){this._target[r]=o,this._notify(!0);return}if(n<0){this._target[r]=i;return}t=n/a%2,t=s&&t>1?2-t:t,t=this._easing(Math.min(1,Math.max(0,t))),this._target[r]=this._fn(i,o,t)}wait(){let e=this._promises||(this._promises=[]);return new Promise((t,n)=>{e.push({res:t,rej:n})})}_notify(e){let t=e?"res":"rej",n=this._promises||[];for(let e=0;e<n.length;e++)n[e][t]()}constructor(e,t,n,a){let r=t[n];a=tf([e.to,a,r,e.from]);let i=tf([e.from,r,a]);this._active=!0,this._fn=e.fn||t5[e.type||typeof i],this._easing=eW[e.easing]||eW.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=n,this._from=i,this._to=a,this._promises=void 0}}class t8{configure(e){if(!z(e))return;let t=Object.keys(e3.animation),n=this._properties;Object.getOwnPropertyNames(e).forEach(a=>{let r=e[a];if(!z(r))return;let i={};for(let e of t)i[e]=r[e];(L(r.properties)&&r.properties||[a]).forEach(e=>{e!==a&&n.has(e)||n.set(e,i)})})}_animateOptions(e,t){let n=t.options,a=function(e,t){if(!t)return;let n=e.options;if(!n){e.options=t;return}return n.$shared&&(e.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}(e,n);if(!a)return[];let r=this._createAnimations(a,n);return n.$shared&&(function(e,t){let n=[],a=Object.keys(t);for(let t=0;t<a.length;t++){let r=e[a[t]];r&&r.active()&&n.push(r.wait())}return Promise.all(n)})(e.options.$animations,n).then(()=>{e.options=n},()=>{}),r}_createAnimations(e,t){let n,a=this._properties,r=[],i=e.$animations||(e.$animations={}),s=Object.keys(t),o=Date.now();for(n=s.length-1;n>=0;--n){let l=s[n];if("$"===l.charAt(0))continue;if("options"===l){r.push(...this._animateOptions(e,t));continue}let c=t[l],u=i[l],h=a.get(l);if(u)if(h&&u.active()){u.update(h,c,o);continue}else u.cancel();if(!h||!h.duration){e[l]=c;continue}i[l]=u=new t6(h,e,l,c),r.push(u)}return r}update(e,t){if(0===this._properties.size)return void Object.assign(e,t);let n=this._createAnimations(e,t);if(n.length)return t3.add(this._chart,n),!0}constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}}function t9(e,t){let n=e&&e.options||{},a=n.reverse,r=void 0===n.min?t:0,i=void 0===n.max?t:0;return{start:a?i:r,end:a?r:i}}function t7(e,t){let n,a,r=[],i=e._getSortedDatasetMetas(t);for(n=0,a=i.length;n<a;++n)r.push(i[n].index);return r}function ne(e,t,n){let a,r,i,s,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=e.keys,c="single"===o.mode;if(null===t)return;let u=!1;for(a=0,r=l.length;a<r;++a){if((i=+l[a])===n){if(u=!0,o.all)continue;break}B(s=e.values[i])&&(c||0===t||ef(t)===ef(s))&&(t+=s)}return u||o.all?t:0}function nt(e,t){let n=e&&e.options.stacked;return n||void 0===n&&void 0!==t.stack}function nn(e,t,n,a){for(let r of t.getMatchingVisibleMetas(a).reverse()){let t=e[r.index];if(n&&t>0||!n&&t<0)return r.index}return null}function na(e,t){let n,{chart:a,_cachedMeta:r}=e,i=a._stacks||(a._stacks={}),{iScale:s,vScale:o,index:l}=r,c=s.axis,u=o.axis,h="".concat(s.id,".").concat(o.id,".").concat(r.stack||r.type),d=t.length;for(let e=0;e<d;++e){let a=t[e],{[c]:s,[u]:d}=a;(n=(a._stacks||(a._stacks={}))[u]=function(e,t,n){let a=e[t]||(e[t]={});return a[n]||(a[n]={})}(i,h,s))[l]=d,n._top=nn(n,o,!0,r.type),n._bottom=nn(n,o,!1,r.type),(n._visualValues||(n._visualValues={}))[l]=d}}function nr(e,t){let n=e.scales;return Object.keys(n).filter(e=>n[e].axis===t).shift()}function ni(e,t){let n=e.controller.index,a=e.vScale&&e.vScale.axis;if(a)for(let r of t=t||e._parsed){let e=r._stacks;if(!e||void 0===e[a]||void 0===e[a][n])return;delete e[a][n],void 0!==e[a]._visualValues&&void 0!==e[a]._visualValues[n]&&delete e[a]._visualValues[n]}}let ns=e=>"reset"===e||"none"===e,no=(e,t)=>t?e:Object.assign({},e);class nl{initialize(){let e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=nt(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&ni(this._cachedMeta),this.index=e}linkScales(){let e=this.chart,t=this._cachedMeta,n=this.getDataset(),a=(e,t,n,a)=>"x"===e?t:"r"===e?a:n,r=t.xAxisID=U(n.xAxisID,nr(e,"x")),i=t.yAxisID=U(n.yAxisID,nr(e,"y")),s=t.rAxisID=U(n.rAxisID,nr(e,"r")),o=t.indexAxis,l=t.iAxisID=a(o,r,i,s),c=t.vAxisID=a(o,i,r,s);t.xScale=this.getScaleForId(r),t.yScale=this.getScaleForId(i),t.rScale=this.getScaleForId(s),t.iScale=this.getScaleForId(l),t.vScale=this.getScaleForId(c)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){let t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){let e=this._cachedMeta;this._data&&eD(this._data,this),e._stacked&&ni(e)}_dataCheck(){let e=this.getDataset(),t=e.data||(e.data=[]),n=this._data;if(z(t)){let e=this._cachedMeta;this._data=function(e,t){let n,a,r,{iScale:i,vScale:s}=t,o="x"===i.axis?"x":"y",l="x"===s.axis?"x":"y",c=Object.keys(e),u=Array(c.length);for(n=0,a=c.length;n<a;++n)r=c[n],u[n]={[o]:r,[l]:e[r]};return u}(t,e)}else if(n!==t){if(n){eD(n,this);let e=this._cachedMeta;ni(e),e._parsed=[]}t&&Object.isExtensible(t)&&function(e,t){if(e._chartjs)return e._chartjs.listeners.push(t);Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),eR.forEach(t=>{let n="_onData"+et(t),a=e[t];Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];let s=a.apply(this,r);return e._chartjs.listeners.forEach(e=>{"function"==typeof e[n]&&e[n](...r)}),s}})})}(t,this),this._syncList=[],this._data=t}}addElements(){let e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){let t=this._cachedMeta,n=this.getDataset(),a=!1;this._dataCheck();let r=t._stacked;t._stacked=nt(t.vScale,t),t.stack!==n.stack&&(a=!0,ni(t),t.stack=n.stack),this._resyncElements(e),(a||r!==t._stacked)&&(na(this,t._parsed),t._stacked=nt(t.vScale,t))}configure(){let e=this.chart.config,t=e.datasetScopeKeys(this._type),n=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){let n,a,r,{_cachedMeta:i,_data:s}=this,{iScale:o,_stacked:l}=i,c=o.axis,u=0===e&&t===s.length||i._sorted,h=e>0&&i._parsed[e-1];if(!1===this._parsing)i._parsed=s,i._sorted=!0,r=s;else{r=L(s[e])?this.parseArrayData(i,s,e,t):z(s[e])?this.parseObjectData(i,s,e,t):this.parsePrimitiveData(i,s,e,t);let o=()=>null===a[c]||h&&a[c]<h[c];for(n=0;n<t;++n)i._parsed[n+e]=a=r[n],u&&(o()&&(u=!1),h=a);i._sorted=u}l&&na(this,r)}parsePrimitiveData(e,t,n,a){let r,i,{iScale:s,vScale:o}=e,l=s.axis,c=o.axis,u=s.getLabels(),h=s===o,d=Array(a);for(r=0;r<a;++r)i=r+n,d[r]={[l]:h||s.parse(u[i],i),[c]:o.parse(t[i],i)};return d}parseArrayData(e,t,n,a){let r,i,s,{xScale:o,yScale:l}=e,c=Array(a);for(r=0;r<a;++r)s=t[i=r+n],c[r]={x:o.parse(s[0],i),y:l.parse(s[1],i)};return c}parseObjectData(e,t,n,a){let r,i,s,{xScale:o,yScale:l}=e,{xAxisKey:c="x",yAxisKey:u="y"}=this._parsing,h=Array(a);for(r=0;r<a;++r)s=t[i=r+n],h[r]={x:o.parse(ee(s,c),i),y:l.parse(ee(s,u),i)};return h}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,n){let a=this.chart,r=this._cachedMeta,i=t[e.axis];return ne({keys:t7(a,!0),values:t._stacks[e.axis]._visualValues},i,r.index,{mode:n})}updateRangeFromParsed(e,t,n,a){let r=n[t.axis],i=null===r?NaN:r,s=a&&n._stacks[t.axis];a&&s&&(a.values=s,i=ne(a,r,this._cachedMeta.index)),e.min=Math.min(e.min,i),e.max=Math.max(e.max,i)}getMinMax(e,t){let n,a,r,i=this._cachedMeta,s=i._parsed,o=i._sorted&&e===i.iScale,l=s.length,c=this._getOtherScale(e),u=(r=this.chart,t&&!i.hidden&&i._stacked&&{keys:t7(r,!0),values:null}),h={min:1/0,max:-1/0},{min:d,max:p}=function(e){let{min:t,max:n,minDefined:a,maxDefined:r}=e.getUserBounds();return{min:a?t:-1/0,max:r?n:1/0}}(c);function f(){let t=(a=s[n])[c.axis];return!B(a[e.axis])||d>t||p<t}for(n=0;n<l&&(f()||(this.updateRangeFromParsed(h,e,a,u),!o));++n);if(o){for(n=l-1;n>=0;--n)if(!f()){this.updateRangeFromParsed(h,e,a,u);break}}return h}getAllParsedValues(e){let t,n,a,r=this._cachedMeta._parsed,i=[];for(t=0,n=r.length;t<n;++t)B(a=r[t][e.axis])&&i.push(a);return i}getMaxOverflow(){return!1}getLabelAndValue(e){let t=this._cachedMeta,n=t.iScale,a=t.vScale,r=this.getParsed(e);return{label:n?""+n.getLabelForValue(r[n.axis]):"",value:a?""+a.getLabelForValue(r[a.axis]):""}}_update(e){var t;let n,a,r,i,s=this._cachedMeta;this.update(e||"default"),z(t=U(this.options.clip,function(e,t,n){if(!1===n)return!1;let a=t9(e,n),r=t9(t,n);return{top:r.end,right:a.end,bottom:r.start,left:a.start}}(s.xScale,s.yScale,this.getMaxOverflow())))?(n=t.top,a=t.right,r=t.bottom,i=t.left):n=a=r=i=t,s._clip={top:n,right:a,bottom:r,left:i,disabled:!1===t}}update(e){}draw(){let e,t=this._ctx,n=this.chart,a=this._cachedMeta,r=a.data||[],i=n.chartArea,s=[],o=this._drawStart||0,l=this._drawCount||r.length-o,c=this.options.drawActiveElementsOnTop;for(a.dataset&&a.dataset.draw(t,i,o,l),e=o;e<o+l;++e){let n=r[e];n.hidden||(n.active&&c?s.push(n):n.draw(t,i))}for(e=0;e<s.length;++e)s[e].draw(t,i)}getStyle(e,t){let n=t?"active":"default";return void 0===e&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(e||0,n)}getContext(e,t,n){var a,r;let i,s=this.getDataset();if(e>=0&&e<this._cachedMeta.data.length){let t=this._cachedMeta.data[e];(i=t.$context||(a=this.getContext(),t.$context=tm(a,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"}))).parsed=this.getParsed(e),i.raw=s.data[e],i.index=i.dataIndex=e}else(i=this.$context||(this.$context=tm(this.chart.getContext(),{active:!1,dataset:void 0,datasetIndex:r=this.index,index:r,mode:"default",type:"dataset"}))).dataset=s,i.index=i.datasetIndex=this.index;return i.active=!!t,i.mode=n,i}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",n=arguments.length>2?arguments[2]:void 0,a="active"===t,r=this._cachedDataOpts,i=e+"-"+t,s=r[i],o=this.enableOptionSharing&&en(n);if(s)return no(s,o);let l=this.chart.config,c=l.datasetElementScopeKeys(this._type,e),u=l.getOptionScopes(this.getDataset(),c),h=Object.keys(e3.elements[e]),d=()=>this.getContext(n,a,t),p=l.resolveNamedOptions(u,h,d,a?["".concat(e,"Hover"),"hover",e,""]:[e,""]);return p.$shared&&(p.$shared=o,r[i]=Object.freeze(no(p,o))),p}_resolveAnimations(e,t,n){let a,r=this.chart,i=this._cachedDataOpts,s="animation-".concat(t),o=i[s];if(o)return o;if(!1!==r.options.animation){let r=this.chart.config,i=r.datasetAnimationScopeKeys(this._type,t),s=r.getOptionScopes(this.getDataset(),i);a=r.createResolver(s,this.getContext(e,n,t))}let l=new t8(r,a&&a.animations);return a&&a._cacheable&&(i[s]=Object.freeze(l)),l}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||ns(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){let n=this.resolveDataElementOptions(e,t),a=this._sharedOptions,r=this.getSharedOptions(n),i=this.includeOptions(t,r)||r!==a;return this.updateSharedOptions(r,t,n),{sharedOptions:r,includeOptions:i}}updateElement(e,t,n,a){ns(a)?Object.assign(e,n):this._resolveAnimations(t,a).update(e,n)}updateSharedOptions(e,t,n){e&&!ns(t)&&this._resolveAnimations(void 0,t).update(e,n)}_setStyle(e,t,n,a){e.active=a;let r=this.getStyle(t,a);this._resolveAnimations(t,n,a).update(e,{options:!a&&this.getSharedOptions(r)||r})}removeHoverStyle(e,t,n){this._setStyle(e,n,"active",!1)}setHoverStyle(e,t,n){this._setStyle(e,n,"active",!0)}_removeDatasetHoverStyle(){let e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){let e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){let t=this._data,n=this._cachedMeta.data;for(let[e,t,n]of this._syncList)this[e](t,n);this._syncList=[];let a=n.length,r=t.length,i=Math.min(r,a);i&&this.parse(0,i),r>a?this._insertElements(a,r-a,e):r<a&&this._removeElements(r,a-r)}_insertElements(e,t){let n,a=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=this._cachedMeta,i=r.data,s=e+t,o=e=>{for(e.length+=t,n=e.length-1;n>=s;n--)e[n]=e[n-t]};for(o(i),n=e;n<s;++n)i[n]=new this.dataElementType;this._parsing&&o(r._parsed),this.parse(e,t),a&&this.updateElements(i,e,t,"reset")}updateElements(e,t,n,a){}_removeElements(e,t){let n=this._cachedMeta;if(this._parsing){let a=n._parsed.splice(e,t);n._stacked&&ni(n,a)}n.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{let[t,n,a]=e;this[t](n,a)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){let e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);let n=arguments.length-2;n&&this._sync(["_insertElements",e,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}}function nc(e,t,n,a){return L(e)?!function(e,t,n,a){let r=n.parse(e[0],a),i=n.parse(e[1],a),s=Math.min(r,i),o=Math.max(r,i),l=s,c=o;Math.abs(s)>Math.abs(o)&&(l=o,c=s),t[n.axis]=c,t._custom={barStart:l,barEnd:c,start:r,end:i,min:s,max:o}}(e,t,n,a):t[n.axis]=n.parse(e,a),t}function nu(e,t,n,a){let r,i,s,o,l=e.iScale,c=e.vScale,u=l.getLabels(),h=l===c,d=[];for(r=n,i=n+a;r<i;++r)o=t[r],(s={})[l.axis]=h||l.parse(u[r],r),d.push(nc(o,s,c,r));return d}function nh(e){return e&&void 0!==e.barStart&&void 0!==e.barEnd}function nd(e,t,n,a){var r,i,s;return a?np((r=e,i=t,s=n,e=r===i?s:r===s?i:r),n,t):np(e,t,n)}function np(e,t,n){return"start"===e?t:"end"===e?n:e}o(nl,"defaults",{}),o(nl,"datasetElementType",null),o(nl,"dataElementType",null);class nf extends nl{parsePrimitiveData(e,t,n,a){return nu(e,t,n,a)}parseArrayData(e,t,n,a){return nu(e,t,n,a)}parseObjectData(e,t,n,a){let r,i,s,o,{iScale:l,vScale:c}=e,{xAxisKey:u="x",yAxisKey:h="y"}=this._parsing,d="x"===l.axis?u:h,p="x"===c.axis?u:h,f=[];for(r=n,i=n+a;r<i;++r)o=t[r],(s={})[l.axis]=l.parse(ee(o,d),r),f.push(nc(ee(o,p),s,c,r));return f}updateRangeFromParsed(e,t,n,a){super.updateRangeFromParsed(e,t,n,a);let r=n._custom;r&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,r.min),e.max=Math.max(e.max,r.max))}getMaxOverflow(){return 0}getLabelAndValue(e){let{iScale:t,vScale:n}=this._cachedMeta,a=this.getParsed(e),r=a._custom,i=nh(r)?"["+r.start+", "+r.end+"]":""+n.getLabelForValue(a[n.axis]);return{label:""+t.getLabelForValue(a[t.axis]),value:i}}initialize(){this.enableOptionSharing=!0,super.initialize(),this._cachedMeta.stack=this.getDataset().stack}update(e){let t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,n,a){let r="reset"===a,{index:i,_cachedMeta:{vScale:s}}=this,o=s.getBasePixel(),l=s.isHorizontal(),c=this._getRuler(),{sharedOptions:u,includeOptions:h}=this._getSharedOptions(t,a);for(let d=t;d<t+n;d++){let t=this.getParsed(d),n=r||j(t[s.axis])?{base:o,head:o}:this._calculateBarValuePixels(d),p=this._calculateBarIndexPixels(d,c),f=(t._stacks||{})[s.axis],m={horizontal:l,base:n.base,enableBorderRadius:!f||nh(t._custom)||i===f._top||i===f._bottom,x:l?n.head:p.center,y:l?p.center:n.head,height:l?p.size:Math.abs(n.size),width:l?Math.abs(n.size):p.size};h&&(m.options=u||this.resolveDataElementOptions(d,e[d].active?"active":a));let g=m.options||e[d].options;!function(e,t,n,a){let r,i,s,o,l,c=t.borderSkipped,u={};if(!c){e.borderSkipped=u;return}if(!0===c){e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}let{start:h,end:d,reverse:p,top:f,bottom:m}=(e.horizontal?(r=e.base>e.x,i="left",s="right"):(r=e.base<e.y,i="bottom",s="top"),r?(o="end",l="start"):(o="start",l="end"),{start:i,end:s,reverse:r,top:o,bottom:l});"middle"===c&&n&&(e.enableBorderRadius=!0,(n._top||0)===a?c=f:(n._bottom||0)===a?c=m:(u[nd(m,h,d,p)]=!0,c=f)),u[nd(c,h,d,p)]=!0,e.borderSkipped=u}(m,g,f,i),function(e,t,n){let{inflateAmount:a}=t;e.inflateAmount="auto"===a?.33*(1===n):a}(m,g,c.ratio),this.updateElement(e[d],d,m,a)}}_getStacks(e,t){let{iScale:n}=this._cachedMeta,a=n.getMatchingVisibleMetas(this._type).filter(e=>e.controller.options.grouped),r=n.options.stacked,i=[],s=this._cachedMeta.controller.getParsed(t),o=s&&s[n.axis],l=e=>{let t=e._parsed.find(e=>e[n.axis]===o),a=t&&t[e.vScale.axis];if(j(a)||isNaN(a))return!0};for(let n of a)if(!(void 0!==t&&l(n))&&((!1===r||-1===i.indexOf(n.stack)||void 0===r&&void 0===n.stack)&&i.push(n.stack),n.index===e))break;return i.length||i.push(void 0),i}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){let e=this.chart.scales,t=this.chart.options.indexAxis;return Object.keys(e).filter(n=>e[n].axis===t).shift()}_getAxis(){let e={},t=this.getFirstScaleIdForIndexAxis();for(let n of this.chart.data.datasets)e[U("x"===this.chart.options.indexAxis?n.xAxisID:n.yAxisID,t)]=!0;return Object.keys(e)}_getStackIndex(e,t,n){let a=this._getStacks(e,n),r=void 0!==t?a.indexOf(t):-1;return -1===r?a.length-1:r}_getRuler(){let e,t,n=this.options,a=this._cachedMeta,r=a.iScale,i=[];for(e=0,t=a.data.length;e<t;++e)i.push(r.getPixelForValue(this.getParsed(e)[r.axis],e));let s=n.barThickness;return{min:s||function(e){let t,n,a,r,i=e.iScale,s=function(e,t){if(!e._cache.$bar){let n=e.getMatchingVisibleMetas(t),a=[];for(let t=0,r=n.length;t<r;t++)a=a.concat(n[t].controller.getAllParsedValues(e));e._cache.$bar=eM(a.sort((e,t)=>e-t))}return e._cache.$bar}(i,e.type),o=i._length,l=()=>{32767!==a&&-32768!==a&&(en(r)&&(o=Math.min(o,Math.abs(a-r)||o)),r=a)};for(t=0,n=s.length;t<n;++t)a=i.getPixelForValue(s[t]),l();for(t=0,r=void 0,n=i.ticks.length;t<n;++t)a=i.getPixelForTick(t),l();return o}(a),pixels:i,start:r._startPixel,end:r._endPixel,stackCount:this._getStackCount(),scale:r,grouped:n.grouped,ratio:s?1:n.categoryPercentage*n.barPercentage}}_calculateBarValuePixels(e){let t,n,{_cachedMeta:{vScale:a,_stacked:r,index:i},options:{base:s,minBarLength:o}}=this,l=s||0,c=this.getParsed(e),u=c._custom,h=nh(u),d=c[a.axis],p=0,f=r?this.applyStack(a,c,r):d;f!==d&&(p=f-d,f=d),h&&(d=u.barStart,f=u.barEnd-u.barStart,0!==d&&ef(d)!==ef(u.barEnd)&&(p=0),p+=d);let m=j(s)||h?p:s,g=a.getPixelForValue(m);if(Math.abs(n=(t=this.chart.getDataVisibility(e)?a.getPixelForValue(p+f):g)-g)<o){var x;n=(0!==(x=n)?ef(x):(a.isHorizontal()?1:-1)*(a.min>=l?1:-1))*o,d===l&&(g-=n/2);let e=a.getPixelForDecimal(0),s=a.getPixelForDecimal(1),u=Math.min(e,s);t=(g=Math.max(Math.min(g,Math.max(e,s)),u))+n,r&&!h&&(c._stacks[a.axis]._visualValues[i]=a.getValueForPixel(t)-a.getValueForPixel(g))}if(g===a.getPixelForValue(l)){let e=ef(n)*a.getLineWidthForValue(l)/2;g+=e,n-=e}return{size:n,base:g,head:t,center:t+n/2}}_calculateBarIndexPixels(e,t){let n,a,r=t.scale,i=this.options,s=i.skipNull,o=U(i.maxBarThickness,1/0),l=this._getAxisCount();if(t.grouped){let r=s?this._getStackCount(e):t.stackCount,c="flex"===i.barThickness?function(e,t,n,a){let r=t.pixels,i=r[e],s=e>0?r[e-1]:null,o=e<r.length-1?r[e+1]:null,l=n.categoryPercentage;null===s&&(s=i-(null===o?t.end-t.start:o-i)),null===o&&(o=i+i-s);let c=i-(i-Math.min(s,o))/2*l;return{chunk:Math.abs(o-s)/2*l/a,ratio:n.barPercentage,start:c}}(e,t,i,r*l):function(e,t,n,a){let r,i,s=n.barThickness;return j(s)?(r=t.min*n.categoryPercentage,i=n.barPercentage):(r=s*a,i=1),{chunk:r/a,ratio:i,start:t.pixels[e]-r/2}}(e,t,i,r*l),u="x"===this.chart.options.indexAxis?this.getDataset().xAxisID:this.getDataset().yAxisID,h=this._getAxis().indexOf(U(u,this.getFirstScaleIdForIndexAxis())),d=this._getStackIndex(this.index,this._cachedMeta.stack,s?e:void 0)+h;n=c.start+c.chunk*d+c.chunk/2,a=Math.min(o,c.chunk*c.ratio)}else n=r.getPixelForValue(this.getParsed(e)[r.axis],e),a=Math.min(o,t.min*t.ratio);return{base:n-a/2,head:n+a/2,center:n,size:a}}draw(){let e=this._cachedMeta,t=e.vScale,n=e.data,a=n.length,r=0;for(;r<a;++r)null===this.getParsed(r)[t.axis]||n[r].hidden||n[r].draw(this._ctx)}}o(nf,"id","bar"),o(nf,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),o(nf,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class nm extends nl{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,t,n,a){let r=super.parsePrimitiveData(e,t,n,a);for(let e=0;e<r.length;e++)r[e]._custom=this.resolveDataElementOptions(e+n).radius;return r}parseArrayData(e,t,n,a){let r=super.parseArrayData(e,t,n,a);for(let e=0;e<r.length;e++){let a=t[n+e];r[e]._custom=U(a[2],this.resolveDataElementOptions(e+n).radius)}return r}parseObjectData(e,t,n,a){let r=super.parseObjectData(e,t,n,a);for(let e=0;e<r.length;e++){let a=t[n+e];r[e]._custom=U(a&&a.r&&+a.r,this.resolveDataElementOptions(e+n).radius)}return r}getMaxOverflow(){let e=this._cachedMeta.data,t=0;for(let n=e.length-1;n>=0;--n)t=Math.max(t,e[n].size(this.resolveDataElementOptions(n))/2);return t>0&&t}getLabelAndValue(e){let t=this._cachedMeta,n=this.chart.data.labels||[],{xScale:a,yScale:r}=t,i=this.getParsed(e),s=a.getLabelForValue(i.x),o=r.getLabelForValue(i.y),l=i._custom;return{label:n[e]||"",value:"("+s+", "+o+(l?", "+l:"")+")"}}update(e){let t=this._cachedMeta.data;this.updateElements(t,0,t.length,e)}updateElements(e,t,n,a){let r="reset"===a,{iScale:i,vScale:s}=this._cachedMeta,{sharedOptions:o,includeOptions:l}=this._getSharedOptions(t,a),c=i.axis,u=s.axis;for(let h=t;h<t+n;h++){let t=e[h],n=!r&&this.getParsed(h),d={},p=d[c]=r?i.getPixelForDecimal(.5):i.getPixelForValue(n[c]),f=d[u]=r?s.getBasePixel():s.getPixelForValue(n[u]);d.skip=isNaN(p)||isNaN(f),l&&(d.options=o||this.resolveDataElementOptions(h,t.active?"active":a),r&&(d.options.radius=0)),this.updateElement(t,h,d,a)}}resolveDataElementOptions(e,t){let n=this.getParsed(e),a=super.resolveDataElementOptions(e,t);a.$shared&&(a=Object.assign({},a,{$shared:!1}));let r=a.radius;return"active"!==t&&(a.radius=0),a.radius+=U(n&&n._custom,r),a}}o(nm,"id","bubble"),o(nm,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),o(nm,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});class ng extends nl{linkScales(){}parse(e,t){let n=this.getDataset().data,a=this._cachedMeta;if(!1===this._parsing)a._parsed=n;else{let r,i,s=e=>+n[e];if(z(n[e])){let{key:e="value"}=this._parsing;s=t=>+ee(n[t],e)}for(r=e,i=e+t;r<i;++r)a._parsed[r]=s(r)}}_getRotation(){return eb(this.options.rotation-90)}_getCircumference(){return eb(this.options.circumference)}_getRotationExtents(){let e=es,t=-es;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){let a=this.chart.getDatasetMeta(n).controller,r=a._getRotation(),i=a._getCircumference();e=Math.min(e,r),t=Math.max(t,r+i)}return{rotation:e,circumference:t-e}}update(e){let t,{chartArea:n}=this.chart,a=this._cachedMeta,r=a.data,i=this.getMaxBorderWidth()+this.getMaxOffset(r)+this.options.spacing,s=Math.max((Math.min(n.width,n.height)-i)/2,0),o=Math.min((t=this.options.cutout,"string"==typeof t&&t.endsWith("%")?parseFloat(t)/100:t/s),1),l=this._getRingWeight(this.index),{circumference:c,rotation:u}=this._getRotationExtents(),{ratioX:h,ratioY:d,offsetX:p,offsetY:f}=function(e,t,n){let a=1,r=1,i=0,s=0;if(t<es){let o=e+t,l=Math.cos(e),c=Math.sin(e),u=Math.cos(o),h=Math.sin(o),d=(t,a,r)=>eC(t,e,o,!0)?1:Math.max(a,a*n,r,r*n),p=(t,a,r)=>eC(t,e,o,!0)?-1:Math.min(a,a*n,r,r*n),f=d(0,l,u),m=d(eu,c,h),g=p(ei,l,u),x=p(ei+eu,c,h);a=(f-g)/2,r=(m-x)/2,i=-(f+g)/2,s=-(m+x)/2}return{ratioX:a,ratioY:r,offsetX:i,offsetY:s}}(u,c,o),m=Math.max(Math.min((n.width-i)/h,(n.height-i)/d)/2,0),g=W(this.options.radius,m),x=Math.max(g*o,0),y=(g-x)/this._getVisibleDatasetWeightTotal();this.offsetX=p*g,this.offsetY=f*g,a.total=this.calculateTotal(),this.outerRadius=g-y*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-y*l,0),this.updateElements(r,0,r.length,e)}_circumference(e,t){let n=this.options,a=this._cachedMeta,r=this._getCircumference();return t&&n.animation.animateRotate||!this.chart.getDataVisibility(e)||null===a._parsed[e]||a.data[e].hidden?0:this.calculateCircumference(a._parsed[e]*r/es)}updateElements(e,t,n,a){let r,i="reset"===a,s=this.chart,o=s.chartArea,l=s.options.animation,c=(o.left+o.right)/2,u=(o.top+o.bottom)/2,h=i&&l.animateScale,d=h?0:this.innerRadius,p=h?0:this.outerRadius,{sharedOptions:f,includeOptions:m}=this._getSharedOptions(t,a),g=this._getRotation();for(r=0;r<t;++r)g+=this._circumference(r,i);for(r=t;r<t+n;++r){let t=this._circumference(r,i),n=e[r],s={x:c+this.offsetX,y:u+this.offsetY,startAngle:g,endAngle:g+t,circumference:t,outerRadius:p,innerRadius:d};m&&(s.options=f||this.resolveDataElementOptions(r,n.active?"active":a)),g+=t,this.updateElement(n,r,s,a)}}calculateTotal(){let e,t=this._cachedMeta,n=t.data,a=0;for(e=0;e<n.length;e++){let r=t._parsed[e];null!==r&&!isNaN(r)&&this.chart.getDataVisibility(e)&&!n[e].hidden&&(a+=Math.abs(r))}return a}calculateCircumference(e){let t=this._cachedMeta.total;return t>0&&!isNaN(e)?Math.abs(e)/t*es:0}getLabelAndValue(e){let t=this._cachedMeta,n=this.chart,a=n.data.labels||[],r=eZ(t._parsed[e],n.options.locale);return{label:a[e]||"",value:r}}getMaxBorderWidth(e){let t,n,a,r,i,s=0,o=this.chart;if(!e){for(t=0,n=o.data.datasets.length;t<n;++t)if(o.isDatasetVisible(t)){e=(a=o.getDatasetMeta(t)).data,r=a.controller;break}}if(!e)return 0;for(t=0,n=e.length;t<n;++t)"inner"!==(i=r.resolveDataElementOptions(t)).borderAlign&&(s=Math.max(s,i.borderWidth||0,i.hoverBorderWidth||0));return s}getMaxOffset(e){let t=0;for(let n=0,a=e.length;n<a;++n){let e=this.resolveDataElementOptions(n);t=Math.max(t,e.offset||0,e.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let n=0;n<e;++n)this.chart.isDatasetVisible(n)&&(t+=this._getRingWeight(n));return t}_getRingWeight(e){return Math.max(U(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}}o(ng,"id","doughnut"),o(ng,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),o(ng,"descriptors",{_scriptable:e=>"spacing"!==e,_indexable:e=>"spacing"!==e&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),o(ng,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){let t=e.data;if(t.labels.length&&t.datasets.length){let{labels:{pointStyle:n,color:a}}=e.legend.options;return t.labels.map((t,r)=>{let i=e.getDatasetMeta(0).controller.getStyle(r);return{text:t,fillStyle:i.backgroundColor,strokeStyle:i.borderColor,fontColor:a,lineWidth:i.borderWidth,pointStyle:n,hidden:!e.getDataVisibility(r),index:r}})}return[]}},onClick(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}}}});class nx extends nl{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){let t=this._cachedMeta,{dataset:n,data:a=[],_dataset:r}=t,i=this.chart._animationsDisabled,{start:s,count:o}=eL(t,a,i);this._drawStart=s,this._drawCount=o,ez(t)&&(s=0,o=a.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!r._decimated,n.points=a;let l=this.resolveDatasetElementOptions(e);this.options.showLine||(l.borderWidth=0),l.segment=this.options.segment,this.updateElement(n,void 0,{animated:!i,options:l},e),this.updateElements(a,s,o,e)}updateElements(e,t,n,a){let r="reset"===a,{iScale:i,vScale:s,_stacked:o,_dataset:l}=this._cachedMeta,{sharedOptions:c,includeOptions:u}=this._getSharedOptions(t,a),h=i.axis,d=s.axis,{spanGaps:p,segment:f}=this.options,m=ex(p)?p:1/0,g=this.chart._animationsDisabled||r||"none"===a,x=t+n,y=e.length,b=t>0&&this.getParsed(t-1);for(let n=0;n<y;++n){let p=e[n],y=g?p:{};if(n<t||n>=x){y.skip=!0;continue}let v=this.getParsed(n),w=j(v[d]),N=y[h]=i.getPixelForValue(v[h],n),k=y[d]=r||w?s.getBasePixel():s.getPixelForValue(o?this.applyStack(s,v,o):v[d],n);y.skip=isNaN(N)||isNaN(k)||w,y.stop=n>0&&Math.abs(v[h]-b[h])>m,f&&(y.parsed=v,y.raw=l.data[n]),u&&(y.options=c||this.resolveDataElementOptions(n,p.active?"active":a)),g||this.updateElement(p,n,y,a),b=v}}getMaxOverflow(){let e=this._cachedMeta,t=e.dataset,n=t.options&&t.options.borderWidth||0,a=e.data||[];return a.length?Math.max(n,a[0].size(this.resolveDataElementOptions(0)),a[a.length-1].size(this.resolveDataElementOptions(a.length-1)))/2:n}draw(){let e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}o(nx,"id","line"),o(nx,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),o(nx,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class ny extends nl{getLabelAndValue(e){let t=this._cachedMeta,n=this.chart,a=n.data.labels||[],r=eZ(t._parsed[e].r,n.options.locale);return{label:a[e]||"",value:r}}parseObjectData(e,t,n,a){return tI.bind(this)(e,t,n,a)}update(e){let t=this._cachedMeta.data;this._updateRadius(),this.updateElements(t,0,t.length,e)}getMinMax(){let e=this._cachedMeta,t={min:1/0,max:-1/0};return e.data.forEach((e,n)=>{let a=this.getParsed(n).r;!isNaN(a)&&this.chart.getDataVisibility(n)&&(a<t.min&&(t.min=a),a>t.max&&(t.max=a))}),t}_updateRadius(){let e=this.chart,t=e.chartArea,n=e.options,a=Math.max(Math.min(t.right-t.left,t.bottom-t.top)/2,0),r=Math.max(n.cutoutPercentage?a/100*n.cutoutPercentage:1,0),i=(a-r)/e.getVisibleDatasetCount();this.outerRadius=a-i*this.index,this.innerRadius=this.outerRadius-i}updateElements(e,t,n,a){let r,i="reset"===a,s=this.chart,o=s.options.animation,l=this._cachedMeta.rScale,c=l.xCenter,u=l.yCenter,h=l.getIndexAngle(0)-.5*ei,d=h,p=360/this.countVisibleElements();for(r=0;r<t;++r)d+=this._computeAngle(r,a,p);for(r=t;r<t+n;r++){let t=e[r],n=d,f=d+this._computeAngle(r,a,p),m=s.getDataVisibility(r)?l.getDistanceFromCenterForValue(this.getParsed(r).r):0;d=f,i&&(o.animateScale&&(m=0),o.animateRotate&&(n=f=h));let g={x:c,y:u,innerRadius:0,outerRadius:m,startAngle:n,endAngle:f,options:this.resolveDataElementOptions(r,t.active?"active":a)};this.updateElement(t,r,g,a)}}countVisibleElements(){let e=this._cachedMeta,t=0;return e.data.forEach((e,n)=>{!isNaN(this.getParsed(n).r)&&this.chart.getDataVisibility(n)&&t++}),t}_computeAngle(e,t,n){return this.chart.getDataVisibility(e)?eb(this.resolveDataElementOptions(e,t).angle||n):0}constructor(e,t){super(e,t),this.innerRadius=void 0,this.outerRadius=void 0}}o(ny,"id","polarArea"),o(ny,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),o(ny,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){let t=e.data;if(t.labels.length&&t.datasets.length){let{labels:{pointStyle:n,color:a}}=e.legend.options;return t.labels.map((t,r)=>{let i=e.getDatasetMeta(0).controller.getStyle(r);return{text:t,fillStyle:i.backgroundColor,strokeStyle:i.borderColor,fontColor:a,lineWidth:i.borderWidth,pointStyle:n,hidden:!e.getDataVisibility(r),index:r}})}return[]}},onClick(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class nb extends ng{}o(nb,"id","pie"),o(nb,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class nv extends nl{getLabelAndValue(e){let t=this._cachedMeta.vScale,n=this.getParsed(e);return{label:t.getLabels()[e],value:""+t.getLabelForValue(n[t.axis])}}parseObjectData(e,t,n,a){return tI.bind(this)(e,t,n,a)}update(e){let t=this._cachedMeta,n=t.dataset,a=t.data||[],r=t.iScale.getLabels();if(n.points=a,"resize"!==e){let t=this.resolveDatasetElementOptions(e);this.options.showLine||(t.borderWidth=0);let i={_loop:!0,_fullLoop:r.length===a.length,options:t};this.updateElement(n,void 0,i,e)}this.updateElements(a,0,a.length,e)}updateElements(e,t,n,a){let r=this._cachedMeta.rScale,i="reset"===a;for(let s=t;s<t+n;s++){let t=e[s],n=this.resolveDataElementOptions(s,t.active?"active":a),o=r.getPointPositionForValue(s,this.getParsed(s).r),l=i?r.xCenter:o.x,c=i?r.yCenter:o.y,u={x:l,y:c,angle:o.angle,skip:isNaN(l)||isNaN(c),options:n};this.updateElement(t,s,u,a)}}}o(nv,"id","radar"),o(nv,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),o(nv,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class nw extends nl{getLabelAndValue(e){let t=this._cachedMeta,n=this.chart.data.labels||[],{xScale:a,yScale:r}=t,i=this.getParsed(e),s=a.getLabelForValue(i.x),o=r.getLabelForValue(i.y);return{label:n[e]||"",value:"("+s+", "+o+")"}}update(e){let t=this._cachedMeta,{data:n=[]}=t,a=this.chart._animationsDisabled,{start:r,count:i}=eL(t,n,a);if(this._drawStart=r,this._drawCount=i,ez(t)&&(r=0,i=n.length),this.options.showLine){this.datasetElementType||this.addElements();let{dataset:r,_dataset:i}=t;r._chart=this.chart,r._datasetIndex=this.index,r._decimated=!!i._decimated,r.points=n;let s=this.resolveDatasetElementOptions(e);s.segment=this.options.segment,this.updateElement(r,void 0,{animated:!a,options:s},e)}else this.datasetElementType&&(delete t.dataset,this.datasetElementType=!1);this.updateElements(n,r,i,e)}addElements(){let{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,t,n,a){let r="reset"===a,{iScale:i,vScale:s,_stacked:o,_dataset:l}=this._cachedMeta,c=this.resolveDataElementOptions(t,a),u=this.getSharedOptions(c),h=this.includeOptions(a,u),d=i.axis,p=s.axis,{spanGaps:f,segment:m}=this.options,g=ex(f)?f:1/0,x=this.chart._animationsDisabled||r||"none"===a,y=t>0&&this.getParsed(t-1);for(let c=t;c<t+n;++c){let t=e[c],n=this.getParsed(c),f=x?t:{},b=j(n[p]),v=f[d]=i.getPixelForValue(n[d],c),w=f[p]=r||b?s.getBasePixel():s.getPixelForValue(o?this.applyStack(s,n,o):n[p],c);f.skip=isNaN(v)||isNaN(w)||b,f.stop=c>0&&Math.abs(n[d]-y[d])>g,m&&(f.parsed=n,f.raw=l.data[c]),h&&(f.options=u||this.resolveDataElementOptions(c,t.active?"active":a)),x||this.updateElement(t,c,f,a),y=n}this.updateSharedOptions(u,a,c)}getMaxOverflow(){let e=this._cachedMeta,t=e.data||[];if(!this.options.showLine){let e=0;for(let n=t.length-1;n>=0;--n)e=Math.max(e,t[n].size(this.resolveDataElementOptions(n))/2);return e>0&&e}let n=e.dataset,a=n.options&&n.options.borderWidth||0;return t.length?Math.max(a,t[0].size(this.resolveDataElementOptions(0)),t[t.length-1].size(this.resolveDataElementOptions(t.length-1)))/2:a}}function nN(){throw Error("This method is not implemented: Check that a complete date adapter is provided.")}o(nw,"id","scatter"),o(nw,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),o(nw,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});class nk{static override(e){Object.assign(nk.prototype,e)}init(){}formats(){return nN()}parse(){return nN()}format(){return nN()}add(){return nN()}diff(){return nN()}startOf(){return nN()}endOf(){return nN()}constructor(e){o(this,"options",void 0),this.options=e||{}}}var nS={_date:nk};function nC(e,t,n,a,r){let i=e.getSortedVisibleDatasetMetas(),s=n[t];for(let e=0,n=i.length;e<n;++e){let{index:n,data:o}=i[e],{lo:l,hi:c}=function(e,t,n,a){let{controller:r,data:i,_sorted:s}=e,o=r._cachedMeta.iScale,l=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null;if(o&&t===o.axis&&"r"!==t&&s&&i.length){let s=o._reversePixels?eA:e_;if(a){if(r._sharedOptions){let e=i[0],a="function"==typeof e.getRange&&e.getRange(t);if(a){let e=s(i,t,n-a),r=s(i,t,n+a);return{lo:e.lo,hi:r.hi}}}}else{let a=s(i,t,n);if(l){let{vScale:t}=r._cachedMeta,{_parsed:n}=e,i=n.slice(0,a.lo+1).reverse().findIndex(e=>!j(e[t.axis]));a.lo-=Math.max(0,i);let s=n.slice(a.hi).findIndex(e=>!j(e[t.axis]));a.hi+=Math.max(0,s)}return a}}return{lo:0,hi:i.length-1}}(i[e],t,s,r);for(let e=l;e<=c;++e){let t=o[e];t.skip||a(t,n,e)}}}function nT(e,t,n,a,r){let i=[];return(r||e.isPointInArea(t))&&nC(e,n,t,function(n,s,o){(r||e7(n,e.chartArea,0))&&n.inRange(t.x,t.y,a)&&i.push({element:n,datasetIndex:s,index:o})},!0),i}function nI(e,t,n,a,r,i){let s;return i||e.isPointInArea(t)?"r"!==n||a?function(e,t,n,a,r,i){let s=[],o=function(e){let t=-1!==e.indexOf("x"),n=-1!==e.indexOf("y");return function(e,a){return Math.sqrt(Math.pow(t?Math.abs(e.x-a.x):0,2)+Math.pow(n?Math.abs(e.y-a.y):0,2))}}(n),l=1/0;return nC(e,n,t,function(n,c,u){let h=n.inRange(t.x,t.y,r);if(a&&!h)return;let d=n.getCenterPoint(r);if(!(i||e.isPointInArea(d))&&!h)return;let p=o(t,d);p<l?(s=[{element:n,datasetIndex:c,index:u}],l=p):p===l&&s.push({element:n,datasetIndex:c,index:u})}),s}(e,t,n,a,r,i):(s=[],nC(e,n,t,function(e,n,a){let{startAngle:i,endAngle:o}=e.getProps(["startAngle","endAngle"],r),{angle:l}=ew(e,{x:t.x,y:t.y});eC(l,i,o)&&s.push({element:e,datasetIndex:n,index:a})}),s):[]}function nE(e,t,n,a,r){let i=[],s="x"===n?"inXRange":"inYRange",o=!1;return(nC(e,n,t,(e,a,l)=>{e[s]&&e[s](t[n],r)&&(i.push({element:e,datasetIndex:a,index:l}),o=o||e.inRange(t.x,t.y,r))}),a&&!o)?[]:i}var n_={modes:{index(e,t,n,a){let r=tL(t,e),i=n.axis||"x",s=n.includeInvisible||!1,o=n.intersect?nT(e,r,i,a,s):nI(e,r,i,!1,a,s),l=[];return o.length?(e.getSortedVisibleDatasetMetas().forEach(e=>{let t=o[0].index,n=e.data[t];n&&!n.skip&&l.push({element:n,datasetIndex:e.index,index:t})}),l):[]},dataset(e,t,n,a){let r=tL(t,e),i=n.axis||"xy",s=n.includeInvisible||!1,o=n.intersect?nT(e,r,i,a,s):nI(e,r,i,!1,a,s);if(o.length>0){let t=o[0].datasetIndex,n=e.getDatasetMeta(t).data;o=[];for(let e=0;e<n.length;++e)o.push({element:n[e],datasetIndex:t,index:e})}return o},point(e,t,n,a){let r=tL(t,e);return nT(e,r,n.axis||"xy",a,n.includeInvisible||!1)},nearest(e,t,n,a){let r=tL(t,e),i=n.axis||"xy",s=n.includeInvisible||!1;return nI(e,r,i,n.intersect,a,s)},x(e,t,n,a){let r=tL(t,e);return nE(e,r,"x",n.intersect,a)},y(e,t,n,a){let r=tL(t,e);return nE(e,r,"y",n.intersect,a)}}};let nA=["left","top","right","bottom"];function nR(e,t){return e.filter(e=>e.pos===t)}function nD(e,t){return e.filter(e=>-1===nA.indexOf(e.pos)&&e.box.axis===t)}function nM(e,t){return e.sort((e,n)=>{let a=t?n:e,r=t?e:n;return a.weight===r.weight?a.index-r.index:a.weight-r.weight})}function nF(e,t,n,a){return Math.max(e[n],t[n])+Math.max(e[a],t[a])}function nO(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function nP(e,t,n,a){let r,i,s,o,l,c,u=[];for(r=0,i=e.length,l=0;r<i;++r){(o=(s=e[r]).box).update(s.width||t.w,s.height||t.h,function(e,t){let n=t.maxPadding;var a=e?["left","right"]:["top","bottom"];let r={left:0,top:0,right:0,bottom:0};return a.forEach(e=>{r[e]=Math.max(t[e],n[e])}),r}(s.horizontal,t));let{same:i,other:h}=function(e,t,n,a){let{pos:r,box:i}=n,s=e.maxPadding;if(!z(r)){n.size&&(e[r]-=n.size);let t=a[n.stack]||{size:0,count:1};t.size=Math.max(t.size,n.horizontal?i.height:i.width),n.size=t.size/t.count,e[r]+=n.size}i.getPadding&&nO(s,i.getPadding());let o=Math.max(0,t.outerWidth-nF(s,e,"left","right")),l=Math.max(0,t.outerHeight-nF(s,e,"top","bottom")),c=o!==e.w,u=l!==e.h;return e.w=o,e.h=l,n.horizontal?{same:c,other:u}:{same:u,other:c}}(t,n,s,a);l|=i&&u.length,c=c||h,o.fullSize||u.push(s)}return l&&nP(u,t,n,a)||c}function nj(e,t,n,a,r){e.top=n,e.left=t,e.right=t+a,e.bottom=n+r,e.width=a,e.height=r}function nL(e,t,n,a){let r=n.padding,{x:i,y:s}=t;for(let o of e){let e=o.box,l=a[o.stack]||{count:1,placed:0,weight:1},c=o.stackWeight/l.weight||1;if(o.horizontal){let a=t.w*c,i=l.size||e.height;en(l.start)&&(s=l.start),e.fullSize?nj(e,r.left,s,n.outerWidth-r.right-r.left,i):nj(e,t.left+l.placed,s,a,i),l.start=s,l.placed+=a,s=e.bottom}else{let a=t.h*c,s=l.size||e.width;en(l.start)&&(i=l.start),e.fullSize?nj(e,i,r.top,s,n.outerHeight-r.bottom-r.top):nj(e,i,t.top+l.placed,s,a),l.start=i,l.placed+=a,i=e.right}}t.x=i,t.y=s}var nz={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(e){t.draw(e)}}]},e.boxes.push(t)},removeBox(e,t){let n=e.boxes?e.boxes.indexOf(t):-1;-1!==n&&e.boxes.splice(n,1)},configure(e,t,n){t.fullSize=n.fullSize,t.position=n.position,t.weight=n.weight},update(e,t,n,a){if(!e)return;let r=td(e.options.layout.padding),i=Math.max(t-r.width,0),s=Math.max(n-r.height,0),o=function(e){let t=function(e){let t,n,a,r,i,s,o=[];for(t=0,n=(e||[]).length;t<n;++t)a=e[t],({position:r,options:{stack:i,stackWeight:s=1}}=a),o.push({index:t,box:a,pos:r,horizontal:a.isHorizontal(),weight:a.weight,stack:i&&r+i,stackWeight:s});return o}(e),n=nM(t.filter(e=>e.box.fullSize),!0),a=nM(nR(t,"left"),!0),r=nM(nR(t,"right")),i=nM(nR(t,"top"),!0),s=nM(nR(t,"bottom")),o=nD(t,"x"),l=nD(t,"y");return{fullSize:n,leftAndTop:a.concat(i),rightAndBottom:r.concat(l).concat(s).concat(o),chartArea:nR(t,"chartArea"),vertical:a.concat(r).concat(l),horizontal:i.concat(s).concat(o)}}(e.boxes),l=o.vertical,c=o.horizontal;H(e.boxes,e=>{"function"==typeof e.beforeLayout&&e.beforeLayout()});let u=Object.freeze({outerWidth:t,outerHeight:n,padding:r,availableWidth:i,availableHeight:s,vBoxMaxWidth:i/2/(l.reduce((e,t)=>t.box.options&&!1===t.box.options.display?e:e+1,0)||1),hBoxMaxHeight:s/2}),h=Object.assign({},r);nO(h,td(a));let d=Object.assign({maxPadding:h,w:i,h:s,x:r.left,y:r.top},r),p=function(e,t){let n,a,r,i=function(e){let t={};for(let n of e){let{stack:e,pos:a,stackWeight:r}=n;if(!e||!nA.includes(a))continue;let i=t[e]||(t[e]={count:0,placed:0,weight:0,size:0});i.count++,i.weight+=r}return t}(e),{vBoxMaxWidth:s,hBoxMaxHeight:o}=t;for(n=0,a=e.length;n<a;++n){let{fullSize:a}=(r=e[n]).box,l=i[r.stack],c=l&&r.stackWeight/l.weight;r.horizontal?(r.width=c?c*s:a&&t.availableWidth,r.height=o):(r.width=s,r.height=c?c*o:a&&t.availableHeight)}return i}(l.concat(c),u);nP(o.fullSize,d,u,p),nP(l,d,u,p),nP(c,d,u,p)&&nP(l,d,u,p);let f=d.maxPadding;function m(e){let t=Math.max(f[e]-d[e],0);return d[e]+=t,t}d.y+=m("top"),d.x+=m("left"),m("right"),m("bottom"),nL(o.leftAndTop,d,u,p),d.x+=d.w,d.y+=d.h,nL(o.rightAndBottom,d,u,p),e.chartArea={left:d.left,top:d.top,right:d.left+d.w,bottom:d.top+d.h,height:d.h,width:d.w},H(o.chartArea,t=>{let n=t.box;Object.assign(n,e.chartArea),n.update(d.w,d.h,{left:0,top:0,right:0,bottom:0})})}};class nB{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,n){}removeEventListener(e,t,n){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,n,a){return t=Math.max(0,t||e.width),n=n||e.height,{width:t,height:Math.max(0,a?Math.floor(t/a):n)}}isAttached(e){return!0}updateConfig(e){}}class nV extends nB{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}let nU="$chartjs",nW={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},nG=e=>null===e||""===e,nH=!!tV&&{passive:!0};function nq(e,t){for(let n of e)if(n===t||n.contains(t))return!0}function nK(e,t,n){let a=e.canvas,r=new MutationObserver(e=>{let t=!1;for(let n of e)t=(t=t||nq(n.addedNodes,a))&&!nq(n.removedNodes,a);t&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}function nX(e,t,n){let a=e.canvas,r=new MutationObserver(e=>{let t=!1;for(let n of e)t=(t=t||nq(n.removedNodes,a))&&!nq(n.addedNodes,a);t&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}let nY=new Map,nZ=0;function nQ(){let e=window.devicePixelRatio;e!==nZ&&(nZ=e,nY.forEach((t,n)=>{n.currentDevicePixelRatio!==e&&t()}))}function nJ(e,t,n){let a=e.canvas,r=a&&tM(a);if(!r)return;let i=eO((e,t)=>{let a=r.clientWidth;n(e,t),a<r.clientWidth&&n()},window),s=new ResizeObserver(e=>{let t=e[0],n=t.contentRect.width,a=t.contentRect.height;(0!==n||0!==a)&&i(n,a)});return s.observe(r),nY.size||window.addEventListener("resize",nQ),nY.set(e,i),s}function n$(e,t,n){n&&n.disconnect(),"resize"===t&&(nY.delete(e),nY.size||window.removeEventListener("resize",nQ))}function n0(e,t,n){let a=e.canvas,r=eO(t=>{null!==e.ctx&&n(function(e,t){let n=nW[e.type]||e.type,{x:a,y:r}=tL(e,t);return{type:n,chart:t,native:e,x:void 0!==a?a:null,y:void 0!==r?r:null}}(t,e))},e);return a&&a.addEventListener(t,r,nH),r}class n1 extends nB{acquireContext(e,t){let n=e&&e.getContext&&e.getContext("2d");return n&&n.canvas===e?(!function(e,t){let n=e.style,a=e.getAttribute("height"),r=e.getAttribute("width");if(e[nU]={initial:{height:a,width:r,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",nG(r)){let t=tU(e,"width");void 0!==t&&(e.width=t)}if(nG(a))if(""===e.style.height)e.height=e.width/(t||2);else{let t=tU(e,"height");void 0!==t&&(e.height=t)}}(e,t),n):null}releaseContext(e){let t=e.canvas;if(!t[nU])return!1;let n=t[nU].initial;["height","width"].forEach(e=>{let a=n[e];j(a)?t.removeAttribute(e):t.setAttribute(e,a)});let a=n.style||{};return Object.keys(a).forEach(e=>{t.style[e]=a[e]}),t.width=t.width,delete t[nU],!0}addEventListener(e,t,n){this.removeEventListener(e,t);let a=e.$proxies||(e.$proxies={}),r={attach:nK,detach:nX,resize:nJ}[t]||n0;a[t]=r(e,t,n)}removeEventListener(e,t){let n=e.$proxies||(e.$proxies={}),a=n[t];a&&((({attach:n$,detach:n$,resize:n$})[t]||function(e,t,n){e&&e.canvas&&e.canvas.removeEventListener(t,n,nH)})(e,t,a),n[t]=void 0)}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,n,a){return function(e,t,n,a){let r=tO(e),i=tj(r,"margin"),s=tF(r.maxWidth,e,"clientWidth")||el,o=tF(r.maxHeight,e,"clientHeight")||el,l=function(e,t,n){let a,r;if(void 0===t||void 0===n){let i=e&&tM(e);if(i){let e=i.getBoundingClientRect(),s=tO(i),o=tj(s,"border","width"),l=tj(s,"padding");t=e.width-l.width-o.width,n=e.height-l.height-o.height,a=tF(s.maxWidth,i,"clientWidth"),r=tF(s.maxHeight,i,"clientHeight")}else t=e.clientWidth,n=e.clientHeight}return{width:t,height:n,maxWidth:a||el,maxHeight:r||el}}(e,t,n),{width:c,height:u}=l;if("content-box"===r.boxSizing){let e=tj(r,"border","width"),t=tj(r,"padding");c-=t.width+e.width,u-=t.height+e.height}return c=Math.max(0,c-i.width),u=Math.max(0,a?c/a:u-i.height),c=tz(Math.min(c,s,l.maxWidth)),u=tz(Math.min(u,o,l.maxHeight)),c&&!u&&(u=tz(c/2)),(void 0!==t||void 0!==n)&&a&&l.height&&u>l.height&&(c=tz(Math.floor((u=l.height)*a))),{width:c,height:u}}(e,t,n,a)}isAttached(e){let t=e&&tM(e);return!!(t&&t.isConnected)}}class n2{tooltipPosition(e){let{x:t,y:n}=this.getProps(["x","y"],e);return{x:t,y:n}}hasValue(){return ex(this.x)&&ex(this.y)}getProps(e,t){let n=this.$animations;if(!t||!n)return this;let a={};return e.forEach(e=>{a[e]=n[e]&&n[e].active()?n[e]._to:this[e]}),a}constructor(){o(this,"x",void 0),o(this,"y",void 0),o(this,"active",!1),o(this,"options",void 0),o(this,"$animations",void 0)}}function n3(e,t,n,a,r){let i,s,o,l=U(a,0),c=Math.min(U(r,e.length),e.length),u=0;for(n=Math.ceil(n),r&&(n=(i=r-a)/Math.floor(i/n)),o=l;o<0;)o=Math.round(l+ ++u*n);for(s=Math.max(l,0);s<c;s++)s===o&&(t.push(e[s]),o=Math.round(l+ ++u*n))}o(n2,"defaults",{}),o(n2,"defaultRoutes",void 0);let n4=(e,t,n)=>"top"===t||"left"===t?e[t]+n:e[t]-n,n5=(e,t)=>Math.min(t||e,e);function n6(e,t){let n=[],a=e.length/t,r=e.length,i=0;for(;i<r;i+=a)n.push(e[Math.floor(i)]);return n}function n8(e){return e.drawTicks?e.tickLength:0}function n9(e,t){if(!e.display)return 0;let n=tp(e.font,t),a=td(e.padding);return(L(e.text)?e.text.length:1)*n.lineHeight+a.height}class n7 extends n2{init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:n,_suggestedMax:a}=this;return e=V(e,1/0),t=V(t,-1/0),n=V(n,1/0),a=V(a,-1/0),{min:V(e,n),max:V(t,a),minDefined:B(e),maxDefined:B(t)}}getMinMax(e){let t,{min:n,max:a,minDefined:r,maxDefined:i}=this.getUserBounds();if(r&&i)return{min:n,max:a};let s=this.getMatchingVisibleMetas();for(let o=0,l=s.length;o<l;++o)t=s[o].controller.getMinMax(this,e),r||(n=Math.min(n,t.min)),i||(a=Math.max(a,t.max));return n=i&&n>a?a:n,a=r&&n>a?n:a,{min:V(n,V(a,n)),max:V(a,V(n,a))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){let e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chart.chartArea;return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){G(this.options.beforeUpdate,[this])}update(e,t,n){let{beginAtZero:a,grace:r,ticks:i}=this.options,s=i.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=function(e,t,n){let{min:a,max:r}=e,i=W(t,(r-a)/2),s=(e,t)=>n&&0===e?0:e+t;return{min:s(a,-Math.abs(i)),max:s(r,i)}}(this,r,a),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();let o=s<this.ticks.length;this._convertTicksToLabels(o?n6(this.ticks,s):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),i.display&&(i.autoSkip||"auto"===i.source)&&(this.ticks=function(e,t){let n=e.options.ticks,a=function(e){let t=e.options.offset,n=e._tickSize();return Math.floor(Math.min(e._length/n+ +!t,e._maxLength/n))}(e),r=Math.min(n.maxTicksLimit||a,a),i=n.major.enabled?function(e){let t,n,a=[];for(t=0,n=e.length;t<n;t++)e[t].major&&a.push(t);return a}(t):[],s=i.length,o=i[0],l=i[s-1],c=[];if(s>r)return function(e,t,n,a){let r,i=0,s=n[0];for(r=0,a=Math.ceil(a);r<e.length;r++)r===s&&(t.push(e[r]),s=n[++i*a])}(t,c,i,s/r),c;let u=function(e,t,n){let a=function(e){let t,n,a=e.length;if(a<2)return!1;for(n=e[0],t=1;t<a;++t)if(e[t]-e[t-1]!==n)return!1;return n}(e),r=t.length/n;if(!a)return Math.max(r,1);let i=function(e){let t,n=[],a=Math.sqrt(e);for(t=1;t<a;t++)e%t==0&&(n.push(t),n.push(e/t));return a===(0|a)&&n.push(a),n.sort((e,t)=>e-t).pop(),n}(a);for(let e=0,t=i.length-1;e<t;e++){let t=i[e];if(t>r)return t}return Math.max(r,1)}(i,t,r);if(s>0){let e,n,a=s>1?Math.round((l-o)/(s-1)):null;for(n3(t,c,u,j(a)?0:o-a,o),e=0,n=s-1;e<n;e++)n3(t,c,u,i[e],i[e+1]);return n3(t,c,u,l,j(a)?t.length:l+a),c}return n3(t,c,u),c}(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),o&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e,t,n=this.options.reverse;this.isHorizontal()?(e=this.left,t=this.right):(e=this.top,t=this.bottom,n=!n),this._startPixel=e,this._endPixel=t,this._reversePixels=n,this._length=t-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){G(this.options.afterUpdate,[this])}beforeSetDimensions(){G(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){G(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),G(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){G(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){let t,n,a,r=this.options.ticks;for(t=0,n=e.length;t<n;t++)(a=e[t]).label=G(r.callback,[a.value,t,e],this)}afterTickToLabelConversion(){G(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){G(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){let e,t,n,a=this.options,r=a.ticks,i=n5(this.ticks.length,a.ticks.maxTicksLimit),s=r.minRotation||0,o=r.maxRotation,l=s;if(!this._isVisible()||!r.display||s>=o||i<=1||!this.isHorizontal()){this.labelRotation=s;return}let c=this._getLabelSizes(),u=c.widest.width,h=c.highest.height,d=eT(this.chart.width-u,0,this.maxWidth);u+6>(e=a.offset?this.maxWidth/i:d/(i-1))&&(e=d/(i-(a.offset?.5:1)),t=this.maxHeight-n8(a.grid)-r.padding-n9(a.title,this.chart.options.font),n=Math.sqrt(u*u+h*h),l=Math.max(s,Math.min(o,l=180/ei*Math.min(Math.asin(eT((c.highest.height+6)/e,-1,1)),Math.asin(eT(t/n,-1,1))-Math.asin(eT(h/n,-1,1)))))),this.labelRotation=l}afterCalculateLabelRotation(){G(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){G(this.options.beforeFit,[this])}fit(){let e={width:0,height:0},{chart:t,options:{ticks:n,title:a,grid:r}}=this,i=this._isVisible(),s=this.isHorizontal();if(i){let i=n9(a,t.options.font);if(s?(e.width=this.maxWidth,e.height=n8(r)+i):(e.height=this.maxHeight,e.width=n8(r)+i),n.display&&this.ticks.length){let{first:t,last:a,widest:r,highest:i}=this._getLabelSizes(),o=2*n.padding,l=eb(this.labelRotation),c=Math.cos(l),u=Math.sin(l);if(s){let t=n.mirror?0:u*r.width+c*i.height;e.height=Math.min(this.maxHeight,e.height+t+o)}else{let t=n.mirror?0:c*r.width+u*i.height;e.width=Math.min(this.maxWidth,e.width+t+o)}this._calculatePadding(t,a,u,c)}}this._handleMargins(),s?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,n,a){let{ticks:{align:r,padding:i},position:s}=this.options,o=0!==this.labelRotation,l="top"!==s&&"x"===this.axis;if(this.isHorizontal()){let s=this.getPixelForTick(0)-this.left,c=this.right-this.getPixelForTick(this.ticks.length-1),u=0,h=0;o?l?(u=a*e.width,h=n*t.height):(u=n*e.height,h=a*t.width):"start"===r?h=t.width:"end"===r?u=e.width:"inner"!==r&&(u=e.width/2,h=t.width/2),this.paddingLeft=Math.max((u-s+i)*this.width/(this.width-s),0),this.paddingRight=Math.max((h-c+i)*this.width/(this.width-c),0)}else{let n=t.height/2,a=e.height/2;"start"===r?(n=0,a=e.height):"end"===r&&(n=t.height,a=0),this.paddingTop=n+i,this.paddingBottom=a+i}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){G(this.options.afterFit,[this])}isHorizontal(){let{axis:e,position:t}=this.options;return"top"===t||"bottom"===t||"x"===e}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){let t,n;for(this.beforeTickToLabelConversion(),this.generateTickLabels(e),t=0,n=e.length;t<n;t++)j(e[t].label)&&(e.splice(t,1),n--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){let t=this.options.ticks.sampleSize,n=this.ticks;t<n.length&&(n=n6(n,t)),this._labelSizes=e=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,n){let a,r,i,s,o,l,c,u,h,d,p,{ctx:f,_longestTextCache:m}=this,g=[],x=[],y=Math.floor(t/n5(t,n)),b=0,v=0;for(a=0;a<t;a+=y){if(s=e[a].label,f.font=l=(o=this._resolveTickFontOptions(a)).string,c=m[l]=m[l]||{data:{},gc:[]},u=o.lineHeight,h=d=0,j(s)||L(s)){if(L(s))for(r=0,i=s.length;r<i;++r)j(p=s[r])||L(p)||(h=e4(f,c.data,c.gc,h,p),d+=u)}else h=e4(f,c.data,c.gc,h,s),d=u;g.push(h),x.push(d),b=Math.max(h,b),v=Math.max(d,v)}H(m,e=>{let n,a=e.gc,r=a.length/2;if(r>t){for(n=0;n<r;++n)delete e.data[a[n]];a.splice(0,r)}});let w=g.indexOf(b),N=x.indexOf(v),k=e=>({width:g[e]||0,height:x[e]||0});return{first:k(0),last:k(t-1),widest:k(w),highest:k(N),widths:g,heights:x}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){let t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);let t=this._startPixel+e*this._length;return eT(this._alignToPixels?e5(this.chart,t,0):t,-32768,32767)}getDecimalForPixel(e){let t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){let{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){var t,n;let a=this.ticks||[];if(e>=0&&e<a.length){let n=a[e];return n.$context||(t=this.getContext(),n.$context=tm(t,{tick:n,index:e,type:"tick"}))}return this.$context||(this.$context=(n=this.chart.getContext(),tm(n,{scale:this,type:"scale"})))}_tickSize(){let e=this.options.ticks,t=eb(this.labelRotation),n=Math.abs(Math.cos(t)),a=Math.abs(Math.sin(t)),r=this._getLabelSizes(),i=e.autoSkipPadding||0,s=r?r.widest.width+i:0,o=r?r.highest.height+i:0;return this.isHorizontal()?o*n>s*a?s/n:o/a:o*a<s*n?o/n:s/a}_isVisible(){let e=this.options.display;return"auto"!==e?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){let t,n,a,r,i,s,o,l,c,u,h,d,p=this.axis,f=this.chart,m=this.options,{grid:g,position:x,border:y}=m,b=g.offset,v=this.isHorizontal(),w=this.ticks.length+ +!!b,N=n8(g),k=[],S=y.setContext(this.getContext()),C=S.display?S.width:0,T=C/2,I=function(e){return e5(f,e,C)};if("top"===x)t=I(this.bottom),s=this.bottom-N,l=t-T,u=I(e.top)+T,d=e.bottom;else if("bottom"===x)t=I(this.top),u=e.top,d=I(e.bottom)-T,s=t+T,l=this.top+N;else if("left"===x)t=I(this.right),i=this.right-N,o=t-T,c=I(e.left)+T,h=e.right;else if("right"===x)t=I(this.left),c=e.left,h=I(e.right)-T,i=t+T,o=this.left+N;else if("x"===p){if("center"===x)t=I((e.top+e.bottom)/2+.5);else if(z(x)){let e=Object.keys(x)[0],n=x[e];t=I(this.chart.scales[e].getPixelForValue(n))}u=e.top,d=e.bottom,l=(s=t+T)+N}else if("y"===p){if("center"===x)t=I((e.left+e.right)/2);else if(z(x)){let e=Object.keys(x)[0],n=x[e];t=I(this.chart.scales[e].getPixelForValue(n))}o=(i=t-T)-N,c=e.left,h=e.right}let E=U(m.ticks.maxTicksLimit,w),_=Math.max(1,Math.ceil(w/E));for(n=0;n<w;n+=_){let e=this.getContext(n),t=g.setContext(e),p=y.setContext(e),m=t.lineWidth,x=t.color,w=p.dash||[],N=p.dashOffset,S=t.tickWidth,C=t.tickColor,T=t.tickBorderDash||[],I=t.tickBorderDashOffset;void 0!==(a=function(e,t,n){let a,r=e.ticks.length,i=Math.min(t,r-1),s=e._startPixel,o=e._endPixel,l=e.getPixelForTick(i);if(!n||(a=1===r?Math.max(l-s,o-l):0===t?(e.getPixelForTick(1)-l)/2:(l-e.getPixelForTick(i-1))/2,!((l+=i<t?a:-a)<s-1e-6)&&!(l>o+1e-6)))return l}(this,n,b))&&(r=e5(f,a,m),v?i=o=c=h=r:s=l=u=d=r,k.push({tx1:i,ty1:s,tx2:o,ty2:l,x1:c,y1:u,x2:h,y2:d,width:m,color:x,borderDash:w,borderDashOffset:N,tickWidth:S,tickColor:C,tickBorderDash:T,tickBorderDashOffset:I}))}return this._ticksLength=w,this._borderValue=t,k}_computeLabelItems(e){let t,n,a,r,i,s,o,l,c,u,h,d=this.axis,p=this.options,{position:f,ticks:m}=p,g=this.isHorizontal(),x=this.ticks,{align:y,crossAlign:b,padding:v,mirror:w}=m,N=n8(p.grid),k=N+v,S=w?-v:k,C=-eb(this.labelRotation),T=[],I="middle";if("top"===f)i=this.bottom-S,s=this._getXAxisLabelAlignment();else if("bottom"===f)i=this.top+S,s=this._getXAxisLabelAlignment();else if("left"===f){let e=this._getYAxisLabelAlignment(N);s=e.textAlign,r=e.x}else if("right"===f){let e=this._getYAxisLabelAlignment(N);s=e.textAlign,r=e.x}else if("x"===d){if("center"===f)i=(e.top+e.bottom)/2+k;else if(z(f)){let e=Object.keys(f)[0],t=f[e];i=this.chart.scales[e].getPixelForValue(t)+k}s=this._getXAxisLabelAlignment()}else if("y"===d){if("center"===f)r=(e.left+e.right)/2-k;else if(z(f)){let e=Object.keys(f)[0],t=f[e];r=this.chart.scales[e].getPixelForValue(t)}s=this._getYAxisLabelAlignment(N).textAlign}"y"===d&&("start"===y?I="top":"end"===y&&(I="bottom"));let E=this._getLabelSizes();for(t=0,n=x.length;t<n;++t){let e;a=x[t].label;let d=m.setContext(this.getContext(t));o=this.getPixelForTick(t)+m.labelOffset,c=(l=this._resolveTickFontOptions(t)).lineHeight;let p=(u=L(a)?a.length:1)/2,y=d.color,v=d.textStrokeColor,N=d.textStrokeWidth,k=s;if(g?(r=o,"inner"===s&&(k=t===n-1?this.options.reverse?"left":"right":0===t?this.options.reverse?"right":"left":"center"),h="top"===f?"near"===b||0!==C?-u*c+c/2:"center"===b?-E.highest.height/2-p*c+c:-E.highest.height+c/2:"near"===b||0!==C?c/2:"center"===b?E.highest.height/2-p*c:E.highest.height-u*c,w&&(h*=-1),0===C||d.showLabelBackdrop||(r+=c/2*Math.sin(C))):(i=o,h=(1-u)*c/2),d.showLabelBackdrop){let a=td(d.backdropPadding),r=E.heights[t],i=E.widths[t],o=h-a.top,l=0-a.left;switch(I){case"middle":o-=r/2;break;case"bottom":o-=r}switch(s){case"center":l-=i/2;break;case"right":l-=i;break;case"inner":t===n-1?l-=i:t>0&&(l-=i/2)}e={left:l,top:o,width:i+a.width,height:r+a.height,color:d.backdropColor}}T.push({label:a,font:l,textOffset:h,options:{rotation:C,color:y,strokeColor:v,strokeWidth:N,textAlign:k,textBaseline:I,translation:[r,i],backdrop:e}})}return T}_getXAxisLabelAlignment(){let{position:e,ticks:t}=this.options;if(-eb(this.labelRotation))return"top"===e?"left":"right";let n="center";return"start"===t.align?n="left":"end"===t.align?n="right":"inner"===t.align&&(n="inner"),n}_getYAxisLabelAlignment(e){let t,n,{position:a,ticks:{crossAlign:r,mirror:i,padding:s}}=this.options,o=this._getLabelSizes(),l=e+s,c=o.widest.width;return"left"===a?i?(n=this.right+s,"near"===r?t="left":"center"===r?(t="center",n+=c/2):(t="right",n+=c)):(n=this.right-l,"near"===r?t="right":"center"===r?(t="center",n-=c/2):(t="left",n=this.left)):"right"===a?i?(n=this.left+s,"near"===r?t="right":"center"===r?(t="center",n-=c/2):(t="left",n-=c)):(n=this.left+l,"near"===r?t="left":"center"===r?(t="center",n+=c/2):(t="right",n=this.right)):t="right",{textAlign:t,x:n}}_computeLabelArea(){if(this.options.ticks.mirror)return;let e=this.chart,t=this.options.position;return"left"===t||"right"===t?{top:0,left:this.left,bottom:e.height,right:this.right}:"top"===t||"bottom"===t?{top:this.top,left:0,bottom:this.bottom,right:e.width}:void 0}drawBackground(){let{ctx:e,options:{backgroundColor:t},left:n,top:a,width:r,height:i}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(n,a,r,i),e.restore())}getLineWidthForValue(e){let t=this.options.grid;if(!this._isVisible()||!t.display)return 0;let n=this.ticks.findIndex(t=>t.value===e);return n>=0?t.setContext(this.getContext(n)).lineWidth:0}drawGrid(e){let t,n,a=this.options.grid,r=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e)),s=(e,t,n)=>{n.width&&n.color&&(r.save(),r.lineWidth=n.width,r.strokeStyle=n.color,r.setLineDash(n.borderDash||[]),r.lineDashOffset=n.borderDashOffset,r.beginPath(),r.moveTo(e.x,e.y),r.lineTo(t.x,t.y),r.stroke(),r.restore())};if(a.display)for(t=0,n=i.length;t<n;++t){let e=i[t];a.drawOnChartArea&&s({x:e.x1,y:e.y1},{x:e.x2,y:e.y2},e),a.drawTicks&&s({x:e.tx1,y:e.ty1},{x:e.tx2,y:e.ty2},{color:e.tickColor,width:e.tickWidth,borderDash:e.tickBorderDash,borderDashOffset:e.tickBorderDashOffset})}}drawBorder(){let e,t,n,a,{chart:r,ctx:i,options:{border:s,grid:o}}=this,l=s.setContext(this.getContext()),c=s.display?l.width:0;if(!c)return;let u=o.setContext(this.getContext(0)).lineWidth,h=this._borderValue;this.isHorizontal()?(e=e5(r,this.left,c)-c/2,t=e5(r,this.right,u)+u/2,n=a=h):(n=e5(r,this.top,c)-c/2,a=e5(r,this.bottom,u)+u/2,e=t=h),i.save(),i.lineWidth=l.width,i.strokeStyle=l.color,i.beginPath(),i.moveTo(e,n),i.lineTo(t,a),i.stroke(),i.restore()}drawLabels(e){if(!this.options.ticks.display)return;let t=this.ctx,n=this._computeLabelArea();for(let a of(n&&te(t,n),this.getLabelItems(e))){let e=a.options,n=a.font;tr(t,a.label,0,a.textOffset,n,e)}n&&tt(t)}drawTitle(){let e,t,{ctx:n,options:{position:a,title:r,reverse:i}}=this;if(!r.display)return;let s=tp(r.font),o=td(r.padding),l=r.align,c=s.lineHeight/2;"bottom"===a||"center"===a||z(a)?(c+=o.bottom,L(r.text)&&(c+=s.lineHeight*(r.text.length-1))):c+=o.top;let{titleX:u,titleY:h,maxWidth:d,rotation:p}=function(e,t,n,a){let r,i,s,{top:o,left:l,bottom:c,right:u,chart:h}=e,{chartArea:d,scales:p}=h,f=0,m=c-o,g=u-l;if(e.isHorizontal()){if(i=ej(a,l,u),z(n)){let e=Object.keys(n)[0],a=n[e];s=p[e].getPixelForValue(a)+m-t}else s="center"===n?(d.bottom+d.top)/2+m-t:n4(e,n,t);r=u-l}else{if(z(n)){let e=Object.keys(n)[0],a=n[e];i=p[e].getPixelForValue(a)-g+t}else i="center"===n?(d.left+d.right)/2-g+t:n4(e,n,t);s=ej(a,c,o),f="left"===n?-eu:eu}return{titleX:i,titleY:s,maxWidth:r,rotation:f}}(this,c,a,l);tr(n,r.text,0,0,s,{color:r.color,maxWidth:d,rotation:p,textAlign:(e=eP(l),(i&&"right"!==a||!i&&"right"===a)&&(e="left"===(t=e)?"right":"right"===t?"left":t),e),textBaseline:"middle",translation:[u,h]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){let e=this.options,t=e.ticks&&e.ticks.z||0,n=U(e.grid&&e.grid.z,-1),a=U(e.border&&e.border.z,0);return this._isVisible()&&this.draw===n7.prototype.draw?[{z:n,draw:e=>{this.drawBackground(),this.drawGrid(e),this.drawTitle()}},{z:a,draw:()=>{this.drawBorder()}},{z:t,draw:e=>{this.drawLabels(e)}}]:[{z:t,draw:e=>{this.draw(e)}}]}getMatchingVisibleMetas(e){let t,n,a=this.chart.getSortedVisibleDatasetMetas(),r=this.axis+"AxisID",i=[];for(t=0,n=a.length;t<n;++t){let n=a[t];n[r]!==this.id||e&&n.type!==e||i.push(n)}return i}_resolveTickFontOptions(e){return tp(this.options.ticks.setContext(this.getContext(e)).font)}_maxDigits(){let e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}}class ae{isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){var t;let n,a=Object.getPrototypeOf(e);"id"in(t=a)&&"defaults"in t&&(n=this.register(a));let r=this.items,i=e.id,s=this.scope+"."+i;if(!i)throw Error("class does not have id: "+e);return i in r||(r[i]=e,function(e,t,n){var a,r;let i=Z(Object.create(null),[n?e3.get(n):{},e3.get(t),e.defaults]);e3.set(t,i),e.defaultRoutes&&(a=t,Object.keys(r=e.defaultRoutes).forEach(e=>{let t=e.split("."),n=t.pop(),i=[a].concat(t).join("."),s=r[e].split("."),o=s.pop(),l=s.join(".");e3.route(i,n,l,o)})),e.descriptors&&e3.describe(t,e.descriptors)}(e,s,n),this.override&&e3.override(e.id,e.overrides)),s}get(e){return this.items[e]}unregister(e){let t=this.items,n=e.id,a=this.scope;n in t&&delete t[n],a&&n in e3[a]&&(delete e3[a][n],this.override&&delete e$[n])}constructor(e,t,n){this.type=e,this.scope=t,this.override=n,this.items=Object.create(null)}}var at=new class{add(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t)}remove(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t)}addControllers(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.controllers)}addElements(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.elements)}addPlugins(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.plugins)}addScales(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.controllers)}removeElements(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.elements)}removePlugins(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.plugins)}removeScales(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.scales)}_each(e,t,n){[...t].forEach(t=>{let a=n||this._getRegistryForType(t);n||a.isForType(t)||a===this.plugins&&t.id?this._exec(e,a,t):H(t,t=>{let a=n||this._getRegistryForType(t);this._exec(e,a,t)})})}_exec(e,t,n){let a=et(e);G(n["before"+a],[],n),t[e](n),G(n["after"+a],[],n)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){let n=this._typedRegistries[t];if(n.isForType(e))return n}return this.plugins}_get(e,t,n){let a=t.get(e);if(void 0===a)throw Error('"'+e+'" is not a registered '+n+".");return a}constructor(){this.controllers=new ae(nl,"datasets",!0),this.elements=new ae(n2,"elements"),this.plugins=new ae(Object,"plugins"),this.scales=new ae(n7,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}};class an{notify(e,t,n,a){"beforeInit"===t&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));let r=a?this._descriptors(e).filter(a):this._descriptors(e),i=this._notify(r,e,t,n);return"afterDestroy"===t&&(this._notify(r,e,"stop"),this._notify(this._init,e,"uninstall")),i}_notify(e,t,n,a){for(let r of(a=a||{},e)){let e=r.plugin;if(!1===G(e[n],[t,a,r.options],e)&&a.cancelable)return!1}return!0}invalidate(){j(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;let t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){let n=e&&e.config,a=U(n.options&&n.options.plugins,{}),r=function(e){let t={},n=[],a=Object.keys(at.plugins.items);for(let e=0;e<a.length;e++)n.push(at.getPlugin(a[e]));let r=e.plugins||[];for(let e=0;e<r.length;e++){let a=r[e];-1===n.indexOf(a)&&(n.push(a),t[a.id]=!0)}return{plugins:n,localIds:t}}(n);return!1!==a||t?function(e,t,n,a){let{plugins:r,localIds:i}=t,s=[],o=e.getContext();for(let t of r){var l;let r=t.id,c=(l=n[r],a||!1!==l?!0===l?{}:l:null);null!==c&&s.push({plugin:t,options:function(e,t,n,a){let{plugin:r,local:i}=t,s=e.pluginScopeKeys(r),o=e.getOptionScopes(n,s);return i&&r.defaults&&o.push(r.defaults),e.createResolver(o,a,[""],{scriptable:!1,indexable:!1,allKeys:!0})}(e.config,{plugin:t,local:i[r]},c,o)})}return s}(e,r,a,t):[]}_notifyStateChanges(e){let t=this._oldCache||[],n=this._cache,a=(e,t)=>e.filter(e=>!t.some(t=>e.plugin.id===t.plugin.id));this._notify(a(t,n),e,"stop"),this._notify(a(n,t),e,"start")}constructor(){this._init=[]}}function aa(e,t){let n=e3.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||n.indexAxis||"x"}function ar(e){if("x"===e||"y"===e||"r"===e)return e}function ai(e){for(var t,n=arguments.length,a=Array(n>1?n-1:0),r=1;r<n;r++)a[r-1]=arguments[r];if(ar(e))return e;for(let n of a){let a=n.axis||("top"===(t=n.position)||"bottom"===t?"x":"left"===t||"right"===t?"y":void 0)||e.length>1&&ar(e[0].toLowerCase());if(a)return a}throw Error("Cannot determine type of '".concat(e,"' axis. Please provide 'axis' or 'position' option."))}function as(e,t,n){if(n[t+"AxisID"]===e)return{axis:t}}function ao(e){let t=e.options||(e.options={});t.plugins=U(t.plugins,{}),t.scales=function(e,t){let n=e$[e.type]||{scales:{}},a=t.scales||{},r=aa(e.type,t),i=Object.create(null);return Object.keys(a).forEach(t=>{let s=a[t];if(!z(s))return console.error("Invalid scale configuration for scale: ".concat(t));if(s._proxy)return console.warn("Ignoring resolver passed as options for scale: ".concat(t));let o=ai(t,s,function(e,t){if(t.data&&t.data.datasets){let n=t.data.datasets.filter(t=>t.xAxisID===e||t.yAxisID===e);if(n.length)return as(e,"x",n[0])||as(e,"y",n[0])}return{}}(t,e),e3.scales[s.type]),l=o===r?"_index_":"_value_",c=n.scales||{};i[t]=Q(Object.create(null),[{axis:o},s,c[o],c[l]])}),e.data.datasets.forEach(n=>{let r=n.type||e.type,s=n.indexAxis||aa(r,t),o=(e$[r]||{}).scales||{};Object.keys(o).forEach(e=>{let t,r=(t=e,"_index_"===e?t=s:"_value_"===e&&(t="x"===s?"y":"x"),t),l=n[r+"AxisID"]||r;i[l]=i[l]||Object.create(null),Q(i[l],[{axis:r},a[l],o[e]])})}),Object.keys(i).forEach(e=>{let t=i[e];Q(t,[e3.scales[t.type],e3.scale])}),i}(e,t)}function al(e){return(e=e||{}).datasets=e.datasets||[],e.labels=e.labels||[],e}let ac=new Map,au=new Set;function ah(e,t){let n=ac.get(e);return n||(n=t(),ac.set(e,n),au.add(n)),n}let ad=(e,t,n)=>{let a=ee(t,n);void 0!==a&&e.add(a)};class ap{get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=al(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){let e=this._config;this.clearCache(),ao(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return ah(e,()=>[["datasets.".concat(e),""]])}datasetAnimationScopeKeys(e,t){return ah("".concat(e,".transition.").concat(t),()=>[["datasets.".concat(e,".transitions.").concat(t),"transitions.".concat(t)],["datasets.".concat(e),""]])}datasetElementScopeKeys(e,t){return ah("".concat(e,"-").concat(t),()=>[["datasets.".concat(e,".elements.").concat(t),"datasets.".concat(e),"elements.".concat(t),""]])}pluginScopeKeys(e){let t=e.id,n=this.type;return ah("".concat(n,"-plugin-").concat(t),()=>[["plugins.".concat(t),...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){let n=this._scopeCache,a=n.get(e);return(!a||t)&&(a=new Map,n.set(e,a)),a}getOptionScopes(e,t,n){let{options:a,type:r}=this,i=this._cachedScopes(e,n),s=i.get(t);if(s)return s;let o=new Set;t.forEach(t=>{e&&(o.add(e),t.forEach(t=>ad(o,e,t))),t.forEach(e=>ad(o,a,e)),t.forEach(e=>ad(o,e$[r]||{},e)),t.forEach(e=>ad(o,e3,e)),t.forEach(e=>ad(o,e0,e))});let l=Array.from(o);return 0===l.length&&l.push(Object.create(null)),au.has(t)&&i.set(t,l),l}chartOptionScopes(){let{options:e,type:t}=this;return[e,e$[t]||{},e3.datasets[t]||{},{type:t},e3,e0]}resolveNamedOptions(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[""],r={$shared:!0},{resolver:i,subPrefixes:s}=af(this._resolverCache,e,a),o=i;if(function(e,t){let{isScriptable:n,isIndexable:a}=ty(e);for(let r of t){let t=n(r),i=a(r),s=(i||t)&&e[r];if(t&&(ea(s)||am(s))||i&&L(s))return!0}return!1}(i,t)){r.$shared=!1,n=ea(n)?n():n;let t=this.createResolver(e,n,s);o=tx(i,n,t)}for(let e of t)r[e]=o[e];return r}createResolver(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[""],a=arguments.length>3?arguments[3]:void 0,{resolver:r}=af(this._resolverCache,e,n);return z(t)?tx(r,t,void 0,a):r}constructor(e){this._config=function(e){return(e=e||{}).data=al(e.data),ao(e),e}(e),this._scopeCache=new Map,this._resolverCache=new Map}}function af(e,t,n){let a=e.get(t);a||(a=new Map,e.set(t,a));let r=n.join(),i=a.get(r);return i||(i={resolver:tg(t,n),subPrefixes:n.filter(e=>!e.toLowerCase().includes("hover"))},a.set(r,i)),i}let am=e=>z(e)&&Object.getOwnPropertyNames(e).some(t=>ea(e[t])),ag=["top","bottom","left","right","chartArea"];function ax(e,t){return"top"===e||"bottom"===e||-1===ag.indexOf(e)&&"x"===t}function ay(e,t){return function(n,a){return n[e]===a[e]?n[t]-a[t]:n[e]-a[e]}}function ab(e){let t=e.chart,n=t.options.animation;t.notifyPlugins("afterRender"),G(n&&n.onComplete,[e],t)}function av(e){let t=e.chart,n=t.options.animation;G(n&&n.onProgress,[e],t)}function aw(e){return tD()&&"string"==typeof e?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}let aN={},ak=e=>{let t=aw(e);return Object.values(aN).filter(e=>e.canvas===t).pop()};class aS{static register(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];at.add(...t),aC()}static unregister(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];at.remove(...t),aC()}get aspectRatio(){let{options:{aspectRatio:e,maintainAspectRatio:t},width:n,height:a,_aspectRatio:r}=this;return j(e)?t&&r?r:a?n/a:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return at}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():tB(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return e6(this.canvas,this.ctx),this}stop(){return t3.stop(this),this}resize(e,t){t3.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){let n=this.options,a=this.canvas,r=n.maintainAspectRatio&&this.aspectRatio,i=this.platform.getMaximumSize(a,e,t,r),s=n.devicePixelRatio||this.platform.getDevicePixelRatio(),o=this.width?"resize":"attach";this.width=i.width,this.height=i.height,this._aspectRatio=this.aspectRatio,tB(this,s,!0)&&(this.notifyPlugins("resize",{size:i}),G(n.onResize,[this,i],this),this.attached&&this._doResize(o)&&this.render())}ensureScalesHaveIDs(){H(this.options.scales||{},(e,t)=>{e.id=t})}buildOrUpdateScales(){let e=this.options,t=e.scales,n=this.scales,a=Object.keys(n).reduce((e,t)=>(e[t]=!1,e),{}),r=[];t&&(r=r.concat(Object.keys(t).map(e=>{let n=t[e],a=ai(e,n),r="r"===a,i="x"===a;return{options:n,dposition:r?"chartArea":i?"bottom":"left",dtype:r?"radialLinear":i?"category":"linear"}}))),H(r,t=>{let r=t.options,i=r.id,s=ai(i,r),o=U(r.type,t.dtype);(void 0===r.position||ax(r.position,s)!==ax(t.dposition))&&(r.position=t.dposition),a[i]=!0;let l=null;i in n&&n[i].type===o?l=n[i]:n[(l=new(at.getScale(o))({id:i,type:o,ctx:this.ctx,chart:this})).id]=l,l.init(r,e)}),H(a,(e,t)=>{e||delete n[t]}),H(n,e=>{nz.configure(this,e,e.options),nz.addBox(this,e)})}_updateMetasets(){let e=this._metasets,t=this.data.datasets.length,n=e.length;if(e.sort((e,t)=>e.index-t.index),n>t){for(let e=t;e<n;++e)this._destroyDatasetMeta(e);e.splice(t,n-t)}this._sortedMetasets=e.slice(0).sort(ay("order","index"))}_removeUnreferencedMetasets(){let{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((e,n)=>{0===t.filter(t=>t===e._dataset).length&&this._destroyDatasetMeta(n)})}buildOrUpdateControllers(){let e,t,n=[],a=this.data.datasets;for(this._removeUnreferencedMetasets(),e=0,t=a.length;e<t;e++){let t=a[e],r=this.getDatasetMeta(e),i=t.type||this.config.type;if(r.type&&r.type!==i&&(this._destroyDatasetMeta(e),r=this.getDatasetMeta(e)),r.type=i,r.indexAxis=t.indexAxis||aa(i,this.options),r.order=t.order||0,r.index=e,r.label=""+t.label,r.visible=this.isDatasetVisible(e),r.controller)r.controller.updateIndex(e),r.controller.linkScales();else{let t=at.getController(i),{datasetElementType:a,dataElementType:s}=e3.datasets[i];Object.assign(t,{dataElementType:at.getElement(s),datasetElementType:a&&at.getElement(a)}),r.controller=new t(this,e),n.push(r.controller)}}return this._updateMetasets(),n}_resetElements(){H(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){let t=this.config;t.update();let n=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),a=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0}))return;let r=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let i=0;for(let e=0,t=this.data.datasets.length;e<t;e++){let{controller:t}=this.getDatasetMeta(e),n=!a&&-1===r.indexOf(t);t.buildOrUpdateElements(n),i=Math.max(+t.getMaxOverflow(),i)}i=this._minPadding=n.layout.autoPadding?i:0,this._updateLayout(i),a||H(r,e=>{e.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(ay("z","_idx"));let{_active:s,_lastEvent:o}=this;o?this._eventHandler(o,!0):s.length&&this._updateHoverStyles(s,s,!0),this.render()}_updateScales(){H(this.scales,e=>{nz.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){let e=this.options;er(new Set(Object.keys(this._listeners)),new Set(e.events))&&!!this._responsiveListeners===e.responsive||(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){let{_hiddenIndices:e}=this;for(let{method:n,start:a,count:r}of this._getUniformDataChanges()||[]){var t="_removeElements"===n?-r:r;for(let n of Object.keys(e)){let r=+n;if(r>=a){let i=e[n];delete e[n],(t>0||r>a)&&(e[r+t]=i)}}}}_getUniformDataChanges(){let e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];let t=this.data.datasets.length,n=t=>new Set(e.filter(e=>e[0]===t).map((e,t)=>t+","+e.splice(1).join(","))),a=n(0);for(let e=1;e<t;e++)if(!er(a,n(e)))return;return Array.from(a).map(e=>e.split(",")).map(e=>({method:e[1],start:+e[2],count:+e[3]}))}_updateLayout(e){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;nz.update(this,this.width,this.height,e);let t=this.chartArea,n=t.width<=0||t.height<=0;this._layers=[],H(this.boxes,e=>{n&&"chartArea"===e.position||(e.configure&&e.configure(),this._layers.push(...e._layers()))},this),this._layers.forEach((e,t)=>{e._idx=t}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})){for(let e=0,t=this.data.datasets.length;e<t;++e)this.getDatasetMeta(e).controller.configure();for(let t=0,n=this.data.datasets.length;t<n;++t)this._updateDataset(t,ea(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){let n=this.getDatasetMeta(e),a={meta:n,index:e,mode:t,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",a)&&(n.controller._update(t),a.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",a))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(t3.has(this)?this.attached&&!t3.running(this)&&t3.start(this):(this.draw(),ab({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){let{width:e,height:t}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(e,t)}if(this.clear(),this.width<=0||this.height<=0||!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;let t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){let t,n,a=this._sortedMetasets,r=[];for(t=0,n=a.length;t<n;++t){let n=a[t];(!e||n.visible)&&r.push(n)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;let e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){let t=this.ctx,n={meta:e,index:e.index,cancelable:!0},a=t2(this,e);!1!==this.notifyPlugins("beforeDatasetDraw",n)&&(a&&te(t,a),e.controller.draw(),a&&tt(t),n.cancelable=!1,this.notifyPlugins("afterDatasetDraw",n))}isPointInArea(e){return e7(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,n,a){let r=n_.modes[t];return"function"==typeof r?r(this,e,n,a):[]}getDatasetMeta(e){let t=this.data.datasets[e],n=this._metasets,a=n.filter(e=>e&&e._dataset===t).pop();return a||(a={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},n.push(a)),a}getContext(){return this.$context||(this.$context=tm(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){let t=this.data.datasets[e];if(!t)return!1;let n=this.getDatasetMeta(e);return"boolean"==typeof n.hidden?!n.hidden:!t.hidden}setDatasetVisibility(e,t){this.getDatasetMeta(e).hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,n){let a=n?"show":"hide",r=this.getDatasetMeta(e),i=r.controller._resolveAnimations(void 0,a);en(t)?(r.data[t].hidden=!n,this.update()):(this.setDatasetVisibility(e,n),i.update(r,{visible:n}),this.update(t=>t.datasetIndex===e?a:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){let t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),t3.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");let{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),e6(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete aN[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){let e=this._listeners,t=this.platform,n=(n,a)=>{t.addEventListener(this,n,a),e[n]=a},a=(e,t,n)=>{e.offsetX=t,e.offsetY=n,this._eventHandler(e)};H(this.options.events,e=>n(e,a))}bindResponsiveEvents(){let e;this._responsiveListeners||(this._responsiveListeners={});let t=this._responsiveListeners,n=this.platform,a=(e,a)=>{n.addEventListener(this,e,a),t[e]=a},r=(e,a)=>{t[e]&&(n.removeEventListener(this,e,a),delete t[e])},i=(e,t)=>{this.canvas&&this.resize(e,t)},s=()=>{r("attach",s),this.attached=!0,this.resize(),a("resize",i),a("detach",e)};e=()=>{this.attached=!1,r("resize",i),this._stop(),this._resize(0,0),a("attach",s)},n.isAttached(this.canvas)?s():e()}unbindEvents(){H(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},H(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,n){let a,r,i,s=n?"set":"remove";for("dataset"===t&&this.getDatasetMeta(e[0].datasetIndex).controller["_"+s+"DatasetHoverStyle"](),r=0,i=e.length;r<i;++r){let t=(a=e[r])&&this.getDatasetMeta(a.datasetIndex).controller;t&&t[s+"HoverStyle"](a.element,a.datasetIndex,a.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){let t=this._active||[],n=e.map(e=>{let{datasetIndex:t,index:n}=e,a=this.getDatasetMeta(t);if(!a)throw Error("No dataset found at index "+t);return{datasetIndex:t,element:a.data[n],index:n}});q(n,t)||(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,t))}notifyPlugins(e,t,n){return this._plugins.notify(this,e,t,n)}isPluginEnabled(e){return 1===this._plugins._cache.filter(t=>t.plugin.id===e).length}_updateHoverStyles(e,t,n){let a=this.options.hover,r=(e,t)=>e.filter(e=>!t.some(t=>e.datasetIndex===t.datasetIndex&&e.index===t.index)),i=r(t,e),s=n?e:r(e,t);i.length&&this.updateHoverStyle(i,a.mode,!1),s.length&&a.mode&&this.updateHoverStyle(s,a.mode,!0)}_eventHandler(e,t){let n={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},a=t=>(t.options.events||this.options.events).includes(e.native.type);if(!1===this.notifyPlugins("beforeEvent",n,a))return;let r=this._handleEvent(e,t,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,a),(r||n.changed)&&this.render(),this}_handleEvent(e,t,n){var a;let{_active:r=[],options:i}=this,s=this._getActiveElements(e,r,n,t),o="mouseup"===e.type||"click"===e.type||"contextmenu"===e.type,l=(a=this._lastEvent,n&&"mouseout"!==e.type?o?a:e:null);n&&(this._lastEvent=null,G(i.onHover,[e,s,this],this),o&&G(i.onClick,[e,s,this],this));let c=!q(s,r);return(c||t)&&(this._active=s,this._updateHoverStyles(s,r,t)),this._lastEvent=l,c}_getActiveElements(e,t,n,a){if("mouseout"===e.type)return[];if(!n)return t;let r=this.options.hover;return this.getElementsAtEventForMode(e,r.mode,r,a)}constructor(e,t){let n=this.config=new ap(t),a=aw(e),r=ak(a);if(r)throw Error("Canvas is already in use. Chart with ID '"+r.id+"' must be destroyed before the canvas with ID '"+r.canvas.id+"' can be reused.");let i=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||(!tD()||"undefined"!=typeof OffscreenCanvas&&a instanceof OffscreenCanvas?nV:n1)),this.platform.updateConfig(n);let s=this.platform.acquireContext(a,i.aspectRatio),o=s&&s.canvas,l=o&&o.height,c=o&&o.width;if(this.id=P(),this.ctx=s,this.canvas=o,this.width=c,this.height=l,this._options=i,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new an,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=function(e,t){let n;return function(){for(var a=arguments.length,r=Array(a),i=0;i<a;i++)r[i]=arguments[i];return t?(clearTimeout(n),n=setTimeout(e,t,r)):e.apply(this,r),t}}(e=>this.update(e),i.resizeDelay||0),this._dataChanges=[],aN[this.id]=this,!s||!o)return void console.error("Failed to create chart: can't acquire context from the given item");t3.listen(this,"complete",ab),t3.listen(this,"progress",av),this._initialize(),this.attached&&this.update()}}function aC(){return H(aS.instances,e=>e._plugins.invalidate())}function aT(e,t,n,a){return{x:n+e*Math.cos(t),y:a+e*Math.sin(t)}}function aI(e,t,n,a,r,i){let{x:s,y:o,startAngle:l,pixelMargin:c,innerRadius:u}=t,h=Math.max(t.outerRadius+a+n-c,0),d=u>0?u+a+n+c:0,p=0,f=r-l;if(a){let e=h>0?h-a:0,t=((u>0?u-a:0)+e)/2;p=(f-(0!==t?f*t/(t+a):f))/2}let m=Math.max(.001,f*h-n/ei)/h,g=(f-m)/2,x=l+g+p,y=r-g-p,{outerStart:b,outerEnd:v,innerStart:w,innerEnd:N}=function(e,t,n,a){let r=tc(e.options.borderRadius,["outerStart","outerEnd","innerStart","innerEnd"]),i=(n-t)/2,s=Math.min(i,a*t/2),o=e=>{let t=(n-Math.min(i,e))*a/2;return eT(e,0,Math.min(i,t))};return{outerStart:o(r.outerStart),outerEnd:o(r.outerEnd),innerStart:eT(r.innerStart,0,s),innerEnd:eT(r.innerEnd,0,s)}}(t,d,h,y-x),k=h-b,S=h-v,C=x+b/k,T=y-v/S,I=d+w,E=d+N,_=x+w/I,A=y-N/E;if(e.beginPath(),i){let t=(C+T)/2;if(e.arc(s,o,h,C,t),e.arc(s,o,h,t,T),v>0){let t=aT(S,T,s,o);e.arc(t.x,t.y,v,T,y+eu)}let n=aT(E,y,s,o);if(e.lineTo(n.x,n.y),N>0){let t=aT(E,A,s,o);e.arc(t.x,t.y,N,y+eu,A+Math.PI)}let a=(y-N/d+(x+w/d))/2;if(e.arc(s,o,d,y-N/d,a,!0),e.arc(s,o,d,a,x+w/d,!0),w>0){let t=aT(I,_,s,o);e.arc(t.x,t.y,w,_+Math.PI,x-eu)}let r=aT(k,x,s,o);if(e.lineTo(r.x,r.y),b>0){let t=aT(k,C,s,o);e.arc(t.x,t.y,b,x-eu,C)}}else{e.moveTo(s,o);let t=Math.cos(C)*h+s,n=Math.sin(C)*h+o;e.lineTo(t,n);let a=Math.cos(T)*h+s,r=Math.sin(T)*h+o;e.lineTo(a,r)}e.closePath()}o(aS,"defaults",e3),o(aS,"instances",aN),o(aS,"overrides",e$),o(aS,"registry",at),o(aS,"version","4.5.0"),o(aS,"getChart",ak);class aE extends n2{inRange(e,t,n){let{angle:a,distance:r}=ew(this.getProps(["x","y"],n),{x:e,y:t}),{startAngle:i,endAngle:s,innerRadius:o,outerRadius:l,circumference:c}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],n),u=(this.options.spacing+this.options.borderWidth)/2,h=U(c,s-i),d=eC(a,i,s)&&i!==s,p=h>=es||d,f=eI(r,o+u,l+u);return p&&f}getCenterPoint(e){let{x:t,y:n,startAngle:a,endAngle:r,innerRadius:i,outerRadius:s}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:o,spacing:l}=this.options,c=(a+r)/2,u=(i+s+l+o)/2;return{x:t+Math.cos(c)*u,y:n+Math.sin(c)*u}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){let{options:t,circumference:n}=this,a=(t.offset||0)/4,r=(t.spacing||0)/2,i=t.circular;if(this.pixelMargin=.33*("inner"===t.borderAlign),this.fullCircles=n>es?Math.floor(n/es):0,0===n||this.innerRadius<0||this.outerRadius<0)return;e.save();let s=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(s)*a,Math.sin(s)*a);let o=a*(1-Math.sin(Math.min(ei,n||0)));e.fillStyle=t.backgroundColor,e.strokeStyle=t.borderColor,function(e,t,n,a,r){let{fullCircles:i,startAngle:s,circumference:o}=t,l=t.endAngle;if(i){aI(e,t,n,a,l,r);for(let t=0;t<i;++t)e.fill();isNaN(o)||(l=s+(o%es||es))}aI(e,t,n,a,l,r),e.fill()}(e,this,o,r,i),function(e,t,n,a,r){let{fullCircles:i,startAngle:s,circumference:o,options:l}=t,{borderWidth:c,borderJoinStyle:u,borderDash:h,borderDashOffset:d,borderRadius:p}=l,f="inner"===l.borderAlign;if(!c)return;e.setLineDash(h||[]),e.lineDashOffset=d,f?(e.lineWidth=2*c,e.lineJoin=u||"round"):(e.lineWidth=c,e.lineJoin=u||"bevel");let m=t.endAngle;if(i){aI(e,t,n,a,m,r);for(let t=0;t<i;++t)e.stroke();isNaN(o)||(m=s+(o%es||es))}f&&function(e,t,n){let{startAngle:a,pixelMargin:r,x:i,y:s,outerRadius:o,innerRadius:l}=t,c=r/o;e.beginPath(),e.arc(i,s,o,a-c,n+c),l>r?(c=r/l,e.arc(i,s,l,n+c,a-c,!0)):e.arc(i,s,r,n+eu,a-eu),e.closePath(),e.clip()}(e,t,m),l.selfJoin&&m-s>=ei&&0===p&&"miter"!==u&&function(e,t,n){let{startAngle:a,x:r,y:i,outerRadius:s,innerRadius:o,options:l}=t,{borderWidth:c,borderJoinStyle:u}=l,h=Math.min(c/s,eS(a-n));if(e.beginPath(),e.arc(r,i,s-c/2,a+h/2,n-h/2),o>0){let t=Math.min(c/o,eS(a-n));e.arc(r,i,o+c/2,n-t/2,a+t/2,!0)}else{let t=Math.min(c/2,s*eS(a-n));if("round"===u)e.arc(r,i,t,n-ei/2,a+ei/2,!0);else if("bevel"===u){let s=2*t*t,o=-s*Math.cos(n+ei/2)+r,l=-s*Math.sin(n+ei/2)+i,c=s*Math.cos(a+ei/2)+r,u=s*Math.sin(a+ei/2)+i;e.lineTo(o,l),e.lineTo(c,u)}}e.closePath(),e.moveTo(0,0),e.rect(0,0,e.canvas.width,e.canvas.height),e.clip("evenodd")}(e,t,m),i||(aI(e,t,n,a,m,r),e.stroke())}(e,this,o,r,i),e.restore()}constructor(e){super(),o(this,"circumference",void 0),o(this,"endAngle",void 0),o(this,"fullCircles",void 0),o(this,"innerRadius",void 0),o(this,"outerRadius",void 0),o(this,"pixelMargin",void 0),o(this,"startAngle",void 0),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}}function a_(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;e.lineCap=U(n.borderCapStyle,t.borderCapStyle),e.setLineDash(U(n.borderDash,t.borderDash)),e.lineDashOffset=U(n.borderDashOffset,t.borderDashOffset),e.lineJoin=U(n.borderJoinStyle,t.borderJoinStyle),e.lineWidth=U(n.borderWidth,t.borderWidth),e.strokeStyle=U(n.borderColor,t.borderColor)}function aA(e,t,n){e.lineTo(n.x,n.y)}function aR(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=e.length,{start:r=0,end:i=a-1}=n,{start:s,end:o}=t,l=Math.max(r,s),c=Math.min(i,o);return{count:a,start:l,loop:t.loop,ilen:c<l&&!(r<s&&i<s||r>o&&i>o)?a+c-l:c-l}}function aD(e,t,n,a){let r,i,s,{points:o,options:l}=t,{count:c,start:u,loop:h,ilen:d}=aR(o,n,a),p=l.stepped?tn:l.tension||"monotone"===l.cubicInterpolationMode?ta:aA,{move:f=!0,reverse:m}=a||{};for(r=0;r<=d;++r)(i=o[(u+(m?d-r:r))%c]).skip||(f?(e.moveTo(i.x,i.y),f=!1):p(e,s,i,m,l.stepped),s=i);return h&&p(e,s,i=o[(u+(m?d:0))%c],m,l.stepped),!!h}function aM(e,t,n,a){let r,i,s,o,l,c,u=t.points,{count:h,start:d,ilen:p}=aR(u,n,a),{move:f=!0,reverse:m}=a||{},g=0,x=0,y=e=>(d+(m?p-e:e))%h,b=()=>{o!==l&&(e.lineTo(g,l),e.lineTo(g,o),e.lineTo(g,c))};for(f&&(i=u[y(0)],e.moveTo(i.x,i.y)),r=0;r<=p;++r){if((i=u[y(r)]).skip)continue;let t=i.x,n=i.y,a=0|t;a===s?(n<o?o=n:n>l&&(l=n),g=(x*g+t)/++x):(b(),e.lineTo(t,n),s=a,x=0,o=l=n),c=n}b()}function aF(e){let t=e.options,n=t.borderDash&&t.borderDash.length;return e._decimated||e._loop||t.tension||"monotone"===t.cubicInterpolationMode||t.stepped||n?aD:aM}o(aE,"id","arc"),o(aE,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),o(aE,"defaultRoutes",{backgroundColor:"backgroundColor"}),o(aE,"descriptors",{_scriptable:!0,_indexable:e=>"borderDash"!==e});let aO="function"==typeof Path2D;class aP extends n2{updateControlPoints(e,t){let n=this.options;if((n.tension||"monotone"===n.cubicInterpolationMode)&&!n.stepped&&!this._pointsUpdated){let a=n.spanGaps?this._loop:this._fullLoop;!function(e,t,n,a,r){let i,s,o,l;if(t.spanGaps&&(e=e.filter(e=>!e.skip)),"monotone"===t.cubicInterpolationMode)!function(e){let t,n,a,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"x",i=tA(r),s=e.length,o=Array(s).fill(0),l=Array(s),c=t_(e,0);for(t=0;t<s;++t)if(n=a,a=c,c=t_(e,t+1),a){if(c){let e=c[r]-a[r];o[t]=0!==e?(c[i]-a[i])/e:0}l[t]=n?c?ef(o[t-1])!==ef(o[t])?0:(o[t-1]+o[t])/2:o[t-1]:o[t]}!function(e,t,n){let a,r,i,s,o,l=e.length,c=t_(e,0);for(let u=0;u<l-1;++u)if(o=c,c=t_(e,u+1),o&&c){if(em(t[u],0,tE)){n[u]=n[u+1]=0;continue}(s=Math.pow(a=n[u]/t[u],2)+Math.pow(r=n[u+1]/t[u],2))<=9||(i=3/Math.sqrt(s),n[u]=a*i*t[u],n[u+1]=r*i*t[u])}}(e,o,l),function(e,t){let n,a,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"x",s=tA(i),o=e.length,l=t_(e,0);for(let c=0;c<o;++c){if(a=r,r=l,l=t_(e,c+1),!r)continue;let o=r[i],u=r[s];a&&(n=(o-a[i])/3,r["cp1".concat(i)]=o-n,r["cp1".concat(s)]=u-n*t[c]),l&&(n=(l[i]-o)/3,r["cp2".concat(i)]=o+n,r["cp2".concat(s)]=u+n*t[c])}}(e,l,r)}(e,r);else{let n=a?e[e.length-1]:e[0];for(i=0,s=e.length;i<s;++i)l=function(e,t,n,a){let r=e.skip?t:e,i=n.skip?t:n,s=eN(t,r),o=eN(i,t),l=s/(s+o),c=o/(s+o);l=isNaN(l)?0:l,c=isNaN(c)?0:c;let u=a*l,h=a*c;return{previous:{x:t.x-u*(i.x-r.x),y:t.y-u*(i.y-r.y)},next:{x:t.x+h*(i.x-r.x),y:t.y+h*(i.y-r.y)}}}(n,o=e[i],e[Math.min(i+1,s-!a)%s],t.tension),o.cp1x=l.previous.x,o.cp1y=l.previous.y,o.cp2x=l.next.x,o.cp2y=l.next.y,n=o}t.capBezierPoints&&function(e,t){let n,a,r,i,s,o=e7(e[0],t);for(n=0,a=e.length;n<a;++n)s=i,i=o,o=n<a-1&&e7(e[n+1],t),i&&(r=e[n],s&&(r.cp1x=tR(r.cp1x,t.left,t.right),r.cp1y=tR(r.cp1y,t.top,t.bottom)),o&&(r.cp2x=tR(r.cp2x,t.left,t.right),r.cp2y=tR(r.cp2y,t.top,t.bottom)))}(e,n)}(this._points,n,e,a,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=function(e,t){let n=e.points,a=e.options.spanGaps,r=n.length;if(!r)return[];let i=!!e._loop,{start:s,end:o}=function(e,t,n,a){let r=0,i=t-1;if(n&&!a)for(;r<t&&!e[r].skip;)r++;for(;r<t&&e[r].skip;)r++;for(r%=t,n&&(i+=r);i>r&&e[i%t].skip;)i--;return{start:r,end:i%=t}}(n,r,i,a);if(!0===a)return t$(e,[{start:s,end:o,loop:i}],n,t);let l=o<s?o+r:o,c=!!e._fullLoop&&0===s&&o===r-1;return t$(e,function(e,t,n,a){let r,i=e.length,s=[],o=t,l=e[t];for(r=t+1;r<=n;++r){let n=e[r%i];n.skip||n.stop?l.skip||(a=!1,s.push({start:t%i,end:(r-1)%i,loop:a}),t=o=n.stop?r:null):(o=r,l.skip&&(t=r)),l=n}return null!==o&&s.push({start:t%i,end:o%i,loop:a}),s}(n,s,l,c),n,t)}(this,this.options.segment))}first(){let e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){let e=this.segments,t=this.points,n=e.length;return n&&t[e[n-1].end]}interpolate(e,t){let n,a,r=this.options,i=e[t],s=this.points,o=tJ(this,{property:t,start:i,end:i});if(!o.length)return;let l=[],c=r.stepped?tG:r.tension||"monotone"===r.cubicInterpolationMode?tH:tW;for(n=0,a=o.length;n<a;++n){let{start:a,end:u}=o[n],h=s[a],d=s[u];if(h===d){l.push(h);continue}let p=Math.abs((i-h[t])/(d[t]-h[t])),f=c(h,d,p,r.stepped);f[t]=e[t],l.push(f)}return 1===l.length?l[0]:l}pathSegment(e,t,n){return aF(this)(e,this,t,n)}path(e,t,n){let a=this.segments,r=aF(this),i=this._loop;for(let s of(t=t||0,n=n||this.points.length-t,a))i&=r(e,this,s,{start:t,end:t+n-1});return!!i}draw(e,t,n,a){let r=this.options||{};(this.points||[]).length&&r.borderWidth&&(e.save(),function(e,t,n,a){if(aO&&!t.options.segment){let r;(r=t._path)||(r=t._path=new Path2D,t.path(r,n,a)&&r.closePath()),a_(e,t.options),e.stroke(r)}else{let{segments:r,options:i}=t,s=aF(t);for(let o of r)a_(e,i,o.style),e.beginPath(),s(e,t,o,{start:n,end:n+a-1})&&e.closePath(),e.stroke()}}(e,this,n,a),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}}function aj(e,t,n,a){let r=e.options,{[n]:i}=e.getProps([n],a);return Math.abs(t-i)<r.radius+r.hitRadius}o(aP,"id","line"),o(aP,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),o(aP,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),o(aP,"descriptors",{_scriptable:!0,_indexable:e=>"borderDash"!==e&&"fill"!==e});class aL extends n2{inRange(e,t,n){let a=this.options,{x:r,y:i}=this.getProps(["x","y"],n);return Math.pow(e-r,2)+Math.pow(t-i,2)<Math.pow(a.hitRadius+a.radius,2)}inXRange(e,t){return aj(this,e,"x",t)}inYRange(e,t){return aj(this,e,"y",t)}getCenterPoint(e){let{x:t,y:n}=this.getProps(["x","y"],e);return{x:t,y:n}}size(e){let t=(e=e||this.options||{}).radius||0,n=(t=Math.max(t,t&&e.hoverRadius||0))&&e.borderWidth||0;return(t+n)*2}draw(e,t){let n=this.options;!this.skip&&!(n.radius<.1)&&e7(this,t,this.size(n)/2)&&(e.strokeStyle=n.borderColor,e.lineWidth=n.borderWidth,e.fillStyle=n.backgroundColor,e8(e,n,this.x,this.y))}getRange(){let e=this.options||{};return e.radius+e.hitRadius}constructor(e){super(),o(this,"parsed",void 0),o(this,"skip",void 0),o(this,"stop",void 0),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}}function az(e,t){let n,a,r,i,s,{x:o,y:l,base:c,width:u,height:h}=e.getProps(["x","y","base","width","height"],t);return e.horizontal?(s=h/2,n=Math.min(o,c),a=Math.max(o,c),r=l-s,i=l+s):(n=o-(s=u/2),a=o+s,r=Math.min(l,c),i=Math.max(l,c)),{left:n,top:r,right:a,bottom:i}}function aB(e,t,n,a){return e?0:eT(t,n,a)}function aV(e,t,n,a){let r=null===t,i=null===n,s=e&&!(r&&i)&&az(e,a);return s&&(r||eI(t,s.left,s.right))&&(i||eI(n,s.top,s.bottom))}function aU(e,t){e.rect(t.x,t.y,t.w,t.h)}function aW(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=e.x!==n.x?-t:0,r=e.y!==n.y?-t:0,i=(e.x+e.w!==n.x+n.w?t:0)-a,s=(e.y+e.h!==n.y+n.h?t:0)-r;return{x:e.x+a,y:e.y+r,w:e.w+i,h:e.h+s,radius:e.radius}}o(aL,"id","point"),o(aL,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),o(aL,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});class aG extends n2{draw(e){var t;let{inflateAmount:n,options:{borderColor:a,backgroundColor:r}}=this,{inner:i,outer:s}=function(e){let t=az(e),n=t.right-t.left,a=t.bottom-t.top,r=function(e,t,n){let a=e.options.borderWidth,r=e.borderSkipped,i=tu(a);return{t:aB(r.top,i.top,0,n),r:aB(r.right,i.right,0,t),b:aB(r.bottom,i.bottom,0,n),l:aB(r.left,i.left,0,t)}}(e,n/2,a/2),i=function(e,t,n){let{enableBorderRadius:a}=e.getProps(["enableBorderRadius"]),r=e.options.borderRadius,i=th(r),s=Math.min(t,n),o=e.borderSkipped,l=a||z(r);return{topLeft:aB(!l||o.top||o.left,i.topLeft,0,s),topRight:aB(!l||o.top||o.right,i.topRight,0,s),bottomLeft:aB(!l||o.bottom||o.left,i.bottomLeft,0,s),bottomRight:aB(!l||o.bottom||o.right,i.bottomRight,0,s)}}(e,n/2,a/2);return{outer:{x:t.left,y:t.top,w:n,h:a,radius:i},inner:{x:t.left+r.l,y:t.top+r.t,w:n-r.l-r.r,h:a-r.t-r.b,radius:{topLeft:Math.max(0,i.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,i.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,i.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,i.bottomRight-Math.max(r.b,r.r))}}}}(this),o=(t=s.radius).topLeft||t.topRight||t.bottomLeft||t.bottomRight?ti:aU;e.save(),(s.w!==i.w||s.h!==i.h)&&(e.beginPath(),o(e,aW(s,n,i)),e.clip(),o(e,aW(i,-n,s)),e.fillStyle=a,e.fill("evenodd")),e.beginPath(),o(e,aW(i,n)),e.fillStyle=r,e.fill(),e.restore()}inRange(e,t,n){return aV(this,e,t,n)}inXRange(e,t){return aV(this,e,null,t)}inYRange(e,t){return aV(this,null,e,t)}getCenterPoint(e){let{x:t,y:n,base:a,horizontal:r}=this.getProps(["x","y","base","horizontal"],e);return{x:r?(t+a)/2:t,y:r?n:(n+a)/2}}getRange(e){return"x"===e?this.width/2:this.height/2}constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}}o(aG,"id","bar"),o(aG,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),o(aG,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});let aH=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],aq=aH.map(e=>e.replace("rgb(","rgba(").replace(")",", 0.5)"));function aK(e,t,n,a){if(a)return;let r=t[e],i=n[e];return"angle"===e&&(r=eS(r),i=eS(i)),{property:e,start:r,end:i}}function aX(e,t,n){for(;t>e;t--){let e=n[t];if(!isNaN(e.x)&&!isNaN(e.y))break}return t}function aY(e,t,n,a){return e&&t?a(e[n],t[n]):e?e[n]:t?t[n]:0}function aZ(e,t){let n=[],a=!1;return L(e)?(a=!0,n=e):n=function(e,t){let{x:n=null,y:a=null}=e||{},r=t.points,i=[];return t.segments.forEach(e=>{let{start:t,end:s}=e;s=aX(t,s,r);let o=r[t],l=r[s];null!==a?(i.push({x:o.x,y:a}),i.push({x:l.x,y:a})):null!==n&&(i.push({x:n,y:o.y}),i.push({x:n,y:l.y}))}),i}(e,t),n.length?new aP({points:n,options:{tension:0},_loop:a,_fullLoop:a}):null}function aQ(e){return e&&!1!==e.fill}class aJ{pathSegment(e,t,n){let{x:a,y:r,radius:i}=this;return t=t||{start:0,end:es},e.arc(a,r,i,t.end,t.start,!0),!n.bounds}interpolate(e){let{x:t,y:n,radius:a}=this,r=e.angle;return{x:t+Math.cos(r)*a,y:n+Math.sin(r)*a,angle:r}}constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}}function a$(e,t,n){let a=function(e){let{chart:t,fill:n,line:a}=e;if(B(n)){var r,i=t,s=n;let e=i.getDatasetMeta(s);return e&&i.isDatasetVisible(s)?e.dataset:null}if("stack"===n)return function(e){let{scale:t,index:n,line:a}=e,r=[],i=a.segments,s=a.points,o=function(e,t){let n=[],a=e.getMatchingVisibleMetas("line");for(let e=0;e<a.length;e++){let r=a[e];if(r.index===t)break;r.hidden||n.unshift(r.dataset)}return n}(t,n);o.push(aZ({x:null,y:t.bottom},a));for(let e=0;e<i.length;e++){let t=i[e];for(let e=t.start;e<=t.end;e++)!function(e,t,n){let a=[];for(let r=0;r<n.length;r++){let{first:i,last:s,point:o}=function(e,t,n){let a=e.interpolate(t,"x");if(!a)return{};let r=a[n],i=e.segments,s=e.points,o=!1,l=!1;for(let e=0;e<i.length;e++){let t=i[e],a=s[t.start][n],c=s[t.end][n];if(eI(r,a,c)){o=r===a,l=r===c;break}}return{first:o,last:l,point:a}}(n[r],t,"x");if(o&&(!i||!s)){if(i)a.unshift(o);else if(e.push(o),!s)break}}e.push(...a)}(r,s[e],o)}return new aP({points:r,options:{}})}(e);if("shape"===n)return!0;let o=((r=e).scale||{}).getPointPositionForValue?function(e){let{scale:t,fill:n}=e,a=t.options,r=t.getLabels().length,i=a.reverse?t.max:t.min,s="start"===n?i:"end"===n?t.options.reverse?t.min:t.max:z(n)?n.value:t.getBaseValue(),o=[];if(a.grid.circular){let e=t.getPointPositionForValue(0,i);return new aJ({x:e.x,y:e.y,radius:t.getDistanceFromCenterForValue(s)})}for(let e=0;e<r;++e)o.push(t.getPointPositionForValue(e,s));return o}(r):function(e){let t,{scale:n={},fill:a}=e,r=(t=null,"start"===a?t=n.bottom:"end"===a?t=n.top:z(a)?t=n.getPixelForValue(a.value):n.getBasePixel&&(t=n.getBasePixel()),t);if(B(r)){let e=n.isHorizontal();return{x:e?r:null,y:e?null:r}}return null}(r);return o instanceof aJ?o:aZ(o,a)}(t),{chart:r,index:i,line:s,scale:o,axis:l}=t,c=s.options,u=c.fill,h=c.backgroundColor,{above:d=h,below:p=h}=u||{},f=r.getDatasetMeta(i),m=t2(r,f);a&&s.points.length&&(te(e,n),function(e,t){let{line:n,target:a,above:r,below:i,area:s,scale:o,clip:l}=t,c=n._loop?"angle":t.axis;e.save();let u=i;i!==r&&("x"===c?(a0(e,a,s.top),a2(e,{line:n,target:a,color:r,scale:o,property:c,clip:l}),e.restore(),e.save(),a0(e,a,s.bottom)):"y"===c&&(a1(e,a,s.left),a2(e,{line:n,target:a,color:i,scale:o,property:c,clip:l}),e.restore(),e.save(),a1(e,a,s.right),u=r)),a2(e,{line:n,target:a,color:u,scale:o,property:c,clip:l}),e.restore()}(e,{line:s,target:a,above:d,below:p,area:n,scale:o,axis:l,clip:m}),tt(e))}function a0(e,t,n){let{segments:a,points:r}=t,i=!0,s=!1;for(let o of(e.beginPath(),a)){let{start:a,end:l}=o,c=r[a],u=r[aX(a,l,r)];i?(e.moveTo(c.x,c.y),i=!1):(e.lineTo(c.x,n),e.lineTo(c.x,c.y)),(s=!!t.pathSegment(e,o,{move:s}))?e.closePath():e.lineTo(u.x,n)}e.lineTo(t.first().x,n),e.closePath(),e.clip()}function a1(e,t,n){let{segments:a,points:r}=t,i=!0,s=!1;for(let o of(e.beginPath(),a)){let{start:a,end:l}=o,c=r[a],u=r[aX(a,l,r)];i?(e.moveTo(c.x,c.y),i=!1):(e.lineTo(n,c.y),e.lineTo(c.x,c.y)),(s=!!t.pathSegment(e,o,{move:s}))?e.closePath():e.lineTo(n,u.y)}e.lineTo(n,t.first().y),e.closePath(),e.clip()}function a2(e,t){let{line:n,target:a,property:r,color:i,scale:s,clip:o}=t;for(let{source:t,target:l,start:c,end:u}of function(e,t,n){let a=e.segments,r=e.points,i=t.points,s=[];for(let e of a){let{start:a,end:o}=e;o=aX(a,o,r);let l=aK(n,r[a],r[o],e.loop);if(!t.segments){s.push({source:e,target:l,start:r[a],end:r[o]});continue}for(let a of tJ(t,l)){let t=aK(n,i[a.start],i[a.end],a.loop);for(let i of tQ(e,r,t))s.push({source:i,target:a,start:{[n]:aY(l,t,"start",Math.max)},end:{[n]:aY(l,t,"end",Math.min)}})}}return s}(n,a,r)){let h,{style:{backgroundColor:d=i}={}}=t,p=!0!==a;e.save(),e.fillStyle=d,function(e,t,n,a){let r=t.chart.chartArea,{property:i,start:s,end:o}=a||{};if("x"===i||"y"===i){let t,a,l,c;"x"===i?(t=s,a=r.top,l=o,c=r.bottom):(t=r.left,a=s,l=r.right,c=o),e.beginPath(),n&&(t=Math.max(t,n.left),l=Math.min(l,n.right),a=Math.max(a,n.top),c=Math.min(c,n.bottom)),e.rect(t,a,l-t,c-a),e.clip()}}(e,s,o,p&&aK(r,c,u)),e.beginPath();let f=!!n.pathSegment(e,t);if(p){f?e.closePath():a3(e,a,u,r);let t=!!a.pathSegment(e,l,{move:f,reverse:!0});(h=f&&t)||a3(e,a,c,r)}e.closePath(),e.fill(h?"evenodd":"nonzero"),e.restore()}}function a3(e,t,n,a){let r=t.interpolate(n,a);r&&e.lineTo(r.x,r.y)}let a4=(e,t)=>{let{boxHeight:n=t,boxWidth:a=t}=e;return e.usePointStyle&&(n=Math.min(n,t),a=e.pointStyleWidth||Math.min(a,t)),{boxWidth:a,boxHeight:n,itemHeight:Math.max(t,n)}};class a5 extends n2{update(e,t,n){this.maxWidth=e,this.maxHeight=t,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){let e=this.options.labels||{},t=G(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(t=>e.filter(t,this.chart.data))),e.sort&&(t=t.sort((t,n)=>e.sort(t,n,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){let e,t,{options:n,ctx:a}=this;if(!n.display){this.width=this.height=0;return}let r=n.labels,i=tp(r.font),s=i.size,o=this._computeTitleHeight(),{boxWidth:l,itemHeight:c}=a4(r,s);a.font=i.string,this.isHorizontal()?(e=this.maxWidth,t=this._fitRows(o,s,l,c)+10):(t=this.maxHeight,e=this._fitCols(o,i,l,c)+10),this.width=Math.min(e,n.maxWidth||this.maxWidth),this.height=Math.min(t,n.maxHeight||this.maxHeight)}_fitRows(e,t,n,a){let{ctx:r,maxWidth:i,options:{labels:{padding:s}}}=this,o=this.legendHitBoxes=[],l=this.lineWidths=[0],c=a+s,u=e;r.textAlign="left",r.textBaseline="middle";let h=-1,d=-c;return this.legendItems.forEach((e,p)=>{let f=n+t/2+r.measureText(e.text).width;(0===p||l[l.length-1]+f+2*s>i)&&(u+=c,l[l.length-(p>0?0:1)]=0,d+=c,h++),o[p]={left:0,top:d,row:h,width:f,height:a},l[l.length-1]+=f+s}),u}_fitCols(e,t,n,a){let{ctx:r,maxHeight:i,options:{labels:{padding:s}}}=this,o=this.legendHitBoxes=[],l=this.columnSizes=[],c=i-e,u=s,h=0,d=0,p=0,f=0;return this.legendItems.forEach((e,i)=>{var m,g,x,y,b,v,w,N,k,S,C,T;let I,E,{itemWidth:_,itemHeight:A}=(m=n,g=t,x=r,y=e,b=a,{itemWidth:(v=y,w=m,N=g,k=x,(I=v.text)&&"string"!=typeof I&&(I=I.reduce((e,t)=>e.length>t.length?e:t)),w+N.size/2+k.measureText(I).width),itemHeight:(S=b,C=y,T=g.lineHeight,E=S,"string"!=typeof C.text&&(E=a6(C,T)),E)});i>0&&d+A+2*s>c&&(u+=h+s,l.push({width:h,height:d}),p+=h+s,f++,h=d=0),o[i]={left:p,top:d,col:f,width:_,height:A},h=Math.max(h,_),d+=A+s}),u+=h,l.push({width:h,height:d}),u}adjustHitBoxes(){if(!this.options.display)return;let e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:n,labels:{padding:a},rtl:r}}=this,i=tq(r,this.left,this.width);if(this.isHorizontal()){let r=0,s=ej(n,this.left+a,this.right-this.lineWidths[r]);for(let o of t)r!==o.row&&(r=o.row,s=ej(n,this.left+a,this.right-this.lineWidths[r])),o.top+=this.top+e+a,o.left=i.leftForLtr(i.x(s),o.width),s+=o.width+a}else{let r=0,s=ej(n,this.top+e+a,this.bottom-this.columnSizes[r].height);for(let o of t)o.col!==r&&(r=o.col,s=ej(n,this.top+e+a,this.bottom-this.columnSizes[r].height)),o.top=s,o.left+=this.left+a,o.left=i.leftForLtr(i.x(o.left),o.width),s+=o.height+a}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){let e=this.ctx;te(e,this),this._draw(),tt(e)}}_draw(){let e,{options:t,columnSizes:n,lineWidths:a,ctx:r}=this,{align:i,labels:s}=t,o=e3.color,l=tq(t.rtl,this.left,this.width),c=tp(s.font),{padding:u}=s,h=c.size,d=h/2;this.drawTitle(),r.textAlign=l.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=c.string;let{boxWidth:p,boxHeight:f,itemHeight:m}=a4(s,h),g=function(e,t,n){if(isNaN(p)||p<=0||isNaN(f)||f<0)return;r.save();let a=U(n.lineWidth,1);if(r.fillStyle=U(n.fillStyle,o),r.lineCap=U(n.lineCap,"butt"),r.lineDashOffset=U(n.lineDashOffset,0),r.lineJoin=U(n.lineJoin,"miter"),r.lineWidth=a,r.strokeStyle=U(n.strokeStyle,o),r.setLineDash(U(n.lineDash,[])),s.usePointStyle){let i={radius:f*Math.SQRT2/2,pointStyle:n.pointStyle,rotation:n.rotation,borderWidth:a};e9(r,i,l.xPlus(e,p/2),t+d,s.pointStyleWidth&&p)}else{let i=t+Math.max((h-f)/2,0),s=l.leftForLtr(e,p),o=th(n.borderRadius);r.beginPath(),Object.values(o).some(e=>0!==e)?ti(r,{x:s,y:i,w:p,h:f,radius:o}):r.rect(s,i,p,f),r.fill(),0!==a&&r.stroke()}r.restore()},x=function(e,t,n){tr(r,n.text,e,t+m/2,c,{strikethrough:n.hidden,textAlign:l.textAlign(n.textAlign)})},y=this.isHorizontal(),b=this._computeTitleHeight();e=y?{x:ej(i,this.left+u,this.right-a[0]),y:this.top+u+b,line:0}:{x:this.left+u,y:ej(i,this.top+b+u,this.bottom-n[0].height),line:0},tK(this.ctx,t.textDirection);let v=m+u;this.legendItems.forEach((o,h)=>{var f,m;r.strokeStyle=o.fontColor,r.fillStyle=o.fontColor;let w=r.measureText(o.text).width,N=l.textAlign(o.textAlign||(o.textAlign=s.textAlign)),k=p+d+w,S=e.x,C=e.y;if(l.setWidth(this.width),y?h>0&&S+k+u>this.right&&(C=e.y+=v,e.line++,S=e.x=ej(i,this.left+u,this.right-a[e.line])):h>0&&C+v>this.bottom&&(S=e.x=S+n[e.line].width+u,e.line++,C=e.y=ej(i,this.top+b+u,this.bottom-n[e.line].height)),g(l.x(S),C,o),f=S+p+d,m=y?S+k:this.right,S=N===(t.rtl?"left":"right")?m:"center"===N?(f+m)/2:f,x(l.x(S),C,o),y)e.x+=k+u;else if("string"!=typeof o.text){let t=c.lineHeight;e.y+=a6(o,t)+u}else e.y+=v}),tX(this.ctx,t.textDirection)}drawTitle(){let e,t=this.options,n=t.title,a=tp(n.font),r=td(n.padding);if(!n.display)return;let i=tq(t.rtl,this.left,this.width),s=this.ctx,o=n.position,l=a.size/2,c=r.top+l,u=this.left,h=this.width;if(this.isHorizontal())h=Math.max(...this.lineWidths),e=this.top+c,u=ej(t.align,u,this.right-h);else{let n=this.columnSizes.reduce((e,t)=>Math.max(e,t.height),0);e=c+ej(t.align,this.top,this.bottom-n-t.labels.padding-this._computeTitleHeight())}let d=ej(o,u,u+h);s.textAlign=i.textAlign(eP(o)),s.textBaseline="middle",s.strokeStyle=n.color,s.fillStyle=n.color,s.font=a.string,tr(s,n.text,d,e,a)}_computeTitleHeight(){let e=this.options.title,t=tp(e.font),n=td(e.padding);return e.display?t.lineHeight+n.height:0}_getLegendItemAt(e,t){let n,a,r;if(eI(e,this.left,this.right)&&eI(t,this.top,this.bottom)){for(n=0,r=this.legendHitBoxes;n<r.length;++n)if(eI(e,(a=r[n]).left,a.left+a.width)&&eI(t,a.top,a.top+a.height))return this.legendItems[n]}return null}handleEvent(e){var t,n;let a=this.options;if(t=e.type,n=a,("mousemove"!==t&&"mouseout"!==t||!n.onHover&&!n.onLeave)&&(!n.onClick||"click"!==t&&"mouseup"!==t))return;let r=this._getLegendItemAt(e.x,e.y);if("mousemove"===e.type||"mouseout"===e.type){let t=this._hoveredItem,n=null!==t&&null!==r&&t.datasetIndex===r.datasetIndex&&t.index===r.index;t&&!n&&G(a.onLeave,[e,t,this],this),this._hoveredItem=r,r&&!n&&G(a.onHover,[e,r,this],this)}else r&&G(a.onClick,[e,r,this],this)}constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}}function a6(e,t){return t*(e.text?e.text.length:0)}class a8 extends n2{update(e,t){let n=this.options;if(this.left=0,this.top=0,!n.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=t;let a=L(n.text)?n.text.length:1;this._padding=td(n.padding);let r=a*tp(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=r:this.width=r}isHorizontal(){let e=this.options.position;return"top"===e||"bottom"===e}_drawArgs(e){let t,n,a,{top:r,left:i,bottom:s,right:o,options:l}=this,c=l.align,u=0;return this.isHorizontal()?(n=ej(c,i,o),a=r+e,t=o-i):("left"===l.position?(n=i+e,a=ej(c,s,r),u=-.5*ei):(n=o-e,a=ej(c,r,s),u=.5*ei),t=s-r),{titleX:n,titleY:a,maxWidth:t,rotation:u}}draw(){let e=this.ctx,t=this.options;if(!t.display)return;let n=tp(t.font),a=n.lineHeight/2+this._padding.top,{titleX:r,titleY:i,maxWidth:s,rotation:o}=this._drawArgs(a);tr(e,t.text,0,0,n,{color:t.color,maxWidth:s,rotation:o,textAlign:eP(t.align),textBaseline:"middle",translation:[r,i]})}constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}}new WeakMap;let a9={average(e){let t,n;if(!e.length)return!1;let a=new Set,r=0,i=0;for(t=0,n=e.length;t<n;++t){let n=e[t].element;if(n&&n.hasValue()){let e=n.tooltipPosition();a.add(e.x),r+=e.y,++i}}return 0!==i&&0!==a.size&&{x:[...a].reduce((e,t)=>e+t)/a.size,y:r/i}},nearest(e,t){let n,a,r;if(!e.length)return!1;let i=t.x,s=t.y,o=1/0;for(n=0,a=e.length;n<a;++n){let a=e[n].element;if(a&&a.hasValue()){let e=eN(t,a.getCenterPoint());e<o&&(o=e,r=a)}}if(r){let e=r.tooltipPosition();i=e.x,s=e.y}return{x:i,y:s}}};function a7(e,t){return t&&(L(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function re(e){return("string"==typeof e||e instanceof String)&&e.indexOf("\n")>-1?e.split("\n"):e}function rt(e,t){let n=e.chart.ctx,{body:a,footer:r,title:i}=e,{boxWidth:s,boxHeight:o}=t,l=tp(t.bodyFont),c=tp(t.titleFont),u=tp(t.footerFont),h=i.length,d=r.length,p=a.length,f=td(t.padding),m=f.height,g=0,x=a.reduce((e,t)=>e+t.before.length+t.lines.length+t.after.length,0);x+=e.beforeBody.length+e.afterBody.length,h&&(m+=h*c.lineHeight+(h-1)*t.titleSpacing+t.titleMarginBottom),x&&(m+=p*(t.displayColors?Math.max(o,l.lineHeight):l.lineHeight)+(x-p)*l.lineHeight+(x-1)*t.bodySpacing),d&&(m+=t.footerMarginTop+d*u.lineHeight+(d-1)*t.footerSpacing);let y=0,b=function(e){g=Math.max(g,n.measureText(e).width+y)};return n.save(),n.font=c.string,H(e.title,b),n.font=l.string,H(e.beforeBody.concat(e.afterBody),b),y=t.displayColors?s+2+t.boxPadding:0,H(a,e=>{H(e.before,b),H(e.lines,b),H(e.after,b)}),y=0,n.font=u.string,H(e.footer,b),n.restore(),{width:g+=f.width,height:m}}function rn(e,t,n){let a=n.yAlign||t.yAlign||function(e,t){let{y:n,height:a}=t;return n<a/2?"top":n>e.height-a/2?"bottom":"center"}(e,n);return{xAlign:n.xAlign||t.xAlign||function(e,t,n,a){let{x:r,width:i}=n,{width:s,chartArea:{left:o,right:l}}=e,c="center";return"center"===a?c=r<=(o+l)/2?"left":"right":r<=i/2?c="left":r>=s-i/2&&(c="right"),function(e,t,n,a){let{x:r,width:i}=a,s=n.caretSize+n.caretPadding;if("left"===e&&r+i+s>t.width||"right"===e&&r-i-s<0)return!0}(c,e,t,n)&&(c="center"),c}(e,t,n,a),yAlign:a}}function ra(e,t,n,a){let{caretSize:r,caretPadding:i,cornerRadius:s}=e,{xAlign:o,yAlign:l}=n,c=r+i,{topLeft:u,topRight:h,bottomLeft:d,bottomRight:p}=th(s),f=function(e,t){let{x:n,width:a}=e;return"right"===t?n-=a:"center"===t&&(n-=a/2),n}(t,o),m=function(e,t,n){let{y:a,height:r}=e;return"top"===t?a+=n:"bottom"===t?a-=r+n:a-=r/2,a}(t,l,c);return"center"===l?"left"===o?f+=c:"right"===o&&(f-=c):"left"===o?f-=Math.max(u,d)+r:"right"===o&&(f+=Math.max(h,p)+r),{x:eT(f,0,a.width-t.width),y:eT(m,0,a.height-t.height)}}function rr(e,t,n){let a=td(n.padding);return"center"===t?e.x+e.width/2:"right"===t?e.x+e.width-a.right:e.x+a.left}function ri(e,t){let n=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return n?e.override(n):e}let rs={beforeTitle:O,title(e){if(e.length>0){let t=e[0],n=t.chart.data.labels,a=n?n.length:0;if(this&&this.options&&"dataset"===this.options.mode)return t.dataset.label||"";if(t.label)return t.label;if(a>0&&t.dataIndex<a)return n[t.dataIndex]}return""},afterTitle:O,beforeBody:O,beforeLabel:O,label(e){if(this&&this.options&&"dataset"===this.options.mode)return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");let n=e.formattedValue;return j(n)||(t+=n),t},labelColor(e){let t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){let t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:O,afterBody:O,beforeFooter:O,footer:O,afterFooter:O};function ro(e,t,n,a){let r=e[t].call(n,a);return void 0===r?rs[t].call(n,a):r}class rl extends n2{initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){let e=this._cachedAnimations;if(e)return e;let t=this.chart,n=this.options.setContext(this.getContext()),a=n.enabled&&t.options.animation&&n.animations,r=new t8(this.chart,a);return a._cacheable&&(this._cachedAnimations=Object.freeze(r)),r}getContext(){var e;return this.$context||(this.$context=(e=this.chart.getContext(),tm(e,{tooltip:this,tooltipItems:this._tooltipItems,type:"tooltip"})))}getTitle(e,t){let{callbacks:n}=t,a=ro(n,"beforeTitle",this,e),r=ro(n,"title",this,e),i=ro(n,"afterTitle",this,e),s=[];return s=a7(s,re(a)),s=a7(s,re(r)),s=a7(s,re(i))}getBeforeBody(e,t){return a7([],re(ro(t.callbacks,"beforeBody",this,e)))}getBody(e,t){let{callbacks:n}=t,a=[];return H(e,e=>{let t={before:[],lines:[],after:[]},r=ri(n,e);a7(t.before,re(ro(r,"beforeLabel",this,e))),a7(t.lines,ro(r,"label",this,e)),a7(t.after,re(ro(r,"afterLabel",this,e))),a.push(t)}),a}getAfterBody(e,t){return a7([],re(ro(t.callbacks,"afterBody",this,e)))}getFooter(e,t){let{callbacks:n}=t,a=ro(n,"beforeFooter",this,e),r=ro(n,"footer",this,e),i=ro(n,"afterFooter",this,e),s=[];return s=a7(s,re(a)),s=a7(s,re(r)),s=a7(s,re(i))}_createItems(e){let t,n,a=this._active,r=this.chart.data,i=[],s=[],o=[],l=[];for(t=0,n=a.length;t<n;++t)l.push(function(e,t){let{element:n,datasetIndex:a,index:r}=t,i=e.getDatasetMeta(a).controller,{label:s,value:o}=i.getLabelAndValue(r);return{chart:e,label:s,parsed:i.getParsed(r),raw:e.data.datasets[a].data[r],formattedValue:o,dataset:i.getDataset(),dataIndex:r,datasetIndex:a,element:n}}(this.chart,a[t]));return e.filter&&(l=l.filter((t,n,a)=>e.filter(t,n,a,r))),e.itemSort&&(l=l.sort((t,n)=>e.itemSort(t,n,r))),H(l,t=>{let n=ri(e.callbacks,t);i.push(ro(n,"labelColor",this,t)),s.push(ro(n,"labelPointStyle",this,t)),o.push(ro(n,"labelTextColor",this,t))}),this.labelColors=i,this.labelPointStyles=s,this.labelTextColors=o,this.dataPoints=l,l}update(e,t){let n,a=this.options.setContext(this.getContext()),r=this._active,i=[];if(r.length){let e=a9[a.position].call(this,r,this._eventPosition);i=this._createItems(a),this.title=this.getTitle(i,a),this.beforeBody=this.getBeforeBody(i,a),this.body=this.getBody(i,a),this.afterBody=this.getAfterBody(i,a),this.footer=this.getFooter(i,a);let t=this._size=rt(this,a),s=Object.assign({},e,t),o=rn(this.chart,a,s),l=ra(a,s,o,this.chart);this.xAlign=o.xAlign,this.yAlign=o.yAlign,n={opacity:1,x:l.x,y:l.y,width:t.width,height:t.height,caretX:e.x,caretY:e.y}}else 0!==this.opacity&&(n={opacity:0});this._tooltipItems=i,this.$context=void 0,n&&this._resolveAnimations().update(this,n),e&&a.external&&a.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,n,a){let r=this.getCaretPosition(e,n,a);t.lineTo(r.x1,r.y1),t.lineTo(r.x2,r.y2),t.lineTo(r.x3,r.y3)}getCaretPosition(e,t,n){let a,r,i,s,o,l,{xAlign:c,yAlign:u}=this,{caretSize:h,cornerRadius:d}=n,{topLeft:p,topRight:f,bottomLeft:m,bottomRight:g}=th(d),{x:x,y:y}=e,{width:b,height:v}=t;return"center"===u?(o=y+v/2,"left"===c?(r=(a=x)-h,s=o+h,l=o-h):(r=(a=x+b)+h,s=o-h,l=o+h),i=a):(r="left"===c?x+Math.max(p,m)+h:"right"===c?x+b-Math.max(f,g)-h:this.caretX,"top"===u?(o=(s=y)-h,a=r-h,i=r+h):(o=(s=y+v)+h,a=r+h,i=r-h),l=s),{x1:a,x2:r,x3:i,y1:s,y2:o,y3:l}}drawTitle(e,t,n){let a,r,i,s=this.title,o=s.length;if(o){let l=tq(n.rtl,this.x,this.width);for(i=0,e.x=rr(this,n.titleAlign,n),t.textAlign=l.textAlign(n.titleAlign),t.textBaseline="middle",a=tp(n.titleFont),r=n.titleSpacing,t.fillStyle=n.titleColor,t.font=a.string;i<o;++i)t.fillText(s[i],l.x(e.x),e.y+a.lineHeight/2),e.y+=a.lineHeight+r,i+1===o&&(e.y+=n.titleMarginBottom-r)}}_drawColorBox(e,t,n,a,r){let i=this.labelColors[n],s=this.labelPointStyles[n],{boxHeight:o,boxWidth:l}=r,c=tp(r.bodyFont),u=rr(this,"left",r),h=a.x(u),d=o<c.lineHeight?(c.lineHeight-o)/2:0,p=t.y+d;if(r.usePointStyle){let t={radius:Math.min(l,o)/2,pointStyle:s.pointStyle,rotation:s.rotation,borderWidth:1},n=a.leftForLtr(h,l)+l/2,c=p+o/2;e.strokeStyle=r.multiKeyBackground,e.fillStyle=r.multiKeyBackground,e8(e,t,n,c),e.strokeStyle=i.borderColor,e.fillStyle=i.backgroundColor,e8(e,t,n,c)}else{e.lineWidth=z(i.borderWidth)?Math.max(...Object.values(i.borderWidth)):i.borderWidth||1,e.strokeStyle=i.borderColor,e.setLineDash(i.borderDash||[]),e.lineDashOffset=i.borderDashOffset||0;let t=a.leftForLtr(h,l),n=a.leftForLtr(a.xPlus(h,1),l-2),s=th(i.borderRadius);Object.values(s).some(e=>0!==e)?(e.beginPath(),e.fillStyle=r.multiKeyBackground,ti(e,{x:t,y:p,w:l,h:o,radius:s}),e.fill(),e.stroke(),e.fillStyle=i.backgroundColor,e.beginPath(),ti(e,{x:n,y:p+1,w:l-2,h:o-2,radius:s}),e.fill()):(e.fillStyle=r.multiKeyBackground,e.fillRect(t,p,l,o),e.strokeRect(t,p,l,o),e.fillStyle=i.backgroundColor,e.fillRect(n,p+1,l-2,o-2))}e.fillStyle=this.labelTextColors[n]}drawBody(e,t,n){let a,r,i,s,o,l,{body:c}=this,{bodySpacing:u,bodyAlign:h,displayColors:d,boxHeight:p,boxWidth:f,boxPadding:m}=n,g=tp(n.bodyFont),x=g.lineHeight,y=0,b=tq(n.rtl,this.x,this.width),v=function(n){t.fillText(n,b.x(e.x+y),e.y+x/2),e.y+=x+u},w=b.textAlign(h);for(t.textAlign=h,t.textBaseline="middle",t.font=g.string,e.x=rr(this,w,n),t.fillStyle=n.bodyColor,H(this.beforeBody,v),y=d&&"right"!==w?"center"===h?f/2+m:f+2+m:0,i=0,o=c.length;i<o;++i){for(a=c[i],t.fillStyle=this.labelTextColors[i],H(a.before,v),r=a.lines,d&&r.length&&(this._drawColorBox(t,e,i,b,n),x=Math.max(g.lineHeight,p)),s=0,l=r.length;s<l;++s)v(r[s]),x=g.lineHeight;H(a.after,v)}y=0,x=g.lineHeight,H(this.afterBody,v),e.y-=u}drawFooter(e,t,n){let a,r,i=this.footer,s=i.length;if(s){let o=tq(n.rtl,this.x,this.width);for(e.x=rr(this,n.footerAlign,n),e.y+=n.footerMarginTop,t.textAlign=o.textAlign(n.footerAlign),t.textBaseline="middle",a=tp(n.footerFont),t.fillStyle=n.footerColor,t.font=a.string,r=0;r<s;++r)t.fillText(i[r],o.x(e.x),e.y+a.lineHeight/2),e.y+=a.lineHeight+n.footerSpacing}}drawBackground(e,t,n,a){let{xAlign:r,yAlign:i}=this,{x:s,y:o}=e,{width:l,height:c}=n,{topLeft:u,topRight:h,bottomLeft:d,bottomRight:p}=th(a.cornerRadius);t.fillStyle=a.backgroundColor,t.strokeStyle=a.borderColor,t.lineWidth=a.borderWidth,t.beginPath(),t.moveTo(s+u,o),"top"===i&&this.drawCaret(e,t,n,a),t.lineTo(s+l-h,o),t.quadraticCurveTo(s+l,o,s+l,o+h),"center"===i&&"right"===r&&this.drawCaret(e,t,n,a),t.lineTo(s+l,o+c-p),t.quadraticCurveTo(s+l,o+c,s+l-p,o+c),"bottom"===i&&this.drawCaret(e,t,n,a),t.lineTo(s+d,o+c),t.quadraticCurveTo(s,o+c,s,o+c-d),"center"===i&&"left"===r&&this.drawCaret(e,t,n,a),t.lineTo(s,o+u),t.quadraticCurveTo(s,o,s+u,o),t.closePath(),t.fill(),a.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){let t=this.chart,n=this.$animations,a=n&&n.x,r=n&&n.y;if(a||r){let n=a9[e.position].call(this,this._active,this._eventPosition);if(!n)return;let i=this._size=rt(this,e),s=Object.assign({},n,this._size),o=rn(t,e,s),l=ra(e,s,o,t);(a._to!==l.x||r._to!==l.y)&&(this.xAlign=o.xAlign,this.yAlign=o.yAlign,this.width=i.width,this.height=i.height,this.caretX=n.x,this.caretY=n.y,this._resolveAnimations().update(this,l))}}_willRender(){return!!this.opacity}draw(e){let t=this.options.setContext(this.getContext()),n=this.opacity;if(!n)return;this._updateAnimationTarget(t);let a={width:this.width,height:this.height},r={x:this.x,y:this.y};n=.001>Math.abs(n)?0:n;let i=td(t.padding),s=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&s&&(e.save(),e.globalAlpha=n,this.drawBackground(r,e,a,t),tK(e,t.textDirection),r.y+=i.top,this.drawTitle(r,e,t),this.drawBody(r,e,t),this.drawFooter(r,e,t),tX(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){let n=this._active,a=e.map(e=>{let{datasetIndex:t,index:n}=e,a=this.chart.getDatasetMeta(t);if(!a)throw Error("Cannot find a dataset at index "+t);return{datasetIndex:t,element:a.data[n],index:n}}),r=!q(n,a),i=this._positionChanged(a,t);(r||i)&&(this._active=a,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;let a=this.options,r=this._active||[],i=this._getActiveElements(e,r,t,n),s=this._positionChanged(i,e),o=t||!q(i,r)||s;return o&&(this._active=i,(a.enabled||a.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),o}_getActiveElements(e,t,n,a){let r=this.options;if("mouseout"===e.type)return[];if(!a)return t.filter(e=>this.chart.data.datasets[e.datasetIndex]&&void 0!==this.chart.getDatasetMeta(e.datasetIndex).controller.getParsed(e.index));let i=this.chart.getElementsAtEventForMode(e,r.mode,r,n);return r.reverse&&i.reverse(),i}_positionChanged(e,t){let{caretX:n,caretY:a,options:r}=this,i=a9[r.position].call(this,e,t);return!1!==i&&(n!==i.x||a!==i.y)}constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}}function rc(e){let t=this.getLabels();return e>=0&&e<t.length?t[e]:e}o(rl,"positioners",a9);class ru extends n7{init(e){let t=this._addedLabels;if(t.length){let e=this.getLabels();for(let{index:n,label:a}of t)e[n]===a&&e.splice(n,1);this._addedLabels=[]}super.init(e)}parse(e,t){let n,a;if(j(e))return null;let r=this.getLabels();return n=t=isFinite(t)&&r[t]===e?t:function(e,t,n,a){let r=e.indexOf(t);if(-1===r){var i;return i=n,"string"==typeof t?(i=e.push(t)-1,a.unshift({index:i,label:t})):isNaN(t)&&(i=null),i}return r!==e.lastIndexOf(t)?n:r}(r,e,U(t,e),this._addedLabels),a=r.length-1,null===n?null:eT(Math.round(n),0,a)}determineDataLimits(){let{minDefined:e,maxDefined:t}=this.getUserBounds(),{min:n,max:a}=this.getMinMax(!0);"ticks"===this.options.bounds&&(e||(n=0),t||(a=this.getLabels().length-1)),this.min=n,this.max=a}buildTicks(){let e=this.min,t=this.max,n=this.options.offset,a=[],r=this.getLabels();r=0===e&&t===r.length-1?r:r.slice(e,t+1),this._valueRange=Math.max(r.length-!n,1),this._startValue=this.min-.5*!!n;for(let n=e;n<=t;n++)a.push({value:n});return a}getLabelForValue(e){return rc.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return"number"!=typeof e&&(e=this.parse(e)),null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){let t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}}function rh(e,t,n){let{horizontal:a,minRotation:r}=n,i=eb(r),s=(a?Math.sin(i):Math.cos(i))||.001,o=.75*t*(""+e).length;return Math.min(t/s,o)}o(ru,"id","category"),o(ru,"defaults",{ticks:{callback:rc}});class rd extends n7{parse(e,t){return j(e)||("number"==typeof e||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){let{beginAtZero:e}=this.options,{minDefined:t,maxDefined:n}=this.getUserBounds(),{min:a,max:r}=this,i=e=>a=t?a:e,s=e=>r=n?r:e;if(e){let e=ef(a),t=ef(r);e<0&&t<0?s(0):e>0&&t>0&&i(0)}if(a===r){let t=0===r?1:Math.abs(.05*r);s(r+t),e||i(a-t)}this.min=a,this.max=r}getTickLimit(){let e,{maxTicksLimit:t,stepSize:n}=this.options.ticks;return n?(e=Math.ceil(this.max/n)-Math.floor(this.min/n)+1)>1e3&&(console.warn("scales.".concat(this.id,".ticks.stepSize: ").concat(n," would result generating up to ").concat(e," ticks. Limiting to 1000.")),e=1e3):(e=this.computeTickLimit(),t=t||11),t&&(e=Math.min(t,e)),e}computeTickLimit(){return 1/0}buildTicks(){let e=this.options,t=e.ticks,n=this.getTickLimit(),a=function(e,t){let n,a,r,i,s=[],{bounds:o,step:l,min:c,max:u,precision:h,count:d,maxTicks:p,maxDigits:f,includeBounds:m}=e,g=l||1,x=p-1,{min:y,max:b}=t,v=!j(c),w=!j(u),N=!j(d),k=(b-y)/(f+1),S=eg((b-y)/x/g)*g;if(S<1e-14&&!v&&!w)return[{value:y},{value:b}];(i=Math.ceil(b/S)-Math.floor(y/S))>x&&(S=eg(i*S/x/g)*g),j(h)||(S=Math.ceil(S*(n=Math.pow(10,h)))/n),"ticks"===o?(a=Math.floor(y/S)*S,r=Math.ceil(b/S)*S):(a=y,r=b),v&&w&&l&&function(e,t){let n=Math.round(e);return n-t<=e&&n+t>=e}((u-c)/l,S/1e3)?(i=Math.round(Math.min((u-c)/S,p)),S=(u-c)/i,a=c,r=u):N?(a=v?c:a,S=((r=w?u:r)-a)/(i=d-1)):i=em(i=(r-a)/S,Math.round(i),S/1e3)?Math.round(i):Math.ceil(i);let C=Math.max(ev(S),ev(a));a=Math.round(a*(n=Math.pow(10,j(h)?C:h)))/n,r=Math.round(r*n)/n;let T=0;for(v&&(m&&a!==c?(s.push({value:c}),a<c&&T++,em(Math.round((a+T*S)*n)/n,c,rh(c,k,e))&&T++):a<c&&T++);T<i;++T){let e=Math.round((a+T*S)*n)/n;if(w&&e>u)break;s.push({value:e})}return w&&m&&r!==u?s.length&&em(s[s.length-1].value,u,rh(u,k,e))?s[s.length-1].value=u:s.push({value:u}):w&&r!==u||s.push({value:r}),s}({maxTicks:n=Math.max(2,n),bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:!1!==t.includeBounds},this._range||this);return"ticks"===e.bounds&&ey(a,this,"value"),e.reverse?(a.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),a}configure(){let e=this.ticks,t=this.min,n=this.max;if(super.configure(),this.options.offset&&e.length){let a=(n-t)/Math.max(e.length-1,1)/2;t-=a,n+=a}this._startValue=t,this._endValue=n,this._valueRange=n-t}getLabelForValue(e){return eZ(e,this.chart.options.locale,this.options.ticks.format)}constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}}class rp extends rd{determineDataLimits(){let{min:e,max:t}=this.getMinMax(!0);this.min=B(e)?e:0,this.max=B(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){let e=this.isHorizontal(),t=e?this.width:this.height,n=eb(this.options.ticks.minRotation),a=(e?Math.sin(n):Math.cos(n))||.001;return Math.ceil(t/Math.min(40,this._resolveTickFontOptions(0).lineHeight/a))}getPixelForValue(e){return null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}o(rp,"id","linear"),o(rp,"defaults",{ticks:{callback:eJ.formatters.numeric}});let rf=e=>Math.floor(ep(e)),rm=(e,t)=>Math.pow(10,rf(e)+t);function rg(e){return 1==e/Math.pow(10,rf(e))}function rx(e,t,n){let a=Math.pow(10,n),r=Math.floor(e/a);return Math.ceil(t/a)-r}class ry extends n7{parse(e,t){let n=rd.prototype.parse.apply(this,[e,t]);if(0===n){this._zero=!0;return}return B(n)&&n>0?n:null}determineDataLimits(){let{min:e,max:t}=this.getMinMax(!0);this.min=B(e)?Math.max(0,e):null,this.max=B(t)?Math.max(0,t):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!B(this._userMin)&&(this.min=e===rm(this.min,0)?rm(this.min,-1):rm(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){let{minDefined:e,maxDefined:t}=this.getUserBounds(),n=this.min,a=this.max,r=t=>n=e?n:t,i=e=>a=t?a:e;n===a&&(n<=0?(r(1),i(10)):(r(rm(n,-1)),i(rm(a,1)))),n<=0&&r(rm(a,-1)),a<=0&&i(rm(n,1)),this.min=n,this.max=a}buildTicks(){let e=this.options,t=function(e,t){let{min:n,max:a}=t;n=V(e.min,n);let r=[],i=rf(n),s=function(e,t){let n=rf(t-e);for(;rx(e,t,n)>10;)n++;for(;10>rx(e,t,n);)n--;return Math.min(n,rf(e))}(n,a),o=s<0?Math.pow(10,Math.abs(s)):1,l=Math.pow(10,s),c=i>s?Math.pow(10,i):0,u=Math.round((n-c)*o)/o,h=Math.floor((n-c)/l/10)*l*10,d=Math.floor((u-h)/Math.pow(10,s)),p=V(e.min,Math.round((c+h+d*Math.pow(10,s))*o)/o);for(;p<a;)r.push({value:p,major:rg(p),significand:d}),d>=10?d=d<15?15:20:d++,d>=20&&(d=2,o=++s>=0?1:o),p=Math.round((c+h+d*Math.pow(10,s))*o)/o;let f=V(e.max,p);return r.push({value:f,major:rg(f),significand:d}),r}({min:this._userMin,max:this._userMax},this);return"ticks"===e.bounds&&ey(t,this,"value"),e.reverse?(t.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),t}getLabelForValue(e){return void 0===e?"0":eZ(e,this.chart.options.locale,this.options.ticks.format)}configure(){let e=this.min;super.configure(),this._startValue=ep(e),this._valueRange=ep(this.max)-ep(e)}getPixelForValue(e){return((void 0===e||0===e)&&(e=this.min),null===e||isNaN(e))?NaN:this.getPixelForDecimal(e===this.min?0:(ep(e)-this._startValue)/this._valueRange)}getValueForPixel(e){let t=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+t*this._valueRange)}constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}}function rb(e){let t=e.ticks;if(t.display&&e.display){let e=td(t.backdropPadding);return U(t.font&&t.font.size,e3.font.size)+e.height}return 0}function rv(e,t,n,a,r){return e===a||e===r?{start:t-n/2,end:t+n/2}:e<a||e>r?{start:t-n,end:t}:{start:t,end:t+n}}function rw(e,t,n,a){let{ctx:r}=e;if(n)r.arc(e.xCenter,e.yCenter,t,0,es);else{let n=e.getPointPosition(0,t);r.moveTo(n.x,n.y);for(let i=1;i<a;i++)n=e.getPointPosition(i,t),r.lineTo(n.x,n.y)}}o(ry,"id","logarithmic"),o(ry,"defaults",{ticks:{callback:eJ.formatters.logarithmic,major:{enabled:!0}}});class rN extends rd{setDimensions(){let e=this._padding=td(rb(this.options)/2),t=this.width=this.maxWidth-e.width,n=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+t/2+e.left),this.yCenter=Math.floor(this.top+n/2+e.top),this.drawingArea=Math.floor(Math.min(t,n)/2)}determineDataLimits(){let{min:e,max:t}=this.getMinMax(!1);this.min=B(e)&&!isNaN(e)?e:0,this.max=B(t)&&!isNaN(t)?t:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/rb(this.options))}generateTickLabels(e){rd.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((e,t)=>{let n=G(this.options.pointLabels.callback,[e,t],this);return n||0===n?n:""}).filter((e,t)=>this.chart.getDataVisibility(t))}fit(){let e=this.options;e.display&&e.pointLabels.display?function(e){let t={l:e.left+e._padding.left,r:e.right-e._padding.right,t:e.top+e._padding.top,b:e.bottom-e._padding.bottom},n=Object.assign({},t),a=[],r=[],i=e._pointLabels.length,s=e.options.pointLabels,o=s.centerPointLabels?ei/i:0;for(let u=0;u<i;u++){var l,c;let i=s.setContext(e.getPointLabelContext(u));r[u]=i.padding;let h=e.getPointPosition(u,e.drawingArea+r[u],o),d=tp(i.font),p=(l=e.ctx,c=L(c=e._pointLabels[u])?c:[c],{w:function(e,t,n,a){let r,i,s,o,l,c=(a=a||{}).data=a.data||{},u=a.garbageCollect=a.garbageCollect||[];a.font!==t&&(c=a.data={},u=a.garbageCollect=[],a.font=t),e.save(),e.font=t;let h=0,d=n.length;for(r=0;r<d;r++)if(null==(o=n[r])||L(o)){if(L(o))for(i=0,s=o.length;i<s;i++)null==(l=o[i])||L(l)||(h=e4(e,c,u,h,l))}else h=e4(e,c,u,h,o);e.restore();let p=u.length/2;if(p>n.length){for(r=0;r<p;r++)delete c[u[r]];u.splice(0,p)}return h}(l,d.string,c),h:c.length*d.lineHeight});a[u]=p;let f=eS(e.getIndexAngle(u)+o),m=Math.round(180/ei*f);!function(e,t,n,a,r){let i=Math.abs(Math.sin(n)),s=Math.abs(Math.cos(n)),o=0,l=0;a.start<t.l?(o=(t.l-a.start)/i,e.l=Math.min(e.l,t.l-o)):a.end>t.r&&(o=(a.end-t.r)/i,e.r=Math.max(e.r,t.r+o)),r.start<t.t?(l=(t.t-r.start)/s,e.t=Math.min(e.t,t.t-l)):r.end>t.b&&(l=(r.end-t.b)/s,e.b=Math.max(e.b,t.b+l))}(n,t,f,rv(m,h.x,p.w,0,180),rv(m,h.y,p.h,90,270))}e.setCenterPoint(t.l-n.l,n.r-t.r,t.t-n.t,n.b-t.b),e._pointLabelItems=function(e,t,n){let a,r=[],i=e._pointLabels.length,s=e.options,{centerPointLabels:o,display:l}=s.pointLabels,c={extra:rb(s)/2,additionalAngle:o?ei/i:0};for(let s=0;s<i;s++){c.padding=n[s],c.size=t[s];let i=function(e,t,n){var a,r,i,s,o,l,c;let u=e.drawingArea,{extra:h,additionalAngle:d,padding:p,size:f}=n,m=e.getPointPosition(t,u+h+p,d),g=Math.round(180/ei*eS(m.angle+eu)),x=(a=m.y,r=f.h,90===(i=g)||270===i?a-=r/2:(i>270||i<90)&&(a-=r),a),y=0===(s=g)||180===s?"center":s<180?"left":"right",b=(o=m.x,l=f.w,"right"===(c=y)?o-=l:"center"===c&&(o-=l/2),o);return{visible:!0,x:m.x,y:x,textAlign:y,left:b,top:x,right:b+f.w,bottom:x+f.h}}(e,s,c);r.push(i),"auto"===l&&(i.visible=function(e,t){if(!t)return!0;let{left:n,top:a,right:r,bottom:i}=e;return!(e7({x:n,y:a},t)||e7({x:n,y:i},t)||e7({x:r,y:a},t)||e7({x:r,y:i},t))}(i,a),i.visible&&(a=i))}return r}(e,a,r)}(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,t,n,a){this.xCenter+=Math.floor((e-t)/2),this.yCenter+=Math.floor((n-a)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,t,n,a))}getIndexAngle(e){return eS(e*(es/(this._pointLabels.length||1))+eb(this.options.startAngle||0))}getDistanceFromCenterForValue(e){if(j(e))return NaN;let t=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*t:(e-this.min)*t}getValueForDistanceFromCenter(e){if(j(e))return NaN;let t=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-t:this.min+t}getPointLabelContext(e){let t=this._pointLabels||[];if(e>=0&&e<t.length){var n;let a=t[e];return n=this.getContext(),tm(n,{label:a,index:e,type:"pointLabel"})}}getPointPosition(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=this.getIndexAngle(e)-eu+n;return{x:Math.cos(a)*t+this.xCenter,y:Math.sin(a)*t+this.yCenter,angle:a}}getPointPositionForValue(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){let{left:t,top:n,right:a,bottom:r}=this._pointLabelItems[e];return{left:t,top:n,right:a,bottom:r}}drawBackground(){let{backgroundColor:e,grid:{circular:t}}=this.options;if(e){let n=this.ctx;n.save(),n.beginPath(),rw(this,this.getDistanceFromCenterForValue(this._endValue),t,this._pointLabels.length),n.closePath(),n.fillStyle=e,n.fill(),n.restore()}}drawGrid(){let e,t,n,a=this.ctx,r=this.options,{angleLines:i,grid:s,border:o}=r,l=this._pointLabels.length;if(r.pointLabels.display&&function(e,t){let{ctx:n,options:{pointLabels:a}}=e;for(let r=t-1;r>=0;r--){let t=e._pointLabelItems[r];if(!t.visible)continue;let i=a.setContext(e.getPointLabelContext(r));!function(e,t,n){let{left:a,top:r,right:i,bottom:s}=n,{backdropColor:o}=t;if(!j(o)){let n=th(t.borderRadius),l=td(t.backdropPadding);e.fillStyle=o;let c=a-l.left,u=r-l.top,h=i-a+l.width,d=s-r+l.height;Object.values(n).some(e=>0!==e)?(e.beginPath(),ti(e,{x:c,y:u,w:h,h:d,radius:n}),e.fill()):e.fillRect(c,u,h,d)}}(n,i,t);let s=tp(i.font),{x:o,y:l,textAlign:c}=t;tr(n,e._pointLabels[r],o,l+s.lineHeight/2,s,{color:i.color,textAlign:c,textBaseline:"middle"})}}(this,l),s.display&&this.ticks.forEach((e,n)=>{if(0!==n||0===n&&this.min<0){t=this.getDistanceFromCenterForValue(e.value);let a=this.getContext(n),r=s.setContext(a),i=o.setContext(a);!function(e,t,n,a,r){let i=e.ctx,s=t.circular,{color:o,lineWidth:l}=t;(s||a)&&o&&l&&!(n<0)&&(i.save(),i.strokeStyle=o,i.lineWidth=l,i.setLineDash(r.dash||[]),i.lineDashOffset=r.dashOffset,i.beginPath(),rw(e,n,s,a),i.closePath(),i.stroke(),i.restore())}(this,r,t,l,i)}}),i.display){for(a.save(),e=l-1;e>=0;e--){let s=i.setContext(this.getPointLabelContext(e)),{color:o,lineWidth:l}=s;l&&o&&(a.lineWidth=l,a.strokeStyle=o,a.setLineDash(s.borderDash),a.lineDashOffset=s.borderDashOffset,t=this.getDistanceFromCenterForValue(r.reverse?this.min:this.max),n=this.getPointPosition(e,t),a.beginPath(),a.moveTo(this.xCenter,this.yCenter),a.lineTo(n.x,n.y),a.stroke())}a.restore()}}drawBorder(){}drawLabels(){let e,t,n=this.ctx,a=this.options,r=a.ticks;if(!r.display)return;let i=this.getIndexAngle(0);n.save(),n.translate(this.xCenter,this.yCenter),n.rotate(i),n.textAlign="center",n.textBaseline="middle",this.ticks.forEach((i,s)=>{if(0===s&&this.min>=0&&!a.reverse)return;let o=r.setContext(this.getContext(s)),l=tp(o.font);if(e=this.getDistanceFromCenterForValue(this.ticks[s].value),o.showLabelBackdrop){n.font=l.string,t=n.measureText(i.label).width,n.fillStyle=o.backdropColor;let a=td(o.backdropPadding);n.fillRect(-t/2-a.left,-e-l.size/2-a.top,t+a.width,l.size+a.height)}tr(n,i.label,0,-e,l,{color:o.color,strokeColor:o.textStrokeColor,strokeWidth:o.textStrokeWidth})}),n.restore()}drawTitle(){}constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}}o(rN,"id","radialLinear"),o(rN,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:eJ.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:e=>e,padding:5,centerPointLabels:!1}}),o(rN,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),o(rN,"descriptors",{angleLines:{_fallback:"grid"}});let rk={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},rS=Object.keys(rk);function rC(e,t){return e-t}function rT(e,t){if(j(t))return null;let n=e._adapter,{parser:a,round:r,isoWeekday:i}=e._parseOpts,s=t;return("function"==typeof a&&(s=a(s)),B(s)||(s="string"==typeof a?n.parse(s,a):n.parse(s)),null===s)?null:(r&&(s="week"===r&&(ex(i)||!0===i)?n.startOf(s,"isoWeek",i):n.startOf(s,r)),+s)}function rI(e,t,n,a){let r=rS.length;for(let i=rS.indexOf(e);i<r-1;++i){let e=rk[rS[i]],r=e.steps?e.steps:Number.MAX_SAFE_INTEGER;if(e.common&&Math.ceil((n-t)/(r*e.size))<=a)return rS[i]}return rS[r-1]}function rE(e,t,n){if(n){if(n.length){let{lo:a,hi:r}=eE(n,t);e[n[a]>=t?n[a]:n[r]]=!0}}else e[t]=!0}function r_(e,t,n){let a,r,i=[],s={},o=t.length;for(a=0;a<o;++a)s[r=t[a]]=a,i.push({value:r,major:!1});return 0!==o&&n?function(e,t,n,a){let r,i,s=e._adapter,o=+s.startOf(t[0].value,a),l=t[t.length-1].value;for(r=o;r<=l;r=+s.add(r,1,a))(i=n[r])>=0&&(t[i].major=!0);return t}(e,i,s,n):i}class rA extends n7{init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.time||(e.time={}),a=this._adapter=new nS._date(e.adapters.date);a.init(t),Q(n.displayFormats,a.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return void 0===e?null:rT(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){let e=this.options,t=this._adapter,n=e.time.unit||"day",{min:a,max:r,minDefined:i,maxDefined:s}=this.getUserBounds();function o(e){i||isNaN(e.min)||(a=Math.min(a,e.min)),s||isNaN(e.max)||(r=Math.max(r,e.max))}i&&s||(o(this._getLabelBounds()),("ticks"!==e.bounds||"labels"!==e.ticks.source)&&o(this.getMinMax(!1))),a=B(a)&&!isNaN(a)?a:+t.startOf(Date.now(),n),r=B(r)&&!isNaN(r)?r:+t.endOf(Date.now(),n)+1,this.min=Math.min(a,r-1),this.max=Math.max(a+1,r)}_getLabelBounds(){let e=this.getLabelTimestamps(),t=1/0,n=-1/0;return e.length&&(t=e[0],n=e[e.length-1]),{min:t,max:n}}buildTicks(){let e=this.options,t=e.time,n=e.ticks,a="labels"===n.source?this.getLabelTimestamps():this._generate();"ticks"===e.bounds&&a.length&&(this.min=this._userMin||a[0],this.max=this._userMax||a[a.length-1]);let r=this.min,i=function(e,t,n){let a=0,r=e.length;for(;a<r&&e[a]<t;)a++;for(;r>a&&e[r-1]>n;)r--;return a>0||r<e.length?e.slice(a,r):e}(a,r,this.max);return this._unit=t.unit||(n.autoSkip?rI(t.minUnit,this.min,this.max,this._getLabelCapacity(r)):function(e,t,n,a,r){for(let i=rS.length-1;i>=rS.indexOf(n);i--){let n=rS[i];if(rk[n].common&&e._adapter.diff(r,a,n)>=t-1)return n}return rS[n?rS.indexOf(n):0]}(this,i.length,t.minUnit,this.min,this.max)),this._majorUnit=n.major.enabled&&"year"!==this._unit?function(e){for(let t=rS.indexOf(e)+1,n=rS.length;t<n;++t)if(rk[rS[t]].common)return rS[t]}(this._unit):void 0,this.initOffsets(a),e.reverse&&i.reverse(),r_(this,i,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(){let e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=0,r=0;this.options.offset&&n.length&&(e=this.getDecimalForValue(n[0]),a=1===n.length?1-e:(this.getDecimalForValue(n[1])-e)/2,t=this.getDecimalForValue(n[n.length-1]),r=1===n.length?t:(t-this.getDecimalForValue(n[n.length-2]))/2);let i=n.length<3?.5:.25;a=eT(a,0,i),r=eT(r,0,i),this._offsets={start:a,end:r,factor:1/(a+1+r)}}_generate(){let e,t,n=this._adapter,a=this.min,r=this.max,i=this.options,s=i.time,o=s.unit||rI(s.minUnit,a,r,this._getLabelCapacity(a)),l=U(i.ticks.stepSize,1),c="week"===o&&s.isoWeekday,u=ex(c)||!0===c,h={},d=a;if(u&&(d=+n.startOf(d,"isoWeek",c)),d=+n.startOf(d,u?"day":o),n.diff(r,a,o)>1e5*l)throw Error(a+" and "+r+" are too far apart with stepSize of "+l+" "+o);let p="data"===i.ticks.source&&this.getDataTimestamps();for(e=d,t=0;e<r;e=+n.add(e,l,o),t++)rE(h,e,p);return(e===r||"ticks"===i.bounds||1===t)&&rE(h,e,p),Object.keys(h).sort(rC).map(e=>+e)}getLabelForValue(e){let t=this._adapter,n=this.options.time;return n.tooltipFormat?t.format(e,n.tooltipFormat):t.format(e,n.displayFormats.datetime)}format(e,t){let n=this.options.time.displayFormats,a=this._unit,r=t||n[a];return this._adapter.format(e,r)}_tickFormatFunction(e,t,n,a){let r=this.options,i=r.ticks.callback;if(i)return G(i,[e,t,n],this);let s=r.time.displayFormats,o=this._unit,l=this._majorUnit,c=o&&s[o],u=l&&s[l],h=n[t],d=l&&u&&h&&h.major;return this._adapter.format(e,a||(d?u:c))}generateTickLabels(e){let t,n,a;for(t=0,n=e.length;t<n;++t)(a=e[t]).label=this._tickFormatFunction(a.value,t,e)}getDecimalForValue(e){return null===e?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){let t=this._offsets,n=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+n)*t.factor)}getValueForPixel(e){let t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+n*(this.max-this.min)}_getLabelSize(e){let t=this.options.ticks,n=this.ctx.measureText(e).width,a=eb(this.isHorizontal()?t.maxRotation:t.minRotation),r=Math.cos(a),i=Math.sin(a),s=this._resolveTickFontOptions(0).size;return{w:n*r+s*i,h:n*i+s*r}}_getLabelCapacity(e){let t=this.options.time,n=t.displayFormats,a=n[t.unit]||n.millisecond,r=this._tickFormatFunction(e,0,r_(this,[e],this._majorUnit),a),i=this._getLabelSize(r),s=Math.floor(this.isHorizontal()?this.width/i.w:this.height/i.h)-1;return s>0?s:1}getDataTimestamps(){let e,t,n=this._cache.data||[];if(n.length)return n;let a=this.getMatchingVisibleMetas();if(this._normalized&&a.length)return this._cache.data=a[0].controller.getAllParsedValues(this);for(e=0,t=a.length;e<t;++e)n=n.concat(a[e].controller.getAllParsedValues(this));return this._cache.data=this.normalize(n)}getLabelTimestamps(){let e,t,n=this._cache.labels||[];if(n.length)return n;let a=this.getLabels();for(e=0,t=a.length;e<t;++e)n.push(rT(this,a[e]));return this._cache.labels=this._normalized?n:this.normalize(n)}normalize(e){return eM(e.sort(rC))}constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}}function rR(e,t,n){let a,r,i,s,o=0,l=e.length-1;n?(t>=e[o].pos&&t<=e[l].pos&&({lo:o,hi:l}=e_(e,"pos",t)),{pos:a,time:i}=e[o],{pos:r,time:s}=e[l]):(t>=e[o].time&&t<=e[l].time&&({lo:o,hi:l}=e_(e,"time",t)),{time:a,pos:i}=e[o],{time:r,pos:s}=e[l]);let c=r-a;return c?i+(s-i)*(t-a)/c:i}o(rA,"id","time"),o(rA,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});class rD extends rA{initOffsets(){let e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=rR(t,this.min),this._tableRange=rR(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){let t,n,a,{min:r,max:i}=this,s=[],o=[];for(t=0,n=e.length;t<n;++t)(a=e[t])>=r&&a<=i&&s.push(a);if(s.length<2)return[{time:r,pos:0},{time:i,pos:1}];for(t=0,n=s.length;t<n;++t)Math.round((s[t+1]+s[t-1])/2)!==(a=s[t])&&o.push({time:a,pos:t/(n-1)});return o}_generate(){let e=this.min,t=this.max,n=super.getDataTimestamps();return n.includes(e)&&n.length||n.splice(0,0,e),n.includes(t)&&1!==n.length||n.push(t),n.sort((e,t)=>e-t)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;let t=this.getDataTimestamps(),n=this.getLabelTimestamps();return e=t.length&&n.length?this.normalize(t.concat(n)):t.length?t:n,e=this._cache.all=e}getDecimalForValue(e){return(rR(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){let t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return rR(this._table,n*this._tableRange+this._minPos,!0)}constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}}o(rD,"id","timeseries"),o(rD,"defaults",rA.defaults);let rM="label";function rF(e,t){"function"==typeof e?e(t):e&&(e.current=t)}function rO(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rM,a=[];e.datasets=t.map(t=>{let r=e.datasets.find(e=>e[n]===t[n]);return!r||!t.data||a.includes(r)?{...t}:(a.push(r),Object.assign(r,t),r)})}let rP=(0,s.forwardRef)(function(e,t){let{height:n=150,width:a=300,redraw:r=!1,datasetIdKey:i,type:o,data:l,options:c,plugins:u=[],fallbackContent:h,updateMode:d,...p}=e,f=(0,s.useRef)(null),m=(0,s.useRef)(null),g=()=>{f.current&&(m.current=new aS(f.current,{type:o,data:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rM,n={labels:[],datasets:[]};return n.labels=e.labels,rO(n,e.datasets,t),n}(l,i),options:c&&{...c},plugins:u}),rF(t,m.current))},x=()=>{rF(t,null),m.current&&(m.current.destroy(),m.current=null)};return(0,s.useEffect)(()=>{!r&&m.current&&c&&function(e,t){let n=e.options;n&&t&&Object.assign(n,t)}(m.current,c)},[r,c]),(0,s.useEffect)(()=>{!r&&m.current&&(m.current.config.data.labels=l.labels)},[r,l.labels]),(0,s.useEffect)(()=>{!r&&m.current&&l.datasets&&rO(m.current.config.data,l.datasets,i)},[r,l.datasets]),(0,s.useEffect)(()=>{m.current&&(r?(x(),setTimeout(g)):m.current.update(d))},[r,c,l.labels,l.datasets,d]),(0,s.useEffect)(()=>{m.current&&(x(),setTimeout(g))},[o]),(0,s.useEffect)(()=>(g(),()=>x()),[]),s.default.createElement("canvas",{ref:f,role:"img",height:n,width:a,...p},h)}),rj=(aS.register(nx),(0,s.forwardRef)((e,t)=>s.default.createElement(rP,{...e,ref:t,type:"line"})));function rL(e){let{title:t,data:r,height:i=300,className:o=""}=e,l=(0,s.useRef)(null);return(0,n.jsxs)(a.motion.div,{className:"bg-white rounded-lg shadow-lg p-6 border border-automotive-chrome ".concat(o),initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-automotive-carbon mb-4",children:t}),(0,n.jsx)("div",{style:{height:"".concat(i,"px")},children:(0,n.jsx)(rj,{ref:l,data:r,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{usePointStyle:!0,padding:20,font:{size:12,family:"Inter, system-ui, sans-serif"}}},title:{display:!1},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#ffffff",bodyColor:"#ffffff",borderColor:"#0ea5e9",borderWidth:1,cornerRadius:8,padding:12}},scales:{x:{grid:{color:"rgba(113, 113, 122, 0.1)"},ticks:{font:{size:11,family:"Inter, system-ui, sans-serif"},color:"#71717a"}},y:{grid:{color:"rgba(113, 113, 122, 0.1)"},ticks:{font:{size:11,family:"Inter, system-ui, sans-serif"},color:"#71717a"}}},elements:{point:{radius:4,hoverRadius:6},line:{tension:.4}},interaction:{intersect:!1,mode:"index"}}})})]})}aS.register(ru,rp,aL,aP,{id:"title",_element:a8,start(e,t,n){let a=new a8({ctx:e.ctx,options:n,chart:e});nz.configure(e,a,n),nz.addBox(e,a),e.titleBlock=a},stop(e){let t=e.titleBlock;nz.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,n){let a=e.titleBlock;nz.configure(e,a,n),a.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}},{id:"tooltip",_element:rl,positioners:a9,afterInit(e,t,n){n&&(e.tooltip=new rl({chart:e,options:n}))},beforeUpdate(e,t,n){e.tooltip&&e.tooltip.initialize(n)},reset(e,t,n){e.tooltip&&e.tooltip.initialize(n)},afterDraw(e){let t=e.tooltip;if(t&&t._willRender()){let n={tooltip:t};if(!1===e.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0}))return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",n)}},afterEvent(e,t){if(e.tooltip){let n=t.replay;e.tooltip.handleEvent(t.event,n,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:rs},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>"filter"!==e&&"itemSort"!==e&&"external"!==e,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},{id:"legend",_element:a5,start(e,t,n){let a=e.legend=new a5({ctx:e.ctx,options:n,chart:e});nz.configure(e,a,n),nz.addBox(e,a)},stop(e){nz.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,n){let a=e.legend;nz.configure(e,a,n),a.options=n},afterUpdate(e){let t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,n){let a=t.datasetIndex,r=n.chart;r.isDatasetVisible(a)?(r.hide(a),t.hidden=!0):(r.show(a),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){let t=e.data.datasets,{labels:{usePointStyle:n,pointStyle:a,textAlign:r,color:i,useBorderRadius:s,borderRadius:o}}=e.legend.options;return e._getSortedDatasetMetas().map(e=>{let l=e.controller.getStyle(n?0:void 0),c=td(l.borderWidth);return{text:t[e.index].label,fillStyle:l.backgroundColor,fontColor:i,hidden:!e.visible,lineCap:l.borderCapStyle,lineDash:l.borderDash,lineDashOffset:l.borderDashOffset,lineJoin:l.borderJoinStyle,lineWidth:(c.width+c.height)/4,strokeStyle:l.borderColor,pointStyle:a||l.pointStyle,rotation:l.rotation,textAlign:r||l.textAlign,borderRadius:s&&(o||l.borderRadius),datasetIndex:e.index}},this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}},{id:"filler",afterDatasetsUpdate(e,t,n){let a,r,i,s,o=(e.data.datasets||[]).length,l=[];for(r=0;r<o;++r)i=(a=e.getDatasetMeta(r)).dataset,s=null,i&&i.options&&i instanceof aP&&(s={visible:e.isDatasetVisible(r),index:r,fill:function(e,t,n){var a,r,i,s;let o=function(e){let t=e.options,n=t.fill,a=U(n&&n.target,n);return void 0===a&&(a=!!t.backgroundColor),!1!==a&&null!==a&&(!0===a?"origin":a)}(e);if(z(o))return!isNaN(o.value)&&o;let l=parseFloat(o);return B(l)&&Math.floor(l)===l?(a=o[0],r=t,i=l,s=n,("-"===a||"+"===a)&&(i=r+i),i!==r&&!(i<0)&&!(i>=s)&&i):["origin","start","end","stack","shape"].indexOf(o)>=0&&o}(i,r,o),chart:e,axis:a.controller.options.indexAxis,scale:a.vScale,line:i}),a.$filler=s,l.push(s);for(r=0;r<o;++r)(s=l[r])&&!1!==s.fill&&(s.fill=function(e,t,n){let a,r=e[t].fill,i=[t];if(!n)return r;for(;!1!==r&&-1===i.indexOf(r);){if(!B(r))return r;if(!(a=e[r]))break;if(a.visible)return r;i.push(r),r=a.fill}return!1}(l,r,n.propagate))},beforeDraw(e,t,n){let a="beforeDraw"===n.drawTime,r=e.getSortedVisibleDatasetMetas(),i=e.chartArea;for(let t=r.length-1;t>=0;--t){let n=r[t].$filler;n&&(n.line.updateControlPoints(i,n.axis),a&&n.fill&&a$(e.ctx,n,i))}},beforeDatasetsDraw(e,t,n){if("beforeDatasetsDraw"!==n.drawTime)return;let a=e.getSortedVisibleDatasetMetas();for(let t=a.length-1;t>=0;--t){let n=a[t].$filler;aQ(n)&&a$(e.ctx,n,e.chartArea)}},beforeDatasetDraw(e,t,n){let a=t.meta.$filler;aQ(a)&&"beforeDatasetDraw"===n.drawTime&&a$(e.ctx,a,e.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}});let rz=[{title:"Production Efficiency",value:94.7,suffix:"%",trend:"up",trendValue:2.3,icon:"",decimals:1},{title:"Quality Score",value:99.2,suffix:"%",trend:"up",trendValue:.8,icon:"",decimals:1},{title:"On-Time Delivery",value:96.5,suffix:"%",trend:"neutral",trendValue:.2,icon:"",decimals:1},{title:"Cost Reduction",value:12.4,suffix:"%",trend:"up",trendValue:3.1,icon:"",decimals:1}],rB={labels:["Jan","Feb","Mar","Apr","May","Jun"],datasets:[{label:"Production Efficiency",data:[89,91,93,94,95,94.7],borderColor:"#0ea5e9",backgroundColor:"rgba(14, 165, 233, 0.1)",fill:!0},{label:"Quality Score",data:[97,98,98.5,99,99.1,99.2],borderColor:"#10b981",backgroundColor:"rgba(16, 185, 129, 0.1)",fill:!0}]},rV={labels:["Week 1","Week 2","Week 3","Week 4"],datasets:[{label:"Demand Forecast",data:[2400,2600,2800,3200],borderColor:"#22d3ee",backgroundColor:"rgba(34, 211, 238, 0.1)",fill:!0},{label:"Inventory Optimization",data:[1800,2100,2300,2500],borderColor:"#f59e0b",backgroundColor:"rgba(245, 158, 11, 0.1)",fill:!0}]};function rU(){return(0,n.jsx)("section",{className:"py-16 bg-gradient-to-br from-slate-50 to-blue-50",children:(0,n.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,n.jsxs)(a.motion.div,{className:"text-center mb-12",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[(0,n.jsx)("h2",{className:"text-3xl font-bold text-automotive-carbon mb-4",children:"Real-Time Automotive Analytics"}),(0,n.jsx)("p",{className:"text-lg text-automotive-steel max-w-3xl mx-auto",children:"Monitor key performance indicators and predictive insights for your automotive supply chain operations"})]}),(0,n.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12",children:rz.map((e,t)=>(0,n.jsx)(a.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1*t},children:(0,n.jsx)(i,{...e})},e.title))}),(0,n.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,n.jsx)(rL,{title:"Performance Trends",data:rB,height:350}),(0,n.jsx)(rL,{title:"AI Predictions",data:rV,height:350})]}),(0,n.jsxs)(a.motion.div,{className:"mt-12 bg-white rounded-lg shadow-lg p-6 border border-automotive-chrome",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.8},children:[(0,n.jsx)("h3",{className:"text-xl font-semibold text-automotive-carbon mb-6",children:"System Status"}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,n.jsx)("div",{className:"w-3 h-3 bg-automotive-success rounded-full animate-pulse-slow"}),(0,n.jsx)("span",{className:"text-automotive-steel",children:"Production Lines: Online"})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,n.jsx)("div",{className:"w-3 h-3 bg-automotive-success rounded-full animate-pulse-slow"}),(0,n.jsx)("span",{className:"text-automotive-steel",children:"Quality Control: Active"})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,n.jsx)("div",{className:"w-3 h-3 bg-automotive-electric rounded-full animate-pulse-slow"}),(0,n.jsx)("span",{className:"text-automotive-steel",children:"AI Models: Processing"})]})]})]})]})})}},93250,e=>{"use strict";e.s(["default",()=>v],93250);var t=e.i(43476),n=e.i(71645),a=e.i(46932);e.i(47167);var r=e.i(31178),i=e.i(47414),s=e.i(74008),o=e.i(21476),l=e.i(72846),c=n,u=e.i(37806);class h extends c.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,n=(0,l.isHTMLElement)(e)&&e.offsetWidth||0,a=this.props.sizeRef.current;a.height=t.offsetHeight||0,a.width=t.offsetWidth||0,a.top=t.offsetTop,a.left=t.offsetLeft,a.right=n-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function d(e){let{children:n,isPresent:a,anchorX:r,root:i}=e,s=(0,c.useId)(),o=(0,c.useRef)(null),l=(0,c.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:d}=(0,c.useContext)(u.MotionConfigContext);return(0,c.useInsertionEffect)(()=>{let{width:e,height:t,top:n,left:c,right:u}=l.current;if(a||!o.current||!e||!t)return;o.current.dataset.motionPopId=s;let h=document.createElement("style");d&&(h.nonce=d);let p=null!=i?i:document.head;return p.appendChild(h),h.sheet&&h.sheet.insertRule('\n          [data-motion-pop-id="'.concat(s,'"] {\n            position: absolute !important;\n            width: ').concat(e,"px !important;\n            height: ").concat(t,"px !important;\n            ").concat("left"===r?"left: ".concat(c):"right: ".concat(u),"px !important;\n            top: ").concat(n,"px !important;\n          }\n        ")),()=>{p.contains(h)&&p.removeChild(h)}},[a]),(0,t.jsx)(h,{isPresent:a,childRef:o,sizeRef:l,children:c.cloneElement(n,{ref:o})})}let p=e=>{let{children:a,initial:r,isPresent:s,onExitComplete:l,custom:c,presenceAffectsLayout:u,mode:h,anchorX:p,root:m}=e,g=(0,i.useConstant)(f),x=(0,n.useId)(),y=!0,b=(0,n.useMemo)(()=>(y=!1,{id:x,initial:r,isPresent:s,custom:c,onExitComplete:e=>{for(let t of(g.set(e,!0),g.values()))if(!t)return;l&&l()},register:e=>(g.set(e,!1),()=>g.delete(e))}),[s,g,l]);return u&&y&&(b={...b}),(0,n.useMemo)(()=>{g.forEach((e,t)=>g.set(t,!1))},[s]),n.useEffect(()=>{s||g.size||!l||l()},[s]),"popLayout"===h&&(a=(0,t.jsx)(d,{isPresent:s,anchorX:p,root:m,children:a})),(0,t.jsx)(o.PresenceContext.Provider,{value:b,children:a})};function f(){return new Map}var m=e.i(64978);let g=e=>e.key||"";function x(e){let t=[];return n.Children.forEach(e,e=>{(0,n.isValidElement)(e)&&t.push(e)}),t}let y=e=>{let{children:a,custom:o,initial:l=!0,onExitComplete:c,presenceAffectsLayout:u=!0,mode:h="sync",propagate:d=!1,anchorX:f="left",root:y}=e,[b,v]=(0,m.usePresence)(d),w=(0,n.useMemo)(()=>x(a),[a]),N=d&&!b?[]:w.map(g),k=(0,n.useRef)(!0),S=(0,n.useRef)(w),C=(0,i.useConstant)(()=>new Map),[T,I]=(0,n.useState)(w),[E,_]=(0,n.useState)(w);(0,s.useIsomorphicLayoutEffect)(()=>{k.current=!1,S.current=w;for(let e=0;e<E.length;e++){let t=g(E[e]);N.includes(t)?C.delete(t):!0!==C.get(t)&&C.set(t,!1)}},[E,N.length,N.join("-")]);let A=[];if(w!==T){let e=[...w];for(let t=0;t<E.length;t++){let n=E[t],a=g(n);N.includes(a)||(e.splice(t,0,n),A.push(n))}return"wait"===h&&A.length&&(e=A),_(x(e)),I(w),null}let{forceRender:R}=(0,n.useContext)(r.LayoutGroupContext);return(0,t.jsx)(t.Fragment,{children:E.map(e=>{let n=g(e),a=(!d||!!b)&&(w===E||N.includes(n));return(0,t.jsx)(p,{isPresent:a,initial:(!k.current||!!l)&&void 0,custom:o,presenceAffectsLayout:u,mode:h,root:y,onExitComplete:a?void 0:()=>{if(!C.has(n))return;C.set(n,!0);let e=!0;C.forEach(t=>{t||(e=!1)}),e&&(null==R||R(),_(S.current),d&&(null==v||v()),c&&c())},anchorX:f,children:e},n)})})},b=[{id:"production-planning",title:"Production Planning",description:"Optimize manufacturing schedules and resource allocation with AI-driven planning algorithms.",icon:"",features:["Capacity Planning","Resource Optimization","Schedule Automation","Bottleneck Analysis"],benefits:["15% efficiency increase","Reduced downtime","Better resource utilization"],color:"from-blue-500 to-blue-600"},{id:"quality-control",title:"Quality Control",description:"Real-time quality monitoring and predictive defect detection using advanced analytics.",icon:"",features:["Defect Detection","Statistical Process Control","Root Cause Analysis","Quality Metrics"],benefits:["99.2% quality score","Reduced waste","Compliance assurance"],color:"from-green-500 to-green-600"},{id:"supply-chain",title:"Supply Chain Optimization",description:"End-to-end visibility and optimization of your automotive supply chain network.",icon:"",features:["Supplier Management","Inventory Optimization","Demand Forecasting","Risk Assessment"],benefits:["30% inventory reduction","Improved delivery times","Cost optimization"],color:"from-purple-500 to-purple-600"},{id:"predictive-maintenance",title:"Predictive Maintenance",description:"Prevent equipment failures with AI-powered predictive maintenance solutions.",icon:"",features:["Equipment Monitoring","Failure Prediction","Maintenance Scheduling","Performance Analytics"],benefits:["40% less downtime","Extended equipment life","Reduced maintenance costs"],color:"from-orange-500 to-orange-600"},{id:"logistics",title:"Logistics & Distribution",description:"Optimize transportation routes and warehouse operations for maximum efficiency.",icon:"",features:["Route Optimization","Warehouse Management","Fleet Tracking","Delivery Analytics"],benefits:["25% cost reduction","Faster deliveries","Better customer satisfaction"],color:"from-cyan-500 to-cyan-600"},{id:"compliance",title:"Regulatory Compliance",description:"Ensure full compliance with automotive industry standards and regulations.",icon:"",features:["ISO Standards","Audit Management","Documentation Control","Compliance Tracking"],benefits:["100% compliance rate","Reduced audit time","Risk mitigation"],color:"from-red-500 to-red-600"},{id:"analytics",title:"Advanced Analytics",description:"Transform data into actionable insights with powerful analytics and reporting tools.",icon:"",features:["Real-time Dashboards","Custom Reports","Data Visualization","Trend Analysis"],benefits:["Data-driven decisions","Improved visibility","Strategic insights"],color:"from-indigo-500 to-indigo-600"},{id:"integration",title:"System Integration",description:"Seamlessly connect with existing ERP, MES, and other automotive systems.",icon:"",features:["ERP Integration","API Connectivity","Data Synchronization","Legacy System Support"],benefits:["Unified data view","Reduced silos","Improved efficiency"],color:"from-teal-500 to-teal-600"}];function v(){let[e,r]=(0,n.useState)(b[0].id),i=b.find(t=>t.id===e)||b[0];return(0,t.jsx)("section",{className:"py-16 bg-white",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,t.jsxs)(a.motion.div,{className:"text-center mb-12",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[(0,t.jsx)("h2",{className:"text-3xl font-bold text-automotive-carbon mb-4",children:"Automotive Solutions Portfolio"}),(0,t.jsx)("p",{className:"text-lg text-automotive-steel max-w-3xl mx-auto",children:"Comprehensive supply chain management solutions tailored for the automotive industry"})]}),(0,t.jsx)("div",{className:"mb-8",children:(0,t.jsx)("div",{className:"flex flex-wrap justify-center gap-2 mb-6",children:b.map((n,i)=>(0,t.jsxs)(a.motion.button,{onClick:()=>r(n.id),className:"px-4 py-2 rounded-lg font-medium text-sm transition-all duration-300 ".concat(e===n.id?"bg-primary-500 text-white shadow-lg":"bg-gray-100 text-automotive-steel hover:bg-gray-200"),initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.05*i},whileHover:{scale:1.05},whileTap:{scale:.95},children:[(0,t.jsx)("span",{className:"mr-2",children:n.icon}),n.title]},n.id))})}),(0,t.jsx)(y,{mode:"wait",children:(0,t.jsx)(a.motion.div,{className:"bg-gradient-to-br from-slate-50 to-blue-50 rounded-2xl p-8 shadow-lg",initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center mb-6",children:[(0,t.jsx)("div",{className:"w-16 h-16 rounded-2xl bg-gradient-to-br ".concat(i.color," flex items-center justify-center text-2xl shadow-lg"),children:i.icon}),(0,t.jsx)("div",{className:"ml-4",children:(0,t.jsx)("h3",{className:"text-2xl font-bold text-automotive-carbon",children:i.title})})]}),(0,t.jsx)("p",{className:"text-automotive-steel text-lg mb-6 leading-relaxed",children:i.description}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-automotive-carbon mb-3",children:"Key Benefits"}),(0,t.jsx)("div",{className:"space-y-2",children:i.benefits.map((e,n)=>(0,t.jsxs)(a.motion.div,{className:"flex items-center text-automotive-steel",initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.3,delay:.1*n},children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-automotive-success rounded-full mr-3"}),e]},e))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-automotive-carbon mb-4",children:"Core Features"}),(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:i.features.map((e,n)=>(0,t.jsx)(a.motion.div,{className:"bg-white rounded-lg p-4 shadow-sm border border-automotive-chrome",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1*n},whileHover:{scale:1.02},children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br ".concat(i.color," flex items-center justify-center mr-3"),children:(0,t.jsx)("div",{className:"w-2 h-2 bg-white rounded-full"})}),(0,t.jsx)("span",{className:"font-medium text-automotive-carbon text-sm",children:e})]})},e))}),(0,t.jsx)(a.motion.div,{className:"mt-8",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.5},children:(0,t.jsxs)("button",{className:"w-full bg-primary-500 hover:bg-primary-600 text-white font-semibold py-3 px-6 rounded-lg transition-colors duration-300 shadow-lg hover:shadow-xl",children:["Learn More About ",i.title]})})]})]})},e)})]})})}},67034,(e,t,n)=>{!function(){var e={675:function(e,t){"use strict";t.byteLength=function(e){var t=l(e),n=t[0],a=t[1];return(n+a)*3/4-a},t.toByteArray=function(e){var t,n,i=l(e),s=i[0],o=i[1],c=new r((s+o)*3/4-o),u=0,h=o>0?s-4:s;for(n=0;n<h;n+=4)t=a[e.charCodeAt(n)]<<18|a[e.charCodeAt(n+1)]<<12|a[e.charCodeAt(n+2)]<<6|a[e.charCodeAt(n+3)],c[u++]=t>>16&255,c[u++]=t>>8&255,c[u++]=255&t;return 2===o&&(t=a[e.charCodeAt(n)]<<2|a[e.charCodeAt(n+1)]>>4,c[u++]=255&t),1===o&&(t=a[e.charCodeAt(n)]<<10|a[e.charCodeAt(n+1)]<<4|a[e.charCodeAt(n+2)]>>2,c[u++]=t>>8&255,c[u++]=255&t),c},t.fromByteArray=function(e){for(var t,a=e.length,r=a%3,i=[],s=0,o=a-r;s<o;s+=16383)i.push(function(e,t,a){for(var r,i=[],s=t;s<a;s+=3)r=(e[s]<<16&0xff0000)+(e[s+1]<<8&65280)+(255&e[s+2]),i.push(n[r>>18&63]+n[r>>12&63]+n[r>>6&63]+n[63&r]);return i.join("")}(e,s,s+16383>o?o:s+16383));return 1===r?i.push(n[(t=e[a-1])>>2]+n[t<<4&63]+"=="):2===r&&i.push(n[(t=(e[a-2]<<8)+e[a-1])>>10]+n[t>>4&63]+n[t<<2&63]+"="),i.join("")};for(var n=[],a=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,o=i.length;s<o;++s)n[s]=i[s],a[i.charCodeAt(s)]=s;function l(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");-1===n&&(n=t);var a=n===t?0:4-n%4;return[n,a]}a[45]=62,a[95]=63},72:function(e,t,n){"use strict";var a=n(675),r=n(783),i="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function s(e){if(e>0x7fffffff)throw RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,o.prototype),t}function o(e,t,n){if("number"==typeof e){if("string"==typeof t)throw TypeError('The "string" argument must be of type string. Received type number');return u(e)}return l(e,t,n)}function l(e,t,n){if("string"==typeof e){var a=e,r=t;if(("string"!=typeof r||""===r)&&(r="utf8"),!o.isEncoding(r))throw TypeError("Unknown encoding: "+r);var i=0|p(a,r),l=s(i),c=l.write(a,r);return c!==i&&(l=l.slice(0,c)),l}if(ArrayBuffer.isView(e))return h(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(_(e,ArrayBuffer)||e&&_(e.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(_(e,SharedArrayBuffer)||e&&_(e.buffer,SharedArrayBuffer)))return function(e,t,n){var a;if(t<0||e.byteLength<t)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(a=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),o.prototype),a}(e,t,n);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');var u=e.valueOf&&e.valueOf();if(null!=u&&u!==e)return o.from(u,t,n);var f=function(e){if(o.isBuffer(e)){var t=0|d(e.length),n=s(t);return 0===n.length||e.copy(n,0,0,t),n}return void 0!==e.length?"number"!=typeof e.length||function(e){return e!=e}(e.length)?s(0):h(e):"Buffer"===e.type&&Array.isArray(e.data)?h(e.data):void 0}(e);if(f)return f;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return o.from(e[Symbol.toPrimitive]("string"),t,n);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function c(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return c(e),s(e<0?0:0|d(e))}function h(e){for(var t=e.length<0?0:0|d(e.length),n=s(t),a=0;a<t;a+=1)n[a]=255&e[a];return n}t.Buffer=o,t.SlowBuffer=function(e){return+e!=e&&(e=0),o.alloc(+e)},t.INSPECT_MAX_BYTES=50,t.kMaxLength=0x7fffffff,o.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),o.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}}),o.poolSize=8192,o.from=function(e,t,n){return l(e,t,n)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array),o.alloc=function(e,t,n){return(c(e),e<=0)?s(e):void 0!==t?"string"==typeof n?s(e).fill(t,n):s(e).fill(t):s(e)},o.allocUnsafe=function(e){return u(e)},o.allocUnsafeSlow=function(e){return u(e)};function d(e){if(e>=0x7fffffff)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}function p(e,t){if(o.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||_(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var n=e.length,a=arguments.length>2&&!0===arguments[2];if(!a&&0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return C(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return I(e).length;default:if(r)return a?-1:C(e).length;t=(""+t).toLowerCase(),r=!0}}function f(e,t,n){var r,i,s,o=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===n||n>this.length)&&(n=this.length),n<=0||(n>>>=0)<=(t>>>=0)))return"";for(e||(e="utf8");;)switch(e){case"hex":return function(e,t,n){var a=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>a)&&(n=a);for(var r="",i=t;i<n;++i)r+=A[e[i]];return r}(this,t,n);case"utf8":case"utf-8":return y(this,t,n);case"ascii":return function(e,t,n){var a="";n=Math.min(e.length,n);for(var r=t;r<n;++r)a+=String.fromCharCode(127&e[r]);return a}(this,t,n);case"latin1":case"binary":return function(e,t,n){var a="";n=Math.min(e.length,n);for(var r=t;r<n;++r)a+=String.fromCharCode(e[r]);return a}(this,t,n);case"base64":return r=this,i=t,s=n,0===i&&s===r.length?a.fromByteArray(r):a.fromByteArray(r.slice(i,s));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,n){for(var a=e.slice(t,n),r="",i=0;i<a.length;i+=2)r+=String.fromCharCode(a[i]+256*a[i+1]);return r}(this,t,n);default:if(o)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),o=!0}}function m(e,t,n){var a=e[t];e[t]=e[n],e[n]=a}function g(e,t,n,a,r){var i;if(0===e.length)return -1;if("string"==typeof n?(a=n,n=0):n>0x7fffffff?n=0x7fffffff:n<-0x80000000&&(n=-0x80000000),(i=n*=1)!=i&&(n=r?0:e.length-1),n<0&&(n=e.length+n),n>=e.length)if(r)return -1;else n=e.length-1;else if(n<0)if(!r)return -1;else n=0;if("string"==typeof t&&(t=o.from(t,a)),o.isBuffer(t))return 0===t.length?-1:x(e,t,n,a,r);if("number"==typeof t){if(t&=255,"function"==typeof Uint8Array.prototype.indexOf)if(r)return Uint8Array.prototype.indexOf.call(e,t,n);else return Uint8Array.prototype.lastIndexOf.call(e,t,n);return x(e,[t],n,a,r)}throw TypeError("val must be string, number or Buffer")}function x(e,t,n,a,r){var i,s=1,o=e.length,l=t.length;if(void 0!==a&&("ucs2"===(a=String(a).toLowerCase())||"ucs-2"===a||"utf16le"===a||"utf-16le"===a)){if(e.length<2||t.length<2)return -1;s=2,o/=2,l/=2,n/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(r){var u=-1;for(i=n;i<o;i++)if(c(e,i)===c(t,-1===u?0:i-u)){if(-1===u&&(u=i),i-u+1===l)return u*s}else -1!==u&&(i-=i-u),u=-1}else for(n+l>o&&(n=o-l),i=n;i>=0;i--){for(var h=!0,d=0;d<l;d++)if(c(e,i+d)!==c(t,d)){h=!1;break}if(h)return i}return -1}o.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==o.prototype},o.compare=function(e,t){if(_(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),_(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(e)||!o.isBuffer(t))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var n=e.length,a=t.length,r=0,i=Math.min(n,a);r<i;++r)if(e[r]!==t[r]){n=e[r],a=t[r];break}return n<a?-1:+(a<n)},o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);if(void 0===t)for(n=0,t=0;n<e.length;++n)t+=e[n].length;var n,a=o.allocUnsafe(t),r=0;for(n=0;n<e.length;++n){var i=e[n];if(_(i,Uint8Array)&&(i=o.from(i)),!o.isBuffer(i))throw TypeError('"list" argument must be an Array of Buffers');i.copy(a,r),r+=i.length}return a},o.byteLength=p,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},o.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},o.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},o.prototype.toString=function(){var e=this.length;return 0===e?"":0==arguments.length?y(this,0,e):f.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(e){if(!o.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},i&&(o.prototype[i]=o.prototype.inspect),o.prototype.compare=function(e,t,n,a,r){if(_(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),!o.isBuffer(e))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===a&&(a=0),void 0===r&&(r=this.length),t<0||n>e.length||a<0||r>this.length)throw RangeError("out of range index");if(a>=r&&t>=n)return 0;if(a>=r)return -1;if(t>=n)return 1;if(t>>>=0,n>>>=0,a>>>=0,r>>>=0,this===e)return 0;for(var i=r-a,s=n-t,l=Math.min(i,s),c=this.slice(a,r),u=e.slice(t,n),h=0;h<l;++h)if(c[h]!==u[h]){i=c[h],s=u[h];break}return i<s?-1:+(s<i)},o.prototype.includes=function(e,t,n){return -1!==this.indexOf(e,t,n)},o.prototype.indexOf=function(e,t,n){return g(this,e,t,n,!0)},o.prototype.lastIndexOf=function(e,t,n){return g(this,e,t,n,!1)};function y(e,t,n){n=Math.min(e.length,n);for(var a=[],r=t;r<n;){var i,s,o,l,c=e[r],u=null,h=c>239?4:c>223?3:c>191?2:1;if(r+h<=n)switch(h){case 1:c<128&&(u=c);break;case 2:(192&(i=e[r+1]))==128&&(l=(31&c)<<6|63&i)>127&&(u=l);break;case 3:i=e[r+1],s=e[r+2],(192&i)==128&&(192&s)==128&&(l=(15&c)<<12|(63&i)<<6|63&s)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:i=e[r+1],s=e[r+2],o=e[r+3],(192&i)==128&&(192&s)==128&&(192&o)==128&&(l=(15&c)<<18|(63&i)<<12|(63&s)<<6|63&o)>65535&&l<1114112&&(u=l)}null===u?(u=65533,h=1):u>65535&&(u-=65536,a.push(u>>>10&1023|55296),u=56320|1023&u),a.push(u),r+=h}var d=a,p=d.length;if(p<=4096)return String.fromCharCode.apply(String,d);for(var f="",m=0;m<p;)f+=String.fromCharCode.apply(String,d.slice(m,m+=4096));return f}function b(e,t,n){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>n)throw RangeError("Trying to access beyond buffer length")}function v(e,t,n,a,r,i){if(!o.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<i)throw RangeError('"value" argument is out of bounds');if(n+a>e.length)throw RangeError("Index out of range")}function w(e,t,n,a,r,i){if(n+a>e.length||n<0)throw RangeError("Index out of range")}function N(e,t,n,a,i){return t*=1,n>>>=0,i||w(e,t,n,4,34028234663852886e22,-34028234663852886e22),r.write(e,t,n,a,23,4),n+4}function k(e,t,n,a,i){return t*=1,n>>>=0,i||w(e,t,n,8,17976931348623157e292,-17976931348623157e292),r.write(e,t,n,a,52,8),n+8}o.prototype.write=function(e,t,n,a){if(void 0===t)a="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)a=t,n=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(n)?(n>>>=0,void 0===a&&(a="utf8")):(a=n,n=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var r,i,s,o,l,c,u,h,d=this.length-t;if((void 0===n||n>d)&&(n=d),e.length>0&&(n<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");a||(a="utf8");for(var p=!1;;)switch(a){case"hex":return function(e,t,n,a){n=Number(n)||0;var r=e.length-n;a?(a=Number(a))>r&&(a=r):a=r;var i=t.length;a>i/2&&(a=i/2);for(var s=0;s<a;++s){var o,l=parseInt(t.substr(2*s,2),16);if((o=l)!=o)break;e[n+s]=l}return s}(this,e,t,n);case"utf8":case"utf-8":return r=t,i=n,E(C(e,this.length-r),this,r,i);case"ascii":return s=t,o=n,E(T(e),this,s,o);case"latin1":case"binary":return function(e,t,n,a){return E(T(t),e,n,a)}(this,e,t,n);case"base64":return l=t,c=n,E(I(e),this,l,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return u=t,h=n,E(function(e,t){for(var n,a,r=[],i=0;i<e.length&&!((t-=2)<0);++i)a=(n=e.charCodeAt(i))>>8,r.push(n%256),r.push(a);return r}(e,this.length-u),this,u,h);default:if(p)throw TypeError("Unknown encoding: "+a);a=(""+a).toLowerCase(),p=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},o.prototype.slice=function(e,t){var n=this.length;e=~~e,t=void 0===t?n:~~t,e<0?(e+=n)<0&&(e=0):e>n&&(e=n),t<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var a=this.subarray(e,t);return Object.setPrototypeOf(a,o.prototype),a},o.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||b(e,t,this.length);for(var a=this[e],r=1,i=0;++i<t&&(r*=256);)a+=this[e+i]*r;return a},o.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||b(e,t,this.length);for(var a=this[e+--t],r=1;t>0&&(r*=256);)a+=this[e+--t]*r;return a},o.prototype.readUInt8=function(e,t){return e>>>=0,t||b(e,1,this.length),this[e]},o.prototype.readUInt16LE=function(e,t){return e>>>=0,t||b(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUInt16BE=function(e,t){return e>>>=0,t||b(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUInt32LE=function(e,t){return e>>>=0,t||b(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+0x1000000*this[e+3]},o.prototype.readUInt32BE=function(e,t){return e>>>=0,t||b(e,4,this.length),0x1000000*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||b(e,t,this.length);for(var a=this[e],r=1,i=0;++i<t&&(r*=256);)a+=this[e+i]*r;return a>=(r*=128)&&(a-=Math.pow(2,8*t)),a},o.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||b(e,t,this.length);for(var a=t,r=1,i=this[e+--a];a>0&&(r*=256);)i+=this[e+--a]*r;return i>=(r*=128)&&(i-=Math.pow(2,8*t)),i},o.prototype.readInt8=function(e,t){return(e>>>=0,t||b(e,1,this.length),128&this[e])?-((255-this[e]+1)*1):this[e]},o.prototype.readInt16LE=function(e,t){e>>>=0,t||b(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?0xffff0000|n:n},o.prototype.readInt16BE=function(e,t){e>>>=0,t||b(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?0xffff0000|n:n},o.prototype.readInt32LE=function(e,t){return e>>>=0,t||b(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return e>>>=0,t||b(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readFloatLE=function(e,t){return e>>>=0,t||b(e,4,this.length),r.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return e>>>=0,t||b(e,4,this.length),r.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return e>>>=0,t||b(e,8,this.length),r.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return e>>>=0,t||b(e,8,this.length),r.read(this,e,!1,52,8)},o.prototype.writeUIntLE=function(e,t,n,a){if(e*=1,t>>>=0,n>>>=0,!a){var r=Math.pow(2,8*n)-1;v(this,e,t,n,r,0)}var i=1,s=0;for(this[t]=255&e;++s<n&&(i*=256);)this[t+s]=e/i&255;return t+n},o.prototype.writeUIntBE=function(e,t,n,a){if(e*=1,t>>>=0,n>>>=0,!a){var r=Math.pow(2,8*n)-1;v(this,e,t,n,r,0)}var i=n-1,s=1;for(this[t+i]=255&e;--i>=0&&(s*=256);)this[t+i]=e/s&255;return t+n},o.prototype.writeUInt8=function(e,t,n){return e*=1,t>>>=0,n||v(this,e,t,1,255,0),this[t]=255&e,t+1},o.prototype.writeUInt16LE=function(e,t,n){return e*=1,t>>>=0,n||v(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeUInt16BE=function(e,t,n){return e*=1,t>>>=0,n||v(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeUInt32LE=function(e,t,n){return e*=1,t>>>=0,n||v(this,e,t,4,0xffffffff,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},o.prototype.writeUInt32BE=function(e,t,n){return e*=1,t>>>=0,n||v(this,e,t,4,0xffffffff,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeIntLE=function(e,t,n,a){if(e*=1,t>>>=0,!a){var r=Math.pow(2,8*n-1);v(this,e,t,n,r-1,-r)}var i=0,s=1,o=0;for(this[t]=255&e;++i<n&&(s*=256);)e<0&&0===o&&0!==this[t+i-1]&&(o=1),this[t+i]=(e/s|0)-o&255;return t+n},o.prototype.writeIntBE=function(e,t,n,a){if(e*=1,t>>>=0,!a){var r=Math.pow(2,8*n-1);v(this,e,t,n,r-1,-r)}var i=n-1,s=1,o=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===o&&0!==this[t+i+1]&&(o=1),this[t+i]=(e/s|0)-o&255;return t+n},o.prototype.writeInt8=function(e,t,n){return e*=1,t>>>=0,n||v(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,n){return e*=1,t>>>=0,n||v(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeInt16BE=function(e,t,n){return e*=1,t>>>=0,n||v(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeInt32LE=function(e,t,n){return e*=1,t>>>=0,n||v(this,e,t,4,0x7fffffff,-0x80000000),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},o.prototype.writeInt32BE=function(e,t,n){return e*=1,t>>>=0,n||v(this,e,t,4,0x7fffffff,-0x80000000),e<0&&(e=0xffffffff+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeFloatLE=function(e,t,n){return N(this,e,t,!0,n)},o.prototype.writeFloatBE=function(e,t,n){return N(this,e,t,!1,n)},o.prototype.writeDoubleLE=function(e,t,n){return k(this,e,t,!0,n)},o.prototype.writeDoubleBE=function(e,t,n){return k(this,e,t,!1,n)},o.prototype.copy=function(e,t,n,a){if(!o.isBuffer(e))throw TypeError("argument should be a Buffer");if(n||(n=0),a||0===a||(a=this.length),t>=e.length&&(t=e.length),t||(t=0),a>0&&a<n&&(a=n),a===n||0===e.length||0===this.length)return 0;if(t<0)throw RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw RangeError("Index out of range");if(a<0)throw RangeError("sourceEnd out of bounds");a>this.length&&(a=this.length),e.length-t<a-n&&(a=e.length-t+n);var r=a-n;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,n,a);else if(this===e&&n<t&&t<a)for(var i=r-1;i>=0;--i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,a),t);return r},o.prototype.fill=function(e,t,n,a){if("string"==typeof e){if("string"==typeof t?(a=t,t=0,n=this.length):"string"==typeof n&&(a=n,n=this.length),void 0!==a&&"string"!=typeof a)throw TypeError("encoding must be a string");if("string"==typeof a&&!o.isEncoding(a))throw TypeError("Unknown encoding: "+a);if(1===e.length){var r,i=e.charCodeAt(0);("utf8"===a&&i<128||"latin1"===a)&&(e=i)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw RangeError("Out of range index");if(n<=t)return this;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(r=t;r<n;++r)this[r]=e;else{var s=o.isBuffer(e)?e:o.from(e,a),l=s.length;if(0===l)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(r=0;r<n-t;++r)this[r+t]=s[r%l]}return this};var S=/[^+/0-9A-Za-z-_]/g;function C(e,t){t=t||1/0;for(var n,a=e.length,r=null,i=[],s=0;s<a;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!r){if(n>56319||s+1===a){(t-=3)>-1&&i.push(239,191,189);continue}r=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),r=n;continue}n=(r-55296<<10|n-56320)+65536}else r&&(t-=3)>-1&&i.push(239,191,189);if(r=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else if(n<1114112){if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}else throw Error("Invalid code point")}return i}function T(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function I(e){return a.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(S,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function E(e,t,n,a){for(var r=0;r<a&&!(r+n>=t.length)&&!(r>=e.length);++r)t[r+n]=e[r];return r}function _(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}var A=function(){for(var e="0123456789abcdef",t=Array(256),n=0;n<16;++n)for(var a=16*n,r=0;r<16;++r)t[a+r]=e[n]+e[r];return t}()},783:function(e,t){t.read=function(e,t,n,a,r){var i,s,o=8*r-a-1,l=(1<<o)-1,c=l>>1,u=-7,h=n?r-1:0,d=n?-1:1,p=e[t+h];for(h+=d,i=p&(1<<-u)-1,p>>=-u,u+=o;u>0;i=256*i+e[t+h],h+=d,u-=8);for(s=i&(1<<-u)-1,i>>=-u,u+=a;u>0;s=256*s+e[t+h],h+=d,u-=8);if(0===i)i=1-c;else{if(i===l)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,a),i-=c}return(p?-1:1)*s*Math.pow(2,i-a)},t.write=function(e,t,n,a,r,i){var s,o,l,c=8*i-r-1,u=(1<<c)-1,h=u>>1,d=5960464477539062e-23*(23===r),p=a?0:i-1,f=a?1:-1,m=+(t<0||0===t&&1/t<0);for(isNaN(t=Math.abs(t))||t===1/0?(o=+!!isNaN(t),s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),s+h>=1?t+=d/l:t+=d*Math.pow(2,1-h),t*l>=2&&(s++,l/=2),s+h>=u?(o=0,s=u):s+h>=1?(o=(t*l-1)*Math.pow(2,r),s+=h):(o=t*Math.pow(2,h-1)*Math.pow(2,r),s=0));r>=8;e[n+p]=255&o,p+=f,o/=256,r-=8);for(s=s<<r|o,c+=r;c>0;e[n+p]=255&s,p+=f,s/=256,c-=8);e[n+p-f]|=128*m}}},n={};function a(t){var r=n[t];if(void 0!==r)return r.exports;var i=n[t]={exports:{}},s=!0;try{e[t](i,i.exports,a),s=!1}finally{s&&delete n[t]}return i.exports}a.ab="/ROOT/node_modules/next/dist/compiled/buffer/",t.exports=a(72)}()},1392,(e,t,n)=>{t.exports=r;var a=null;try{a=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function r(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function i(e){return!0===(e&&e.__isLong__)}r.prototype.__isLong__,Object.defineProperty(r.prototype,"__isLong__",{value:!0}),r.isLong=i;var s={},o={};function l(e,t){var n,a,r;if(t)return(e>>>=0,(r=0<=e&&e<256)&&(a=o[e]))?a:(n=u(e,(0|e)<0?-1:0,!0),r&&(o[e]=n),n);return(e|=0,(r=-128<=e&&e<128)&&(a=s[e]))?a:(n=u(e,e<0?-1:0,!1),r&&(s[e]=n),n)}function c(e,t){if(isNaN(e))return t?b:y;if(t){if(e<0)return b;if(e>=m)return S}else{if(e<=-g)return C;if(e+1>=g)return k}return e<0?c(-e,t).neg():u(e%f|0,e/f|0,t)}function u(e,t,n){return new r(e,t,n)}r.fromInt=l,r.fromNumber=c,r.fromBits=u;var h=Math.pow;function d(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return y;if("number"==typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");if((a=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===a)return d(e.substring(1),t,n).neg();for(var a,r=c(h(n,8)),i=y,s=0;s<e.length;s+=8){var o=Math.min(8,e.length-s),l=parseInt(e.substring(s,s+o),n);if(o<8){var u=c(h(n,o));i=i.mul(u).add(c(l))}else i=(i=i.mul(r)).add(c(l))}return i.unsigned=t,i}function p(e,t){return"number"==typeof e?c(e,t):"string"==typeof e?d(e,t):u(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}r.fromString=d,r.fromValue=p;var f=0x100000000,m=0xffffffffffffffff,g=0x8000000000000000,x=l(0x1000000),y=l(0);r.ZERO=y;var b=l(0,!0);r.UZERO=b;var v=l(1);r.ONE=v;var w=l(1,!0);r.UONE=w;var N=l(-1);r.NEG_ONE=N;var k=u(-1,0x7fffffff,!1);r.MAX_VALUE=k;var S=u(-1,-1,!0);r.MAX_UNSIGNED_VALUE=S;var C=u(0,-0x80000000,!1);r.MIN_VALUE=C;var T=r.prototype;T.toInt=function(){return this.unsigned?this.low>>>0:this.low},T.toNumber=function(){return this.unsigned?(this.high>>>0)*f+(this.low>>>0):this.high*f+(this.low>>>0)},T.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(!this.eq(C))return"-"+this.neg().toString(e);else{var t=c(e),n=this.div(t),a=n.mul(t).sub(this);return n.toString(e)+a.toInt().toString(e)}for(var r=c(h(e,6),this.unsigned),i=this,s="";;){var o=i.div(r),l=(i.sub(o.mul(r)).toInt()>>>0).toString(e);if((i=o).isZero())return l+s;for(;l.length<6;)l="0"+l;s=""+l+s}},T.getHighBits=function(){return this.high},T.getHighBitsUnsigned=function(){return this.high>>>0},T.getLowBits=function(){return this.low},T.getLowBitsUnsigned=function(){return this.low>>>0},T.getNumBitsAbs=function(){if(this.isNegative())return this.eq(C)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&(e&1<<t)==0;t--);return 0!=this.high?t+33:t+1},T.isZero=function(){return 0===this.high&&0===this.low},T.eqz=T.isZero,T.isNegative=function(){return!this.unsigned&&this.high<0},T.isPositive=function(){return this.unsigned||this.high>=0},T.isOdd=function(){return(1&this.low)==1},T.isEven=function(){return(1&this.low)==0},T.equals=function(e){return i(e)||(e=p(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},T.eq=T.equals,T.notEquals=function(e){return!this.eq(e)},T.neq=T.notEquals,T.ne=T.notEquals,T.lessThan=function(e){return 0>this.comp(e)},T.lt=T.lessThan,T.lessThanOrEqual=function(e){return 0>=this.comp(e)},T.lte=T.lessThanOrEqual,T.le=T.lessThanOrEqual,T.greaterThan=function(e){return this.comp(e)>0},T.gt=T.greaterThan,T.greaterThanOrEqual=function(e){return this.comp(e)>=0},T.gte=T.greaterThanOrEqual,T.ge=T.greaterThanOrEqual,T.compare=function(e){if(i(e)||(e=p(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},T.comp=T.compare,T.negate=function(){return!this.unsigned&&this.eq(C)?C:this.not().add(v)},T.neg=T.negate,T.add=function(e){i(e)||(e=p(e));var t,n,a=this.high>>>16,r=65535&this.high,s=this.low>>>16,o=65535&this.low,l=e.high>>>16,c=65535&e.high,h=e.low>>>16,d=65535&e.low,f=0,m=0;return t=0+((n=0+(o+d))>>>16),n&=65535,t+=s+h,m+=t>>>16,t&=65535,m+=r+c,f+=m>>>16,m&=65535,f+=a+l,u(t<<16|n,(f&=65535)<<16|m,this.unsigned)},T.subtract=function(e){return i(e)||(e=p(e)),this.add(e.neg())},T.sub=T.subtract,T.multiply=function(e){if(this.isZero())return y;if(i(e)||(e=p(e)),a)return u(a.mul(this.low,this.high,e.low,e.high),a.get_high(),this.unsigned);if(e.isZero())return y;if(this.eq(C))return e.isOdd()?C:y;if(e.eq(C))return this.isOdd()?C:y;if(this.isNegative())if(e.isNegative())return this.neg().mul(e.neg());else return this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(x)&&e.lt(x))return c(this.toNumber()*e.toNumber(),this.unsigned);var t,n,r=this.high>>>16,s=65535&this.high,o=this.low>>>16,l=65535&this.low,h=e.high>>>16,d=65535&e.high,f=e.low>>>16,m=65535&e.low,g=0,b=0;return t=0+((n=0+l*m)>>>16),n&=65535,t+=o*m,b+=t>>>16,t&=65535,t+=l*f,b+=t>>>16,t&=65535,b+=s*m,g+=b>>>16,b&=65535,b+=o*f,g+=b>>>16,b&=65535,b+=l*d,g+=b>>>16,b&=65535,g+=r*m+s*f+o*d+l*h,u(t<<16|n,(g&=65535)<<16|b,this.unsigned)},T.mul=T.multiply,T.divide=function(e){if(i(e)||(e=p(e)),e.isZero())throw Error("division by zero");if(a){var t,n,r;return this.unsigned||-0x80000000!==this.high||-1!==e.low||-1!==e.high?u((this.unsigned?a.div_u:a.div_s)(this.low,this.high,e.low,e.high),a.get_high(),this.unsigned):this}if(this.isZero())return this.unsigned?b:y;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return b;if(e.gt(this.shru(1)))return w;r=b}else{if(this.eq(C))if(e.eq(v)||e.eq(N))return C;else return e.eq(C)?v:(t=this.shr(1).div(e).shl(1)).eq(y)?e.isNegative()?v:N:(n=this.sub(e.mul(t)),r=t.add(n.div(e)));if(e.eq(C))return this.unsigned?b:y;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();r=y}for(n=this;n.gte(e);){for(var s=Math.ceil(Math.log(t=Math.max(1,Math.floor(n.toNumber()/e.toNumber())))/Math.LN2),o=s<=48?1:h(2,s-48),l=c(t),d=l.mul(e);d.isNegative()||d.gt(n);)t-=o,d=(l=c(t,this.unsigned)).mul(e);l.isZero()&&(l=v),r=r.add(l),n=n.sub(d)}return r},T.div=T.divide,T.modulo=function(e){return(i(e)||(e=p(e)),a)?u((this.unsigned?a.rem_u:a.rem_s)(this.low,this.high,e.low,e.high),a.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},T.mod=T.modulo,T.rem=T.modulo,T.not=function(){return u(~this.low,~this.high,this.unsigned)},T.and=function(e){return i(e)||(e=p(e)),u(this.low&e.low,this.high&e.high,this.unsigned)},T.or=function(e){return i(e)||(e=p(e)),u(this.low|e.low,this.high|e.high,this.unsigned)},T.xor=function(e){return i(e)||(e=p(e)),u(this.low^e.low,this.high^e.high,this.unsigned)},T.shiftLeft=function(e){return(i(e)&&(e=e.toInt()),0==(e&=63))?this:e<32?u(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):u(0,this.low<<e-32,this.unsigned)},T.shl=T.shiftLeft,T.shiftRight=function(e){return(i(e)&&(e=e.toInt()),0==(e&=63))?this:e<32?u(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):u(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},T.shr=T.shiftRight,T.shiftRightUnsigned=function(e){if(i(e)&&(e=e.toInt()),0==(e&=63))return this;var t=this.high;return e<32?u(this.low>>>e|t<<32-e,t>>>e,this.unsigned):32===e?u(t,0,this.unsigned):u(t>>>e-32,0,this.unsigned)},T.shru=T.shiftRightUnsigned,T.shr_u=T.shiftRightUnsigned,T.toSigned=function(){return this.unsigned?u(this.low,this.high,!1):this},T.toUnsigned=function(){return this.unsigned?this:u(this.low,this.high,!0)},T.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},T.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},T.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},r.fromBytes=function(e,t,n){return n?r.fromBytesLE(e,t):r.fromBytesBE(e,t)},r.fromBytesLE=function(e,t){return new r(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},r.fromBytesBE=function(e,t){return new r(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},87741,(e,t,n)=>{!function(t,n,a){function r(e){var t,n=this,a=(t=0xefc8249d,function(e){e=String(e);for(var n=0;n<e.length;n++){var a=.02519603282416938*(t+=e.charCodeAt(n));t=a>>>0,a-=t,a*=t,t=a>>>0,a-=t,t+=0x100000000*a}return(t>>>0)*23283064365386963e-26});n.next=function(){var e=2091639*n.s0+23283064365386963e-26*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=e-(n.c=0|e)},n.c=1,n.s0=a(" "),n.s1=a(" "),n.s2=a(" "),n.s0-=a(e),n.s0<0&&(n.s0+=1),n.s1-=a(e),n.s1<0&&(n.s1+=1),n.s2-=a(e),n.s2<0&&(n.s2+=1)}function i(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function s(e,t){var n=new r(e),a=t&&t.state,s=n.next;return s.int32=function(){return 0x100000000*n.next()|0},s.double=function(){return s()+(2097152*s()|0)*11102230246251565e-32},s.quick=s,a&&("object"==typeof a&&i(a,n),s.state=function(){return i(n,{})}),s}if(n&&n.exports)n.exports=s;else if(a&&a.amd)e.r,void 0!==s&&e.v(s);else this.alea=s}(e.e,t,"function"==typeof define&&define)},89057,(e,t,n)=>{!function(t,n,a){function r(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var a=0;a<n.length+64;a++)t.x^=n.charCodeAt(a),t.next()}function i(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function s(e,t){var n=new r(e),a=t&&t.state,s=function(){return(n.next()>>>0)/0x100000000};return s.double=function(){do var e=((n.next()>>>11)+(n.next()>>>0)/0x100000000)/2097152;while(0===e)return e},s.int32=n.next,s.quick=s,a&&("object"==typeof a&&i(a,n),s.state=function(){return i(n,{})}),s}if(n&&n.exports)n.exports=s;else if(a&&a.amd)e.r,void 0!==s&&e.v(s);else this.xor128=s}(e.e,t,"function"==typeof define&&define)},26605,(e,t,n)=>{!function(t,n,a){function r(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^(e^e<<1))|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var a=0;a<n.length+64;a++)t.x^=n.charCodeAt(a),a==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function i(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function s(e,t){var n=new r(e),a=t&&t.state,s=function(){return(n.next()>>>0)/0x100000000};return s.double=function(){do var e=((n.next()>>>11)+(n.next()>>>0)/0x100000000)/2097152;while(0===e)return e},s.int32=n.next,s.quick=s,a&&("object"==typeof a&&i(a,n),s.state=function(){return i(n,{})}),s}if(n&&n.exports)n.exports=s;else if(a&&a.amd)e.r,void 0!==s&&e.v(s);else this.xorwow=s}(e.e,t,"function"==typeof define&&define)},58753,(e,t,n)=>{!function(t,n,a){function r(e){var t=this;t.next=function(){var e,n,a=t.x,r=t.i;return e=a[r],e^=e>>>7,n=e^e<<24^((e=a[r+1&7])^e>>>10)^((e=a[r+3&7])^e>>>3)^((e=a[r+4&7])^e<<7),e=a[r+7&7],e^=e<<13,n^=e^e<<9,a[r]=n,t.i=r+1&7,n};var n,a=e,r=[];if(a===(0|a))r[0]=a;else for(n=0,a=""+a;n<a.length;++n)r[7&n]=r[7&n]<<15^a.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],t.x=r,t.i=0,n=256;n>0;--n)t.next()}function i(e,t){return t.x=e.x.slice(),t.i=e.i,t}function s(e,t){null==e&&(e=+new Date);var n=new r(e),a=t&&t.state,s=function(){return(n.next()>>>0)/0x100000000};return s.double=function(){do var e=((n.next()>>>11)+(n.next()>>>0)/0x100000000)/2097152;while(0===e)return e},s.int32=n.next,s.quick=s,a&&(a.x&&i(a,n),s.state=function(){return i(n,{})}),s}if(n&&n.exports)n.exports=s;else if(a&&a.amd)e.r,void 0!==s&&e.v(s);else this.xorshift7=s}(e.e,t,"function"==typeof define&&define)},25600,(e,t,n)=>{!function(t,n,a){function r(e){var t=this;t.next=function(){var e,n,a=t.w,r=t.X,i=t.i;return t.w=a=a+0x61c88647|0,n=r[i+34&127],e=r[i=i+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=r[i]=n^e,t.i=i,n+(a^a>>>16)|0},!function(e,t){var n,a,r,i,s,o=[],l=128;for(t===(0|t)?(a=t,t=null):(t+="\0",a=0,l=Math.max(l,t.length)),r=0,i=-32;i<l;++i)t&&(a^=t.charCodeAt((i+32)%t.length)),0===i&&(s=a),a^=a<<10,a^=a>>>15,a^=a<<4,a^=a>>>13,i>=0&&(s=s+0x61c88647|0,r=0==(n=o[127&i]^=a+s)?r+1:0);for(r>=128&&(o[127&(t&&t.length||0)]=-1),r=127,i=512;i>0;--i)a=o[r+34&127],n=o[r=r+1&127],a^=a<<13,n^=n<<17,a^=a>>>15,n^=n>>>12,o[r]=a^n;e.w=s,e.X=o,e.i=r}(t,e)}function i(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function s(e,t){null==e&&(e=+new Date);var n=new r(e),a=t&&t.state,s=function(){return(n.next()>>>0)/0x100000000};return s.double=function(){do var e=((n.next()>>>11)+(n.next()>>>0)/0x100000000)/2097152;while(0===e)return e},s.int32=n.next,s.quick=s,a&&(a.X&&i(a,n),s.state=function(){return i(n,{})}),s}if(n&&n.exports)n.exports=s;else if(a&&a.amd)e.r,void 0!==s&&e.v(s);else this.xor4096=s}(e.e,t,"function"==typeof define&&define)},14038,(e,t,n)=>{!function(t,n,a){function r(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,a=t.d,r=t.a;return e=e<<25^e>>>7^n,n=n-a|0,a=a<<24^a>>>8^r,r=r-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-a|0,t.d=a<<16^n>>>16^r,t.a=r-e|0},t.a=0,t.b=0,t.c=-0x61c88647,t.d=0x517cc1b7,e===Math.floor(e)?(t.a=e/0x100000000|0,t.b=0|e):n+=e;for(var a=0;a<n.length+20;a++)t.b^=n.charCodeAt(a),t.next()}function i(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function s(e,t){var n=new r(e),a=t&&t.state,s=function(){return(n.next()>>>0)/0x100000000};return s.double=function(){do var e=((n.next()>>>11)+(n.next()>>>0)/0x100000000)/2097152;while(0===e)return e},s.int32=n.next,s.quick=s,a&&("object"==typeof a&&i(a,n),s.state=function(){return i(n,{})}),s}if(n&&n.exports)n.exports=s;else if(a&&a.amd)e.r,void 0!==s&&e.v(s);else this.tychei=s}(e.e,t,"function"==typeof define&&define)},32034,(e,t,n)=>{!function(n,a,r){var i,s="random",o=r.pow(256,6),l=r.pow(2,52),c=2*l;function u(e,t,u){var m=[],g=p(function e(t,n){var a,r=[],i=typeof t;if(n&&"object"==i)for(a in t)try{r.push(e(t[a],n-1))}catch(e){}return r.length?r:"string"==i?t:t+"\0"}((t=!0==t?{entropy:!0}:t||{}).entropy?[e,f(a)]:null==e?function(){try{var e;return i&&(e=i.randomBytes)?e=e(256):(e=new Uint8Array(256),(n.crypto||n.msCrypto).getRandomValues(e)),f(e)}catch(e){var t=n.navigator,r=t&&t.plugins;return[+new Date,n,r,n.screen,f(a)]}}():e,3),m),x=new h(m),y=function(){for(var e=x.g(6),t=o,n=0;e<l;)e=(e+n)*256,t*=256,n=x.g(1);for(;e>=c;)e/=2,t/=2,n>>>=1;return(e+n)/t};return y.int32=function(){return 0|x.g(4)},y.quick=function(){return x.g(4)/0x100000000},y.double=y,p(f(x.S),a),(t.pass||u||function(e,t,n,a){return(a&&(a.S&&d(a,x),e.state=function(){return d(x,{})}),n)?(r[s]=e,t):e})(y,g,"global"in t?t.global:this==r,t.state)}function h(e){var t,n=e.length,a=this,r=0,i=a.i=a.j=0,s=a.S=[];for(n||(e=[n++]);r<256;)s[r]=r++;for(r=0;r<256;r++)s[r]=s[i=255&i+e[r%n]+(t=s[r])],s[i]=t;(a.g=function(e){for(var t,n=0,r=a.i,i=a.j,s=a.S;e--;)t=s[r=255&r+1],n=256*n+s[255&(s[r]=s[i=255&i+t])+(s[i]=t)];return a.i=r,a.j=i,n})(256)}function d(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function p(e,t){for(var n,a=e+"",r=0;r<a.length;)t[255&r]=255&(n^=19*t[255&r])+a.charCodeAt(r++);return f(t)}function f(e){return String.fromCharCode.apply(0,e)}if(p(r.random(),a),t.exports){t.exports=u;try{i={}}catch(e){}}else if("function"==typeof define&&define.amd)e.r,void 0!==u&&e.v(u);else r["seed"+s]=u}("undefined"!=typeof self?self:e.e,[],Math)},89378,(e,t,n)=>{var a=e.r(87741),r=e.r(89057),i=e.r(26605),s=e.r(58753),o=e.r(25600),l=e.r(14038),c=e.r(32034);c.alea=a,c.xor128=r,c.xorwow=i,c.xorshift7=s,c.xor4096=o,c.tychei=l,t.exports=c},21994,e=>{"use strict";let t,n,a,r,i,s,o,l;e.s(["default",()=>IQ],21994);var c,u,h,d,p,f,m,g,x,y,b,v,w,N,k,S=e.i(43476),C=e.i(71645),T=e.i(46932);class I{get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}}class E{refCount(e){return _("refCount")}incRef(e){return _("incRef")}timerAvailable(){return!0}time(e){return _("time")}read(e){return _("read")}readSync(e){return _("readSync")}readToGPU(e,t){return _("readToGPU")}numDataIds(){return _("numDataIds")}disposeData(e,t){return _("disposeData")}write(e,t,n){return _("write")}move(e,t,n,a,r){return _("move")}createTensorFromGPUData(e,t,n){return _("createTensorFromGPUData")}memory(){return _("memory")}floatPrecision(){return _("floatPrecision")}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}dispose(){return _("dispose")}}function _(e){throw Error("'".concat(e,"' not yet implemented or not found in the registry. ")+"This kernel may not be supported by the tfjs backend you have chosen")}function A(e){let t=e.length,n=0;for(;t>0;)n=Math.random()*t|0,F(e,--t,n)}function R(e,t){if(e.length!==t.length)throw Error("Array sizes must match to be shuffled together "+"First array length was ".concat(e.length)+"Second array length was ".concat(t.length));let n=e.length,a=0;for(;n>0;)a=Math.random()*n|0,F(e,--n,a),F(t,n,a)}function D(e,t,n){return Math.max(e,Math.min(t,n))}function M(e){return e%2==0?e:e+1}function F(e,t,n){let a=e[t];e[t]=e[n],e[n]=a}function O(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t}function P(e,t){let n=Math.random();return t*n+(1-n)*e}function j(e,t){let n=0;for(let a=0;a<e.length;a++){let r=Number(e[a])-Number(t[a]);n+=r*r}return n}function L(e,t){if(!e)throw Error("string"==typeof t?t:t())}function z(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";L(G(e,t),()=>n+" Shapes ".concat(e," and ").concat(t," must match"))}function B(e){L(null!=e,()=>"The input to the tensor constructor must be a non-null value.")}function V(e){if(0===e.length)return 1;let t=e[0];for(let n=1;n<e.length;n++)t*=e[n];return t}function U(e){return 0===e.length}function W(e,t){if(e===t)return!0;if(null==e||null==t||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(null!==e[n]&&null!==t[n]&&e[n]!==t[n])return!1;return!0}function G(e,t){if(e===t)return!0;if(null==e||null==t||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function H(e){return e%1==0}function q(e){if(null!=Math.tanh)return Math.tanh(e);if(e===1/0)return 1;{if(e===-1/0)return -1;let t=Math.exp(2*e);return(t-1)/(t+1)}}function K(e){let t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function X(e){let t=new Uint32Array(e);for(let n=0;n<e;++n)t[n]=n;return A(t),t}function Y(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function Z(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>0,n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;return new Promise((r,i)=>{let s=0,o=()=>{if(e())return void r();let l=t(++s);if(null!=n&&s>=n)return void i();null!=a?a(o,l):setTimeout(o,l)};o()})}function Q(e,t){let n=1,a=-1;for(let t=0;t<e.length;++t)if(e[t]>=0)n*=e[t];else if(-1===e[t]){if(-1!==a)throw Error("Shapes can only have 1 implicit size. "+"Found -1 at dim ".concat(a," and dim ").concat(t));a=t}else if(e[t]<0)throw Error("Shapes can not be < 0. Found ".concat(e[t]," at dim ").concat(t));if(-1===a){if(t>0&&t!==n)throw Error("Size(".concat(t,") must match the product of shape ").concat(e));return e}if(0===n)throw Error("Cannot infer the missing size in [".concat(e,"] when ")+"there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. "+"Got ".concat(t," / ").concat(n));let r=e.slice();return r[a]=t/n,r}function J(e,t){let n=t.length;return L((e=null==e?t.map((e,t)=>t):[].concat(e)).every(e=>e>=-n&&e<n),()=>"All values in axis param must be in range [-".concat(n,", ").concat(n,") but ")+"got axis ".concat(e)),L(e.every(e=>H(e)),()=>"All values in axis param must be integers but "+"got axis ".concat(e)),e.map(e=>e<0?n+e:e)}function $(e,t){let n=[],a=[],r=null!=t&&Array.isArray(t)&&0===t.length,i=null==t||r?null:J(t,e).sort(),s=0;for(let t=0;t<e.length;++t){if(null!=i){if(i[s]===t&&1!==e[t])throw Error("Can't squeeze axis ".concat(t," since its dim '").concat(e[t],"' is not 1"));(null==i[s]||i[s]>t)&&1===e[t]&&(n.push(e[t]),a.push(t)),i[s]<=t&&s++}1!==e[t]&&(n.push(e[t]),a.push(t))}return{newShape:n,keptDims:a}}function ee(e,t){return et(e,t)}function et(e,t){let n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else if("string"===e)n=Array(t);else throw Error("Unknown data type ".concat(e));return n}function en(e,t){for(let n=0;n<e.length;n++){let a=e[n];if(isNaN(a)||!isFinite(a))throw Error("A tensor of type ".concat(t," being uploaded contains ").concat(a,"."))}}function ea(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}function er(e,t){return"complex64"!==t&&("float32"!==t||"complex64"===e)&&("int32"!==t||"float32"===e||"complex64"===e)&&("bool"!==t||"bool"!==e)}function ei(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw Error("Unknown dtype ".concat(e))}function es(e){if(null==e)return 0;let t=0;return e.forEach(e=>t+=e.length),t}function eo(e){return"string"==typeof e||e instanceof String}function el(e){return"boolean"==typeof e}function ec(e){return"number"==typeof e}function eu(e){if(Array.isArray(e))return eu(e[0]);if(e instanceof Float32Array);else if(e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray)return"int32";else if(ec(e));else if(eo(e))return"string";else if(el(e))return"bool";return"float32"}function eh(e){return!!(e&&e.constructor&&e.call&&e.apply)}function ed(e,t){for(let n=t;n<e;++n)if(e%n==0)return n;return e}function ep(e){let t=e.length;if(t<2)return[];let n=Array(t-1);n[t-2]=e[t-1];for(let a=t-3;a>=0;--a)n[a]=n[a+1]*e[a+1];return n}function ef(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===e.length)return t[0];let a=e.reduce((e,t)=>e*t)*(n?2:1);if(0===a)return[];if(a!==t.length)throw Error("[".concat(e,"] does not match the input size ").concat(t.length).concat(n?" for a complex tensor":"","."));return function e(t,n,a){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=[];if(1===n.length){let e=n[0]*(r?2:1);for(let n=0;n<e;n++)i[n]=a[t+n]}else{let s=n[0],o=n.slice(1),l=o.reduce((e,t)=>e*t)*(r?2:1);for(let n=0;n<s;n++)i[n]=e(t+n*l,o,a,r)}return i}(0,e,t,n)}function em(e,t){if(Array.isArray(e))return e;if("float32"===t)return e instanceof Float32Array?e:new Float32Array(e);if("int32"===t)return e instanceof Int32Array?e:new Int32Array(e);if("bool"===t||"string"===t)return Uint8Array.from(new Int32Array(e));throw Error("Unknown dtype ".concat(t))}function eg(e,t){let n=ex(e,t);for(let e=0;e<n.length;e++)n[e]=1;return n}function ex(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw Error("Unknown data type ".concat(t))}function ey(e,t){let n=e.reduce((e,t)=>e*t,1);if(null==t||"float32"===t)return ef(e,new Float32Array(n));if("int32"===t)return ef(e,new Int32Array(n));if("bool"===t)return ef(e,new Uint8Array(n));throw Error("Unknown data type ".concat(t))}function eb(e){e.forEach(t=>{L(Number.isInteger(t)&&t>=0,()=>"Tensor must have a shape comprised of positive integers but got "+"shape [".concat(e,"]."))})}function ev(e,t,n){if(0===t)return 0;if(1===t)return e[0];let a=e[e.length-1];for(let t=0;t<e.length-1;++t)a+=n[t]*e[t];return a}function ew(e,t,n){if(0===t)return[];if(1===t)return[e];let a=Array(t);for(let t=0;t<a.length-1;++t)a[t]=Math.floor(e/n[t]),e-=a[t]*n[t];return a[a.length-1]=e,a}function eN(e){return e&&e.then&&"function"==typeof e.then}e.s(["arraysEqual",()=>G,"arraysEqualWithNull",()=>W,"assert",()=>L,"assertNonNegativeIntegerDimensions",()=>eb,"assertNonNull",()=>B,"assertShapesMatch",()=>z,"bytesFromStringArray",()=>es,"bytesPerElement",()=>ei,"checkConversionForErrors",()=>en,"clamp",()=>D,"computeStrides",()=>ep,"convertBackendValuesAndArrayBuffer",()=>em,"createShuffledIndices",()=>X,"distSquared",()=>j,"getArrayFromDType",()=>et,"getTypedArrayFromDType",()=>ee,"hasEncodingLoss",()=>er,"indexToLoc",()=>ew,"inferDtype",()=>eu,"inferFromImplicitShape",()=>Q,"isBoolean",()=>el,"isFunction",()=>eh,"isInt",()=>H,"isNumber",()=>ec,"isPromise",()=>eN,"isScalarShape",()=>U,"isString",()=>eo,"isValidDtype",()=>ea,"locToIndex",()=>ev,"makeOnesTypedArray",()=>eg,"makeZerosNestedTypedArray",()=>ey,"makeZerosTypedArray",()=>ex,"nearestDivisor",()=>ed,"nearestLargerEven",()=>M,"parseAxisParam",()=>J,"randUniform",()=>P,"repeatedTry",()=>Z,"rightPad",()=>Y,"shuffle",()=>A,"shuffleCombo",()=>R,"sizeFromShape",()=>V,"sizeToSquarishShape",()=>K,"squeezeShape",()=>$,"sum",()=>O,"swap",()=>F,"tanh",()=>q,"toNestedArray",()=>ef],86879);let ek="tfjsflags";class eS{setPlatform(e,t){null==this.platform||eT.getBool("IS_TEST")||eT.getBool("PROD")||console.warn("Platform ".concat(this.platformName," has already been set. ")+"Overwriting the platform with ".concat(e,".")),this.platformName=e,this.platform=t}registerFlag(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){let t=this.urlFlags[e];eT.getBool("IS_TEST")||eT.getBool("PROD")||console.warn("Setting feature override from URL ".concat(e,": ").concat(t,".")),this.set(e,t)}}async getAsync(e){return e in this.flags||(this.flags[e]=await this.evaluateFlag(e)),this.flags[e]}get(e){if(e in this.flags)return this.flags[e];let t=this.evaluateFlag(e);if(eN(t))throw Error("Flag ".concat(e," cannot be synchronously evaluated. ")+"Please use getAsync() instead.");return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(null==this.flagRegistry[e])throw Error("Cannot set flag ".concat(e," as it has not been registered."));this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(null==this.flagRegistry[e])throw Error("Cannot evaluate flag '".concat(e,"': no evaluation function found."));return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(void 0===this.global||void 0===this.global.location||void 0===this.global.location.search)return;let e=this.getQueryParams(this.global.location.search);ek in e&&e[ek].split(",").forEach(e=>{let[t,n]=e.split(":");this.urlFlags[t]=function(e,t){let n=t.toLowerCase();return"true"===n||"false"===n?"true"===n:"".concat(+n)===n?+n:t}(0,n)})}constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=eC,this.populateURLFlags()}}function eC(e){let t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(e){for(var n,a,r,i=arguments.length,s=Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];return n=t,a=s[0],r=s[1],n[decodeURIComponent(a)]=decodeURIComponent(r||""),s.join("=")}),t}let eT=null;function eI(){if(null==t){let n;t=n="undefined"!=typeof window?window:e.g}return t}function eE(e,t){let n=function(){let e=eI();return null==e._tfGlobals&&(e._tfGlobals=new Map),e._tfGlobals}();if(n.has(e))return n.get(e);{let a=t();return n.set(e,a),n.get(e)}}let e_="Acos",eA="Acosh",eR="AddN",eD="ArgMax",eM="ArgMin",eF="Asin",eO="Asinh",eP="Atan",ej="Atanh",eL="Atan2",ez="AvgPool",eB="AvgPoolGrad",eV="AvgPool3D",eU="AvgPool3DGrad",eW="BatchMatMul",eG="BatchToSpaceND",eH="Bincount",eq="BitwiseAnd",eK="BroadcastArgs",eX="Cast",eY="Ceil",eZ="ClipByValue",eQ="Complex",eJ="ComplexAbs",e$="Concat",e0="Conv2D",e1="Conv2DBackpropFilter",e2="Conv2DBackpropInput",e3="Conv3D",e4="Conv3DBackpropFilterV2",e5="Conv3DBackpropInputV2",e6="Cosh",e8="Cumprod",e9="Cumsum",e7="CropAndResize",te="DenseBincount",tt="DepthToSpace",tn="DepthwiseConv2dNative",ta="DepthwiseConv2dNativeBackpropFilter",tr="DepthwiseConv2dNativeBackpropInput",ti="Diag",ts="Dilation2D",to="Dilation2DBackpropInput",tl="Dilation2DBackpropFilter",tc="Draw",tu="RealDiv",th="Einsum",td="EluGrad",tp="Equal",tf="ExpandDims",tm="Expm1",tg="Fill",tx="FlipLeftRight",ty="Floor",tb="FloorDiv",tv="FusedBatchNorm",tw="GatherV2",tN="GatherNd",tk="Greater",tS="GreaterEqual",tC="Identity",tT="IFFT",tI="Imag",tE="IsFinite",t_="IsInf",tA="IsNan",tR="LeakyRelu",tD="Less",tM="LessEqual",tF="LinSpace",tO="Log1p",tP="LogicalAnd",tj="LogicalNot",tL="LogicalOr",tz="LRNGrad",tB="Maximum",tV="MaxPool",tU="MaxPoolGrad",tW="MaxPool3D",tG="MaxPool3DGrad",tH="MaxPoolWithArgmax",tq="Mean",tK="Minimum",tX="MirrorPad",tY="Multinomial",tZ="Multiply",tQ="NotEqual",tJ="NonMaxSuppressionV3",t$="NonMaxSuppressionV4",t0="NonMaxSuppressionV5",t1="OnesLike",t2="OneHot",t3="Pack",t4="PadV2",t5="Prelu",t6="Prod",t8="RaggedGather",t9="RaggedRange",t7="RaggedTensorToTensor",ne="Range",nt="Real",nn="Reciprocal",na="Relu",nr="Reshape",ni="ResizeNearestNeighbor",ns="ResizeNearestNeighborGrad",no="ResizeBilinear",nl="ResizeBilinearGrad",nc="Relu6",nu="Reverse",nh="Round",nd="Rsqrt",np="ScatterNd",nf="TensorScatterUpdate",nm="SearchSorted",ng="Select",nx="Selu",ny="Slice",nb="Sinh",nv="Sign",nw="Sigmoid",nN="Softplus",nk="Sqrt",nS="SpaceToBatchND",nC="SplitV",nT="Softmax",nI="SparseFillEmptyRows",nE="SparseReshape",n_="SparseSegmentMean",nA="SparseSegmentSum",nR="SparseToDense",nD="SquaredDifference",nM="Square",nF="StaticRegexReplace",nO="StridedSlice",nP="StringNGrams",nj="StringSplit",nL="StringToHashBucketFast",nz="Tanh",nB="Tile",nV="TopK",nU="Transform",nW="Transpose",nG="Unique",nH="Unpack",nq="UnsortedSegmentSum",nK="ZerosLike",nX="Step",nY="FromPixels",nZ="RotateWithOffset",nQ="_FusedMatMul",nJ="FusedConv2D",n$="FusedDepthwiseConv2D";function n0(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];eT.getBool("IS_TEST")||eT.getBool("PROD")||console.warn(...t)}function n1(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];eT.getBool("IS_TEST")||eT.getBool("PROD")||console.log(...t)}e.s(["log",()=>n1,"warn",()=>n0],71070);let n2=eE("kernelRegistry",()=>new Map),n3=eE("gradRegistry",()=>new Map);function n4(e,t){let n=n8(e,t);return n2.get(n)}function n5(e){let t=n2.entries(),n=[];for(;;){let{done:a,value:r}=t.next();if(a)break;let[i,s]=r,[o]=i.split("_");o===e&&n.push(s)}return n}function n6(e){let{kernelName:t,backendName:n}=e,a=n8(t,n);n2.has(a)&&n0("The kernel '".concat(t,"' for backend ")+"'".concat(n,"' is already registered")),n2.set(a,e)}function n8(e,t){return"".concat(t,"_").concat(e)}function n9(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}function n7(e,t){return"string"===t?aa(e):ae([e],t)}function ae(e,t){var n;if("string"===t)throw Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=as(e)),eT.getBool("DEBUG")&&en(e,t),(n=e)instanceof Float32Array&&"float32"===t||n instanceof Int32Array&&"int32"===t||n instanceof Uint8Array&&"bool"===t)return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){let t=new Uint8Array(e.length);for(let n=0;n<t.length;++n)0!==Math.round(e[n])&&(t[n]=1);return t}throw Error("Unknown data type ".concat(t))}function at(){return eT.platform.now()}function an(e,t){return eT.platform.fetch(e,t)}function aa(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",eT.platform.encode(e,t)}function ar(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",eT.platform.decode(e,t)}function ai(e){return null!=eT.platform.isTypedArray?eT.platform.isTypedArray(e):n9(e)}function as(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t&&(t=[]),"boolean"==typeof e||"number"==typeof e||"string"==typeof e||eN(e)||null==e||ai(e)&&n)t.push(e);else if(Array.isArray(e)||ai(e))for(let a=0;a<e.length;++a)as(e[a],t,n);else{let a=-1;for(let t of Object.keys(e))/^([1-9]+[0-9]*|0)$/.test(t)&&(a=Math.max(a,Number(t)));for(let r=0;r<=a;r++)as(e[r],t,n)}return t}e.s(["createScalarValue",()=>n7,"decodeString",()=>ar,"encodeString",()=>aa,"fetch",()=>an,"flatten",()=>as,"isTypedArray",()=>ai,"now",()=>at,"toTypedArray",()=>ae],91587);class ao{profileKernel(e,t,n){let a,r,i=()=>{a=n()},s=at();if(this.backendTimer.timerAvailable())r=this.backendTimer.time(i);else{for(let e of(i(),a))e.dataSync();r=Promise.resolve({kernelMs:at()-s})}if(eT.getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let t=0;t<a.length;t++){let n=a[t];n.data().then(t=>{!function(e,t,n){if("float32"===t)for(let t=0;t<e.length;t++){let a=e[t];if(isNaN(a)||!isFinite(a))return console.warn("Found ".concat(a," in the result of '").concat(n,"'")),!0}}(t,n.dtype,e)})}return{kernelName:e,outputs:a,inputs:t,timeMs:r.then(e=>e.kernelMs),extraInfo:r.then(e=>null!=e.getExtraProfileInfo?e.getExtraProfileInfo():"")}}logKernelProfile(e){let{kernelName:t,outputs:n,timeMs:a,inputs:r,extraInfo:i}=e;n.forEach(e=>{Promise.all([e.data(),a,i]).then(n=>{this.logger.logKernelProfile(t,e,n[0],n[1],r,n[2])})})}constructor(e,t){this.backendTimer=e,this.logger=t,null==t&&(this.logger=new al)}}class al{logKernelProfile(e,t,n,a,r,i){let s="number"==typeof a?Y("".concat(a,"ms"),9):a.error,o=Y(e,25),l=t.rank,c=t.size,u=Y(t.shape.toString(),14),h="";for(let e in r){let n=r[e];if(null!=n){let a=n.shape||t.shape,r=a.length;h+="".concat(e,": ").concat(r,"D ").concat(r>0?a:""," ")}}console.log("%c".concat(o,"	%c").concat(s,"	%c").concat(l,"D ").concat(u,"	%c").concat(c,"	%c").concat(h,"	%c").concat(i),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}function ac(e,t,n){return Y(Array.isArray(e)?"".concat(parseFloat(e[0].toFixed(7))," + ")+"".concat(parseFloat(e[1].toFixed(7)),"j"):eo(e)?"'".concat(e,"'"):"bool"===n?au(e):parseFloat(e.toFixed(7)).toString(),t)}function au(e){return 0===e?"false":"true"}function ah(e){let t=[];for(let n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}class ad{set(e){for(var t=arguments.length,n=Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];0===n.length&&(n=[0]),L(n.length===this.rank,()=>"The number of provided coordinates (".concat(n.length,") must ")+"match the rank (".concat(this.rank,")"));let r=this.locToIndex(n);this.values[r]=e}get(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];0===t.length&&(t=[0]);let a=0;for(let e of t){if(e<0||e>=this.shape[a])throw Error("Requested out of range element at ".concat(t,". ")+"  Buffer shape=".concat(this.shape));a++}let r=t[t.length-1];for(let e=0;e<t.length-1;++e)r+=this.strides[e]*t[e];return this.values[r]}locToIndex(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];let t=e[e.length-1];for(let n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}indexToLoc(e){if(0===this.rank)return[];if(1===this.rank)return[e];let t=Array(this.shape.length);for(let n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return ap().makeTensor(this.values,this.shape,this.dtype)}constructor(e,t,n){if(this.dtype=t,this.shape=e.slice(),this.size=V(e),null!=n){let e=n.length;L(e===this.size,()=>"Length of values '".concat(e,"' does not match the size ")+"inferred by the shape '".concat(this.size,"'."))}if("complex64"===t)throw Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||et(t,this.size),this.strides=ep(e)}}let ap=null,af=null;class am{get rank(){return this.shape.length}async buffer(){let e=await this.data();return af.buffer(this.shape,this.dtype,e)}bufferSync(){return af.buffer(this.shape,this.dtype,this.dataSync())}async array(){let e=await this.data();return ef(this.shape,e,"complex64"===this.dtype)}arraySync(){return ef(this.shape,this.dataSync(),"complex64"===this.dtype)}async data(){this.throwIfDisposed();let e=ap().read(this.dataId);if("string"===this.dtype){let t=await e;try{return t.map(e=>ar(e))}catch(e){throw Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),ap().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();let e=ap().readSync(this.dataId);if("string"===this.dtype)try{return e.map(e=>ar(e))}catch(e){throw Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();let e=await ap().read(this.dataId);return"string"===this.dtype?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),ap().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw Error("Tensor is disposed.")}print(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return af.print(this,e)}clone(){return this.throwIfDisposed(),af.clone(this)}toString(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(e,t,n,a){let r=ep(t),i=function(e,t,n,a){let r=V(t),i=a[a.length-1],s=Array(i).fill(0),o=t.length,l="complex64"===n?ah(e):e;if(o>1)for(let e=0;e<r/i;e++){let t=e*i;for(let e=0;e<i;e++)s[e]=Math.max(s[e],ac(l[t+e],0,n).length)}return s}(e,t,n,r),s=t.length,o=function e(t,n,a,r,i){let s=!(arguments.length>5)||void 0===arguments[5]||arguments[5],o="complex64"===a?2:1,l=n[0],c=n.length;if(0===c)return"complex64"===a?[ac(ah(t)[0],0,a)]:"bool"===a?[au(t[0])]:[t[0].toString()];if(1===c){if(l>20){let e=Array.from(t.slice(0,3*o)),n=Array.from(t.slice((l-3)*o,l*o));return"complex64"===a&&(e=ah(e),n=ah(n)),["["+e.map((e,t)=>ac(e,i[t],a)).join(", ")+", ..., "+n.map((e,t)=>ac(e,i[l-3+t],a)).join(", ")+"]"]}return["["+("complex64"===a?ah(t):Array.from(t)).map((e,t)=>ac(e,i[t],a)).join(", ")+"]"]}let u=n.slice(1),h=r.slice(1),d=r[0]*o,p=[];if(l>20){for(let n=0;n<3;n++){let r=n*d,s=r+d;p.push(...e(t.slice(r,s),u,a,h,i,!1))}p.push("...");for(let n=l-3;n<l;n++){let r=n*d,s=r+d;p.push(...e(t.slice(r,s),u,a,h,i,n===l-1))}}else for(let n=0;n<l;n++){let r=n*d,s=r+d;p.push(...e(t.slice(r,s),u,a,h,i,n===l-1))}let f=2===c?",":"";p[0]="["+(l>0?p[0]+f:"");for(let e=1;e<p.length-1;e++)p[e]=" "+p[e]+f;let m=",\n";for(let e=2;e<c;e++)m+="\n";return p[p.length-1]=" "+p[p.length-1]+"]"+(s?"":m),p}(e,t,n,r,i),l=["Tensor"];return a&&(l.push("  dtype: ".concat(n)),l.push("  rank: ".concat(s)),l.push("  shape: [".concat(t,"]")),l.push("  values:")),l.push(o.map(e=>"    "+e).join("\n")),l.join("\n")}(this.dataSync(),this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),af.cast(this,e)}variable(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.throwIfDisposed(),ap().makeVariable(this,e,t,n)}constructor(e,t,n,a){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=V(e),this.strides=ep(e),this.dataId=n,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}}function ag(){return eE("Tensor",()=>am)}Object.defineProperty(am,Symbol.hasInstance,{value:e=>!!e&&null!=e.data&&null!=e.dataSync&&null!=e.throwIfDisposed}),ag();class ax extends am{assign(e){if(e.dtype!==this.dtype)throw Error("dtype of the new value (".concat(e.dtype,") and ")+"previous value (".concat(this.dtype,") must match"));if(!G(e.shape,this.shape))throw Error("shape of the new value (".concat(e.shape,") and ")+"previous value (".concat(this.shape,") must match"));ap().disposeTensor(this),this.dataId=e.dataId,ap().incRef(this,null)}dispose(){ap().disposeVariable(this),this.isDisposedInternal=!0}constructor(e,t,n,a){super(e.shape,e.dtype,e.dataId,a),this.trainable=t,this.name=n}}Object.defineProperty(ax,Symbol.hasInstance,{value:e=>e instanceof am&&null!=e.assign&&e.assign instanceof Function}),e.s(["assertTypesMatch",()=>aS,"getTensorsInContainer",()=>aT,"isTensorInList",()=>aC,"makeTypesMatch",()=>ak],41175),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(c||(c={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(u||(u={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(h||(h={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(d||(d={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(p||(p={}));let ay={float32:d,int32:u,bool:h,complex64:p};function ab(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw Error("Can not upcast ".concat(e," with ").concat(t))}return ay[e][t]}function av(e){return ab(e,"int32")}function aw(e){return null!=e&&"object"==typeof e&&"texture"in e&&e.texture instanceof WebGLTexture}function aN(e){return"undefined"!=typeof GPUBuffer&&null!=e&&"object"==typeof e&&"buffer"in e&&e.buffer instanceof GPUBuffer}function ak(e,t){if(e.dtype===t.dtype)return[e,t];let n=ab(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function aS(e,t){L(e.dtype===t.dtype,()=>"The dtypes of the first(".concat(e.dtype,") and")+" second(".concat(t.dtype,") input must match"))}function aC(e,t){return t.some(t=>t.id===e.id)}function aT(e){let t=[];return function e(t,n,a){var r;if(null!=t){if(t instanceof am)return void n.push(t);if(Array.isArray(r=t)||"object"==typeof r)for(let r in t){let i=t[r];a.has(i)||(a.add(i),e(i,n,a))}}}(e,t,new Set),t}function aI(e){return null!=e.kernelName}class aE{dispose(){for(let e in this.registeredVariables)this.registeredVariables[e].dispose()}constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}}class a_{async ready(){if(null!=this.pendingBackendInit)return this.pendingBackendInit.then(()=>{});if(null!=this.backendInstance)return;let e=this.getSortedBackends();for(let t=0;t<e.length;t++){let n=e[t];if(await this.initializeBackend(n).success)return void await this.setBackend(n)}throw Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(null!=this.pendingBackendInit)throw Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make ")+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){let{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw Error("The highest priority backend '".concat(e,"' has not yet been ")+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(!(e in this.registryFactory))return null;else{let{asyncInit:t}=this.initializeBackend(e);if(t)return null}return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e in this.registryFactory?(n0("".concat(e," backend was already registered. ")+"Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}async setBackend(e){if(null==this.registryFactory[e])throw Error("Backend name '".concat(e,"' not found in registry"));if(this.backendName=e,null==this.registry[e]){this.backendInstance=null;let{success:t,asyncInit:n}=this.initializeBackend(e);if(!(n?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new ao(this.backendInstance),!0}setupRegisteredKernels(){n5(this.backendName).forEach(e=>{null!=e.setupFunc&&e.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){n5(e).forEach(t=>{null!=t.disposeFunc&&t.disposeFunc(this.registry[e])})}initializeBackend(e){let t=this.registryFactory[e];if(null==t)throw Error("Cannot initialize backend ".concat(e,", no registration found."));try{let n=t.factory();if(!n||n instanceof E||"function"!=typeof n.then)return this.registry[e]=n,{success:!0,asyncInit:!1};{let t=++this.pendingBackendInitId,a=n.then(n=>!(t<this.pendingBackendInitId)&&(this.registry[e]=n,this.pendingBackendInit=null,!0)).catch(n=>!(t<this.pendingBackendInitId)&&(this.pendingBackendInit=null,n0("Initialization of backend ".concat(e," failed")),n0(n.stack||n.message),!1));return this.pendingBackendInit=a,{success:a,asyncInit:!0}}}catch(t){return n0("Initialization of backend ".concat(e," failed")),n0(t.stack||t.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw Error("".concat(e," backend not found in registry"));this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){let e=this.getSortedBackends();for(let t=0;t<e.length;t++){let n=e[t],{success:a,asyncInit:r}=this.initializeBackend(n);if(r||a)return{name:n,asyncInit:r}}throw Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){let n=this.state.tensorInfo.get(t),a=n.backend,r=this.readSync(t),i=a.refCount(t);a.disposeData(t,!0),n.backend=e,e.move(t,r,n.shape,n.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let n,a=null;if(null==t){if("function"!=typeof e)throw Error("Please provide a function to tidy()");t=e}else{if("string"!=typeof e&&!(e instanceof String))throw Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof t)throw Error("When calling with two arguments, the 2nd argument to tidy() must be a function");a=e}return this.scopedRun(()=>this.startScope(a),()=>this.endScope(n),()=>((n=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n))}scopedRun(e,t,n){e();try{let e=n();return t(),e}catch(e){throw t(),e}}nextTensorId(){return a_.nextTensorId++}nextVariableId(){return a_.nextVariableId++}clone(e){let t=aR.runKernel(tC,{x:e});return this.addTapeNode(this.state.activeScope.name,{x:e},[t],e=>({x:()=>aR.runKernel(eX,{x:e},{dtype:"float32"})}),[],{}),t}runKernel(e,t,n){if(null==this.backendName&&this.backend,null==n4(e,this.backendName))throw Error("Kernel '".concat(e,"' not registered for backend '").concat(this.backendName,"'"));return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,n){let a=this.backend.numDataIds(),r=0;n.forEach(e=>{r+="complex64"===e.dtype?3:1});let i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=a-t-r-i;if(s>0)throw Error("Backend '".concat(this.backendName,"' has an internal memory leak ")+"(".concat(s," data ids) after running '").concat(e,"'"))}runKernelFunc(e){let t,n,a,r,i=[],s=this.isTapeOn(),o=this.state.numBytes,l=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;let c=aI(e)?e.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(aI(e)){let{kernelName:t,inputs:r,attrs:o}=e;null==this.backendName&&this.backend;let l=n4(t,this.backendName);L(null!=l,()=>"Cannot find registered kernel '".concat(t,"' for backend '").concat(this.backendName,"'")),n=()=>{let e=this.backend.numDataIds(),n=Array.isArray(a=l.kernelFunc({inputs:r,attrs:o,backend:this.backend}))?a:[a];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(t,e,n);let c=n.map(e=>null!=e.rank?e:this.makeTensorFromTensorInfo(e));if(s){let e=this.getTensorsForGradient(t,r,c);i=this.saveTensorsForBackwardMode(e)}return c}}else{let{forwardFunc:t}=e,r=e=>{s&&(i=e.map(e=>this.keep(this.clone(e))))};n=()=>{let e=this.backend.numDataIds(),n=Array.isArray(a=this.tidy(()=>t(this.backend,r)))?a:[a];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,e,n),n}}let{inputs:u,attrs:h}=e,d=aI(e)?null:e.backwardsFunc;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{this.ENV.getBool("DEBUG")||this.state.profiling?(r=this.profiler.profileKernel(c,u,()=>n()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(r),t=r.outputs):t=n()}),s&&this.addTapeNode(c,u,t,d,i,h),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-o,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-l,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(u).map(e=>null!=u[e]?u[e].shape:null),outputShapes:t.map(e=>e.shape),kernelTimeMs:r.timeMs,extraInfo:r.extraInfo}),Array.isArray(a)?t:t[0]}saveTensorsForBackwardMode(e){return e.map(e=>this.keep(this.clone(e)))}getTensorsForGradient(e,t,n){let a=n3.get(e);if(null!=a){let e,r=a.inputsToSave||[],i=a.outputsToSave||[];a.saveAllInputs?(L(Array.isArray(t),()=>"saveAllInputs is true, expected inputs to be an array."),e=Object.keys(t).map(e=>t[e])):e=r.map(e=>t[e]);let s=n.filter((e,t)=>i[t]);return e.concat(s)}return[]}makeTensor(e,t,n,a){if(null==e)throw Error("Values passed to engine.makeTensor() are null");n=n||"float32",a=a||this.backend;let r=e;"string"===n&&eo(e[0])&&(r=e.map(e=>aa(e)));let i=a.write(r,t,n),s=new am(t,n,i,this.nextTensorId());if(this.trackTensor(s,a),"string"===n){let e=this.state.tensorInfo.get(i),t=es(r);this.state.numBytes+=t-e.bytes,e.bytes=t}return s}makeTensorFromDataId(e,t,n,a){let r={dataId:e,shape:t,dtype:n=n||"float32"};return this.makeTensorFromTensorInfo(r,a)}makeTensorFromTensorInfo(e,t){let{dataId:n,shape:a,dtype:r}=e,i=new am(a,r,n,this.nextTensorId());return this.trackTensor(i,t),i}makeVariable(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;n=n||this.nextVariableId().toString(),null!=a&&a!==e.dtype&&(e=e.cast(a));let r=new ax(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[r.name])throw Error("Variable with name ".concat(r.name," was already registered"));return this.state.registeredVariables[r.name]=r,this.incRef(r,this.backend),r}trackTensor(e,t){this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++;let n=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(n=e.size*ei(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof ax||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;let t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,"string"===e.dtype&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),"complex64"!==e.dtype&&"string"!==e.dtype){let t=e.size*ei(e.dtype);this.state.numBytes-=t}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(let e in this.state.registeredVariables){let t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}memory(){let e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;let t=this.state.numBytes,n=this.state.numTensors;for(let a of(this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(e=>e.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n,this.state.activeProfile.kernels))a.kernelTimeMs=await a.kernelTimeMs,a.extraInfo=await a.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(e,t,n,a,r,i){let s={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:r},o=n3.get(e);null!=o&&(a=o.gradFunc),null!=a&&(s.gradient=e=>(e=e.map((e,t)=>{if(null==e){let e=n[t],a=ex(e.size,e.dtype);return this.makeTensor(a,e.shape,e.dtype)}return e}),a(e.length>1?e:e[0],r,i))),this.state.activeTape.push(s)}keep(e){return e.kept=!0,e}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){let t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){let t=aT(e),n=new Set(t.map(e=>e.id));for(let e=0;e<this.state.activeScope.track.length;e++){let t=this.state.activeScope.track[e];t.kept||n.has(t.id)||t.dispose()}let a=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(e=>{e.kept||e.scopeId!==a.id||this.track(e)})}gradients(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(L(t.length>0,()=>"gradients() received an empty list of xs."),null!=n&&"float32"!==n.dtype)throw Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));let r=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));L(r instanceof am,()=>"The result y returned by f() must be a tensor.");let i=function(e,t,n){let a={},r={};for(let e=0;e<t.length;e++)a[t[e].id]=!0;for(let n=0;n<e.length;n++){let i=e[n],s=i.inputs;for(let e in s){let n=s[e],o=!1;for(let e=0;e<t.length;e++)if(a[n.id]){i.outputs.forEach(e=>a[e.id]=!0),o=!0,r[i.id]=!0;break}if(o)break}}let i={};i[n.id]=!0;let s={};for(let t=e.length-1;t>=0;t--){let n=e[t],a=n.inputs;for(let e=0;e<n.outputs.length;e++)if(i[n.outputs[e].id]){for(let e in a)i[a[e].id]=!0,s[n.id]=!0;break}}let o=[];for(let t=0;t<e.length;t++){let n=e[t];if(r[n.id]&&s[n.id]){let e={};for(let t in n.inputs){let r=n.inputs[t];a[r.id]&&(e[t]=r)}let t=Object.assign({},n);t.inputs=e,t.outputs=n.outputs,o.push(t)}}return o}(this.state.activeTape,t,r);if(!a&&0===i.length&&t.length>0)throw Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{let e={};e[r.id]=null==n?function(e){let t=eg(V(e),"float32");return aR.makeTensor(t,e,"float32")}(r.shape):n,function(e,t,n,a){for(let r=t.length-1;r>=0;r--){let i=t[r],s=[];if(i.outputs.forEach(t=>{let n=e[t.id];null!=n?s.push(n):s.push(null)}),null==i.gradient)throw Error("Cannot compute gradient: gradient function not found "+"for ".concat(i.kernelName,"."));let o=i.gradient(s);for(let t in i.inputs){if(!(t in o))throw Error("Cannot backprop through input ".concat(t,". ")+"Available gradients found: ".concat(Object.keys(o),"."));let r=n(()=>o[t]());if("float32"!==r.dtype)throw Error("Error in gradient for op ".concat(i.kernelName,". The gradient of input ")+"".concat(t," must have 'float32' dtype, but has '").concat(r.dtype,"'"));let s=i.inputs[t];if(!G(r.shape,s.shape))throw Error("Error in gradient for op ".concat(i.kernelName,". The gradient of input ")+"'".concat(t,"' has shape '").concat(r.shape,"', which does not match ")+"the shape of the input '".concat(s.shape,"'"));if(null==e[s.id])e[s.id]=r;else{let t=e[s.id];e[s.id]=a(t,r),t.dispose()}}}}(e,i,e=>this.tidy(e),aD);let a=t.map(t=>e[t.id]);return 0===this.state.gradientDepth&&(this.state.activeTape.forEach(e=>{for(let t of e.saved)t.dispose()}),this.state.activeTape=null),{value:r,grads:a}})}customGrad(e){var t=this;return L(eh(e),()=>"The f passed in customGrad(f) must be a function."),function(){let n;for(var a=arguments.length,r=Array(a),i=0;i<a;i++)r[i]=arguments[i];L(r.every(e=>e instanceof am),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s={};return r.forEach((e,t)=>{s[t]=e}),t.runKernelFunc({forwardFunc:(t,a)=>(L((n=e(...r,a)).value instanceof am,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),L(eh(n.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),n.value),backwardsFunc:(e,t)=>{let a=n.gradFunc(e,t),i=Array.isArray(a)?a:[a];L(i.length===r.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),L(i.every(e=>e instanceof am),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");let s={};return i.forEach((e,t)=>{s[t]=()=>e}),s},inputs:s})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){let t=at(),n=await this.backend.time(e);return n.wallMs=at()-t,n}track(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){for(let e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new aE,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new aE}}function aA(){let e=eI();if(null==e._tfengine){let t=new eS(e);e._tfengine=new a_(t)}return eT=e._tfengine.ENV,ap=()=>e._tfengine,e._tfengine}a_.nextTensorId=0,a_.nextVariableId=0;let aR=aA();function aD(e,t){return aR.runKernel("Add",{a:e,b:t})}var aM=e.i(47167);function aF(e){n=e}function aO(e){if(void 0!==n)return n;if(e||"undefined"!=typeof navigator&&null!=navigator){if(e||(e=navigator),"ReactNative"===e.product)return!0;let t=e.userAgent||e.vendor||("undefined"!=typeof window?window.opera:"");if(!t){let t=e;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function aP(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}e.s(["isBrowser",()=>aP,"isMobile",()=>aO,"mockIsMobile",()=>aF],62893);let aj=eT;aj.registerFlag("DEBUG",()=>!1,e=>{e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),aj.registerFlag("IS_BROWSER",()=>aP()),aj.registerFlag("IS_NODE",()=>void 0!==aM.default&&void 0!==aM.default.versions&&void 0!==aM.default.versions.node),aj.registerFlag("IS_CHROME",()=>"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)),aj.registerFlag("IS_SAFARI",()=>"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor)),aj.registerFlag("PROD",()=>!1),aj.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>aj.getBool("DEBUG")),aj.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0),aj.registerFlag("IS_TEST",()=>!1),aj.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>aj.getBool("DEBUG")),aj.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1),aj.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1),aj.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);var aL=e.i(67034);function az(e,t){let n=e;if(ai(e))return"string"===t?[]:[e.length];if(aw(e)){let t=e.channels||"RGBA";return[e.height,e.width*t.length]}if(aN(e))return[e.buffer.size/(null==t?4:ei(t))];if(!Array.isArray(e))return[];let a=[];for(;Array.isArray(n)||ai(n)&&"string"!==t;)a.push(n.length),n=n[0];return Array.isArray(e)&&eT.getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function e(t,n,a){if(a=a||[],!Array.isArray(t)&&!ai(t))return void L(0===n.length,()=>"Element arr[".concat(a.join("]["),"] is a primitive, ")+"but should be an array/TypedArray of ".concat(n[0]," elements"));L(n.length>0,()=>"Element arr[".concat(a.join("]["),"] should be a primitive, ")+"but is an array of ".concat(t.length," elements")),L(t.length===n[0],()=>"Element arr[".concat(a.join("]["),"] should have ").concat(n[0]," ")+"elements, but has ".concat(t.length," elements"));let r=n.slice(1);for(let n=0;n<t.length;++n)e(t[n],r,a.concat(n))}(e,a,[]),a}function aB(e,t,n,a){if("string_or_numeric"!==e){if(null==e)throw Error("Expected dtype cannot be null.");if("numeric"!==e&&e!==t||"numeric"===e&&"string"===t)throw Error("Argument '".concat(n,"' passed to '").concat(a,"' must ")+"be ".concat(e," tensor, but got ").concat(t," tensor"))}}function aV(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(e instanceof ag())return aB(a,e.dtype,t,n),e;let r=eu(e);if("string"!==r&&["bool","int32","float32"].indexOf(a)>=0&&(r=a),aB(a,r,t,n),null==e||!ai(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e){let a=null==e?"null":e.constructor.name;throw Error("Argument '".concat(t,"' passed to '").concat(n,"' must be a ")+"Tensor or TensorLike, but got '".concat(a,"'"))}let i=az(e,r);ai(e)||Array.isArray(e)||(e=[e]);let s="string"!==r?ae(e,r):as(e,[],!0);return aR.makeTensor(s,i,r)}function aU(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(!Array.isArray(e))throw Error("Argument ".concat(t," passed to ").concat(n," must be a ")+"`Tensor[]` or `TensorLike[]`");return e.map((e,r)=>aV(e,"".concat(t,"[").concat(r,"]"),n,a))}let aW="__op";function aG(e){let t=Object.keys(e);if(1!==t.length)throw Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+"".concat(t.length," keys."));let n=t[0],a=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));let r=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];aR.startScope(n);try{let e=a(...t);return eN(e)&&console.error("Cannot return a Promise inside of tidy."),aR.endScope(e),e}catch(e){throw aR.endScope(null),e}};return Object.defineProperty(r,"name",{value:n+=aW,configurable:!0}),r}let aH=aG({complex_:function(e,t){let n=aV(e,"real","complex"),a=aV(t,"imag","complex");return z(n.shape,a.shape,"real and imag shapes, ".concat(n.shape," and ").concat(a.shape,", ")+"must match in call to tf.complex()."),aR.runKernel(eQ,{real:n,imag:a})}});function aq(e,t,n,a){if(null==a)a=eu(e);else if("complex64"===a)throw Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(aN(e)||aw(e)){if("float32"!==a&&"int32"!==a)throw Error("Creating tensor from GPU data only supports "+"'float32'|'int32' dtype, while the dtype is ".concat(a,"."));return aR.backend.createTensorFromGPUData(e,t||n,a)}if(!ai(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e)throw Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){eb(t);let e=V(t),a=V(n);L(e===a,()=>"Based on the provided shape, [".concat(t,"], the tensor should have ")+"".concat(e," values but has ").concat(a));for(let e=0;e<n.length;++e){let a=n[e],r=e!==n.length-1||a!==V(t.slice(e));L(n[e]===t[e]||!r,()=>"Error creating a new Tensor. Inferred shape "+"(".concat(n,") does not match the provided ")+"shape (".concat(t,"). "))}}return ai(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==a?ae(e,a):as(e,[],!0),aR.makeTensor(e,t,a)}function aK(e,t,n){let a=az(e,n);return aq(e,t,a,n)}let aX={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class aY{static join(e){return new aY(e).slice()}slice(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.byteLength;if(0===this.shards.length||(e=isNaN(Number(e))?0:e,t=isNaN(Number(t))?0:t,e=Math.max(0,e),(t=Math.min(this.byteLength,t))<=e))return new ArrayBuffer(0);let n=this.findShardForByte(e);if(-1===n)throw Error("Could not find start shard for byte ".concat(e));let a=new ArrayBuffer(t-e),r=new Uint8Array(a),i=0;for(let a=n;a<this.shards.length;a++){let n=this.shards[a],s=e+i-n.start,o=i,l=Math.min(t,n.end)-n.start,c=new Uint8Array(n.buffer,s,l-s);if(r.set(c,o),i+=c.length,t<n.end)break}return a}findShardForByte(e){if(0===this.shards.length||e<0||e>=this.byteLength)return -1;if(null!=this.bufferUniformSize)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function t(t){return e<t.start?-1:+(e>=t.end)}if(0===t(this.shards[this.previousShardIndex]))return this.previousShardIndex;let n=function(e,t){let n=0,a=e.length;for(;n<=a;){let r=Math.floor((a-n)/2)+n,i=t(e[r]);if(0===i)return r;i<0?a=r:n=r+1}return -1}(this.shards,t);return -1===n?-1:(this.previousShardIndex=n,this.previousShardIndex)}constructor(e){if(this.shards=[],this.previousShardIndex=0,null==e||(e instanceof Array||(e=[e]),0===(e=e.map(e=>ai(e)?e.buffer:e)).length))return;this.bufferUniformSize=e[0].byteLength;let t=0;for(let n=0;n<e.length;n++){let a=e[n];n!==e.length-1&&a.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);let r=t+a.byteLength;this.shards.push({buffer:a,start:t,end:r}),t=r}0===this.shards.length&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}}function aZ(){return aR.memory()}function aQ(e,t){return aR.tidy(e,t)}function aJ(e){aT(e).forEach(e=>e.dispose())}function a$(e){return aR.keep(e)}function a0(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return aR.registerBackend(e,t,n)}async function a1(e,t){let n=[],a=[],r=Array.isArray(e)?e.map(e=>e.name):Object.keys(e);for(let i=0;i<r.length;++i){let s=r[i],o=Array.isArray(e)?e[i].tensor:e[s];if("float32"!==o.dtype&&"int32"!==o.dtype&&"bool"!==o.dtype&&"string"!==o.dtype&&"complex64"!==o.dtype)throw Error("Unsupported dtype in weight '".concat(s,"': ").concat(o.dtype));let l={name:s,shape:o.shape,dtype:o.dtype};if("string"===o.dtype){let e=new Promise(async e=>{let t=await o.bytes(),n=new Uint8Array(t.reduce((e,t)=>e+t.length,0)+4*t.length),a=0;for(let e=0;e<t.length;e++){let r=t[e],i=new Uint8Array(new Uint32Array([r.length]).buffer);n.set(i,a),a+=4,n.set(r,a),a+=r.length}e(n)});a.push(e)}else a.push(o.data());null!=t&&(l.group=t),n.push(l)}return{data:function(e){if(null===e)throw Error("Invalid input value: ".concat(JSON.stringify(e)));let t=0,n=[];e.forEach(e=>{if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw Error("Unsupported TypedArray subtype: ".concat(e.constructor.name))});let a=new Uint8Array(t),r=0;return n.forEach(e=>{a.set(new Uint8Array(e.buffer),r),r+=e.byteLength}),a.buffer}(await Promise.all(a)),specs:n}}function a2(e,t){let n=new aY(e),a={},r=0;for(let e of t){let t=function(e,t){let n,a=V(e.shape);if("quantization"in e)n=aX[e.quantization.dtype];else if("string"===e.dtype){let e=0;for(let n=0;n<a;n++)e+=4+new Uint32Array(t(e,e+4))[0];return e}else n=aX[e.dtype];return a*n}(e,(e,t)=>n.slice(r+e,r+t));a[e.name]=a4(e,n.slice(r,r+t)),r+=t}return a}async function a3(e,t){let n,a=V(e.shape);if("quantization"in e)n=aX[e.quantization.dtype];else if("string"===e.dtype){let e=0;for(let n=0;n<a;n++)e+=4+new Uint32Array(await t(e,e+4))[0];return e}else n=aX[e.dtype];return a*n}function a4(e,t){let n,a=e.name,r=e.dtype,i=e.shape,s=V(i),o=0;if("quantization"in e){let i=e.quantization;if("uint8"===i.dtype||"uint16"===i.dtype){if(!("min"in i&&"scale"in i))throw Error("Weight ".concat(e.name," with quantization ").concat(i.dtype," ")+"doesn't have corresponding metadata min and scale.")}else if("float16"===i.dtype){if("float32"!==r)throw Error("Weight ".concat(e.name," is quantized with ").concat(i.dtype," ")+"which only supports weights of type float32 not ".concat(r,"."))}else throw Error("Weight ".concat(e.name," has unknown ")+"quantization dtype ".concat(i.dtype,". ")+"Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.");let l=aX[i.dtype],c="uint8"===i.dtype?new Uint8Array(t):new Uint16Array(t);if("float32"===r)if("uint8"===i.dtype||"uint16"===i.dtype){n=new Float32Array(c.length);for(let e=0;e<c.length;e++){let t=c[e];n[e]=t*i.scale+i.min}}else if("float16"===i.dtype)n=(function(){let e=function(){let e=e=>{let t=e<<13,n=0;for(;(8388608&t)==0;)n-=8388608,t<<=1;return(t&=-8388609)|(n+=0x38800000)},t=new Uint32Array(2048);t[0]=0;for(let n=1;n<1024;n++)t[n]=e(n);for(let e=1024;e<2048;e++)t[e]=0x38000000+(e-1024<<13);return t}(),t=function(){let e=new Uint32Array(64);e[0]=0,e[31]=0x47800000,e[32]=0x80000000,e[63]=0xc7800000;for(let t=1;t<31;t++)e[t]=t<<23;for(let t=33;t<63;t++)e[t]=0x80000000+(t-32<<23);return e}(),n=function(){let e=new Uint32Array(64);for(let t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}();return a=>{let r=new ArrayBuffer(4*a.length),i=new Uint32Array(r);for(let r=0;r<a.length;r++){let s=a[r],o=e[n[s>>10]+(1023&s)]+t[s>>10];i[r]=o}return new Float32Array(r)}})()(c);else throw Error("Unsupported quantization type ".concat(i.dtype," ")+"for weight type float32.");else if("int32"===r){if("uint8"!==i.dtype&&"uint16"!==i.dtype)throw Error("Unsupported quantization type ".concat(i.dtype," ")+"for weight type int32.");n=new Int32Array(c.length);for(let e=0;e<c.length;e++){let t=c[e];n[e]=Math.round(t*i.scale+i.min)}}else throw Error("Unsupported dtype in weight '".concat(a,"': ").concat(r));o+=s*l}else if("string"===r){let a=V(e.shape);n=[];for(let e=0;e<a;e++){let e=new Uint32Array(t.slice(o,o+4))[0];o+=4;let a=new Uint8Array(t.slice(o,o+e));n.push(a),o+=e}}else{let e=aX[r];if("float32"===r)n=new Float32Array(t);else if("int32"===r)n=new Int32Array(t);else if("bool"===r)n=new Uint8Array(t);else if("complex64"===r){n=new Float32Array(t);let e=new Float32Array(n.length/2),a=new Float32Array(n.length/2);for(let t=0;t<e.length;t++)e[t]=n[2*t],a[t]=n[2*t+1];let r=aK(e,i,"float32"),s=aK(a,i,"float32"),o=aH(r,s);return r.dispose(),s.dispose(),o}else throw Error("Unsupported dtype in weight '".concat(a,"': ").concat(r));o+=s*e}return aK(n,i,r)}async function a5(e,t,n){let a=new Uint8Array(t);for(;a.byteLength<n;){let{done:t,value:r}=await e.read();if(t&&null==r){let e=n-a.byteLength;throw Error("Reader is done but ".concat(e," bytes are still expected"))}let i=new Uint8Array(a.length+r.byteLength);i.set(a,0),i.set(new Uint8Array(r),a.length),a=i}return a.buffer}async function a6(e,t){let n={},a=e.getReader(),r=new ArrayBuffer(0);for(let e of t){let t=await a3(e,async(e,t)=>(r=await a5(a,r,t)).slice(e,t)),i=(r=await a5(a,r,t)).slice(0,t);r=r.slice(t);let s=a4(e,i);if(n[e.name]=s,"webgpu"===aR.backendName){let e=aR.backend;"uploadToGPU"in e&&V(s.shape)>=eT.get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&e.uploadToGPU(s.dataId)}}return n}let a8=void 0!==aL.Buffer&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function a9(e){return a8?aL.Buffer.byteLength(e,"utf8"):new Blob([e]).size}function a7(e){return aY.join(e)}function re(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);let t=e.split("/");return t[t.length-1]}function rt(e,t){let n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return null!=e.signature&&(n.signature=e.signature),null!=e.userDefinedMetadata&&(n.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(n.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(n.initializerSignature=e.initializerSignature),null!=e.trainingConfig&&(n.trainingConfig=e.trainingConfig),n}function rn(e,t,n){let a={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(null!=e.trainingConfig&&(a.trainingConfig=e.trainingConfig),null!=e.weightsManifest){if(!t)throw Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw Error("modelJSON has weightsManifest but weightData is null");a.weightSpecs=t,a.weightData=n}return null!=e.signature&&(a.signature=e.signature),null!=e.userDefinedMetadata&&(a.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(a.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(a.initializerSignature=e.initializerSignature),a}async function ra(e,t){let n,a;return null!=e.weightsManifest&&([n,a]=await t(e.weightsManifest)),rn(e,n,a)}function rr(e){if(e.modelTopology instanceof ArrayBuffer)throw Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:a9(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:a9(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:new aY(e.weightData).byteLength}}function ri(e){let t=[];for(let n of e)t.push(...n.weights);return t}class rs{static getInstance(){return null==rs.instance&&(rs.instance=new rs),rs.instance}static registerSaveRouter(e){rs.getInstance().saveRouters.push(e)}static registerLoadRouter(e){rs.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return rs.getHandlers(e,"save")}static getLoadHandlers(e,t){return rs.getHandlers(e,"load",t)}static getHandlers(e,t,n){let a=[];return("load"===t?rs.getInstance().loadRouters:rs.getInstance().saveRouters).forEach(t=>{let r=t(e,n);null!==r&&a.push(r)}),a}constructor(){this.saveRouters=[],this.loadRouters=[]}}let ro=e=>rs.registerSaveRouter(e),rl=e=>rs.registerLoadRouter(e),rc=e=>rs.getSaveHandlers(e),ru=(e,t)=>rs.getLoadHandlers(e,t),rh="tensorflowjs",rd="models_store",rp="model_info_store";function rf(){if(!eT.getBool("IS_BROWSER"))throw Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");let e="undefined"==typeof window?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw Error("The current browser does not appear to support IndexedDB.");return t}function rm(e){let t=e.result;t.createObjectStore(rd,{keyPath:"modelPath"}),t.createObjectStore(rp,{keyPath:"modelPath"})}class rg{async save(e){if(e.modelTopology instanceof ArrayBuffer)throw Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((e,n)=>{let a=this.indexedDB.open(rh,1);a.onupgradeneeded=()=>rm(a),a.onsuccess=()=>{let r=a.result;if(null==t){let t=r.transaction(rd,"readonly"),a=t.objectStore(rd).get(this.modelPath);a.onsuccess=()=>{if(null==a.result)return r.close(),n(Error("Cannot find model with path '".concat(this.modelPath,"' ")+"in IndexedDB."));e(a.result.modelArtifacts)},a.onerror=e=>(r.close(),n(a.error)),t.oncomplete=()=>r.close()}else{let a,i;t.weightData=aY.join(t.weightData);let s=rr(t),o=r.transaction(rp,"readwrite"),l=o.objectStore(rp);try{a=l.put({modelPath:this.modelPath,modelArtifactsInfo:s})}catch(e){return n(e)}a.onsuccess=()=>{let a,c=(i=r.transaction(rd,"readwrite")).objectStore(rd);try{a=c.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:s})}catch(e){return n(e)}a.onsuccess=()=>e({modelArtifactsInfo:s}),a.onerror=e=>{let t=(l=o.objectStore(rp)).delete(this.modelPath);t.onsuccess=()=>(r.close(),n(a.error)),t.onerror=e=>(r.close(),n(a.error))}},a.onerror=e=>(r.close(),n(a.error)),o.oncomplete=()=>{null==i?r.close():i.oncomplete=()=>r.close()}}},a.onerror=e=>n(a.error)})}constructor(e){if(this.indexedDB=rf(),null==e||!e)throw Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}}rg.URL_SCHEME="indexeddb://";let rx=e=>{var t;return eT.getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(rg.URL_SCHEME)?(t=e.slice(rg.URL_SCHEME.length),new rg(t)):null};rs.registerSaveRouter(rx),rs.registerLoadRouter(rx);let ry="tensorflowjs_models",rb="info";function rv(e){return{info:[ry,e,rb].join("/"),topology:[ry,e,"model_topology"].join("/"),weightSpecs:[ry,e,"weight_specs"].join("/"),weightData:[ry,e,"weight_data"].join("/"),modelMetadata:[ry,e,"model_metadata"].join("/")}}function rw(e){for(let t of Object.values(e))window.localStorage.removeItem(t)}class rN{async save(e){if(e.modelTopology instanceof ArrayBuffer)throw Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{let t=JSON.stringify(e.modelTopology),n=JSON.stringify(e.weightSpecs),a=rr(e),r=aY.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,function(e){if(a8)return aL.Buffer.from(e).toString("base64");let t=new Uint8Array(e),n="";for(let e=0,a=t.length;e<a;e++)n+=String.fromCharCode(t[e]);return btoa(n)}(r));let i={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:null!=e.signature?e.signature:void 0,userDefinedMetadata:null!=e.userDefinedMetadata?e.userDefinedMetadata:void 0,modelInitializer:null!=e.modelInitializer?e.modelInitializer:void 0,initializerSignature:null!=e.initializerSignature?e.initializerSignature:void 0,trainingConfig:null!=e.trainingConfig?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),{modelArtifactsInfo:a}}catch(e){throw rw(this.keys),Error("Failed to save model '".concat(this.modelPath,"' to local storage: ")+"size quota being exceeded is a possible cause of this failure: "+"modelTopologyBytes=".concat(a.modelTopologyBytes,", ")+"weightSpecsBytes=".concat(a.weightSpecsBytes,", ")+"weightDataBytes=".concat(a.weightDataBytes,"."))}}}async load(){let e=JSON.parse(this.LS.getItem(this.keys.info));if(null==e)throw Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));if("JSON"!==e.modelTopologyType)throw Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");let t={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(null==n)throw Error("In local storage, the topology of model '".concat(this.modelPath,"' ")+"is missing.");t.modelTopology=n;let a=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(null==a)throw Error("In local storage, the weight specs of model '".concat(this.modelPath,"' ")+"are missing.");t.weightSpecs=a;let r=this.LS.getItem(this.keys.modelMetadata);if(null!=r){let e=JSON.parse(r);t.format=e.format,t.generatedBy=e.generatedBy,t.convertedBy=e.convertedBy,null!=e.signature&&(t.signature=e.signature),null!=e.userDefinedMetadata&&(t.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(t.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(t.initializerSignature=e.initializerSignature),null!=e.trainingConfig&&(t.trainingConfig=e.trainingConfig)}let i=this.LS.getItem(this.keys.weightData);if(null==i)throw Error("In local storage, the binary weight values of model "+"'".concat(this.modelPath,"' are missing."));return t.weightData=function(e){if(a8){let t=aL.Buffer.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}let t=atob(e),n=new Uint8Array(t.length);for(let e=0;e<t.length;++e)n.set([t.charCodeAt(e)],e);return n.buffer}(i),t}constructor(e){if(!eT.getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=rv(this.modelPath)}}rN.URL_SCHEME="localstorage://";let rk=e=>{var t;return eT.getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(rN.URL_SCHEME)?(t=e.slice(rN.URL_SCHEME.length),new rN(t)):null};rs.registerSaveRouter(rk),rs.registerLoadRouter(rk);class rS{static getInstance(){return null==rS.instance&&(rS.instance=new rS),rS.instance}static registerManager(e,t){L(null!=e,()=>"scheme must not be undefined or null."),e.endsWith("://")&&(e=e.slice(0,e.indexOf("://"))),L(e.length>0,()=>"scheme must not be an empty string.");let n=rS.getInstance();L(null==n.managers[e],()=>"A model store manager is already registered for scheme '".concat(e,"'.")),n.managers[e]=t}static getManager(e){let t=rS.getInstance().managers[e];if(null==t)throw Error("Cannot find model manager for scheme '".concat(e,"'"));return t}static getSchemes(){return Object.keys(rS.getInstance().managers)}constructor(){this.managers={}}}function rC(e){if(-1===e.indexOf("://"))throw Error("The url string provided does not contain a scheme. Supported schemes are: "+"".concat(rS.getSchemes().join(",")));return{scheme:e.split("://")[0],path:e.split("://")[1]}}async function rT(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];L(e!==t,()=>"Old path and new path are the same: '".concat(e,"'"));let a=rs.getLoadHandlers(e);L(a.length>0,()=>"Copying failed because no load handler is found for source URL ".concat(e,".")),L(a.length<2,()=>"Copying failed because more than one (".concat(a.length,") ")+"load handlers for source URL ".concat(e,"."));let r=a[0],i=rs.getSaveHandlers(t);L(i.length>0,()=>"Copying failed because no save handler is found for destination "+"URL ".concat(t,".")),L(i.length<2,()=>"Copying failed because more than one (".concat(a.length,") ")+"save handlers for destination URL ".concat(t,"."));let s=i[0],o=rC(e).scheme,l=rC(e).path,c=o===rC(e).scheme,u=await r.load();n&&c&&await rS.getManager(o).removeModel(l);let h=await s.save(u);return n&&!c&&await rS.getManager(o).removeModel(l),h.modelArtifactsInfo}async function rI(){let e=rS.getSchemes(),t={};for(let n of e){let e=await rS.getManager(n).listModels();for(let a in e)t[n+"://"+a]=e[a]}return t}async function rE(e){let t=rC(e);return rS.getManager(t.scheme).removeModel(t.path)}async function r_(e,t){return rT(e,t,!1)}async function rA(e,t){return rT(e,t,!0)}if(eT.get("IS_BROWSER")){eT.setPlatform("browser",new class{fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if("utf-8"!==t&&"utf8"!==t)throw Error("Browser's encoder only supports utf-8, but got ".concat(t));return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){if("undefined"==typeof window||!eT.getBool("USE_SETTIMEOUTCUSTOM"))return void setTimeout(e,t);this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",e=>{e.source===window&&e.data.name===this.messageName&&(e.stopPropagation(),(0,this.functionRefs[e.data.index])(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0))},!0))}isTypedArray(e){return n9(e)}constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}});try{rS.registerManager(rN.URL_SCHEME,new class{async listModels(){let e={},t=ry+"/",n="/"+rb;for(let a=0;a<this.LS.length;++a){let r=this.LS.key(a);r.startsWith(t)&&r.endsWith(n)&&(e[function(e){let t=e.split("/");if(t.length<3)throw Error("Invalid key format: ".concat(e));return t.slice(1,t.length-1).join("/")}(r)]=JSON.parse(this.LS.getItem(r)))}return e}async removeModel(e){var t;let n=rv(e=(t=e).startsWith(rN.URL_SCHEME)?t.slice(rN.URL_SCHEME.length):t);if(null==this.LS.getItem(n.info))throw Error("Cannot find model at path '".concat(e,"'"));let a=JSON.parse(this.LS.getItem(n.info));return rw(n),a}constructor(){L(eT.getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),L("undefined"==typeof window||void 0!==window.localStorage,()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}})}catch(e){}try{rS.registerManager(rg.URL_SCHEME,new class{async listModels(){return new Promise((e,t)=>{let n=this.indexedDB.open(rh,1);n.onupgradeneeded=()=>rm(n),n.onsuccess=()=>{let a=n.result,r=a.transaction(rp,"readonly"),i=r.objectStore(rp).getAll();i.onsuccess=()=>{let t={};for(let e of i.result)t[e.modelPath]=e.modelArtifactsInfo;e(t)},i.onerror=e=>(a.close(),t(i.error)),r.oncomplete=()=>a.close()},n.onerror=e=>t(n.error)})}async removeModel(e){var t;return e=(t=e).startsWith(rg.URL_SCHEME)?t.slice(rg.URL_SCHEME.length):t,new Promise((t,n)=>{let a=this.indexedDB.open(rh,1);a.onupgradeneeded=()=>rm(a),a.onsuccess=()=>{let r,i=a.result,s=i.transaction(rp,"readwrite"),o=s.objectStore(rp),l=o.get(e);l.onsuccess=()=>{if(null==l.result)return i.close(),n(Error("Cannot find model with path '".concat(e,"' ")+"in IndexedDB."));{let a=o.delete(e),s=()=>{let a=(r=i.transaction(rd,"readwrite")).objectStore(rd).delete(e);a.onsuccess=()=>t(l.result.modelArtifactsInfo),a.onerror=e=>n(l.error)};a.onsuccess=s,a.onerror=e=>(s(),i.close(),n(l.error))}},l.onerror=e=>(i.close(),n(l.error)),s.oncomplete=()=>{null==r?i.close():r.oncomplete=()=>i.close()}},a.onerror=e=>n(a.error)})}constructor(){this.indexedDB=rf()}})}catch(e){}}let rR={importFetch:()=>({})};function rD(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2?arguments[2]:void 0;return t=t||"float32",eb(e),new ad(e,t,n)}eT.get("IS_NODE")&&!eT.get("IS_BROWSER")&&eT.setPlatform("node",new class{fetch(e,t){return null!=eT.global.fetch?eT.global.fetch(e,t):(null==a&&(a=rR.importFetch()),a(e,t))}now(){let e=aM.default.hrtime();return 1e3*e[0]+e[1]/1e6}encode(e,t){if("utf-8"!==t&&"utf8"!==t)throw Error("Node built-in encoder only supports utf-8, but got ".concat(t));return this.textEncoder.encode(e)}decode(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}constructor(){this.util={},this.textEncoder=new this.util.TextEncoder}});let rM=aG({cast_:function(e,t){let n=aV(e,"x","cast");if(!ea(t))throw Error("Failed to cast to unknown dtype ".concat(t));if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw Error("Only strings can be casted to strings");return aR.runKernel(eX,{x:n},{dtype:t})}}),rF=aG({clone_:function(e){let t=aV(e,"x","clone","string_or_numeric");return aR.runKernel(tC,{x:t})}});function rO(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(e.toString(t))}aA(),af={buffer:rD,cast:rM,clone:rF,print:rO};let rP=aG({add_:function(e,t){let n=aV(e,"a","add"),a=aV(t,"b","add");[n,a]=ak(n,a);let r={a:n,b:a};return aR.runKernel("Add",r)}}),rj=aG({floorDiv_:function(e,t){let n=aV(e,"a","floorDiv"),a=aV(t,"b","floorDiv");[n,a]=ak(n,a);let r={a:n,b:a};return aR.runKernel(tb,r)}}),rL=aG({div_:function(e,t){let n=aV(e,"a","div"),a=aV(t,"b","div");if([n,a]=ak(n,a),"int32"===n.dtype&&"int32"===a.dtype)return rj(n,a);let r={a:n,b:a};return aR.runKernel(tu,r,{})}}),rz=aG({mul_:function(e,t){let n=aV(e,"a","mul"),a=aV(t,"b","mul");[n,a]=ak(n,a);let r={a:n,b:a};return aR.runKernel(tZ,r)}}),rB=aG({sqrt_:function(e){let t=aV(e,"x","sqrt","float32");return aR.runKernel(nk,{x:t})}}),rV=aG({square_:function(e){let t=aV(e,"x","square");return aR.runKernel("Square",{x:t},{})}}),rU=aG({zerosLike_:function(e){let t=aV(e,"x","zerosLike");return aR.runKernel(nK,{x:t})}});function rW(e){return aR.customGrad(e)}function rG(e,t){if((ai(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&ai(e)&&!(e instanceof Uint8Array))throw Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return aq(e,[],[],t)}e.s(["Serializable",()=>rK,"SerializationMap",()=>rX,"getRegisteredName",()=>rZ,"registerClass",()=>rY],86862);let rH=new Map,rq=new Map;class rK{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}}class rX{static getMap(){return null==rX.instance&&(rX.instance=new rX),rX.instance}static register(e){rX.getMap().classNameMap[e.className]=[e,e.fromConfig]}constructor(){this.classNameMap={}}}function rY(e,t,n){L(null!=e.className,()=>"Class being registered does not have the static className property defined."),L("string"==typeof e.className,()=>"className is required to be a string, but got type "+typeof e.className),L(e.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),void 0===t&&(t="Custom"),void 0===n&&(n=e.className);let a=t+">"+n;return rX.register(e),rH.set(a,e),rq.set(e,a),e}function rZ(e){return rq.has(e)?rq.get(e):e.className}class rQ extends rK{minimize(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,{value:a,grads:r}=this.computeGradients(e,n);if(null!=n){let e=n.map(e=>({name:e.name,tensor:r[e.name]}));this.applyGradients(e)}else this.applyGradients(r);return(aJ(r),t)?a:(a.dispose(),null)}get iterations(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return function(e,t){L(eh(e),()=>"The f passed in variableGrads(f) must be a function"),L(null==t||Array.isArray(t)&&t.every(e=>e instanceof ax),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");let n=null!=t;if(!n)for(let e in t=[],aR.registeredVariables)t.push(aR.registeredVariables[e]);let a=n?t.filter(e=>!e.trainable):null,r=t.length;L((t=t.filter(e=>e.trainable)).length>0,()=>"variableGrads() expects at least one of the input variables to "+"be trainable, but none of the ".concat(r," variables is ")+"trainable.");let{value:i,grads:s}=aR.gradients(e,t,null,!0);L(s.some(e=>null!=e),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),L(0===i.rank,()=>"The f passed in variableGrads(f) must return a scalar, but it "+"returned a rank-".concat(i.rank," tensor"));let o={};return t.forEach((e,t)=>{null!=s[t]&&(o[e.name]=s[t])}),null!=a&&a.forEach(e=>o[e.name]=null),{value:i,grads:o}}(e,t)}dispose(){null!=this.iterations_&&aJ(this.iterations_)}async saveIterations(){return null==this.iterations_&&(this.iterations_=0),{name:"iter",tensor:rG(this.iterations_,"int32")}}async getWeights(){throw Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw Error("setWeights() is not implemented for this optimizer class "+"".concat(this.getClassName()))}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(rQ,Symbol.hasInstance,{value:e=>null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients});class rJ extends rQ{static get className(){return"Adadelta"}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{let a=aR.registeredVariables[t];null==this.accumulatedGrads[n]&&(this.accumulatedGrads[n]={originalName:"".concat(t,"/accum_grad"),variable:aQ(()=>rU(a).variable(!1))}),null==this.accumulatedUpdates[n]&&(this.accumulatedUpdates[n]={originalName:"".concat(t,"/accum_var"),variable:aQ(()=>rU(a).variable(!1))});let r=Array.isArray(e)?e[n].tensor:e[t];if(null==r)return;let i=this.accumulatedGrads[n].variable,s=this.accumulatedUpdates[n].variable;aQ(()=>{let e=rP(rz(i,this.rho),rz(rV(r),1-this.rho)),t=rz(rL(rB(rP(s,this.epsilon)),rB(rP(i,this.epsilon))),r),n=rP(rz(s,this.rho),rz(rV(t),1-this.rho));i.assign(e),s.assign(n);let o=rP(rz(t,-this.learningRate),a);a.assign(o)})}),this.incrementIterations()}dispose(){null!=this.accumulatedUpdates&&(aJ(this.accumulatedGrads.map(e=>e.variable)),aJ(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){let e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){let t=(e=await this.extractIterations(e)).length/2;this.accumulatedGrads=e.slice(0,t).map(e=>({originalName:e.name,variable:e.tensor.variable(!1)})),this.accumulatedUpdates=e.slice(t,2*t).map(e=>({originalName:e.name,variable:e.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}constructor(e,t,n=null){super(),this.learningRate=e,this.rho=t,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],null==n&&(this.epsilon=aR.backend.epsilon())}}function r$(e,t,n){eb(e),n=n||eu(t);let a={shape:e,value:t,dtype:n};return aR.runKernel(tg,{},a)}class r0 extends rQ{static get className(){return"Adagrad"}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{let a=aR.registeredVariables[t];null==this.accumulatedGrads[n]&&(this.accumulatedGrads[n]={originalName:"".concat(t,"/accumulator"),variable:aQ(()=>r$(a.shape,this.initialAccumulatorValue).variable(!1))});let r=Array.isArray(e)?e[n].tensor:e[t];if(null==r)return;let i=this.accumulatedGrads[n].variable;aQ(()=>{let e=rP(i,rV(r));i.assign(e);let t=rP(rz(rL(r,rB(rP(e,aR.backend.epsilon()))),-this.learningRate),a);a.assign(t)})}),this.incrementIterations()}dispose(){null!=this.accumulatedGrads&&aJ(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e),this.accumulatedGrads=e.map(e=>({originalName:e.name,variable:e.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}constructor(e,t=.1){super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}}let r1=aG({pow_:function(e,t){let n=aV(e,"base","pow"),a=aV(t,"exp","pow");[n,a]=ak(n,a);let r={a:n,b:a};return aR.runKernel("Pow",r)}}),r2=aG({sub_:function(e,t){let n=aV(e,"a","sub"),a=aV(t,"b","sub");[n,a]=ak(n,a);let r={a:n,b:a};return aR.runKernel("Sub",r)}});class r3 extends rQ{static get className(){return"Adam"}applyGradients(e){let t=Array.isArray(e)?e.map(e=>e.name):Object.keys(e);aQ(()=>{let n=r2(1,this.accBeta1),a=r2(1,this.accBeta2);t.forEach((t,r)=>{let i=aR.registeredVariables[t];null==this.accumulatedFirstMoment[r]&&(this.accumulatedFirstMoment[r]={originalName:"".concat(t,"/m"),variable:aQ(()=>rU(i).variable(!1))}),null==this.accumulatedSecondMoment[r]&&(this.accumulatedSecondMoment[r]={originalName:"".concat(t,"/v"),variable:aQ(()=>rU(i).variable(!1))});let s=Array.isArray(e)?e[r].tensor:e[t];if(null==s)return;let o=this.accumulatedFirstMoment[r].variable,l=this.accumulatedSecondMoment[r].variable,c=rP(rz(o,this.beta1),rz(s,1-this.beta1)),u=rP(rz(l,this.beta2),rz(rV(s),1-this.beta2)),h=rL(c,n),d=rL(u,a);o.assign(c),l.assign(u);let p=rP(rz(rL(h,rP(rB(d),this.epsilon)),-this.learningRate),i);i.assign(p)}),this.accBeta1.assign(rz(this.accBeta1,this.beta1)),this.accBeta2.assign(rz(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&aJ(this.accumulatedFirstMoment.map(e=>e.variable)),null!=this.accumulatedSecondMoment&&aJ(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){let e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e),aQ(()=>{this.accBeta1.assign(r1(this.beta1,this.iterations_+1)),this.accBeta2.assign(r1(this.beta2,this.iterations_+1))});let t=e.length/2;this.accumulatedFirstMoment=e.slice(0,t).map(e=>({originalName:e.name,variable:e.tensor.variable(!1)})),this.accumulatedSecondMoment=e.slice(t,2*t).map(e=>({originalName:e.name,variable:e.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}constructor(e,t,n,a=null){super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=a,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],aQ(()=>{this.accBeta1=rG(t).variable(),this.accBeta2=rG(n).variable()}),null==a&&(this.epsilon=aR.backend.epsilon())}}let r4=aG({abs_:function(e){let t=aV(e,"x","abs");return"complex64"===t.dtype?aR.runKernel(eJ,{x:t}):aR.runKernel("Abs",{x:t})}});function r5(e,t){let n=e.length,a=[];for(let r=0;r<n;r++){let i=n-1-r,s=e[i]||1;(t[t.length-1-r]||1)>1&&1===s&&a.unshift(i)}return a}function r6(e,t){let n=[];for(let a=0;a<t.length;a++){let r=e[e.length-a-1],i=t.length-a-1,s=t[i];(null==r||1===r&&s>1)&&n.unshift(i)}return n}function r8(e,t){let n=Math.max(e.length,t.length),a=Array(n);for(let r=0;r<n;r++){let i=e[e.length-r-1];null==i&&(i=1);let s=t[t.length-r-1];if(null==s&&(s=1),1===i)a[n-r-1]=s;else if(1===s)a[n-r-1]=i;else if(i!==s)throw Error("Operands could not be broadcast together with shapes "+"".concat(e," and ").concat(t,"."));else a[n-r-1]=i}return a}e.s(["assertAndGetBroadcastShape",()=>r8,"getBroadcastDims",()=>r5,"getReductionAxes",()=>r6],42242);let r9=aG({maximum_:function(e,t){let n=aV(e,"a","maximum"),a=aV(t,"b","maximum");[n,a]=ak(n,a),"bool"===n.dtype&&(n=rM(n,"int32"),a=rM(a,"int32")),r8(n.shape,a.shape);let r={a:n,b:a};return aR.runKernel(tB,r)}});class r7 extends rQ{static get className(){return"Adamax"}applyGradients(e){let t=Array.isArray(e)?e.map(e=>e.name):Object.keys(e);aQ(()=>{let n=r2(1,this.accBeta1),a=rL(-this.learningRate,rP(rz(this.iteration,this.decay),1));t.forEach((t,r)=>{let i=aR.registeredVariables[t];null==this.accumulatedFirstMoment[r]&&(this.accumulatedFirstMoment[r]={originalName:"".concat(t,"/m"),variable:rU(i).variable(!1)}),null==this.accumulatedWeightedInfNorm[r]&&(this.accumulatedWeightedInfNorm[r]={originalName:"".concat(t,"/v"),variable:rU(i).variable(!1)});let s=Array.isArray(e)?e[r].tensor:e[t];if(null==s)return;let o=this.accumulatedFirstMoment[r].variable,l=this.accumulatedWeightedInfNorm[r].variable,c=rP(rz(o,this.beta1),rz(s,1-this.beta1)),u=r9(rz(l,this.beta2),r4(s));o.assign(c),l.assign(u);let h=rP(rz(rL(a,n),rL(c,rP(u,this.epsilon))),i);i.assign(h)}),this.iteration.assign(rP(this.iteration,1)),this.accBeta1.assign(rz(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&aJ(this.accumulatedFirstMoment.map(e=>e.variable)),null!=this.accumulatedWeightedInfNorm&&aJ(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}constructor(e,t,n,a=null,r=0){super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=a,this.decay=r,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],aQ(()=>{this.iteration=rG(0).variable(),this.accBeta1=rG(t).variable()}),null==a&&(this.epsilon=aR.backend.epsilon())}}class ie extends rQ{static get className(){return"SGD"}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{let a=Array.isArray(e)?e[n].tensor:e[t];if(null==a)return;let r=aR.registeredVariables[t];aQ(()=>{let e=rP(rz(this.c,a),r);r.assign(e)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=a$(rG(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(0!==(e=await this.extractIterations(e)).length)throw Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}}class it extends ie{static get className(){return"Momentum"}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{let a=aR.registeredVariables[t];null==this.accumulations[n]&&(this.accumulations[n]={originalName:"".concat(t,"/momentum"),variable:aQ(()=>rU(a).variable(!1))});let r=this.accumulations[n].variable,i=Array.isArray(e)?e[n].tensor:e[t];null!=i&&aQ(()=>{let e,t=rP(rz(this.m,r),i);e=this.useNesterov?rP(rz(this.c,rP(i,rz(t,this.m))),a):rP(rz(this.c,t),a),r.assign(t),a.assign(e)})}),this.incrementIterations()}dispose(){this.m.dispose(),null!=this.accumulations&&aJ(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e),this.accumulations=e.map(e=>({originalName:e.name,variable:e.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}constructor(e,t,n=!1){super(e),this.learningRate=e,this.momentum=t,this.useNesterov=n,this.accumulations=[],this.m=rG(this.momentum)}}class ia extends rQ{static get className(){return"RMSProp"}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{let a=aR.registeredVariables[t];null==this.accumulatedMeanSquares[n]&&(this.accumulatedMeanSquares[n]={originalName:"".concat(t,"/rms"),variable:aQ(()=>rU(a).variable(!1))}),null==this.accumulatedMoments[n]&&(this.accumulatedMoments[n]={originalName:"".concat(t,"/momentum"),variable:aQ(()=>rU(a).variable(!1))}),null==this.accumulatedMeanGrads[n]&&this.centered&&(this.accumulatedMeanGrads[n]={originalName:"".concat(t,"/mg"),variable:aQ(()=>rU(a).variable(!1))});let r=Array.isArray(e)?e[n].tensor:e[t];if(null==r)return;let i=this.accumulatedMeanSquares[n].variable,s=this.accumulatedMoments[n].variable;aQ(()=>{let e=rP(rz(i,this.decay),rz(rV(r),1-this.decay));if(this.centered){let t=this.accumulatedMeanGrads[n].variable,o=rP(rz(t,this.decay),rz(r,1-this.decay)),l=rL(rz(r,this.learningRate),rB(r2(e,rP(rV(o),this.epsilon)))),c=rP(rz(s,this.momentum),l);i.assign(e),t.assign(o),s.assign(c);let u=r2(a,c);a.assign(u)}else{let e=rP(rz(i,this.decay),rz(rV(r),1-this.decay)),t=rP(rz(s,this.momentum),rL(rz(r,this.learningRate),rB(rP(e,this.epsilon))));i.assign(e),s.assign(t);let n=r2(a,t);a.assign(n)}})}),this.incrementIterations()}dispose(){null!=this.accumulatedMeanSquares&&aJ(this.accumulatedMeanSquares.map(e=>e.variable)),null!=this.accumulatedMeanGrads&&this.centered&&aJ(this.accumulatedMeanGrads.map(e=>e.variable)),null!=this.accumulatedMoments&&aJ(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){let e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);let t=this.centered?e.length/3:e.length/2;this.accumulatedMeanSquares=e.slice(0,t).map(e=>({originalName:e.name,variable:e.tensor.variable(!1)})),this.accumulatedMoments=e.slice(t,2*t).map(e=>({originalName:e.name,variable:e.tensor.variable(!1)})),this.centered&&(this.accumulatedMeanGrads=e.slice(2*t,3*t).map(e=>({originalName:e.name,variable:e.tensor.variable(!1)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}constructor(e,t=.9,n=0,a=null,r=!1){if(super(),this.learningRate=e,this.decay=t,this.momentum=n,this.epsilon=a,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=r,null==a&&(this.epsilon=aR.backend.epsilon()),null==e)throw Error("learningRate for RMSPropOptimizer must be defined.")}}for(let e of[rJ,r0,r3,r7,it,ia,ie])rY(e);let ir=aG({step_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=aV(e,"x","step");return aR.runKernel(nX,{x:n},{alpha:t})}}),ii={kernelName:"Abs",inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>rz(e,ir(rM(n,"float32"),-1))}}},is=aG({neg_:function(e){let t=aV(e,"x","neg");return aR.runKernel("Neg",{x:t})}}),io=aG({reshape_:function(e,t){let n=aV(e,"x","reshape","string_or_numeric");return aR.runKernel(nr,{x:n},{shape:t})}}),il=aG({sum_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=aV(e,"x","sum");"bool"===a.dtype&&(a=rM(a,"int32"));let r={x:a};return aR.runKernel("Sum",r,{axis:t,keepDims:n})}});function ic(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5?arguments[5]:void 0,s=[...t,e[3]];return id(e,s,n,i,a,null,null,ik(r))}function iu(e,t,n,a,r,i){let s,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",[l,c]=ig(t);if("channelsLast"===o)s=[l,c,e[3],e[3]];else if("channelsFirst"===o)s=[l,c,e[1],e[1]];else throw Error("Unknown dataFormat ".concat(o));return id(e,s,n,a,r,i,!1,o)}function ih(e,t,n,a,r,i){let s,o,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NDHWC",[c,u,h]=ix(t);if("NDHWC"===l)o="channelsLast",s=[c,u,h,e[4],e[4]];else if("NCDHW"===l)o="channelsFirst",s=[c,u,h,e[1],e[1]];else throw Error("Unknown dataFormat ".concat(l));return ip(e,s,n,a,r,!1,o,i)}function id(e,t,n,a,r,i){let s,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"channelsLast",[c,u,h,d]=[-1,-1,-1,-1];if("channelsLast"===l)[c,u,h,d]=e;else if("channelsFirst"===l)[c,d,u,h]=e;else throw Error("Unknown dataFormat ".concat(l));let[p,f,,m]=t,[g,x]=ig(n),[y,b]=ig(a),v=iy(p,y),w=iy(f,b),{padInfo:N,outHeight:k,outWidth:S}=function(e,t,n,a,r,i,s,o,l){let c,u,h;if("number"==typeof e){let r=0===e?"VALID":"NUMBER";c={top:e,bottom:e,left:e,right:e,type:r};let s=function(e,t,n,a,r){null==a&&(a=im(e,t,n));let i=e[0],s=e[1];return[ib((i-t+2*a)/n+1,r),ib((s-t+2*a)/n+1,r)]}([t,n],i,a,e,o);u=s[0],h=s[1]}else if("same"===e){let e=Math.max(0,((u=Math.ceil(t/a))-1)*a+i-t),o=Math.max(0,((h=Math.ceil(n/r))-1)*r+s-n),l=Math.floor(e/2),d=Math.floor(o/2);c={top:l,bottom:e-l,left:d,right:o-d,type:"SAME"}}else if("valid"===e)c={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((t-i+1)/a),h=Math.ceil((n-s+1)/r);else if("object"==typeof e){let d="channelsLast"===l?e[1][0]:e[2][0],p="channelsLast"===l?e[1][1]:e[2][1],f="channelsLast"===l?e[2][0]:e[3][0],m="channelsLast"===l?e[2][1]:e[3][1];c={top:d,bottom:p,left:f,right:m,type:0===d&&0===p&&0===f&&0===m?"VALID":"EXPLICIT"},u=ib((t-i+d+p)/a+1,o),h=ib((n-s+f+m)/r+1,o)}else throw Error("Unknown padding parameter: ".concat(e));return{padInfo:c,outHeight:u,outWidth:h}}(r,u,h,g,x,v,w,i,l),C=o?m*d:m;return"channelsFirst"===l?s=[c,C,k,S]:"channelsLast"===l&&(s=[c,k,S,C]),{batchSize:c,dataFormat:l,inHeight:u,inWidth:h,inChannels:d,outHeight:k,outWidth:S,outChannels:C,padInfo:N,strideHeight:g,strideWidth:x,filterHeight:p,filterWidth:f,effectiveFilterHeight:v,effectiveFilterWidth:w,dilationHeight:y,dilationWidth:b,inShape:e,outShape:s,filterShape:t}}function ip(e,t,n,a,r){let i,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",l=arguments.length>7?arguments[7]:void 0,[c,u,h,d,p]=[-1,-1,-1,-1,-1];if("channelsLast"===o)[c,u,h,d,p]=e;else if("channelsFirst"===o)[c,p,u,h,d]=e;else throw Error("Unknown dataFormat ".concat(o));let[f,m,g,,x]=t,[y,b,v]=ix(n),[w,N,k]=ix(a),S=iy(f,w),C=iy(m,N),T=iy(g,k),{padInfo:I,outDepth:E,outHeight:_,outWidth:A}=function(e,t,n,a,r,i,s,o,l,c,u){let h,d,p,f;if("valid"===e&&(e=0),"number"==typeof e){let m=0===e?"VALID":"NUMBER";h={top:e,bottom:e,left:e,right:e,front:e,back:e,type:m};let g=function(e,t,n,a,r,i){null==r&&(r=im(e,t[0],a[0]));let s=[0,0,0,1];for(let n=0;n<3;n++)e[n]+2*r>=t[n]&&(s[n]=ib((e[n]-t[n]+2*r)/a[n]+1,i));return s}([t,n,a,1],[o,l,c],0,[r,i,s],e,u);d=g[0],p=g[1],f=g[2]}else if("same"===e){let e=((d=Math.ceil(t/r))-1)*r+o-t,u=((p=Math.ceil(n/i))-1)*i+l-n,m=((f=Math.ceil(a/s))-1)*s+c-a,g=Math.floor(e/2),x=Math.floor(u/2),y=Math.floor(m/2);h={top:x,bottom:u-x,left:y,right:m-y,front:g,back:e-g,type:"SAME"}}else throw Error("Unknown padding parameter: ".concat(e));return{padInfo:h,outDepth:d,outHeight:p,outWidth:f}}(r,u,h,d,y,b,v,S,C,T,l),R=s?x*p:x;return"channelsFirst"===o?i=[c,R,E,_,A]:"channelsLast"===o&&(i=[c,E,_,A,R]),{batchSize:c,dataFormat:o,inDepth:u,inHeight:h,inWidth:d,inChannels:p,outDepth:E,outHeight:_,outWidth:A,outChannels:R,padInfo:I,strideDepth:y,strideHeight:b,strideWidth:v,filterDepth:f,filterHeight:m,filterWidth:g,effectiveFilterDepth:S,effectiveFilterHeight:C,effectiveFilterWidth:T,dilationDepth:w,dilationHeight:N,dilationWidth:k,inShape:e,outShape:i,filterShape:t}}function im(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=iy(t,a);return Math.floor((e[0]*(n-1)-n+r)/2)}function ig(e){return"number"==typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function ix(e){return"number"==typeof e?[e,e,e]:e}function iy(e,t){return t<=1?e:e+(e-1)*(t-1)}function ib(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw Error("Unknown roundingMode ".concat(t))}}function iv(e){let[t,n,a]=ig(e);return 1===t&&1===n&&1===a}function iw(e,t){return iv(e)||iv(t)}function iN(e){return ig(e).every(e=>e>0)}function ik(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw Error("Unknown dataFormat ".concat(e))}function iS(e,t,n){if(null!=n)if("string"==typeof t)throw Error("Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,"."));else if("number"==typeof t)L(H(t),()=>"Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,"."));else if("object"==typeof t)t.forEach(t=>{t.forEach(t=>{L(H(t),()=>"Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,"."))})});else throw Error("Error in ".concat(e,": Unknown padding parameter: ").concat(t))}e.s(["checkPadOnDimRoundingMode",()=>iS,"computeConv2DInfo",()=>id,"computeConv3DInfo",()=>ip,"computeDefaultPad",()=>im,"computeDilation2DInfo",()=>ic,"computePool2DInfo",()=>iu,"computePool3DInfo",()=>ih,"convertConv2DDataFormat",()=>ik,"eitherStridesOrDilationsAreOne",()=>iw,"stridesOrDilationsArePositive",()=>iN,"tupleValuesAreOne",()=>iv],19813);let iC=aG({avgPool3dGrad_:function(e,t,n,a,r,i){let s=aV(e,"dy","avgPool3dGrad"),o=aV(t,"input","avgPool3dGrad"),l=s,c=o,u=!1;4===o.rank&&(u=!0,l=io(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]),c=io(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),L(5===l.rank,()=>"Error in avgPool3dGrad: dy must be rank 5 but got rank "+"".concat(l.rank,".")),L(5===c.rank,()=>"Error in avgPool3dGrad: input must be rank 5 but got rank "+"".concat(c.rank,".")),iS("avgPool3dGrad",r,i);let h={dy:l,input:c},d=aR.runKernel(eU,h,{filterSize:n,strides:a,pad:r,dimRoundingMode:i});return u?io(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}}),iT=aG({avgPoolGrad_:function(e,t,n,a,r){let i=aV(e,"dy","avgPoolGrad"),s=aV(t,"input","avgPoolGrad");L(s.rank===i.rank,()=>"Rank of input (".concat(s.rank,") does not match rank of dy (").concat(i.rank,")"));let o=s,l=i,c=!1;3===s.rank&&(c=!0,o=io(s,[1,s.shape[0],s.shape[1],s.shape[2]]),l=io(i,[1,i.shape[0],i.shape[1],i.shape[2]])),L(4===l.rank,()=>"Error in avgPoolGrad: dy must be rank 4 but got rank "+"".concat(l.rank,".")),L(4===o.rank,()=>"Error in avgPoolGrad: input must be rank 4 but got rank "+"".concat(o.rank,"."));let u={dy:l,input:o},h=aR.runKernel(eB,u,{filterSize:n,strides:a,pad:r});return c?io(h,[h.shape[1],h.shape[2],h.shape[3]]):h}}),iI=aG({matMul_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=aV(e,"a","matMul"),i=aV(t,"b","matMul");[r,i]=ak(r,i);let s={a:r,b:i};return aR.runKernel(eW,s,{transposeA:n,transposeB:a})}}),iE=aG({spaceToBatchND_:function(e,t,n){let a=aV(e,"x","spaceToBatchND");return L(a.rank>=1+t.length,()=>"input rank ".concat(a.rank," should be > than [blockShape] ").concat(t.length)),L(n.length===t.length,()=>"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(t.length)),L(a.shape.reduce((e,a,r)=>r>0&&r<=t.length?e&&(a+n[r-1][0]+n[r-1][1])%t[r-1]==0:e,!0),()=>"input spatial dimensions ".concat(a.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(t.toString())),aR.runKernel(nS,{x:a},{blockShape:t,paddings:n})}}),i_=aG({greaterEqual_:function(e,t){let n=aV(e,"a","greaterEqual","string_or_numeric"),a=aV(t,"b","greaterEqual","string_or_numeric");[n,a]=ak(n,a),r8(n.shape,a.shape);let r={a:n,b:a};return aR.runKernel(tS,r)}}),iA=aG({lessEqual_:function(e,t){let n=aV(e,"a","lessEqual","string_or_numeric"),a=aV(t,"b","lessEqual","string_or_numeric");[n,a]=ak(n,a),r8(n.shape,a.shape);let r={a:n,b:a};return aR.runKernel(tM,r)}}),iR=aG({logicalAnd_:function(e,t){let n=aV(e,"a","logicalAnd","bool"),a=aV(t,"b","logicalAnd","bool");return r8(n.shape,a.shape),aR.runKernel(tP,{a:n,b:a})}}),iD=aG({broadcastTo_:function(e,t){let n=aV(e,"broadcastTo","x"),a=n.shape;if(eb(t),t.length<n.rank)throw Error("broadcastTo(): shape.length=".concat(t.length," < input.rank=").concat(n.rank,"."));if(t.length>n.rank){let e=n.shape.slice();for(;e.length<t.length;)e.unshift(1);n=io(n,e)}let r=n.shape,i=Array.from(t);for(let e=t.length-1;e>=0;e--)if(r[e]===t[e])i[e]=1;else if(1!==n.shape[e])throw Error("broadcastTo(): [".concat(a,"] cannot be broadcast to [").concat(t,"]."));if(0===i.map((e,t)=>e>1?t:-1).filter(e=>e>=0).length)return rF(n);let s={x:n};return aR.runKernel(nB,s,{reps:i})}}),iM=aG({where_:function(e,t,n){let a=aV(t,"a","where"),r=aV(n,"b","where"),i=aV(e,"condition","where","bool"),s=r8(r8(i.shape,a.shape),r.shape),o=iD(i,s),l=iD(a,s),c=iD(r,s);return aR.runKernel(ng,{condition:o,t:l,e:c})}}),iF={kernelName:eJ,inputsToSave:["x"],gradFunc:ii.gradFunc},iO=aG({split_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=aV(e,"x","split");return aR.runKernel(nC,{x:a},{numOrSizeSplits:t,axis:n})}}),iP=aG({conv2DBackpropFilter_:function(e,t,n,a,r){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",s=arguments.length>6?arguments[6]:void 0,o=e;3===e.rank&&(o=io(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;3===l.rank&&(l=io(t,[1,t.shape[0],t.shape[1],t.shape[2]])),L(4===o.rank,()=>"Error in conv2dDerFilter: input must be rank 4, but got shape "+"".concat(o.shape,".")),L(4===l.rank,()=>"Error in conv2dDerFilter: dy must be rank 4, but got shape "+"".concat(l.shape,".")),L(4===n.length,()=>"Error in conv2dDerFilter: filterShape must be length 4, but got "+"".concat(n,"."));let c="NHWC"===i?o.shape[3]:o.shape[1],u="NHWC"===i?l.shape[3]:l.shape[1];L(c===n[2],()=>"Error in conv2dDerFilter: depth of input ".concat(c,") must ")+"match input depth in filter (".concat(n[2],".")),L(u===n[3],()=>"Error in conv2dDerFilter: depth of dy (".concat(u,") must ")+"match output depth for filter (".concat(n[3],").")),iS("conv2dDerFilter",r,s);let h={x:o,dy:l};return aR.runKernel(e1,h,{strides:a,pad:r,dataFormat:i,dimRoundingMode:s,filterShape:n})}}),ij=aG({conv2DBackpropInput_:function(e,t,n,a,r){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",s=arguments.length>6?arguments[6]:void 0;L(e.length===t.rank,()=>"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match"));let o=e,l=t,c=!1;3===t.rank&&(c=!0,l=io(t,[1,t.shape[0],t.shape[1],t.shape[2]]),o=[1,e[0],e[1],e[2]]),L(4===o.length,()=>"Error in conv2dDerInput: inShape must be length 4, but got length "+"".concat(o.length,".")),L(4===l.rank,()=>"Error in conv2dDerInput: dy must be rank 4, but got "+"rank ".concat(l.rank)),L(4===n.rank,()=>"Error in conv2dDerInput: filter must be rank 4, but got "+"rank ".concat(n.rank));let u="NHWC"===i?o[3]:o[1],h="NHWC"===i?l.shape[3]:l.shape[1];L(u===n.shape[2],()=>"Error in conv2dDerInput: depth of input (".concat(u,") must ")+"match input depth for filter ".concat(n.shape[2],".")),L(h===n.shape[3],()=>"Error in conv2dDerInput: depth of output (".concat(h,") must ")+"match output depth for filter ".concat(n.shape[3],".")),iS("conv2dDerInput",r,s);let d={dy:l,filter:n},p={strides:a,pad:r,dataFormat:i,dimRoundingMode:s,inputShape:o},f=aR.runKernel(e2,d,p);return c?io(f,[f.shape[1],f.shape[2],f.shape[3]]):f}}),iL=aG({conv2d_:function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],s=arguments.length>6?arguments[6]:void 0,o=aV(e,"x","conv2d","float32"),l=aV(t,"filter","conv2d","float32"),c=o,u=!1;3===o.rank&&(u=!0,c=io(o,[1,o.shape[0],o.shape[1],o.shape[2]])),L(4===c.rank,()=>"Error in conv2d: input must be rank 4, but got rank ".concat(c.rank,".")),L(4===l.rank,()=>"Error in conv2d: filter must be rank 4, but got rank "+"".concat(l.rank,".")),iS("conv2d",a,s);let h="NHWC"===r?c.shape[3]:c.shape[1];L(h===l.shape[2],()=>"Error in conv2d: depth of input (".concat(h,") must match ")+"input depth for filter ".concat(l.shape[2],".")),L(iw(n,i),()=>"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(i,"'")),L(iN(i),()=>"Error in conv2D: Dilated rates should be larger than 0."),L(iN(n),()=>"Error in conv2D: Strides should be larger than 0.");let d={x:c,filter:l},p=aR.runKernel(e0,d,{strides:n,pad:a,dataFormat:r,dilations:i,dimRoundingMode:s});return u?io(p,[p.shape[1],p.shape[2],p.shape[3]]):p}}),iz=aG({conv3DBackpropFilter_:function(e,t,n,a,r){let i=e;4===e.rank&&(i=io(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));let s=t;4===s.rank&&(s=io(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),L(5===i.rank,()=>"Error in conv3dDerFilter: input must be rank 5, but got shape "+"".concat(i.shape,".")),L(5===s.rank,()=>"Error in conv3dDerFilter: dy must be rank 5, but got shape "+"".concat(s.shape,".")),L(5===n.length,()=>"Error in conv3dDerFilter: filterShape must be length 5, but got "+"".concat(n,".")),L(i.shape[4]===n[3],()=>"Error in conv3dDerFilter: depth of input ".concat(i.shape[4],") must ")+"match input depth in filter (".concat(n[3],".")),L(s.shape[4]===n[4],()=>"Error in conv3dDerFilter: depth of dy (".concat(s.shape[4],") must ")+"match output depth for filter (".concat(n[4],")."));let o={x:i,dy:s};return aR.runKernel(e4,o,{strides:a,pad:r,filterShape:n})}}),iB=aG({conv3DBackpropInput_:function(e,t,n,a,r){L(e.length===t.rank,()=>"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match"));let i=e,s=t,o=!1;4===t.rank&&(o=!0,s=io(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),i=[1,e[0],e[1],e[2],e[3]]);let l=i[4],c=s.shape[4];L(5===i.length,()=>"Error in conv3dDerInput: inShape must be length 5, but got length "+"".concat(i.length,".")),L(5===s.rank,()=>"Error in conv3dDerInput: dy must be rank 5, but got "+"rank ".concat(s.rank)),L(5===n.rank,()=>"Error in conv3dDerInput: filter must be rank 5, but got "+"rank ".concat(n.rank)),L(l===n.shape[3],()=>"Error in conv3dDerInput: depth of input (".concat(l,") must ")+"match input depth for filter ".concat(n.shape[3],".")),L(c===n.shape[4],()=>"Error in conv3dDerInput: depth of output (".concat(c,") must ")+"match output depth for filter ".concat(n.shape[4],"."));let u={dy:s,filter:n},h={pad:r,strides:a,inputShape:i},d=aR.runKernel(e5,u,h);return o?io(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}}),iV=aG({sin_:function(e){let t=aV(e,"x","sin","float32");return aR.runKernel("Sin",{x:t})}}),iU=aG({sinh_:function(e){let t=aV(e,"x","sinh");return aR.runKernel(nb,{x:t})}});function iW(e,t){for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function iG(e,t,n){let a=e.length+t.length,r=[],i=0,s=0;for(let o=0;o<a;o++)-1===n.indexOf(o)?r.push(e[i++]):r.push(t[s++]);return r}function iH(e,t){let n=[],a=e.length;for(let r=0;r<a;r++)-1===t.indexOf(r)&&n.push(e[r]);return[n,t.map(t=>e[t])]}function iq(e,t){return iG(e,t.map(e=>1),t)}function iK(e,t,n){L(iW(t,n),()=>"".concat(e," supports only inner-most axes for now. ")+"Got axes ".concat(t," and rank-").concat(n," input."))}function iX(e,t){if(iW(e,t))return null;let n=[];for(let a=0;a<t;++a)-1===e.indexOf(a)&&n.push(a);return e.forEach(e=>n.push(e)),n}function iY(e){return e.map((e,t)=>[t,e]).sort((e,t)=>e[1]-t[1]).map(e=>e[0])}function iZ(e,t){let n=[];for(let a=t-e;a<t;++a)n.push(a);return n}e.s(["assertAxesAreInnerMostDims",()=>iK,"axesAreInnerMostDims",()=>iW,"combineLocations",()=>iG,"computeOutAndReduceShapes",()=>iH,"expandShapeToKeepDim",()=>iq,"getAxesPermutation",()=>iX,"getInnerMostAxes",()=>iZ,"getUndoAxesPermutation",()=>iY],15401);let iQ=aG({cumsum_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=aV(e,"x","cumsum");return aR.runKernel(e9,{x:r},{axis:t,exclusive:n,reverse:a})}});e.s(["transpose",()=>i0],90049);let iJ=aG({imag_:function(e){let t=aV(e,"input","imag");return aR.runKernel(tI,{input:t})}}),i$=aG({real_:function(e){let t=aV(e,"input","real");return aR.runKernel(nt,{input:t})}}),i0=aG({transpose_:function(e,t,n){let a=aV(e,"x","transpose");if(null==t&&(t=a.shape.map((e,t)=>t).reverse()),L(a.rank===t.length,()=>"Error in transpose: rank of input ".concat(a.rank," ")+"must match length of perm ".concat(t,".")),t.forEach(e=>{L(e>=0&&e<a.rank,()=>"All entries in 'perm' must be between 0 and ".concat(a.rank-1)+" but got ".concat(t))}),a.rank<=1)return a.clone();let r={perm:t};return"complex64"===a.dtype?aQ(()=>{let e=i$(a),t=iJ(a);return e=aR.runKernel(nW,{x:e},r),t=aR.runKernel(nW,{x:t},r),n&&(t=is(t)),aH(e,t)}):aR.runKernel(nW,{x:a},r)}}),i1=aG({depthwiseConv2dNativeBackpropFilter_:function(e,t,n,a,r){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],s=arguments.length>6?arguments[6]:void 0,o=e;3===e.rank&&(o=io(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;3===l.rank&&(l=io(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let c={x:o,dy:l};return aR.runKernel(ta,c,{strides:a,pad:r,dimRoundingMode:s,dilations:i,filterShape:n})}}),i2=aG({depthwiseConv2dNativeBackpropInput_:function(e,t,n,a,r){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],s=arguments.length>6?arguments[6]:void 0,o=t,l=!1;3===t.rank&&(l=!0,o=io(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let c={dy:o,filter:n},u=aR.runKernel(tr,c,{strides:a,pad:r,dimRoundingMode:s,dilations:i,inputShape:e});return l?io(u,[u.shape[1],u.shape[2],u.shape[3]]):u}}),i3=aG({exp_:function(e){let t=aV(e,"x","exp");return aR.runKernel("Exp",{x:t})}}),i4=aG({rsqrt_:function(e){let t=aV(e,"x","rsqrt","float32");return aR.runKernel(nd,{x:t})}}),i5=aG({tile_:function(e,t){let n=aV(e,"x","tile","string_or_numeric");return L(n.rank===t.length,()=>"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of reps ".concat(t,".")),aR.runKernel(nB,{x:n},{reps:t})}}),i6=aG({stack_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=aU(e,"tensors","stack","string_or_numeric");return L(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&L(t<=n[0].rank,()=>"Axis must be <= rank of the tensor"),aR.runKernel(t3,n,{axis:t})}}),i8=aG({unsortedSegmentSum_:function(e,t,n){let a=aV(e,"x","unsortedSegmentSum"),r=aV(t,"segmentIds","unsortedSegmentSum","int32");return L(H(n),()=>"numSegments must be of dtype int"),aR.runKernel(nq,{x:a,segmentIds:r},{numSegments:n})}});function i9(e,t){let n=[];for(let a=e;a<t;++a)n.push(a);return n}function i7(e){let t=[];for(let n=0;n<e.length;++n)for(let a=0;a<e[n].length;++a)t.push(e[n][a]);return t}let se=aG({greater_:function(e,t){let n=aV(e,"a","greater","string_or_numeric"),a=aV(t,"b","greater","string_or_numeric");[n,a]=ak(n,a),r8(n.shape,a.shape);let r={a:n,b:a};return aR.runKernel(tk,r)}}),st=aG({localResponseNormalizationBackprop_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:.5;return aR.runKernel(tz,{x:e,y:t,dy:n},{depthRadius:a,bias:r,alpha:i,beta:s})}}),sn=aG({equal_:function(e,t){let n=aV(e,"a","equal","string_or_numeric"),a=aV(t,"b","equal","string_or_numeric");[n,a]=ak(n,a),r8(n.shape,a.shape);let r={a:n,b:a};return aR.runKernel(tp,r)}});function sa(e,t,n,a){return t.rank<n.rank&&(t=io(t,iq(t.shape,a))),e.rank<n.rank&&(e=io(e,iq(e.shape,a))),{x:()=>rz(e,rM(sn(n,t),e.dtype))}}let sr={kernelName:"Max",inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let{reductionIndices:a}=n,r=t[0],i=t[1],s=J(a,r.shape),o=sa(e,i,r,s);return{x:()=>o.x()}}},si=aG({less_:function(e,t){let n=aV(e,"a","less","string_or_numeric"),a=aV(t,"b","less","string_or_numeric");[n,a]=ak(n,a),r8(n.shape,a.shape);let r={a:n,b:a};return aR.runKernel(tD,r)}}),ss=aG({maxPool3dGrad_:function(e,t,n,a,r,i,s){let o=aV(e,"dy","maxPool3dGrad"),l=aV(t,"input","maxPool3dGrad"),c=aV(n,"output","maxPool3dGrad"),u=o,h=l,d=c,p=!1;4===l.rank&&(p=!0,u=io(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),h=io(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),d=io(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),L(5===u.rank,()=>"Error in maxPool3dGrad: dy must be rank 5 but got rank "+"".concat(u.rank,".")),L(5===h.rank,()=>"Error in maxPool3dGrad: input must be rank 5 but got rank "+"".concat(h.rank,".")),L(5===d.rank,()=>"Error in maxPool3dGrad: output must be rank 5 but got rank "+"".concat(d.rank,".")),iS("maxPool3dGrad",i,s);let f={dy:u,input:h,output:d},m=aR.runKernel(tG,f,{filterSize:a,strides:r,pad:i,dimRoundingMode:s});return p?io(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}}),so=aG({maxPoolGrad_:function(e,t,n,a,r,i,s){let o=aV(e,"dy","maxPoolGrad"),l=aV(t,"input","maxPoolGrad"),c=aV(n,"output","maxPoolGrad");return L(l.rank===o.rank,()=>"Rank of input (".concat(l.rank,") does not match rank of dy ")+"(".concat(o.rank,")")),L(4===o.rank,()=>"Error in maxPoolGrad: dy must be rank 4 but got rank "+"".concat(o.rank,".")),L(4===l.rank,()=>"Error in maxPoolGrad: input must be rank 4 but got rank "+"".concat(l.rank,".")),iS("maxPoolGrad",i,s),aR.runKernel(tU,{dy:o,input:l,output:c},{filterSize:a,strides:r,pad:i,dimRoundingMode:s})}});function sl(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if(eb(e),"complex64"===t)return aH(sl(e,"float32"),sl(e,"float32"));let n=ex(V(e),t);return aR.makeTensor(n,e,t)}function sc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if(eb(e),"complex64"===t)return aH(sc(e,"float32"),sl(e,"float32"));let n=eg(V(e),t);return aR.makeTensor(n,e,t)}let su=aG({slice_:function(e,t,n){let a=aV(e,"x","slice","string_or_numeric");if(0===a.rank)throw Error("Slicing scalar is not possible");return aR.runKernel(ny,{x:a},{begin:t,size:n})}}),sh=aG({floor_:function(e){let t=aV(e,"x","floor","float32");return aR.runKernel(ty,{x:t})}}),sd=aG({unstack_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=aV(e,"x","unstack","string_or_numeric");return L(t>=-n.shape.length&&t<n.shape.length,()=>"Axis = ".concat(t," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")")),aR.runKernel(nH,{value:n},{axis:t})}}),sp={kernelName:t4,inputsToSave:["x"],gradFunc:(e,t,n)=>{let a=t[0],{paddings:r}=n,i=r.map(e=>e[0]);return{x:()=>su(e,i,a.shape)}}},sf=aG({log_:function(e){let t=aV(e,"x","log","float32");return aR.runKernel("Log",{x:t})}});function sm(e,t,n){let a=e.shape.length;L(a===t.length,()=>"Error in slice".concat(a,"D: Length of begin ").concat(t," must ")+"match the rank of the array (".concat(a,").")),L(a===n.length,()=>"Error in slice".concat(a,"D: Length of size ").concat(n," must ")+"match the rank of the array (".concat(a,")."));for(let r=0;r<a;++r)L(t[r]+n[r]<=e.shape[r],()=>"Error in slice".concat(a,"D: begin[").concat(r,"] + size[").concat(r,"] ")+"(".concat(t[r]+n[r],") would overflow input.shape[").concat(r,"] (").concat(e.shape[r],")"))}function sg(e){let t=[],n=0;for(;e>0;)1&e&&t.push(n),e/=2,n++;return t}function sx(e,t,n){let a=[];for(let r=0;r<e.length;r++)a[r]=Math.ceil((t[r]-e[r])/n[r]);return a}function sy(e,t,n,a){let r=[...e];for(let e=r.length;e<a.length;e++)r.push(1);for(let e=0;e<n;e++)0===e?r[t]=1:(r.splice(t,0,1),r.pop());return r}function sb(e,t){let n=[];for(let a=0;a<e;a++)n.push(t+a);return n}function sv(e,t,n,a,r,i,s,o,l){let c=e.length,u=Array(c),h=Array(c),d=Array(c);if(t.length&&n>0){let l=t[0],c=n+1;u=sw(s,l,c,a,e),h=sN(o,l,c,r,e),d=sy(i,l,c,e)}else for(let t=0;t<c;t++)u[t]=sS(s,a,i,e,t,l),h[t]=sC(o,r,i,e,t,l),d[t]=sk(i,t,l);return{begin:u,end:h,strides:d}}function sw(e,t,n,a,r){let i=[...r],s=sb(n,t);for(let r=0;r<i.length;r++)if(s.indexOf(r)>-1)i[r]=0;else{var o,l,c;let s=(o=t,l=n,(c=r)<=o?c:c-(l-1)),u=a[s];e&1<<s&&(u=0),i[r]=u}return i}function sN(e,t,n,a,r){let i=[...r],s=sb(n,t);for(let r=0;r<i.length;r++)if(s.indexOf(r)>-1)i[r]=Number.MAX_SAFE_INTEGER;else{var o,l,c;let s=(o=t,l=n,(c=r)<=o?c:c-(l-1)),u=a[s];e&1<<s&&(u=Number.MAX_SAFE_INTEGER),i[r]=u}for(let e=0;e<i.length;e++){let t=r[e];i[e]<0&&(i[e]+=t),i[e]=D(0,i[e],r[e])}return i}function sk(e,t,n){let a=e[t];return(n&1<<t||null==a)&&(a=1),a}function sS(e,t,n,a,r,i){let s=t[r],o=n[r]||1;(e&1<<r||i&1<<r||null==s)&&(s=o>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);let l=a[r];return s<0&&(s+=l),s=D(0,s,l-1)}function sC(e,t,n,a,r,i){let s=t[r],o=n[r]||1;(e&1<<r||i&1<<r||null==s)&&(s=o>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);let l=a[r];return s<0&&(s+=l),s=o>0?D(0,s,l):D(-1,s,l-1)}function sT(e,t,n){let a=n.length;for(let e=0;e<n.length;e++)if(n[e]>1){a=e;break}for(let r=a+1;r<n.length;r++)if(t[r]>0||n[r]!==e[r])return!1;return!0}function sI(e,t){let n=e.length>0?e[e.length-1]:1;for(let a=0;a<e.length-1;a++)n+=e[a]*t[a];return n}function sE(e,t,n){let a,r,i=e.shape.length;return(a="number"==typeof t?[t,...Array(i-1).fill(0)]:t.length<i?t.concat(Array(i-t.length).fill(0)):t.slice()).forEach(e=>{L(-1!==e,()=>"slice() does not support negative begin indexing.")}),r=(r=null==n?Array(i).fill(-1):"number"==typeof n?[n,...Array(i-1).fill(-1)]:n.length<i?n.concat(Array(i-n.length).fill(-1)):n).map((t,n)=>t>=0?t:(L(-1===t,()=>"Negative size values should be exactly -1 but got "+"".concat(t," for the slice() size at index ").concat(n,".")),e.shape[n]-a[n])),[a,r]}function s_(e,t,n,a,r,i,s,o,l){let c;if(null==a?(c=Array(t.length)).fill(1):c=a,null!=s&&(s&s-1)!=0)throw Error("Multiple ellipses in slice is not allowed.");let u=!1,h={dims:c.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:c.slice(),beginMask:r,endMask:i,ellipsisMask:s,newAxisMask:o,shrinkAxisMask:l};for(let e=0;e<h.dims;e++)u&&(1<<e&o)!=0&&h.numAddAxisAfterEllipsis++,1<<e&s&&(u=!0);!u&&(h.ellipsisMask|=1<<h.dims,h.dims++);let d={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};var p=h,f=d;f.beginMask=0,f.endMask=0,f.shrinkAxisMask=0;let m=0;f.beginValid=null!=p.begin,f.endValid=null!=p.end,f.begin=Array(f.dims),f.end=Array(f.dims),f.strides=Array(f.dims),f.finalShapeGatherIndices=[],f.finalShapeGatherIndicesSparse=[],f.inputShapeGatherIndicesSparse=Array(f.dims);for(let e=0;e<p.dims;e++)if(1<<e&p.ellipsisMask){let t=Math.min(f.dims-(p.dims-e)+1+p.numAddAxisAfterEllipsis,f.dims);for(;m<t;m++)f.begin[m]=0,f.end[m]=0,f.strides[m]=1,f.beginMask|=1<<m,f.endMask|=1<<m,f.finalShapeGatherIndices.push(m),f.finalShapeGatherIndicesSparse.push(-1),f.inputShapeGatherIndicesSparse[m]=e}else if(1<<e&p.newAxisMask)f.finalShapeGatherIndices.push(-2),f.finalShapeGatherIndicesSparse.push(-1);else{if(m===f.begin.length)throw Error("Index out of range using input dim ".concat(m,"; input ")+"has only ".concat(f.dims," dims, ").concat(f.begin.length,"."));null!=p.begin&&(f.begin[m]=p.begin[e]),null!=p.end&&(f.end[m]=p.end[e]),f.strides[m]=p.strides[e],p.beginMask&1<<e&&(f.beginMask|=1<<m),p.endMask&1<<e&&(f.endMask|=1<<m),p.shrinkAxisMask&1<<e?(f.finalShapeGatherIndices.push(-1),f.finalShapeGatherIndicesSparse.push(-1),f.shrinkAxisMask|=1<<m):(f.finalShapeGatherIndices.push(m),f.finalShapeGatherIndicesSparse.push(e)),f.inputShapeGatherIndicesSparse[m]=e,m++}let g=!0,x=!0,y=!0,b=[],v=[];for(let t=0;t<e.length;++t){let n;if(0===d.strides[t])throw Error("strides[".concat(t,"] must be non-zero"));let a=!!(d.shrinkAxisMask&1<<t),r=e[t];if(-1===r){b.push(a?1:-1);continue}let i=[d.beginMask&1<<t,d.endMask&1<<t],s=[d.strides[t]>0?0:-1,d.strides[t]>0?r:r-1];if(a&&d.strides[t]<=0)throw Error("only stride 1 allowed on non-range indexing.");y=y&&1===d.strides[t];let o=!!(d.beginMask&1<<t&&d.endMask&1<<t);if(d.beginValid&&d.endValid){if(a){let e=d.begin[t]<0?r+d.begin[t]:d.begin[t];if(d.begin[t]=e,d.end[t]=d.begin[t]+1,e<0||e>=r)throw Error("slice index ".concat(d.begin[t]," of dimension ").concat(t," out of bounds."))}else d.begin[t]=sA(d.begin[t],0,d.strides[t],r,i,s),d.end[t]=sA(d.end[t],1,d.strides[t],r,i,s);let e=1===d.strides[t]&&0===d.begin[t]&&d.end[t]===r;g=g&&e,x=x&&(0===t&&1===d.strides[t]||e)}else g=g&&1===d.strides[t]&&o,x=x&&(0===t&&1===d.strides[t]||o);let l=!1;if(d.beginValid&&d.endValid?(n=d.end[t]-d.begin[t],l=!0):a?(n=1,l=!0):o&&r>=0&&(n=d.strides[t]<0?-r:r,l=!0),l){let e;e=0===n||n<0!=d.strides[t]<0?0:Math.trunc(n/d.strides[t])+ +(n%d.strides[t]!=0),b.push(e)}else b.push(-1)}for(let e=0;e<d.finalShapeGatherIndices.length;++e){let t=d.finalShapeGatherIndices[e];t>=0?v.push(b[t]):-2===t&&v.push(1)}return{finalShapeSparse:v.filter((e,t)=>-2!==d.finalShapeGatherIndices[t]),finalShape:v,isIdentity:g,sliceDim0:x,isSimpleSlice:y,begin:d.begin,end:d.end,strides:d.strides}}function sA(e,t,n,a,r,i){if(r[t])return n>0?i[t]:i[t+1&1];{let t=e<0?a+e:e;return t<i[0]?i[0]:t>i[1]?i[1]:t}}e.s(["ERF_A1",()=>oo,"ERF_A2",()=>ol,"ERF_A3",()=>oc,"ERF_A4",()=>ou,"ERF_A5",()=>oh,"ERF_P",()=>os,"PARALLELIZE_THRESHOLD",()=>sD,"RowPartitionType",()=>f,"SELU_SCALE",()=>oi,"SELU_SCALEALPHA",()=>or,"applyActivation",()=>sQ,"assertAndGetBroadcastShape",()=>r8,"assertAxesAreInnerMostDims",()=>iK,"assertParamsConsistent",()=>sV,"assignToTypedArray",()=>ox,"axesAreInnerMostDims",()=>iW,"calculateShapes",()=>oa,"checkEinsumDimSizes",()=>ok,"checkPadOnDimRoundingMode",()=>iS,"combineLocations",()=>iG,"combineRaggedTensorToTensorShapes",()=>s$,"complexWithEvenIndex",()=>of,"complexWithOddIndex",()=>om,"computeConv2DInfo",()=>id,"computeConv3DInfo",()=>ip,"computeDefaultPad",()=>im,"computeDilation2DInfo",()=>ic,"computeOptimalWindowSize",()=>sM,"computeOutAndReduceShapes",()=>iH,"computeOutShape",()=>sU,"computePool2DInfo",()=>iu,"computePool3DInfo",()=>ih,"convertConv2DDataFormat",()=>ik,"decodeEinsumEquation",()=>ow,"eitherStridesOrDilationsAreOne",()=>iw,"expandShapeToKeepDim",()=>iq,"exponent",()=>ob,"exponents",()=>oy,"fromStringArrayToUint8",()=>sz,"fromUint8ToStringArray",()=>sL,"getAxesPermutation",()=>iX,"getBroadcastDims",()=>r5,"getComplexWithIndex",()=>og,"getEinsumComputePath",()=>oS,"getEinsumPermutation",()=>oN,"getFusedBiasGradient",()=>sZ,"getFusedDyActivation",()=>sY,"getImageCenter",()=>s4,"getInnerMostAxes",()=>iZ,"getPermuted",()=>s6,"getRaggedRank",()=>s1,"getReductionAxes",()=>r6,"getReshaped",()=>s5,"getReshapedPermuted",()=>s8,"getRowPartitionTypesHelper",()=>s0,"getSliceBeginCoords",()=>s9,"getSliceSize",()=>s7,"getSparseFillEmptyRowsIndicesDenseShapeMismatch",()=>oI,"getSparseFillEmptyRowsNegativeIndexErrorMessage",()=>oE,"getSparseFillEmptyRowsOutOfRangeIndexErrorMessage",()=>o_,"getSparseReshapeEmptyTensorZeroOutputDimErrorMessage",()=>oD,"getSparseReshapeInputOutputMismatchErrorMessage",()=>oF,"getSparseReshapeInputOutputMultipleErrorMessage",()=>oM,"getSparseReshapeMultipleNegativeOneOutputDimErrorMessage",()=>oA,"getSparseReshapeNegativeOutputDimErrorMessage",()=>oR,"getSparseSegmentReductionIndicesOutOfRangeErrorMessage",()=>oL,"getSparseSegmentReductionNegativeSegmentIdsErrorMessage",()=>oO,"getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage",()=>oP,"getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage",()=>oj,"getUndoAxesPermutation",()=>iY,"isIdentityPermutation",()=>oC,"log",()=>n1,"mergeRealAndImagArrays",()=>od,"prepareAndValidate",()=>oe,"prepareSplitSize",()=>oT,"segment_util",()=>oz,"shouldFuse",()=>sJ,"slice_util",()=>s3,"splitRealAndImagArrays",()=>op,"stridesOrDilationsArePositive",()=>iN,"tupleValuesAreOne",()=>iv,"upcastType",()=>ab,"validateDefaultValueShape",()=>s2,"validateInput",()=>on,"validateUpdateShape",()=>ot,"warn",()=>n0],41667),e.s(["fromStringArrayToUint8",()=>sz,"fromUint8ToStringArray",()=>sL],64609),e.s(["assertParamsValid",()=>sm,"computeFlatOffset",()=>sI,"computeOutShape",()=>sx,"getNormalizedAxes",()=>sv,"isSliceContinous",()=>sT,"maskToAxes",()=>sg,"parseSliceParams",()=>sE,"sliceInfo",()=>s_,"startForAxis",()=>sS,"startIndicesWithElidedDims",()=>sw,"stopForAxis",()=>sC,"stopIndicesWithElidedDims",()=>sN,"stridesForAxis",()=>sk,"stridesWithElidedDims",()=>sy],64791);var sR=e.i(64791);e.s(["collectGatherOpShapeInfo",()=>sP,"computeOutShape",()=>sO,"segOpComputeOptimalWindowSize",()=>sF],62188),e.s(["PARALLELIZE_THRESHOLD",()=>sD,"computeOptimalWindowSize",()=>sM],67118);let sD=30;function sM(e){return e<=sD?e:ed(e,Math.floor(Math.sqrt(e)))}function sF(e,t){let n,a=!1;for(e<=sD?(n=e,a=!0):n=ed(e,Math.floor(Math.sqrt(e)));!a;)n>t||n===e?a=!0:n=ed(e,n+1);return n}function sO(e,t,n){let a=[],r=e.length;for(let i=0;i<r;i++)i!==t?a.push(e[i]):a.push(n);return a}function sP(e,t,n,a){let r=t.shape.length,i=e.shape.length;if(0!==a&&(a<-r||a>r))throw Error("Expect batchDims in the range of [-".concat(r,", ").concat(r,"], but got ").concat(a));if(a<0&&(a+=r),a>i)throw Error("batchDims (".concat(a,") must be less than rank(x) (\n    ").concat(i,")."));if(n<a)throw Error("batchDims (".concat(a,") must be less than or equal to axis (").concat(n,")."));for(let n=0;n<a;++n)if(e.shape[n]!==t.shape[n])throw Error("x.shape[".concat(n,"]: ").concat(e.shape[n]," should be equal to indices.shape[").concat(n,"]: ").concat(t.shape[n],"."));let s=e.shape[n],o=[],l=1,c=1,u=1;for(let t=0;t<a;++t)o.push(e.shape[t]),l*=e.shape[t];for(let t=a;t<n;t++)o.push(e.shape[t]),c*=e.shape[t];for(let e=a;e<r;e++)o.push(t.shape[e]);for(let t=n+1;t<i;t++)o.push(e.shape[t]),u*=e.shape[t];return{batchSize:l,sliceSize:u,outerSize:c,dimSize:s,outputShape:o}}var sj=e.i(62188);function sL(e){try{return e.map(e=>ar(e))}catch(e){throw Error("Failed to decode encoded string bytes into utf-8, error: ".concat(e))}}function sz(e){return e.map(e=>aa(e))}e.i(64609),e.i(15401);var sB=e.i(42242);function sV(e,t){let n=e[0].length;e.forEach((e,t)=>{L(e.length===n,()=>"Error in concat".concat(n,"D: rank of tensors[").concat(t,"] must be the same ")+"as the rank of the rest (".concat(n,")"))}),L(t>=0&&t<n,()=>"Error in concat".concat(n,"D: axis must be between 0 and ").concat(n-1,"."));let a=e[0];e.forEach((e,r)=>{for(let i=0;i<n;i++)L(i===t||e[i]===a[i],()=>"Error in concat".concat(n,"D: Shape of tensors[").concat(r,"] (").concat(e,") ")+"does not match the shape of the rest (".concat(a,") ")+"along the non-concatenated axis ".concat(r,"."))})}function sU(e,t){let n=e[0].slice();for(let a=1;a<e.length;a++)n[t]+=e[a][t];return n}e.s(["assertParamsConsistent",()=>sV,"computeOutShape",()=>sU],8293),e.i(8293),e.i(19813),e.s(["applyActivation",()=>sQ,"getFusedBiasGradient",()=>sZ,"getFusedDyActivation",()=>sY,"shouldFuse",()=>sJ],77744);let sW=aG({elu_:function(e){let t=aV(e,"x","elu","float32");return aR.runKernel("Elu",{x:t})}}),sG=aG({leakyRelu_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,n=aV(e,"x","leakyRelu");return aR.runKernel(tR,{x:n},{alpha:t})}}),sH=aG({prelu_:function(e,t){let n=aV(e,"x","prelu"),a=aV(t,"alpha","prelu");return aR.runKernel(t5,{x:n,alpha:a})}}),sq=aG({relu_:function(e){let t=aV(e,"x","relu");return aR.runKernel(na,{x:t})}}),sK=aG({relu6_:function(e){let t=aV(e,"x","relu6");return aR.runKernel(nc,{x:t})}}),sX=aG({sigmoid_:function(e){let t=aV(e,"x","sigmoid","float32");return aR.runKernel(nw,{x:t})}});function sY(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return rz(e,ir(t));throw Error("Cannot compute gradient for fused activation ".concat(n,"."))}function sZ(e,t){let n=t,a=r6(e.shape,t.shape);return a.length>0&&(n=il(n,a)),io(n,e.shape)}function sQ(e,t,n,a){if("linear"===t)return e;if("relu"===t)return sq(e);if("elu"===t)return sW(e);if("relu6"===t)return sK(e);if("prelu"===t)return sH(e,n);else if("leakyrelu"===t)return sG(e,a);else if("sigmoid"===t)return sX(e);throw Error("Unknown fused activation ".concat(t,"."))}let sJ=(e,t)=>!(e>0)||"linear"===t;function s$(e,t,n){let a=[];if(null==n&&null==t)return a;if(null==t)for(;a.length<e+n.length;)a.push(-1);else a=t.slice();if(null==n)return a;if(e+n.length!==a.length)throw Error("rt input.shape and shape=".concat(t," are incompatible: rt input.rank = ").concat(e+n.length,", but shape.rank = ").concat(a.length));for(let r=1;r<n.length;++r){let i=n[r],s=a[a.length-n.length+r],o=a[s];if(i>=0)if(o>=0){if(o!==i)throw Error("rt input.shape and shape=".concat(t," are incompatible: rt input.shape[").concat(r+e,"] = ").concat(i," but shape[").concat(r+e,"] = ").concat(o))}else a[s]=i}return a}function s0(e){let t={FIRST_DIM_SIZE:f.FIRST_DIM_SIZE,VALUE_ROWIDS:f.VALUE_ROWIDS,ROW_LENGTHS:f.ROW_LENGTHS,ROW_SPLITS:f.ROW_SPLITS,ROW_LIMITS:f.ROW_LIMITS,ROW_STARTS:f.ROW_STARTS},n=[];for(let a of e)if(a in t)n.push(t[a]);else break;return n}function s1(e){return 0===e.length?0:e[0]===f.FIRST_DIM_SIZE?e.length-1:e.length}function s2(e,t){if(null==e||null==t)return;let n=e.length,a=t.length;if(n>=a)throw Error("defaultValue.shape=".concat(e," and ragged tensor flatValues.shape=").concat(t,", are incompatible: defaultValue.rank = ").concat(n," must be less than ragged tensor input flatValues.rank = ").concat(a,")"));for(let r=0;r<Math.min(n,a-1);++r){let n=e[r],a=t[r+1];if(n>=0&&a>=0&&1!==n&&n!==a)throw Error("defaultValue.shape=".concat(e,", and ragged tensor input flatValues.shape=").concat(t," are incompatible: defaultValue.shape[").concat(r-e.length,"] = ").concat(n," but ragged tensor input.flatValues.shape[").concat(r-e.length,"] = ").concat(a))}}e.i(77744),e.s([],4444),e.i(4444),e.s(["RowPartitionType",()=>f,"combineRaggedTensorToTensorShapes",()=>s$,"getRaggedRank",()=>s1,"getRowPartitionTypesHelper",()=>s0,"validateDefaultValueShape",()=>s2],81973),function(e){e[e.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",e[e.VALUE_ROWIDS=1]="VALUE_ROWIDS",e[e.ROW_LENGTHS=2]="ROW_LENGTHS",e[e.ROW_SPLITS=3]="ROW_SPLITS",e[e.ROW_LIMITS=4]="ROW_LIMITS",e[e.ROW_STARTS=5]="ROW_STARTS"}(f||(f={})),e.i(81973),e.i(67118);var s3=sR;function s4(e,t,n){return[n*("number"==typeof e?e:e[0]),t*("number"==typeof e?e:e[1])]}function s5(e,t,n){let a=!(arguments.length>3)||void 0===arguments[3]||arguments[3],r=[];if(a)(r=r.concat(t.slice(0))).push(e[0]/n),r=r.concat(e.slice(1));else{r=r.concat(e[0]);let n=t.length;for(let a=0;a<n;++a)r=r.concat([e[a+1]/t[a],t[a]]);r=r.concat(e.slice(n+1))}return r}function s6(e,t){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],a=[];if(n){a.push(t);for(let n=t+1;n<e;++n)n<=2*t?(a.push(n),a.push(n-(t+1))):a.push(n)}else{let n=[],r=[];for(let a=1;a<e;++a)a>=2*t+1||a%2==1?r.push(a):n.push(a);a.push(...n),a.push(0),a.push(...r)}return a}function s8(e,t,n){let a=!(arguments.length>3)||void 0===arguments[3]||arguments[3],r=[];a?r.push(e[0]/n):r.push(e[0]*n);for(let n=1;n<e.length;++n)n<=t.length?a?r.push(t[n-1]*e[n]):r.push(e[n]/t[n-1]):r.push(e[n]);return r}function s9(e,t){let n=[0];for(let a=0;a<t;++a)n.push(e[a][0]);return n}function s7(e,t,n){let a=e.slice(0,1);for(let r=0;r<n;++r)a.push(e[r+1]-t[r][0]-t[r][1]);return a}function oe(e,t){let n=e.shape.length,a=t.shape.length;if(n<1)throw Error("tf.gatherND() expects the input to be rank 1 or higher,"+" but the rank was ".concat(n,"."));if(a<1)throw Error("tf.gatherND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(a,"."));if("int32"!==t.dtype)throw Error("tf.gatherND() expects the indices to be int32 type,"+" but the dtype was ".concat(t.dtype,"."));if(t.shape[a-1]>n)throw Error("index innermost dimension length must be <= tensor rank; saw: "+"".concat(t.shape[a-1]," vs. ").concat(n));if(0===V(e.shape))throw Error("Requested more than 0 entries, but input is empty."+" Input shape: ".concat(e.shape,"."));let r=t.shape,i=r[r.length-1],s=1;for(let e=0;e<r.length-1;++e)s*=r[e];let o=e.shape,l=r.slice();l.pop();let c=1;for(let e=i;e<n;++e)c*=o[e],l.push(o[e]);let u=[...ep(e.shape).map(e=>e/c),1].slice(0,i);return[l,s,c,u]}function ot(e,t,n){let a=t.rank>1?t.shape[t.rank-1]:1,r=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + "+"shape[sliceDim:], got updates.shape: ".concat(n.shape)+", indices.shape: ".concat(t.shape,", shape: ").concat(e)+", sliceDim: ".concat(a,", and batchDim: ").concat(r,".");if(n.rank<r)throw Error(i+" update.rank < ".concat(r,". "));if(e.length<a+(n.rank-r))throw Error(i+" Output shape length < ".concat(a+(n.rank-r)));if(n.rank!==r+e.length-a)throw Error(i+" update.rank != ".concat(r+e.length-a));for(let e=0;e<r;++e)if(n.shape[e]!==t.shape[e])throw Error(i+" updates.shape[".concat(e,"] (").concat(n.shape[e],") != indices.shape[").concat(e,"] (").concat(t.shape[e],")."));for(let t=0;t<n.rank-r;++t)if(n.shape[t+r]!==e[t+a])throw Error(i+" updates.shape[".concat(t+r,"] (").concat(n.shape[t+r],") != shape[").concat(t+r,"] (").concat(e[t+r],")"))}function on(e,t,n){if(t.rank<1)throw Error("tf.scatterND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(t.rank,"."));if(e.rank<1)throw Error("tf.scatterND() expects the updates to be rank 1 or higher,"+" but the rank was ".concat(e.rank,"."));if("int32"!==t.dtype)throw Error("The dtype of 'indices' should be int32, but got dtype: ".concat(t.dtype));if(n.length<1)throw Error("Output rank must be greater or equal to 1, but got shape: ".concat(n));if(0===n.length){if(0===t.size)throw Error("Indices specified for empty output. indices shape: ".concat(t.shape));if(0===e.size)throw Error("Updates specified for empty output. updates shape: ".concat(e.shape))}ot(n,t,e)}function oa(e,t,n){let a=t.shape.length,r=a>1?t.shape[a-1]:1,i=n.length,s=1;for(let e=r;e<i;++e)s*=n[e];let o=r<1?1:r,l=V(t.shape)/o,c=[...ep(n.slice(0,r)),1];return{sliceRank:r,numUpdates:l,sliceSize:s,strides:c,outputSize:V(n)}}e.s(["getImageCenter",()=>s4],47606),e.i(47606),e.s(["getPermuted",()=>s6,"getReshaped",()=>s5,"getReshapedPermuted",()=>s8,"getSliceBeginCoords",()=>s9,"getSliceSize",()=>s7],45079),e.i(45079),e.s(["prepareAndValidate",()=>oe],39250),e.i(39250),e.s(["calculateShapes",()=>oa,"validateInput",()=>on,"validateUpdateShape",()=>ot],87271),e.i(87271),e.s(["SELU_SCALE",()=>oi,"SELU_SCALEALPHA",()=>or],80109);let or=1.7580993408473768,oi=1.0507009873554805;e.i(80109),e.s(["ERF_A1",()=>oo,"ERF_A2",()=>ol,"ERF_A3",()=>oc,"ERF_A4",()=>ou,"ERF_A5",()=>oh,"ERF_P",()=>os],40834);let os=.3275911,oo=.254829592,ol=-.284496736,oc=1.421413741,ou=-1.453152027,oh=1.061405429;function od(e,t){if(e.length!==t.length)throw Error("Cannot merge real and imag arrays of different lengths. real:"+"".concat(e.length,", imag: ").concat(t.length,"."));let n=new Float32Array(2*e.length);for(let a=0;a<n.length;a+=2)n[a]=e[a/2],n[a+1]=t[a/2];return n}function op(e){let t=new Float32Array(e.length/2),n=new Float32Array(e.length/2);for(let a=0;a<e.length;a+=2)t[a/2]=e[a],n[a/2]=e[a+1];return{real:t,imag:n}}function of(e){let t=Math.ceil(e.length/4),n=new Float32Array(t),a=new Float32Array(t);for(let t=0;t<e.length;t+=4)n[Math.floor(t/4)]=e[t],a[Math.floor(t/4)]=e[t+1];return{real:n,imag:a}}function om(e){let t=Math.floor(e.length/4),n=new Float32Array(t),a=new Float32Array(t);for(let t=2;t<e.length;t+=4)n[Math.floor(t/4)]=e[t],a[Math.floor(t/4)]=e[t+1];return{real:n,imag:a}}function og(e,t){return{real:e[2*t],imag:e[2*t+1]}}function ox(e,t,n,a){e[2*a]=t,e[2*a+1]=n}function oy(e,t){let n=new Float32Array(e/2),a=new Float32Array(e/2);for(let r=0;r<Math.ceil(e/2);r++){let i=(t?2:-2)*Math.PI*(r/e);n[r]=Math.cos(i),a[r]=Math.sin(i)}return{real:n,imag:a}}function ob(e,t,n){let a=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(a),imag:Math.sin(a)}}e.i(40834),e.i(71070),e.s(["assignToTypedArray",()=>ox,"complexWithEvenIndex",()=>of,"complexWithOddIndex",()=>om,"exponent",()=>ob,"exponents",()=>oy,"getComplexWithIndex",()=>og,"mergeRealAndImagArrays",()=>od,"splitRealAndImagArrays",()=>op],27047),e.i(27047),e.s(["checkEinsumDimSizes",()=>ok,"decodeEinsumEquation",()=>ow,"getEinsumComputePath",()=>oS,"getEinsumPermutation",()=>oN,"isIdentityPermutation",()=>oC],82415);let ov=/->/g;function ow(e,t){let n=((e=e.replace(/\s/g,"")).length-e.replace(ov,"").length)/2;if(n<1)throw Error("Equations without an arrow are not supported.");if(n>1)throw Error('Equation must contain exactly one arrow ("'.concat("->",'").'));let[a,r]=e.split("->");L(-1===a.indexOf("..."),()=>'The ellipsis notation ("'.concat("...",'") is not supported yet.'));let i=a.split(","),s=i.length;if(t!==s)throw Error("Expected ".concat(s," input tensors, received ").concat(t));if(s>2)throw Error("Support for more than 2 input tensors is not implemented yet.");let o=[];for(let e=0;e<r.length;++e){let t=r[e];if(!i.some(e=>-1!==e.indexOf(t)))throw Error("Output subscripts contain the label ".concat(t," ")+"not present in the input subscripts.");-1===o.indexOf(t)&&o.push(t)}for(let e=0;e<a.length;++e){let t=a[e];-1===o.indexOf(t)&&","!==t&&o.push(t)}let l=Array(i.length);for(let e=0;e<s;++e){if(new Set(i[e].split("")).size!==i[e].length)throw Error("Found duplicate axes in input component ".concat(i[e],". ")+"Support for duplicate axes in input is not implemented yet.");l[e]=[];for(let t=0;t<i[e].length;++t)l[e].push(o.indexOf(i[e][t]))}let c=o.length,u=r.length,h=[];for(let e=u;e<c;++e)h.push(e);return{allDims:o,summedDims:h,idDims:l}}function oN(e,t){let n=Array(e);n.fill(-1);for(let e=0;e<t.length;++e)n[t[e]]=e;let a=[];for(let t=0;t<e;++t)-1===n[t]&&a.push(t);return{permutationIndices:n=n.filter(e=>-1!==e),expandDims:a}}function ok(e,t,n){let a=Array(e);for(let e=0;e<n.length;++e){let r=n[e].shape;for(let n=0;n<t[e].length;++n)void 0===a[t[e][n]]?a[t[e][n]]=r[n]:L(a[t[e][n]]===r[n],()=>"Expected dimension ".concat(a[t[e][n]]," at axis ").concat(n," ")+"of input shaped ".concat(JSON.stringify(r),", ")+"but got dimension ".concat(r[n]))}}function oS(e,t){let n=[],a=0;0===e.length&&e.push(-1),a=e.length+1;for(let e=0;e<a;++e)n.push([]);let r=[];for(let a=0;a<e.length;++a)for(let i of function(e,t){let n=[];for(let a=0;a<e.length;++a)(0===e[a].length||-1!==e[a].indexOf(t)||-1===t)&&n.push(a);return n}(t,e[a]))-1===r.indexOf(i)&&(n[a].push(i),r.push(i));return{path:e,steps:n}}function oC(e){return e.every((e,t)=>e===t)}function oT(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=[];if("number"==typeof t)L(e.shape[n]%t==0,()=>"Number of splits must evenly divide the axis."),a=Array(t).fill(e.shape[n]/t);else{L(1>=t.reduce((e,t)=>(-1===t&&(e+=1),e),0),()=>"There should be only one negative value in split array.");let r=t.indexOf(-1);if(-1!==r){let a=t.reduce((e,t)=>t>0?e+t:e);t[r]=e.shape[n]-a}L(e.shape[n]===t.reduce((e,t)=>e+t),()=>"The sum of sizes must match the size of the axis dimension."),a=t}return a}function oI(e){return"Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = ".concat(e)}function oE(e,t){return"indices(".concat(e,", 0) is invalid: ").concat(t," < 0")}function o_(e,t,n){return"indices(".concat(e,", 0) is invalid: ").concat(t," >= ").concat(n)}function oA(e,t){return"only one output dimension may be -1, not both ".concat(e," and ").concat(t)}function oR(e,t){return"size ".concat(e," must be non-negative, not ").concat(t)}function oD(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function oM(e,t){let n=V(e),a=V(t);return"Input to reshape is a SparseTensor with ".concat(n,"\n  dense values, but the requested shape requires a multiple of ").concat(a,". inputShape=").concat(e," outputShape= ").concat(t)}function oF(e,t){let n=V(e),a=V(t);return"Input to reshape is a tensor with ".concat(n," dense values, but the requested shape has ").concat(a,". inputShape=").concat(e," outputShape=").concat(t)}function oO(){return"segment ids must be >= 0"}function oP(){return"segment ids are not increasing"}function oj(e,t){return"Segment id ".concat(e," out of range [0, ").concat(t,"), possibly because segmentIds input is not sorted.")}function oL(e,t,n){return"Bad: indices[".concat(e,"] == ").concat(t," out of range [0, ").concat(n,")")}e.i(82415),e.s(["prepareSplitSize",()=>oT],29997),e.i(29997),e.s(["getSparseFillEmptyRowsIndicesDenseShapeMismatch",()=>oI,"getSparseFillEmptyRowsNegativeIndexErrorMessage",()=>oE,"getSparseFillEmptyRowsOutOfRangeIndexErrorMessage",()=>o_],69888),e.i(69888),e.s(["getSparseReshapeEmptyTensorZeroOutputDimErrorMessage",()=>oD,"getSparseReshapeInputOutputMismatchErrorMessage",()=>oF,"getSparseReshapeInputOutputMultipleErrorMessage",()=>oM,"getSparseReshapeMultipleNegativeOneOutputDimErrorMessage",()=>oA,"getSparseReshapeNegativeOutputDimErrorMessage",()=>oR],65990),e.i(65990),e.s(["getSparseSegmentReductionIndicesOutOfRangeErrorMessage",()=>oL,"getSparseSegmentReductionNegativeSegmentIdsErrorMessage",()=>oO,"getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage",()=>oP,"getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage",()=>oj],58472),e.i(58472);var oz=sj,oB=e.i(41667),oB=oB;let oV=aG({cumprod_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=aV(e,"x","cumprod");return aR.runKernel(e8,{x:r},{axis:t,exclusive:n,reverse:a})}}),oU=aG({reverse_:function(e,t){let n=aV(e,"x","reverse");return aR.runKernel(nu,{x:n},{dims:t})}}),oW=aG({logicalNot_:function(e){let t=aV(e,"x","logicalNot","bool");return aR.runKernel(tj,{x:t})}}),oG=aG({cos_:function(e){let t=aV(e,"x","cos","float32");return aR.runKernel("Cos",{x:t})}}),oH=aG({cosh_:function(e){let t=aV(e,"x","cosh","float32");return aR.runKernel(e6,{x:t})}}),oq=aG({pad_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=aV(e,"x","pad");if(0===a.rank)throw Error("pad(scalar) is not defined. Pass non-scalar to pad");return aR.runKernel(t4,{x:a},{paddings:t,constantValue:n})}}),oK=aG({batchToSpaceND_:function(e,t,n){let a=aV(e,"x","batchToSpaceND"),r=t.reduce((e,t)=>e*t);return L(a.rank>=1+t.length,()=>"input rank is ".concat(a.rank," but should be > than blockShape.length ").concat(t.length)),L(n.length===t.length,()=>"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(t.length)),L(a.shape[0]%r==0,()=>"input tensor batch is ".concat(a.shape[0]," but is not divisible by the product of ")+"the elements of blockShape ".concat(t.join(" * ")," === ").concat(r)),aR.runKernel(eG,{x:a},{blockShape:t,crops:n})}}),oX={kernelName:nS,gradFunc:(e,t,n)=>{let{blockShape:a,paddings:r}=n;return{x:()=>oK(e,a,r)}}},oY=aG({concat_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;L(e.length>=1,()=>"Pass at least one tensor to concat");let n=aU(e,"tensors","concat","string_or_numeric");return("complex64"===n[0].dtype&&n.forEach(e=>{if("complex64"!==e.dtype)throw Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(e.dtype,". "))}),1===n.length)?rF(n[0]):aR.runKernel(e$,n,{axis:t})}}),oZ={kernelName:nC,gradFunc:(e,t,n)=>{let{axis:a}=n;return{x:()=>oY(e,a)}}},oQ=aG({expandDims_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=aV(e,"x","expandDims","string_or_numeric");return L(t<=n.rank,()=>"Axis must be <= rank of the tensor"),aR.runKernel(tf,{input:n},{dim:t})}}),oJ=aG({gather_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=aV(e,"x","gather"),i=aV(t,"indices","gather","int32");return aR.runKernel(tw,{x:r,indices:i},{axis:n,batchDims:a})}});for(let e of[ii,{kernelName:e_,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let t=rV(rM(n,"float32"));return is(rL(e,rB(r2(rG(1),t))))}}}},{kernelName:eA,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>rL(e,rB(r2(rV(rM(n,"float32")),1)))}}},{kernelName:"Add",inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,a]=t,r=r8(n.shape,a.shape);return{a:()=>{let t=e,a=r6(n.shape,r);return a.length>0&&(t=il(t,a)),io(t,n.shape)},b:()=>{let t=e,n=r6(a.shape,r);return n.length>0&&(t=il(t,n)),io(t,a.shape)}}}},{kernelName:eR,saveAllInputs:!0,gradFunc:(e,t)=>{let n={};return t.forEach((t,a)=>{n[a]=()=>e.clone()}),n}},{kernelName:eD,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>rU(n)}}},{kernelName:eM,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>rU(n)}}},{kernelName:eF,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>rL(e,rB(r2(rG(1),rV(rM(n,"float32")))))}}},{kernelName:eO,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>rL(e,rB(rP(rG(1),rV(rM(n,"float32")))))}}},{kernelName:eL,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,a]=t,r=r8(n.shape,a.shape);return{a:()=>{let t=rP(rV(n),rV(a)),i=rz(e,rL(a,t)),s=r6(n.shape,r);return s.length>0&&(i=il(i,s)),io(i,n.shape)},b:()=>{let t=rP(rV(n),rV(a)),i=is(rz(e,rL(n,t))),s=r6(a.shape,r);return s.length>0&&(i=il(i,s)),io(i,a.shape)}}}},{kernelName:eP,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>rL(e,rP(rV(rM(n,"float32")),1))}}},{kernelName:ej,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>rL(e,r2(rG(1),rV(rM(n,"float32"))))}}},{kernelName:eV,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[a]=t,{filterSize:r,strides:i,pad:s,dimRoundingMode:o}=n;return{x:()=>iC(e,a,r,i,s,o)}}},{kernelName:ez,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[a]=t,{filterSize:r,strides:i,pad:s}=n;return{x:()=>iT(e,a,r,i,s)}}},{kernelName:eW,inputsToSave:["a","b"],gradFunc:(e,t,n)=>{let[a,r]=t,{transposeA:i,transposeB:s}=n;return i||s?!i&&s?{a:()=>iI(e,r,!1,!1),b:()=>iI(e,a,!0,!1)}:i&&!s?{a:()=>iI(r,e,!1,!0),b:()=>iI(a,e,!1,!1)}:{a:()=>iI(r,e,!0,!0),b:()=>iI(e,a,!0,!0)}:{a:()=>iI(e,r,!1,!0),b:()=>iI(a,e,!0,!1)}}},{kernelName:eG,gradFunc:(e,t,n)=>{let{blockShape:a,crops:r}=n;return{x:()=>iE(e,a,r)}}},{kernelName:"BroadcastTo",gradFunc:(e,t,n)=>{let a=n.inputShape,r=n.shape,i=Array.from(r);for(let e=a.length-1;e>=0;e--)if(a[e]===r[e])i[e]=1;else if(1!==a[e])throw Error("broadcastTo(): [".concat(a,"] cannot be broadcast to [").concat(r,"]."));let s=[];for(let e=0;e<i.length;e++)i[e]>1&&s.push(e);return{x:()=>il(e,s,!0)}}},{kernelName:eX,gradFunc:e=>({x:()=>e.clone()})},{kernelName:eY,gradFunc:e=>({x:()=>rU(e)})},{kernelName:eZ,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[a]=t,{clipValueMin:r,clipValueMax:i}=n;return{x:()=>iM(iR(i_(a,r),iA(a,i)),e,rU(e))}}},iF,{kernelName:e$,saveAllInputs:!0,gradFunc:(e,t,n)=>{let a=t.map(e=>e.shape),{axis:r}=n,i=J(r,t[0].shape)[0];return iO(e,a.map(e=>e[i]),i).map(e=>()=>e)}},{kernelName:e2,inputsToSave:["dy","filter"],gradFunc:(e,t,n)=>{let[a,r]=t,{strides:i,pad:s,dataFormat:o,dimRoundingMode:l}=n;return{dy:()=>iL(e,r,i,s,o,1,l),filter:()=>iP(e,a,r.shape,i,s,o,l)}}},{kernelName:e0,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let[a,r]=t,{dilations:i,strides:s,pad:o,dataFormat:l}=n;return L(iv(i),()=>"Error in gradient of conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(i,"'")),{x:()=>ij(a.shape,e,r,s,o,l),filter:()=>iP(a,e,r.shape,s,o,l)}}},{kernelName:e3,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let{dilations:a,strides:r,pad:i}=n;L(iv(a),()=>"Error in gradient of conv3D: dilation rates greater than 1 are "+"not yet supported in gradients. Got dilations '".concat(a,"'"));let[s,o]=t;return{x:()=>iB(s.shape,e,o,r,i),filter:()=>iz(s,e,o.shape,r,i)}}},{kernelName:"Cos",inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>rz(is(iV(rM(n,"float32"))),e)}}},{kernelName:e6,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>rz(iU(rM(n,"float32")),e)}}},{kernelName:e9,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[a]=t,{axis:r,exclusive:i,reverse:s}=n;return{x:()=>{let t=iX([r],a.rank),n=iQ(e,r,i,!s);return null!=t&&(n=i0(n,t)),n}}}},{kernelName:tn,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let{dilations:a,strides:r,pad:i,dimRoundingMode:s}=n,o=null==a?[1,1]:a;L(iv(o),()=>"Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(o,"'"));let[l,c]=t;return L(4===l.rank,()=>"Error in gradient of depthwiseConv2dNative: input must be "+"rank 4, but got rank ".concat(l.rank,".")),L(4===c.rank,()=>"Error in gradient of depthwiseConv2dNative: filter must be "+"rank 4, but got rank ".concat(c.rank,".")),L(l.shape[3]===c.shape[2],()=>"Error in gradient of depthwiseConv2d: number of input "+"channels (".concat(l.shape[3],") must match the inChannels dimension ")+"in filter ".concat(c.shape[2],".")),L(iw(r,o),()=>"Error in gradient of depthwiseConv2d: Either strides or "+"dilations must be  1. Got strides ".concat(r," and dilations ")+"'".concat(o,"'.")),iS("depthwiseConv2d",i,s),{x:()=>i2(l.shape,e,c,r,i,o,s),filter:()=>i1(l,e,c.shape,r,i,o,s)}}},{kernelName:ts,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let[a,r]=t,i={x:a,filter:r,dy:e},s={x:a,filter:r,dy:e};return{x:()=>aR.runKernel(to,i,n),filter:()=>aR.runKernel(tl,s,n)}}},{kernelName:tu,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,a]=t,r=r8(n.shape,a.shape);return{a:()=>{let t=rL(e,rM(a,"float32")),i=r6(n.shape,r);return i.length>0?io(il(t,i),n.shape):t},b:()=>{let t=rz(e,rM(n,"float32")),i=r6(a.shape,r);return i.length>0&&(t=io(il(t,i),a.shape)),is(rL(t,rM(rV(a),"float32")))}}}},{kernelName:"Elu",outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t,a={dy:e,y:n};return{x:()=>aR.runKernel(td,a)}}},{kernelName:"Erf",inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t,a=rz(i3(is(rV(n))),2/Math.sqrt(Math.PI));return{x:()=>rz(e,a)}}},{kernelName:"Exp",outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t;return{x:()=>rz(e,n)}}},{kernelName:tf,inputsToSave:["input"],gradFunc:(e,t)=>{let[n]=t;return{input:()=>io(e,n.shape)}}},{kernelName:tm,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>rz(e,i3(n))}}},{kernelName:tb,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,a]=t,r=r8(n.shape,a.shape);return{a:()=>{let t=rL(e,rM(a,"float32")),i=r6(n.shape,r);return i.length>0?io(il(t,i),n.shape):t},b:()=>{let t=rz(e,rM(n,"float32")),i=r6(a.shape,r);return i.length>0&&(t=io(il(t,i),a.shape)),is(rL(t,rM(rV(a),"float32")))}}}},{kernelName:ty,gradFunc:e=>({x:()=>rU(e)})},{kernelName:tv,inputsToSave:["x","mean","variance","scale"],gradFunc:(e,t,n)=>{let{varianceEpsilon:a}=n,[r,i,s,o]=t,l=null==o?rG(1):o,c=r6(i.shape,r.shape),u=[];if(1===i.rank){for(let e=0;e<r.shape.length-1;++e)u.push(r.shape[e]);u.push(1)}let h=r2(r,i),d=rz(e,l),p=i4(rP(s,rG(a))),f=rz(rz(rz(p,p),p),rG(-.5));return{x:()=>1===i.rank?io(rz(rz(e,i5(io(p,[1,1,1,i.shape[0]]),u)),l),r.shape):io(rz(rz(e,p),l),r.shape),mean:()=>{let e=rz(rz(p,rG(-1)),d);return 1===i.rank&&(e=il(e,c)),io(e,i.shape)},variance:()=>{let e=rz(rz(f,h),d);return 1===i.rank&&(e=il(e,c)),io(e,i.shape)},scale:()=>{let t=rz(h,p),n=rz(e,t);return 1===i.rank&&(n=il(n,c)),io(n,i.shape)},offset:()=>{let t=e;return 1===i.rank&&(t=il(t,c)),io(t,i.shape)}}}},{kernelName:tw,inputsToSave:["x","indices"],gradFunc:(e,t,n)=>{let[a,r]=t,{axis:i,batchDims:s}=n,o=J(i,a.shape)[0],l=(e,t,n)=>()=>{let a=e.shape,r=t.size,s=a.slice(0,o),l=s.length,c=a.slice(i,a.length).slice(1),u=c.length,h=i9(0,l),d=i9(l+1,l+1+u),p=io(n,i7([s,[r],c])),f=io(t,[r]),m=i7([[l],h,d]),g=i8(i0(p,m),f,e.shape[o]);return i0(g,iY(m))};if(1!==s)return{x:l(a,r,e),indices:()=>r};{let t=a.shape[0],n=a.split(t,0);return{x:()=>i6(n.map((t,n)=>l(t,r.slice(n,1),e.slice(n,1))())).reshape(a.shape),indices:()=>r}}}},{kernelName:tS,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,a]=t;return{a:()=>rU(n),b:()=>rU(a)}}},{kernelName:tC,gradFunc:e=>({x:()=>rM(e,"float32")})},{kernelName:tE,gradFunc:e=>({x:()=>rU(e)})},{kernelName:t_,gradFunc:e=>({x:()=>rU(e)})},{kernelName:tA,gradFunc:e=>({x:()=>rU(e)})},{kernelName:tR,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[a]=t,{alpha:r}=n,i=se(a,0);return{x:()=>iM(i,e,rz(e,r))}}},{kernelName:tO,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>rL(e,rP(n,1))}}},{kernelName:"Log",inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>rL(e,rM(n,"float32"))}}},{kernelName:"LogSoftmax",inputsToSave:[],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[a]=t,{axis:r}=n;return{logits:()=>{let t=i3(a);return r2(e,rz(il(e,r,!0),t))}}}},{kernelName:"LRN",inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[a,r]=t,{depthRadius:i,bias:s,alpha:o,beta:l}=n;return{x:()=>st(a,r,e,i,s,o,l)}}},sr,sr,{kernelName:tB,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,a]=t;return{a:()=>rz(e,rM(i_(n,a),"float32")),b:()=>rz(e,rM(si(n,a),"float32"))}}},{kernelName:tW,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[a,r]=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:l}=n;return{x:()=>ss(e,a,r,i,s,o,l)}}},{kernelName:tV,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[a,r]=t,{filterSize:i,strides:s,pad:o}=n;return{x:()=>so(e,a,r,i,s,o)}}},{kernelName:tq,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[a]=t,{axis:r}=n,i=J(r,a.shape),s=V(iH(a.shape,i)[1]);return{x:()=>{let t=a.shape.slice();return i.forEach(e=>{t[e]=1}),rL(rz(io(e,t),sc(a.shape,"float32")),s)}}}},{kernelName:"Min",inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let{axis:a}=n,[r,i]=t,s=J(a,r.shape),o=sa(e,i,r,s);return{x:()=>o.x()}}},{kernelName:tK,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,a]=t;return{a:()=>rz(e,rM(iA(n,a),"float32")),b:()=>rz(e,rM(se(n,a),"float32"))}}},{kernelName:tX,inputsToSave:["x"],gradFunc:(e,t,n)=>{let a=t[0],{paddings:r}=n,i=r.map(e=>e[0]);return{x:()=>su(e,i,a.shape)}}},{kernelName:"Mod",inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,a]=t,r=r8(n.shape,a.shape);return{a:()=>{let t=r6(n.shape,r);return t.length>0?io(il(e,t),n.shape):e},b:()=>{let t=rz(e,is(sh(rL(n,a)))),i=r6(a.shape,r);return i.length>0?io(il(t,i),a.shape):t}}}},{kernelName:tZ,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,a]=t,r=r8(n.shape,a.shape);return{a:()=>{let t=rz(e,rM(a,"float32")),i=r6(n.shape,r);return i.length>0?io(il(t,i),n.shape):t},b:()=>{let t=rz(e,rM(n,"float32")),i=r6(a.shape,r);return i.length>0?io(il(t,i),a.shape):t}}}},{kernelName:"Neg",gradFunc:e=>({x:()=>is(e)})},{kernelName:t2,inputsToSave:["indices"],gradFunc:(e,t)=>{let n=t[0];return{indices:()=>sl(n.shape,"float32")}}},{kernelName:t1,gradFunc:e=>({x:()=>rU(e)})},{kernelName:t3,saveAllInputs:!0,gradFunc:(e,t,n)=>{let{axis:a}=n;return sd(e,a).map(e=>()=>e)}},sp,sp,{kernelName:"Pow",inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(e,t)=>{let[n,a,r]=t,i=r8(n.shape,a.shape);return{a:()=>{let t=rM(a,"float32"),r=rz(e,rz(t,r1(n,r2(t,rG(1))))),s=r6(n.shape,i);return s.length>0&&(r=il(r,s)),io(r,n.shape)},b:()=>{let t=rz(e,rz(r,iM(se(n,0),sf(n),rU(n)))),s=r6(a.shape,i);return s.length>0&&(t=il(t,s)),io(t,a.shape)}}}},{kernelName:t5,inputsToSave:["x","alpha"],gradFunc:(e,t)=>{let[n,a]=t,r=se(n,0);return{x:()=>iM(r,e,rz(e,a)),alpha:()=>{let t=iM(r,rU(e),rz(e,n)),i=r6(a.shape,e.shape);return i.length>0&&(t=il(t,i)),io(t,a.shape)}}}},{kernelName:t6,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[a]=t,{axis:r}=n,i=[];return i=null==r?a.shape.map((e,t)=>t):"number"==typeof r?[r]:r,{x:()=>(function(e,t,n){let a=e.shape.length,r=a-n.length,i=oB.getAxesPermutation(n,a),s=e;null!=i&&(s=i0(e,i));let o=s.shape.slice(),l=o.splice(a-n.length,n.length).reduce((e,t)=>e*t,1);o.push(l);let c=function(e,t,n){let a=e.shape.slice();a[n]=1;let r=io(t,a),i=rz(oV(e,n,!0,!1),oV(e,n,!0,!0));return rz(r,i)}(s.reshape(o),t,r);return c=c.reshape(s.shape),null!=i&&(c=i0(c,oB.getUndoAxesPermutation(i))),c})(a,e,i)}}},{kernelName:nn,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>rL(e,is(rV(n)))}}},{kernelName:nc,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t,a=rz(iA(n,6),ir(n));return{x:()=>rz(e,rM(a,"float32"))}}},{kernelName:na,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>rz(e,rM(ir(n),"float32"))}}},{kernelName:nr,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>io(e,n.shape)}}},{kernelName:no,inputsToSave:["images"],gradFunc:(e,t,n)=>{let[a]=t,r={dy:e,images:a};return{images:()=>aR.runKernel(nl,r,n)}}},{kernelName:ni,inputsToSave:["images"],gradFunc:(e,t,n)=>{let[a]=t,r={dy:e,images:a};return{images:()=>aR.runKernel(ns,r,n)}}},{kernelName:nu,gradFunc:(e,t,n)=>{let{dims:a}=n,r=J(a,e.shape);return{x:()=>oU(e,r)}}},{kernelName:nh,gradFunc:e=>({x:()=>rU(e)})},{kernelName:nd,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>is(rL(e,rz(r1(n,1.5),2)))}}},{kernelName:ng,inputsToSave:["condition"],gradFunc:(e,t)=>{let[n]=t;return{condition:()=>rM(rU(n),"float32"),t:()=>rz(e,rM(n,e.dtype)),e:()=>rz(e,rM(oW(n),e.dtype))}}},{kernelName:nx,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let t=se(n,rG(0)),a=rG(or);return iM(t,rz(e,rG(oi)),rz(rz(e,a),i3(rM(n,"float32"))))}}}},{kernelName:nw,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t;return{x:()=>rz(e,rz(n,r2(rG(1),n)))}}},{kernelName:nv,gradFunc:e=>({x:()=>rU(e)})},{kernelName:"Sin",inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>rz(oG(rM(n,"float32")),e)}}},{kernelName:nb,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>rz(oH(rM(n,"float32")),e)}}},{kernelName:ny,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[a]=t,{begin:r,size:i}=n,s=a.shape,[o,l]=sE(a,r,i),c=[];for(let t=0;t<e.rank;t++)c.push([o[t],s[t]-o[t]-l[t]]);return{x:()=>oq(e,c)}}},{kernelName:nT,outputsToSave:[!0],gradFunc:(e,t,n)=>{let[a]=t,{dim:r}=n,i=rz(e,a);return{logits:()=>r2(i,rz(il(i,[r],!0),a))}}},{kernelName:nN,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>rz(e,sX(n))}}},oX,oX,oZ,oZ,{kernelName:nk,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>rL(e,rz(rB(rM(n,"float32")),2))}}},{kernelName:nD,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,a]=t,r=rG(2);return{a:()=>rz(e,rz(r,r2(n,a))),b:()=>rz(e,rz(r,r2(a,n)))}}},{kernelName:nM,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>rz(e,rz(rM(n,"float32"),2))}}},{kernelName:nX,gradFunc:e=>({x:()=>rU(e)})},{kernelName:"Sub",inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,a]=t,r=r8(n.shape,a.shape);return{a:()=>{let t=e,a=r6(n.shape,r);return a.length>0&&(t=il(t,a)),io(t,n.shape)},b:()=>{let t=e,n=r6(a.shape,r);return n.length>0&&(t=il(t,n)),io(is(t),a.shape)}}}},{kernelName:"Sum",inputsToSave:["x"],gradFunc:(e,t,n)=>{let[a]=t,r=a.shape.slice(),{axis:i}=n;J(i,a.shape).forEach(e=>{r[e]=1});let s=rz(io(e,r),sc(a.shape,"float32"));return{x:()=>s}}},{kernelName:"Tan",inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>rL(e,rV(oG(n)))}}},{kernelName:nz,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t;return{x:()=>rz(r2(rG(1),rV(n)),e)}}},{kernelName:nB,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[a]=t,{reps:r}=n;return{x:()=>{let t=rU(a);if(1===a.rank)for(let n=0;n<r[0];++n)t=rP(t,su(e,[n*a.shape[0]],[a.shape[0]]));else if(2===a.rank)for(let n=0;n<r[0];++n)for(let i=0;i<r[1];++i)t=rP(t,su(e,[n*a.shape[0],i*a.shape[1]],[a.shape[0],a.shape[1]]));else if(3===a.rank)for(let n=0;n<r[0];++n)for(let i=0;i<r[1];++i)for(let s=0;s<r[2];++s)t=rP(t,su(e,[n*a.shape[0],i*a.shape[1],s*a.shape[2]],[a.shape[0],a.shape[1],a.shape[2]]));else if(4===a.rank)for(let n=0;n<r[0];++n)for(let i=0;i<r[1];++i)for(let s=0;s<r[2];++s)for(let o=0;o<r[3];++o)t=rP(t,su(e,[n*a.shape[0],i*a.shape[1],s*a.shape[2],o*a.shape[3]],[a.shape[0],a.shape[1],a.shape[2],a.shape[3]]));else throw Error("Gradient for tile operation is not implemented for rank-"+"".concat(a.rank," tensors yet."));return t}}}},{kernelName:nW,gradFunc:(e,t,n)=>{let{perm:a}=n,r=iY(a);return{x:()=>i0(e,r)}}},{kernelName:nH,gradFunc:(e,t,n)=>{let{axis:a}=n;return{value:()=>i6(e,a)}}},{kernelName:nq,inputsToSave:["segmentIds"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>(function(e,t){let n=oJ(e,r9(t,rU(t))),a=i_(t,rG(0,"int32")),r=n.rank-a.rank;for(let e=0;e<r;++e)a=oQ(a,e+1);a=iR(a,sc(n.shape,"bool"));let i=rU(n);return iM(a,n,i)})(e,n)}}},{kernelName:nK,gradFunc:e=>({x:()=>rU(e)})}])!function(e){let{kernelName:t}=e;n3.has(t)&&eT.getBool("DEBUG")&&n0("Overriding the gradient for '".concat(t,"'")),n3.set(t,e)}(e);ag().prototype.abs=function(){return this.throwIfDisposed(),r4(this)};let o$=aG({acos_:function(e){let t=aV(e,"x","acos");return aR.runKernel(e_,{x:t})}});ag().prototype.acos=function(){return this.throwIfDisposed(),o$(this)};let o0=aG({acosh_:function(e){let t=aV(e,"x","acosh");return aR.runKernel(eA,{x:t})}});ag().prototype.acosh=function(){return this.throwIfDisposed(),o0(this)},ag().prototype.add=function(e){return this.throwIfDisposed(),rP(this,e)};let o1=aG({all_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=aV(e,"x","all","bool");return aR.runKernel("All",{x:a},{axis:t,keepDims:n})}});ag().prototype.all=function(e,t){return this.throwIfDisposed(),o1(this,e,t)};let o2=aG({any_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=aV(e,"x","any","bool");return aR.runKernel("Any",{x:a},{axis:t,keepDims:n})}});ag().prototype.any=function(e,t){return this.throwIfDisposed(),o2(this,e,t)};let o3=aG({argMax_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=aV(e,"x","argMax");return aR.runKernel(eD,{x:n},{axis:t})}});ag().prototype.argMax=function(e){return this.throwIfDisposed(),o3(this,e)};let o4=aG({argMin_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=aV(e,"x","argMin");return aR.runKernel(eM,{x:n},{axis:t})}});ag().prototype.argMin=function(e){return this.throwIfDisposed(),o4(this,e)},ag().prototype.asScalar=function(){return this.throwIfDisposed(),L(1===this.size,()=>"The array must have only 1 element."),io(this,[])},ag().prototype.asType=function(e){return this.throwIfDisposed(),rM(this,e)},ag().prototype.as1D=function(){return this.throwIfDisposed(),io(this,[this.size])},ag().prototype.as2D=function(e,t){return this.throwIfDisposed(),io(this,[e,t])},ag().prototype.as3D=function(e,t,n){return this.throwIfDisposed(),io(this,[e,t,n])},ag().prototype.as4D=function(e,t,n,a){return this.throwIfDisposed(),io(this,[e,t,n,a])},ag().prototype.as5D=function(e,t,n,a,r){return this.throwIfDisposed(),io(this,[e,t,n,a,r])};let o5=aG({asin_:function(e){let t=aV(e,"x","asin");return aR.runKernel(eF,{x:t})}});ag().prototype.asin=function(){return this.throwIfDisposed(),o5(this)};let o6=aG({asinh_:function(e){let t=aV(e,"x","asinh");return aR.runKernel(eO,{x:t})}});ag().prototype.asinh=function(){return this.throwIfDisposed(),o6(this)};let o8=aG({atan_:function(e){let t=aV(e,"x","atan");return aR.runKernel(eP,{x:t})}});ag().prototype.atan=function(){return this.throwIfDisposed(),o8(this)};let o9=aG({atan2_:function(e,t){let n=aV(e,"a","atan2"),a=aV(t,"b","atan2");[n,a]=ak(n,a);let r={a:n,b:a};return aR.runKernel(eL,r)}});ag().prototype.atan2=function(e){return this.throwIfDisposed(),o9(this,e)};let o7=aG({atanh_:function(e){let t=aV(e,"x","atanh");return aR.runKernel(ej,{x:t})}});ag().prototype.atanh=function(){return this.throwIfDisposed(),o7(this)};let le=aG({avgPool_:function(e,t,n,a,r){let i=aV(e,"x","avgPool","float32");L(iw(n,1),()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'"));let s=i,o=!1;3===i.rank&&(o=!0,s=io(i,[1,i.shape[0],i.shape[1],i.shape[2]])),L(4===s.rank,()=>"Error in avgPool: x must be rank 4 but got rank ".concat(s.rank,".")),iS("avgPool",a,r);let l={x:s},c=aR.runKernel(ez,l,{filterSize:t,strides:n,pad:a,dimRoundingMode:r});return(c=rM(c,i.dtype),o)?io(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});ag().prototype.avgPool=function(e,t,n,a){return this.throwIfDisposed(),le(this,e,t,n,a)},ag().prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),oK(this,e,t)};let lt=aG({batchNorm_:function(e,t,n,a,r,i){let s,o;null==i&&(i=.001);let l=aV(e,"x","batchNorm"),c=aV(t,"mean","batchNorm"),u=aV(n,"variance","batchNorm");null!=r&&(s=aV(r,"scale","batchNorm")),null!=a&&(o=aV(a,"offset","batchNorm")),L(c.rank===u.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),L(null==o||c.rank===o.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),L(null==s||c.rank===s.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let h={x:0===l.rank||1===l.rank?io(l,[1,1,1,l.size]):2===l.rank?io(l,[1,1,l.shape[0],l.shape[1]]):3===l.rank?io(l,[1,l.shape[0],l.shape[1],l.shape[2]]):l,scale:s,offset:o,mean:c,variance:u},d={varianceEpsilon:i};return io(aR.runKernel(tv,h,d),l.shape)}});ag().prototype.batchNorm=function(e,t,n,a,r){return this.throwIfDisposed(),lt(this,e,t,n,a,r)},ag().prototype.broadcastTo=function(e){return this.throwIfDisposed(),iD(this,e)},ag().prototype.cast=function(e){return this.throwIfDisposed(),rM(this,e)};let ln=aG({ceil_:function(e){let t=aV(e,"x","ceil","float32");return aR.runKernel(eY,{x:t})}});ag().prototype.ceil=function(){return this.throwIfDisposed(),ln(this)};let la=aG({clipByValue_:function(e,t,n){let a=aV(e,"x","clipByValue");return(L(t<=n,()=>"Error in clip: min (".concat(t,") must be ")+"less than or equal to max (".concat(n,").")),t===n)?r$(a.shape,t,a.dtype):aR.runKernel(eZ,{x:a},{clipValueMin:t,clipValueMax:n})}});ag().prototype.clipByValue=function(e,t){return this.throwIfDisposed(),la(this,e,t)},ag().prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof am&&(e=[e]),oY([this,...e],t)};let lr=aG({conv1d_:function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,s=arguments.length>6?arguments[6]:void 0,o=aV(e,"x","conv1d"),l=aV(t,"filter","conv1d"),c=o,u=!1;2===o.rank&&(u=!0,c=io(o,[1,o.shape[0],o.shape[1]])),L(3===c.rank,()=>"Error in conv1d: input must be rank 3, but got rank ".concat(c.rank,".")),L(3===l.rank,()=>"Error in conv1d: filter must be rank 3, but got rank "+"".concat(l.rank,".")),iS("conv1d",a,s),L(c.shape[2]===l.shape[1],()=>"Error in conv1d: depth of input (".concat(c.shape[2],") must match ")+"input depth for filter ".concat(l.shape[1],".")),L(iw(n,i),()=>"Error in conv1D: Either stride or dilation must be 1. "+"Got stride ".concat(n," and dilation '").concat(i,"'")),L(iN(i),()=>"Error in conv1D: Dilated rates should be larger than 0."),L(iN(n),()=>"Error in conv1D: Stride should be larger than 0."),L("NWC"===r,()=>"Error in conv1d: got dataFormat of ".concat(r," but only NWC is currently supported."));let h=io(l,[1,l.shape[0],l.shape[1],l.shape[2]]),d=iL(io(c,[c.shape[0],1,c.shape[1],c.shape[2]]),h,[1,n],a,"NHWC",[1,i],s);return u?io(d,[d.shape[2],d.shape[3]]):io(d,[d.shape[0],d.shape[2],d.shape[3]])}});ag().prototype.conv1d=function(e,t,n,a,r,i){return this.throwIfDisposed(),lr(this,e,t,n,a,r,i)};let li=aG({conv2dTranspose_:function(e,t,n,a,r,i){return ij(n,aV(e,"x","conv2dTranspose"),aV(t,"filter","conv2dTranspose"),a,r,"NHWC",i)}});ag().prototype.conv2dTranspose=function(e,t,n,a,r){return this.throwIfDisposed(),li(this,e,t,n,a,r)},ag().prototype.conv2d=function(e,t,n,a,r,i){return this.throwIfDisposed(),iL(this,e,t,n,a,r,i)},ag().prototype.cos=function(){return this.throwIfDisposed(),oG(this)},ag().prototype.cosh=function(){return this.throwIfDisposed(),oH(this)},ag().prototype.cumprod=function(e,t,n){return this.throwIfDisposed(),oV(this,e,t,n)},ag().prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),iQ(this,e,t,n)};let ls=aG({depthToSpace_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NHWC",a=aV(e,"x","depthToSpace","float32"),r="NHWC"===n?a.shape[1]:a.shape[2],i="NHWC"===n?a.shape[2]:a.shape[3],s="NHWC"===n?a.shape[3]:a.shape[1];return L(t>1,()=>"blockSize should be > 1 for depthToSpace, but was: ".concat(t)),L(r*t>=0,()=>"Negative dimension size caused by overflow when multiplying\n    ".concat(r," and ").concat(t,"  for depthToSpace with input shape\n    ").concat(a.shape)),L(i*t>=0,()=>"Negative dimension size caused by overflow when multiplying\n    ".concat(i," and ").concat(t," for depthToSpace with input shape\n        ").concat(a.shape)),L(s%(t*t)==0,()=>"Dimension size must be evenly divisible by ".concat(t*t," but is ").concat(s," for depthToSpace with input shape ").concat(a.shape)),aR.runKernel(tt,{x:a},{blockSize:t,dataFormat:n})}});ag().prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),ls(this,e,t)};let lo=aG({depthwiseConv2d_:function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],s=arguments.length>6?arguments[6]:void 0,o=aV(e,"x","depthwiseConv2d","float32"),l=aV(t,"filter","depthwiseConv2d","float32"),c=o,u=!1;3===o.rank&&(u=!0,c=io(o,[1,o.shape[0],o.shape[1],o.shape[2]])),L(4===c.rank,()=>"Error in depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(c.rank,".")),L(4===l.rank,()=>"Error in depthwiseConv2d: filter must be rank 4, but got rank "+"".concat(l.rank,"."));let h="NHWC"===r?c.shape[3]:c.shape[1];L(h===l.shape[2],()=>"Error in depthwiseConv2d: number of input channels "+"(".concat(h,") must match the inChannels dimension in ")+"filter ".concat(l.shape[2],".")),iS("depthwiseConv2d",a,s);let d={x:c,filter:l},p=aR.runKernel(tn,d,{strides:n,pad:a,dataFormat:r,dilations:i,dimRoundingMode:s});return u?io(p,[p.shape[1],p.shape[2],p.shape[3]]):p}});ag().prototype.depthwiseConv2d=function(e,t,n,a,r,i){return this.throwIfDisposed(),lo(this,e,t,n,a,r,i)};let ll=aG({dilation2d_:function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",s=aV(e,"x","dilation2d"),o=aV(t,"filter","dilation2d");L(3===s.rank||4===s.rank,()=>"Error in dilation2d: input must be rank 3 or 4, but got rank "+"".concat(s.rank,".")),L(3===o.rank,()=>"Error in dilation2d: filter must be rank 3, but got rank "+"".concat(o.rank,".")),L("NHWC"===i,()=>"Error in dilation2d: Only NHWC is currently supported, "+"but got dataFormat of ".concat(i));let l=s,c=!1;3===s.rank&&(l=io(s,[1,s.shape[0],s.shape[1],s.shape[2]]),c=!0),L(l.shape[3]===o.shape[2],()=>"Error in dilation2d:  input and filter must have the same depth: ".concat(l.shape[3]," vs ").concat(o.shape[2]));let u={x:l,filter:o},h=aR.runKernel(ts,u,{strides:n,pad:a,dilations:r});return c?io(h,[h.shape[1],h.shape[2],h.shape[3]]):h}});ag().prototype.dilation2d=function(e,t,n,a,r){return this.throwIfDisposed(),ll(this,e,t,n,a,r)};let lc=aG({divNoNan_:function(e,t){let n=aV(e,"a","div"),a=aV(t,"b","div");[n,a]=ak(n,a);let r=rL(n,a),i=rU(r);return iM(sn(a,i),i,r)}});ag().prototype.divNoNan=function(e){return this.throwIfDisposed(),lc(this,e)},ag().prototype.div=function(e){return this.throwIfDisposed(),rL(this,e)};let lu=aG({dot_:function(e,t){let n=aV(e,"t1","dot"),a=aV(t,"t2","dot");L((1===n.rank||2===n.rank)&&(1===a.rank||2===a.rank),()=>"Error in dot: inputs must all be rank 1 or 2, but got ranks "+"".concat(n.rank," and ").concat(a.rank,"."));let r=1===n.rank?n.size:n.shape[1],i=1===a.rank?a.size:a.shape[0];if(L(r===i,()=>"Error in dot: inner dimensions of inputs must match, but got "+"".concat(r," and ").concat(i,".")),1===n.rank&&1===a.rank){let e=iI(io(n,[1,-1]),io(a,[-1,1]));return io(e,[])}if(1===n.rank&&2===a.rank){let e=iI(io(n,[1,-1]),io(a,[a.shape[0],a.shape[1]]));return io(e,[e.size])}if(2!==n.rank||1!==a.rank)return iI(n,io(a,[a.shape[0],a.shape[1]]));{let e=iI(n,io(a,[-1,1]));return io(e,[e.size])}}});ag().prototype.dot=function(e){return this.throwIfDisposed(),lu(this,e)},ag().prototype.elu=function(){return this.throwIfDisposed(),sW(this)},ag().prototype.equal=function(e){return this.throwIfDisposed(),sn(this,e)};let lh=aG({erf_:function(e){let t=aV(e,"x","erf");L("int32"===t.dtype||"float32"===t.dtype,()=>"Input dtype must be `int32` or `float32`."),"int32"===t.dtype&&(t=rM(t,"float32"));let n={x:t};return aR.runKernel("Erf",n)}});ag().prototype.erf=function(){return this.throwIfDisposed(),lh(this)},e.s(["norm",()=>lf],99269);let ld=aG({max_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=aV(e,"x","max");return aR.runKernel("Max",{x:a},{reductionIndices:t,keepDims:n})}}),lp=aG({min_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=aV(e,"x","min");return aR.runKernel("Min",{x:a},{axis:t,keepDims:n})}}),lf=aG({norm_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"euclidean",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=function e(t,n){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===t.rank)return r4(t);if(1!==t.rank&&null===a)return e(io(t,[-1]),n,a);if(1===t.rank||"number"==typeof a||Array.isArray(a)&&1===a.length){if(1===n)return il(r4(t),a);if(n===1/0)return ld(r4(t),a);if(n===-1/0)return lp(r4(t),a);if("euclidean"===n||2===n)return rB(il(r1(r4(t),rG(2,"int32")),a));throw Error("Error in norm: invalid ord value: ".concat(n))}if(Array.isArray(a)&&2===a.length){if(1===n)return ld(il(r4(t),a[0]),a[1]-1);if(n===1/0)return ld(il(r4(t),a[1]),a[0]);if(n===-1/0)return lp(il(r4(t),a[1]),a[0]);if("fro"===n||"euclidean"===n)return rB(il(rV(t),a));throw Error("Error in norm: invalid ord value: ".concat(n))}throw Error("Error in norm: invalid axis: ".concat(a))}(e=aV(e,"x","norm"),t,n),i=r.shape;if(a){let t=J(n,e.shape);i=iq(r.shape,t)}return io(r,i)}}),lm=aG({euclideanNorm_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return lf(e,"euclidean",t,n)}});ag().prototype.euclideanNorm=function(e,t){return this.throwIfDisposed(),lm(this,e,t)},ag().prototype.exp=function(){return this.throwIfDisposed(),i3(this)},ag().prototype.expandDims=function(e){return this.throwIfDisposed(),oQ(this,e)};let lg=aG({expm1_:function(e){let t=aV(e,"x","expm1");return aR.runKernel(tm,{x:t})}});ag().prototype.expm1=function(){return this.throwIfDisposed(),lg(this)};let lx=aG({fft_:function(e){return L("complex64"===e.dtype,()=>"The dtype for tf.spectral.fft() must be complex64 "+"but got ".concat(e.dtype,".")),aR.runKernel("FFT",{input:e})}});ag().prototype.fft=function(){return this.throwIfDisposed(),lx(this)},ag().prototype.flatten=function(){return this.throwIfDisposed(),io(this,[this.size])},ag().prototype.floor=function(){return this.throwIfDisposed(),sh(this)},ag().prototype.floorDiv=function(e){return this.throwIfDisposed(),rj(this,e)},ag().prototype.gather=function(e,t,n){return this.throwIfDisposed(),oJ(this,e,t,n)},ag().prototype.greaterEqual=function(e){return this.throwIfDisposed(),i_(this,e)},ag().prototype.greater=function(e){return this.throwIfDisposed(),se(this,e)};let ly=aG({ifft_:function(e){return L("complex64"===e.dtype,()=>"The dtype for tf.spectral.ifft() must be complex64 "+"but got ".concat(e.dtype,".")),aR.runKernel(tT,{input:e})}});ag().prototype.ifft=function(){return this.throwIfDisposed(),ly(this)};let lb=aG({irfft_:function(e){let t,n=e.shape[e.shape.length-1],a=e.size/n;if(n<=2)t=ly(io(e,[a,n]));else{let r=[a,2*(n-1)],i=io(i$(e),[a,n]),s=io(iJ(e),[a,n]),o=oU(su(i,[0,1],[a,n-2]),1),l=rz(oU(su(s,[0,1],[a,n-2]),1),rG(-1));t=ly(io(aH(oY([i,o],1),oY([s,l],1)),[r[0],r[1]]))}if(t=i$(t),3===e.rank&&0!==e.shape[0]){let n=t,a=e.shape[0];t=io(t,[a,t.shape[0]/a,t.shape[1]]),n.dispose()}return t}});ag().prototype.irfft=function(){return this.throwIfDisposed(),lb(this)};let lv=aG({isFinite_:function(e){let t=aV(e,"x","isFinite");return aR.runKernel(tE,{x:t})}});ag().prototype.isFinite=function(){return this.throwIfDisposed(),lv(this)};let lw=aG({isInf_:function(e){let t=aV(e,"x","isInf");return aR.runKernel(t_,{x:t})}});ag().prototype.isInf=function(){return this.throwIfDisposed(),lw(this)};let lN=aG({isNaN_:function(e){let t=aV(e,"x","isNaN");return aR.runKernel(tA,{x:t})}});ag().prototype.isNaN=function(){return this.throwIfDisposed(),lN(this)},ag().prototype.leakyRelu=function(e){return this.throwIfDisposed(),sG(this,e)},ag().prototype.lessEqual=function(e){return this.throwIfDisposed(),iA(this,e)},ag().prototype.less=function(e){return this.throwIfDisposed(),si(this,e)};let lk=aG({localResponseNormalization_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,i=aV(e,"x","localResponseNormalization");L(4===i.rank||3===i.rank,()=>"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(i.rank,".")),L(H(t),()=>"Error in localResponseNormalization: depthRadius must be an "+"integer but got depthRadius ".concat(t,"."));let s=i,o=!1;3===i.rank&&(o=!0,s=io(i,[1,i.shape[0],i.shape[1],i.shape[2]]));let l={x:s},c=aR.runKernel("LRN",l,{depthRadius:t,bias:n,alpha:a,beta:r});return o?io(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});ag().prototype.localResponseNormalization=function(e,t,n,a){return this.throwIfDisposed(),lk(this,e,t,n,a)};let lS=aG({softplus_:function(e){let t=aV(e,"x","softplus");return aR.runKernel(nN,{x:t})}}),lC=aG({logSigmoid_:function(e){let t=aV(e,"x","logSigmoid");return rW(e=>({value:is(lS(is(e))),gradFunc:t=>rz(t,sX(is(e)))}))(t)}});ag().prototype.logSigmoid=function(){return this.throwIfDisposed(),lC(this)};let lT=aG({logSoftmax_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=aV(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and axis was ").concat(t));return rW((e,n)=>{let a=ld(e,t,!0),r=r2(e,a),i=r2(rM(r,"float32"),sf(il(i3(r),t,!0)));return n([i]),{value:i,gradFunc:(e,n)=>{let[a]=n,r=i3(a);return r2(e,rz(il(e,t,!0),r))}}})(n)}});ag().prototype.logSoftmax=function(e){return this.throwIfDisposed(),lT(this,e)};let lI=aG({logSumExp_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=aV(e,"x","logSumExp"),r=J(t,a.shape),i=ld(a,r,!0),s=sf(il(i3(r2(a,i)),r)),o=rP(io(i,s.shape),s);if(n){let e=iq(o.shape,r);return io(o,e)}return o}});ag().prototype.logSumExp=function(e,t){return this.throwIfDisposed(),lI(this,e,t)},ag().prototype.log=function(){return this.throwIfDisposed(),sf(this)};let lE=aG({log1p_:function(e){let t=aV(e,"x","log1p");return aR.runKernel(tO,{x:t})}});ag().prototype.log1p=function(){return this.throwIfDisposed(),lE(this)},ag().prototype.logicalAnd=function(e){return this.throwIfDisposed(),iR(this,e)},ag().prototype.logicalNot=function(){return this.throwIfDisposed(),oW(this)};let l_=aG({logicalOr_:function(e,t){let n=aV(e,"a","logicalOr","bool"),a=aV(t,"b","logicalOr","bool");return r8(n.shape,a.shape),aR.runKernel(tL,{a:n,b:a})}});ag().prototype.logicalOr=function(e){return this.throwIfDisposed(),l_(this,e)};let lA=aG({logicalXor_:function(e,t){let n=aV(e,"a","logicalXor","bool"),a=aV(t,"b","logicalXor","bool");return r8(n.shape,a.shape),iR(l_(e,t),oW(iR(e,t)))}});ag().prototype.logicalXor=function(e){return this.throwIfDisposed(),lA(this,e)},ag().prototype.matMul=function(e,t,n){return this.throwIfDisposed(),iI(this,e,t,n)};let lR=aG({maxPool_:function(e,t,n,a,r){let i=aV(e,"x","maxPool"),s=i,o=!1;3===i.rank&&(o=!0,s=io(i,[1,i.shape[0],i.shape[1],i.shape[2]])),L(4===s.rank,()=>"Error in maxPool: input must be rank 4 but got rank ".concat(s.rank,".")),L(iw(n,1),()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")),iS("maxPool",a,r);let l={x:s},c=aR.runKernel(tV,l,{filterSize:t,strides:n,pad:a,dimRoundingMode:r});return o?io(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});ag().prototype.maxPool=function(e,t,n,a){return this.throwIfDisposed(),lR(this,e,t,n,a)},ag().prototype.max=function(e,t){return this.throwIfDisposed(),ld(this,e,t)},ag().prototype.maximum=function(e){return this.throwIfDisposed(),r9(this,e)};let lD=aG({mean_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=aV(e,"x","mean");return aR.runKernel(tq,{x:a},{axis:t,keepDims:n})}});ag().prototype.mean=function(e,t){return this.throwIfDisposed(),lD(this,e,t)},ag().prototype.min=function(e,t){return this.throwIfDisposed(),lp(this,e,t)};let lM=aG({minimum_:function(e,t){let n=aV(e,"a","minimum"),a=aV(t,"b","minimum");[n,a]=ak(n,a),"bool"===n.dtype&&(n=rM(n,"int32"),a=rM(a,"int32")),r8(n.shape,a.shape);let r={a:n,b:a};return aR.runKernel(tK,r)}});ag().prototype.minimum=function(e){return this.throwIfDisposed(),lM(this,e)};let lF=aG({mirrorPad_:function(e,t,n){L("reflect"===n||"symmetric"===n,()=>"Invalid mode. Mode must be either reflect or symmetric. "+"Got ".concat(n,"."));let a=aV(e,"x","mirrorPad");if(0===a.rank)throw Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");L(t.length===a.rank,()=>"Padding doesn't match input. Must be ".concat(a.rank,". ")+"Got ".concat(t.length,"."));let r=+("reflect"===n);for(let e=0;e<a.rank;e++)L(2===t[e].length,()=>"Invalid number of paddings. Must be length of 2 each."),L(t[e][0]>=0&&t[e][0]<=a.shape[e]-r&&t[e][1]>=0&&t[e][1]<=a.shape[e]-r,()=>"Padding in dimension ".concat(e," cannot be greater than or equal ")+"to ".concat(a.shape[e]-r," or less than 0 for input of ")+"shape ".concat(a.shape));return aR.runKernel(tX,{x:a},{paddings:t,mode:n})}});ag().prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),lF(this,e,t)};let lO=aG({mod_:function(e,t){let n=aV(e,"a","mod"),a=aV(t,"b","mod");[n,a]=ak(n,a);let r={a:n,b:a};return aR.runKernel("Mod",r)}});ag().prototype.mod=function(e){return this.throwIfDisposed(),lO(this,e)},ag().prototype.mul=function(e){return this.throwIfDisposed(),rz(this,e)},ag().prototype.neg=function(){return this.throwIfDisposed(),is(this)},ag().prototype.norm=function(e,t,n){return this.throwIfDisposed(),lf(this,e,t,n)};let lP=aG({notEqual_:function(e,t){let n=aV(e,"a","notEqual","string_or_numeric"),a=aV(t,"b","notEqual","string_or_numeric");[n,a]=ak(n,a),r8(n.shape,a.shape);let r={a:n,b:a};return aR.runKernel(tQ,r)}});ag().prototype.notEqual=function(e){return this.throwIfDisposed(),lP(this,e)};let lj=aG({oneHot_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"int32";if(t<2)throw Error("Error in oneHot: depth must be >=2, but it is ".concat(t));let i=aV(e,"indices","oneHot","int32");return aR.runKernel(t2,{indices:i},{dtype:r,depth:t,onValue:n,offValue:a})}});ag().prototype.oneHot=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.throwIfDisposed(),lj(this,e,t,n)};let lL=aG({onesLike_:function(e){let t=aV(e,"x","onesLike");return aR.runKernel(t1,{x:t})}});ag().prototype.onesLike=function(){return this.throwIfDisposed(),lL(this)},ag().prototype.pad=function(e,t){return this.throwIfDisposed(),oq(this,e,t)};let lz=aG({pool_:function(e,t,n,a,r,i,s){let o;null==r&&(r=[1,1]),null==i&&(i=1),0===a&&(a="valid");let l=aV(e,"x","maxPool"),c=l,u=!1;3===l.rank&&(u=!0,c=io(l,[1,l.shape[0],l.shape[1],l.shape[2]])),L(iw(i,r),()=>"Error in pool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(r,"'"));let h=iu(c.shape,t,i,r,a),d=[h.dilationHeight,h.dilationWidth];o="same"===a?function(e,t){let n=e.map((e,n)=>e+(e-1)*(t[n]-1)).map(e=>e-1),a=n.map(e=>Math.floor(e/2)),r=n.map((e,t)=>e-a[t]);return n.map((e,t)=>[a[t],r[t]])}([h.filterHeight,h.filterWidth],d):[[0,0],[0,0]];let p=1===d[0]&&1===d[1],[f,m]=function(e,t,n){let a=n.map(e=>e[0]),r=n.map(e=>e[1]),i=e.concat(a,r),s=t.map((e,t)=>(e-i[t]%e)%e),o=r.map((e,t)=>e+s[t]);return[t.map((e,t)=>[a[t],o[t]]),t.map((e,t)=>[0,s[t]])]}([h.inHeight,h.inWidth],d,o),g=p?a:"valid",x=p?c:iE(c,d,f),y=("avg"===n?()=>le(x,t,i,g,s):()=>lR(x,t,i,g,s))(),b=p?y:oK(y,d,m);return u?io(b,[b.shape[1],b.shape[2],b.shape[3]]):b}});ag().prototype.pool=function(e,t,n,a,r,i){return this.throwIfDisposed(),lz(this,e,t,n,a,r,i)},ag().prototype.pow=function(e){return this.throwIfDisposed(),r1(this,e)},ag().prototype.prelu=function(e){return this.throwIfDisposed(),sH(this,e)};let lB=aG({prod_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=aV(e,"x","prod");"bool"===a.dtype&&(a=rM(a,"int32"));let r={x:a};return aR.runKernel(t6,r,{axis:t,keepDims:n})}});ag().prototype.prod=function(e,t){return this.throwIfDisposed(),lB(this,e,t)};let lV=aG({reciprocal_:function(e){let t=aV(e,"x","reciprocal");return aR.runKernel(nn,{x:t})}});ag().prototype.reciprocal=function(){return this.throwIfDisposed(),lV(this)},ag().prototype.relu=function(){return this.throwIfDisposed(),sq(this)},ag().prototype.relu6=function(){return this.throwIfDisposed(),sK(this)},ag().prototype.reshapeAs=function(e){return this.throwIfDisposed(),io(this,e.shape)},ag().prototype.reshape=function(e){return this.throwIfDisposed(),io(this,e)};let lU=aG({resizeBilinear_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=aV(e,"images","resizeBilinear");L(3===r.rank||4===r.rank,()=>"Error in resizeBilinear: x must be rank 3 or 4, but got "+"rank ".concat(r.rank,".")),L(2===t.length,()=>"Error in resizeBilinear: new shape must 2D, but got shape "+"".concat(t,".")),L(!1===a||!1===n,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=r,s=!1;3===r.rank&&(s=!0,i=io(r,[1,r.shape[0],r.shape[1],r.shape[2]]));let[]=t,o={images:i},l=aR.runKernel(no,o,{alignCorners:n,halfPixelCenters:a,size:t});return s?io(l,[l.shape[1],l.shape[2],l.shape[3]]):l}});ag().prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),lU(this,e,t,n)};let lW=aG({resizeNearestNeighbor_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=aV(e,"images","resizeNearestNeighbor");L(3===r.rank||4===r.rank,()=>"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+"rank ".concat(r.rank,".")),L(2===t.length,()=>"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+"".concat(t,".")),L("float32"===r.dtype||"int32"===r.dtype,()=>"`images` must have `int32` or `float32` as dtype"),L(!1===a||!1===n,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=r,s=!1;3===r.rank&&(s=!0,i=io(r,[1,r.shape[0],r.shape[1],r.shape[2]]));let[]=t,o={images:i},l=aR.runKernel(ni,o,{alignCorners:n,halfPixelCenters:a,size:t});return s?io(l,[l.shape[1],l.shape[2],l.shape[3]]):l}});ag().prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),lW(this,e,t,n)},ag().prototype.reverse=function(e){return this.throwIfDisposed(),oU(this,e)};let lG=aG({rfft_:function(e,t){let n;L("float32"===e.dtype,()=>"The dtype for rfft() must be real value but got ".concat(e.dtype));let a=e.shape[e.shape.length-1],r=e.size/a;if(null!=t&&t<a){let r=e.shape.map(e=>0),i=e.shape.map(e=>e);i[e.shape.length-1]=t,n=su(e,r,i),a=t}else if(null!=t&&t>a){let r=e.shape.map(e=>e);r[e.shape.length-1]=t-a,n=oY([e,sl(r)],e.shape.length-1),a=t}else n=e;let i=rU(n),s=lx(io(aH(n,i),[r,a])),o=Math.floor(a/2)+1,l=i$(s),c=iJ(s),u=iO(l,[o,a-o],l.shape.length-1),h=iO(c,[o,a-o],c.shape.length-1),d=n.shape.slice();return d[n.shape.length-1]=o,io(aH(u[0],h[0]),d)}});ag().prototype.rfft=function(){return this.throwIfDisposed(),lG(this)};let lH=aG({round_:function(e){let t=aV(e,"x","round");return aR.runKernel(nh,{x:t})}});ag().prototype.round=function(){return this.throwIfDisposed(),lH(this)},ag().prototype.rsqrt=function(){return this.throwIfDisposed(),i4(this)};let lq=aG({selu_:function(e){let t=aV(e,"x","selu");return aR.runKernel(nx,{x:t})}});ag().prototype.selu=function(){return this.throwIfDisposed(),lq(this)};let lK=aG({separableConv2d_:function(e,t,n,a,r){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NHWC",o=aV(e,"x","separableConv2d"),l=aV(t,"depthwiseFilter","separableConv2d"),c=aV(n,"pointwiseFilter","separableConv2d"),u=o,h=!1;if(3===o.rank&&(h=!0,u=io(o,[1,o.shape[0],o.shape[1],o.shape[2]])),"NCHW"===s)throw Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");L(4===u.rank,()=>"Error in separableConv2d: input must be rank 4, but got "+"rank ".concat(u.rank,".")),L(4===l.rank,()=>"Error in separableConv2d: depthwise filter must be rank 4, but "+"got rank ".concat(l.rank,".")),L(4===c.rank,()=>"Error in separableConv2d: pointwise filter must be rank 4, but "+"got rank ".concat(l.rank,".")),L(1===c.shape[0],()=>"Error in separableConv2d: the first dimension of pointwise filter "+" must be 1, but got ".concat(c.shape[0],".")),L(1===c.shape[1],()=>"Error in separableConv2d: the second dimension of pointwise "+"filter must be 1, but got ".concat(c.shape[1],"."));let d=l.shape[2],p=l.shape[3];L(c.shape[2]===d*p,()=>"Error in separableConv2d: the third dimension of pointwise filter "+"must be ".concat(d*p,", ")+"but got ".concat(c.shape[2],"."));let f=iL(lo(u,l,a,r,s,i),c,1,"valid",s);return h?io(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});ag().prototype.separableConv2d=function(e,t,n,a,r,i){return this.throwIfDisposed(),lK(this,e,t,n,a,r,i)},ag().prototype.sigmoid=function(){return this.throwIfDisposed(),sX(this)};let lX=aG({sign_:function(e){let t=aV(e,"x","sign");return aR.runKernel(nv,{x:t})}});ag().prototype.sign=function(){return this.throwIfDisposed(),lX(this)},ag().prototype.sin=function(){return this.throwIfDisposed(),iV(this)},ag().prototype.sinh=function(){return this.throwIfDisposed(),iU(this)},ag().prototype.slice=function(e,t){return this.throwIfDisposed(),su(this,e,t)};let lY=aG({softmax_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=aV(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and dim was ").concat(t));let a={dim:t};return aR.runKernel(nT,{logits:n},a)}});ag().prototype.softmax=function(e){return this.throwIfDisposed(),lY(this,e)},ag().prototype.softplus=function(){return this.throwIfDisposed(),lS(this)},ag().prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),iE(this,e,t)},ag().prototype.split=function(e,t){return this.throwIfDisposed(),iO(this,e,t)},ag().prototype.sqrt=function(){return this.throwIfDisposed(),rB(this)},ag().prototype.square=function(){return this.throwIfDisposed(),rV(this)};let lZ=aG({squaredDifference_:function(e,t){let n=aV(e,"a","squaredDifference"),a=aV(t,"b","squaredDifference");[n,a]=ak(n,a),r8(n.shape,a.shape);let r={a:n,b:a};return aR.runKernel(nD,r,{})}});ag().prototype.squaredDifference=function(e){return this.throwIfDisposed(),lZ(this,e)};let lQ=aG({squeeze_:function(e,t){let n=aV(e,"x","squeeze","string_or_numeric");return io(n,$(n.shape,t).newShape)}});ag().prototype.squeeze=function(e){return this.throwIfDisposed(),lQ(this,e)},ag().prototype.stack=function(e,t){return this.throwIfDisposed(),i6(e instanceof am?[this,e]:[this,...e],t)},ag().prototype.step=function(e){return this.throwIfDisposed(),ir(this,e)};let lJ=aG({stridedSlice_:function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,c=aV(e,"x","stridedSlice","string_or_numeric");return aR.runKernel(nO,{x:c},{begin:t,end:n,strides:a,beginMask:r,endMask:i,ellipsisMask:s,newAxisMask:o,shrinkAxisMask:l})}});ag().prototype.stridedSlice=function(e,t,n,a,r,i,s,o){return this.throwIfDisposed(),lJ(this,e,t,n,a,r,i,s,o)},ag().prototype.sub=function(e){return this.throwIfDisposed(),r2(this,e)},ag().prototype.sum=function(e,t){return this.throwIfDisposed(),il(this,e,t)};let l$=aG({tan_:function(e){let t=aV(e,"x","tan","float32");return aR.runKernel("Tan",{x:t})}});ag().prototype.tan=function(){return this.throwIfDisposed(),l$(this)};let l0=aG({tanh_:function(e){let t=aV(e,"x","tanh","float32");return aR.runKernel(nz,{x:t})}});ag().prototype.tanh=function(){return this.throwIfDisposed(),l0(this)},ag().prototype.tile=function(e){return this.throwIfDisposed(),i5(this,e)},ag().prototype.toBool=function(){return this.throwIfDisposed(),rM(this,"bool")},ag().prototype.toFloat=function(){return this.throwIfDisposed(),rM(this,"float32")},ag().prototype.toInt=function(){return this.throwIfDisposed(),rM(this,"int32")};let l1=aG({topk_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],a=aV(e,"x","topk");if(0===a.rank)throw Error("topk() expects the input to be of rank 1 or higher");let r=a.shape[a.shape.length-1];if(t<0)throw Error("'k' passed to topk() must be >= 0 but got ".concat(t));if(t>r)throw Error("'k' passed to topk() must be <= the last dimension (".concat(r,") ")+"but got ".concat(t));let[i,s]=aR.runKernel(nV,{x:a},{k:t,sorted:n});return{values:i,indices:s}}});ag().prototype.topk=function(e,t){return this.throwIfDisposed(),l1(this,e,t)},ag().prototype.transpose=function(e){return this.throwIfDisposed(),i0(this,e)};let l2=aG({unique_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=aV(e,"x","unique","string_or_numeric");L(n.rank>0,()=>"The input tensor must be at least 1D");let[a,r]=aR.runKernel(nG,{x:n},{axis:t});return{values:a,indices:r}}});ag().prototype.unique=function(e){return this.throwIfDisposed(),l2(this,e)},ag().prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),i8(this,e,t)},ag().prototype.unstack=function(e){return this.throwIfDisposed(),sd(this,e)},ag().prototype.where=function(e,t){return this.throwIfDisposed(),iM(e,this,t)},ag().prototype.zerosLike=function(){return this.throwIfDisposed(),rU(this)},e.s([],20443),e.s(["arraysEqual",()=>G,"arraysEqualWithNull",()=>W,"assert",()=>L,"assertNonNegativeIntegerDimensions",()=>eb,"assertNonNull",()=>B,"assertShapesMatch",()=>z,"bytesFromStringArray",()=>es,"bytesPerElement",()=>ei,"checkConversionForErrors",()=>en,"clamp",()=>D,"computeStrides",()=>ep,"convertBackendValuesAndArrayBuffer",()=>em,"createScalarValue",()=>n7,"createShuffledIndices",()=>X,"decodeString",()=>ar,"distSquared",()=>j,"encodeString",()=>aa,"fetch",()=>an,"fingerPrint64",()=>ci,"flatten",()=>as,"getArrayFromDType",()=>et,"getTypedArrayFromDType",()=>ee,"hasEncodingLoss",()=>er,"hexToLong",()=>l5,"indexToLoc",()=>ew,"inferDtype",()=>eu,"inferFromImplicitShape",()=>Q,"isBoolean",()=>el,"isFunction",()=>eh,"isInt",()=>H,"isNumber",()=>ec,"isPromise",()=>eN,"isScalarShape",()=>U,"isString",()=>eo,"isTypedArray",()=>ai,"isValidDtype",()=>ea,"locToIndex",()=>ev,"makeOnesTypedArray",()=>eg,"makeZerosNestedTypedArray",()=>ey,"makeZerosTypedArray",()=>ex,"nearestDivisor",()=>ed,"nearestLargerEven",()=>M,"now",()=>at,"parseAxisParam",()=>J,"randUniform",()=>P,"repeatedTry",()=>Z,"rightPad",()=>Y,"shuffle",()=>A,"shuffleCombo",()=>R,"sizeFromShape",()=>V,"sizeToSquarishShape",()=>K,"squeezeShape",()=>$,"sum",()=>O,"swap",()=>F,"tanh",()=>q,"toNestedArray",()=>ef,"toTypedArray",()=>ae],34338),e.i(91587),e.i(86879),e.s(["fingerPrint64",()=>ci,"hexToLong",()=>l5],57757);var l3=e.i(1392);let l4=l3.default||l3;function l5(e){return l4.fromString(e,!0,16)}let l6=l5("c3a5c85c97cb3127"),l8=l5("b492b66fbe98f273"),l9=l5("9ae16a3b2f90404f");function l7(e){return e.xor(e.shru(47))}function ce(e,t,n){let a=e.slice(t,t+n);return l4.fromBytes(Array.from(a),!0,!0)}function ct(e,t){return ce(e,t,8)}function cn(e,t){return 0===t?e:e.shru(t).or(e.shl(64-t))}function ca(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l5("9ddfea08eb382d69"),a=e.xor(t).mul(n);a=a.xor(a.shru(47));let r=t.xor(a).mul(n);return(r=r.xor(r.shru(47))).mul(n)}function cr(e,t,n,a){return function(e,t,n,a,r,i){r=r.add(e),i=cn(i.add(r).add(a),21);let s=r;return r=(r=r.add(t)).add(n),i=i.add(cn(r,44)),[r.add(a),i.add(s)]}(ct(e,t),ct(e,t+8),ct(e,t+16),ct(e,t+24),n,a)}function ci(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,n=l4.fromNumber(81,!0);if(t<=32)if(t<=16)return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;if(t>=8){let n=l9.add(2*t),a=ct(e,0).add(l9),r=ct(e,t-8);return ca(cn(r,37).mul(n).add(a),cn(a,25).add(r).mul(n),n)}if(t>=4){let n=l9.add(2*t);return ca(ce(e,0,4).shl(3).add(t),ce(e,t-4,4),n)}if(t>0){let n=e[0],a=e[t>>1],r=e[t-1];return l7(l9.mul(n+(a<<8)).xor(l6.mul(t+(r<<2)))).mul(l9)}return l9}(e,t);else return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,n=l9.add(2*t),a=ct(e,0).mul(l8),r=ct(e,8),i=ct(e,t-8).mul(n),s=ct(e,t-16).mul(l9);return ca(cn(a.add(r),43).add(cn(i,30)).add(s),a.add(cn(r.add(l9),18)).add(i),n)}(e,t);if(t<=64)return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,n=l9.add(2*t),a=ct(e,0).mul(l9),r=ct(e,8),i=ct(e,t-8).mul(n),s=ct(e,t-16).mul(l9),o=cn(a.add(r),43).add(cn(i,30)).add(s),l=ca(o,a.add(cn(r.add(l9),18)).add(i),n),c=ct(e,16).mul(n),u=ct(e,24),h=o.add(ct(e,t-32)).mul(n),d=l.add(ct(e,t-24)).mul(n);return ca(cn(c.add(u),43).add(cn(h,30)).add(d),c.add(cn(u.add(a),18)).add(h),n)}(e,t);let a=n,r=n.mul(l8).add(113),i=l7(r.mul(l9).add(113)).mul(l9),s=[l4.UZERO,l4.UZERO],o=[l4.UZERO,l4.UZERO];a=a.mul(l9).add(ct(e,0));let l=0,c=(t-1>>6)*64,u=c+(t-1&63)-63;do a=cn(a.add(r).add(s[0]).add(ct(e,l+8)),37).mul(l8),r=cn(r.add(s[1]).add(ct(e,l+48)),42).mul(l8),a=a.xor(o[1]),r=r.add(s[0]).add(ct(e,l+40)),i=cn(i.add(o[0]),33).mul(l8),s=cr(e,l,s[1].mul(l8),a.add(o[0])),o=cr(e,l+32,i.add(o[1]),r.add(ct(e,l+16))),[i,a]=[a,i],l+=64;while(l!==c)let h=l8.add(i.and(255).shl(1));return l=u,o[0]=o[0].add(t-1&63),s[0]=s[0].add(o[0]),o[0]=o[0].add(s[0]),a=cn(a.add(r).add(s[0]).add(ct(e,l+8)),37).mul(h),r=cn(r.add(s[1]).add(ct(e,l+48)),42).mul(h),a=a.xor(o[1].mul(9)),r=r.add(s[0].mul(9).add(ct(e,l+40))),i=cn(i.add(o[0]),33).mul(h),s=cr(e,l,s[1].mul(h),a.add(o[0])),o=cr(e,l+32,i.add(o[1]),r.add(ct(e,l+16))),[i,a]=[a,i],ca(ca(s[0],o[0],h).add(l7(r).mul(l6)).add(i),ca(s[1],o[1],h).add(a),h)}e.i(57757);var cs=e.i(34338),cs=cs;class co extends Error{constructor(e){super(e),Object.setPrototypeOf(this,co.prototype)}}class cl extends Error{constructor(e){super(e),Object.setPrototypeOf(this,cl.prototype)}}class cc extends Error{constructor(e){super(e),Object.setPrototypeOf(this,cc.prototype)}}class cu extends Error{constructor(e){super(e),Object.setPrototypeOf(this,cu.prototype)}}class ch extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ch.prototype)}}class cd{get(e){let t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}put(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){let e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw Error("The maxEntries of LRU caches must be at least 0, but got ".concat(e,"."));if(this.maxEntries>e)for(let t=0;t<this.maxEntries-e;t++){let e=this.cache.keys().next().value;this.cache.delete(e)}this.maxEntries=e}constructor(e){this.maxEntries=e||100,this.cache=new Map}}var cs=cs;function cp(e,t){if(Array.isArray(e)){let n=[];for(let a=0;a<t;a++)n=n.concat(e);return n}{let n=Array(t);return n.fill(e),n}}function cf(e,t){if(!e)throw new ch(t)}function cm(e,t){let n=0;for(let a of e)a===t&&n++;return n}function cg(e){return 1===e.length?e[0]:e}function cx(e){return Array.isArray(e)?e:[e]}function cy(e){let t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==t[0]?t:"private"+t}function cb(e){return e.length<=1||-1===e.indexOf("_")?e:e.replace(/[_]+(\w|$)/g,(e,t)=>t.toUpperCase())}let cv={};function cw(e){if(null==e)return null;let t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function cN(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"object",r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("string"==typeof e){let r;if(e in n)r=n[e];else if(e in cv)r=cv[e];else if(null==(r=t[e]))throw new cc("Unknown ".concat(a,": ").concat(e,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(a," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(a," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");return r}{let i,s;if(null==e.className||null==e.config)throw new cc("".concat(a,": Improper config format: ")+"".concat(JSON.stringify(e),".\n")+"'className' and 'config' must set.");let o=e.className;if(o in n?[i,s]=n[o]:o in cv?[i,s]=cv.className:o in t&&([i,s]=t[o]),null==i)throw new cc("Unknown ".concat(a,": ").concat(o,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(a," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(a," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");if(null!=s){let t={};for(let e of Object.keys(cv))t[e]=cv[e];for(let e of Object.keys(n))t[e]=n[e];e.config.customObjects=t;let a=Object.assign({},cv);for(let e of Object.keys(n))cv[e]=n[e];!function e(t){if(null!=t&&"object"==typeof t)if(Array.isArray(t))t.forEach(t=>e(t));else for(let n of Object.keys(t)){let a=t[n];null!=a&&"object"==typeof a&&(Array.isArray(a)||"ndarray"!==a.type||"number"!=typeof a.value?e(a):t[n]=a.value)}}(e.config);let o=s(i,e.config,n,r);return cv=Object.assign({},a),o}{let t=Object.assign({},cv);for(let e of Object.keys(n))cv[e]=n[e];let a=new i(e.config);return cv=Object.assign({},t),a}}}function ck(e,t){return -1*(e<t?-1:+(e>t))}function cS(e){if(null==e)return e;let t=[];for(let n of e)-1===t.indexOf(n)&&t.push(n);return t}function cC(e,t,n){if(null!=n&&0>e.indexOf(n))throw new cc("".concat(n," is not a valid ").concat(t,".  Valid values are ").concat(e," or null/undefined."))}function cT(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;return cf(n>=0),cf(a>=n),Array.isArray(e)&&e.length>=n&&e.length<=a&&e.every(e=>typeof e===t)}function cI(e,t){Array.isArray(e)?(cs.assert(e.length>0,()=>"".concat(t," is unexpectedly an empty array.")),e.forEach((e,n)=>cI(e,"element ".concat(n+1," of ").concat(t)))):cs.assert(Number.isInteger(e)&&e>0,()=>"Expected ".concat(t," to be a positive integer, but got ")+"".concat(function e(t){return null===t?"null":Array.isArray(t)?"["+t.map(t=>e(t)).join(",")+"]":"string"==typeof t?'"'.concat(t,'"'):"".concat(t)}(e),"."))}function cE(e){return"relu"===e?"relu":"linear"===e?"linear":"elu"===e?"elu":null}var c_=e.i(86862),c_=c_;let cA=0,cR={};function cD(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e in cR||(cR[e]=0),cR[e]+=1,e+cR[e].toString()}var c_=c_,cs=cs;let cM=["channelsFirst","channelsLast"],cF=["nearest","bilinear"],cO=["valid","same","causal"],cP=["max","avg"],cj=["sum","mul","concat","ave"],cL=new Map;function cz(e){cC(cM,"DataFormat",e)}function cB(e){cC(cO,"PaddingMode",e)}function cV(e){cC(cP,"PoolMode",e)}let cU=[];function cW(e,t){cU.push(e);try{let e=t();return cU.pop(),e}catch(e){throw cU.pop(),e}}function cG(e){if(!cK(e))throw Error("Not a valid tensor name: '"+e+"'");return(0===cU.length?"":cU.join("/")+"/")+e}function cH(e){if(!cK(e))throw Error("Not a valid tensor name: '"+e+"'");cL.has(e)||cL.set(e,0);let t=cL.get(e);if(cL.set(e,cL.get(e)+1),!(t>0))return e;{let n="".concat(e,"_").concat(t);return cL.set(n,1),n}}let cq=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function cK(e){return!!e.match(cq)}let cX=aG({eye_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";null==t&&(t=e);let r=rD([e,t],a),i=e<=t?e:t;for(let e=0;e<i;++e)r.set(1,e,e);let s=io(r.toTensor(),[e,t]);if(null==n)return s;if(1===n.length)return i5(oQ(s,0),[n[0],1,1]);if(2===n.length)return i5(oQ(oQ(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return i5(oQ(oQ(oQ(s,0),0),0),[n[0],n[1],n[2],1,1]);throw Error("eye() currently supports only 1D and 2D "+"batchShapes, but received ".concat(n.length,"D."))}});e.s(["image",()=>uW,"linalg",()=>uG,"losses",()=>uH,"signal",()=>uU,"sparse",()=>uq,"spectral",()=>uV,"string",()=>uK],31445),e.s(["conv2d",()=>cY,"depthwiseConv2d",()=>cZ,"matMul",()=>cQ],85474),e.s([],29746);let cY=aG({fusedConv2d_:function(e){let t,n,{x:a,filter:r,strides:i,pad:s,dataFormat:o="NHWC",dilations:l=[1,1],dimRoundingMode:c,bias:u,activation:h="linear",preluActivationWeights:d,leakyreluAlpha:p}=e;if(h=h||"linear",!1===sJ(aR.state.gradientDepth,h)){L("NHWC"===o,()=>"Error in fused conv2d: got dataFormat of ".concat(o," but ")+"only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.");let e=iL(a,r,i,s,o,l,c);return null!=u&&(e=rP(e,u)),sQ(e,h,d,p)}let f=aV(a,"x","conv2d","float32"),m=aV(r,"filter","conv2d","float32"),g=f,x=!1;3===f.rank&&(x=!0,g=io(f,[1,f.shape[0],f.shape[1],f.shape[2]])),L(4===g.rank,()=>"Error in fused conv2d: input must be rank 4, but got rank "+"".concat(g.rank,".")),L(4===m.rank,()=>"Error in fused conv2d: filter must be rank 4, but got rank "+"".concat(m.rank,".")),iS("fused conv2d",s,c);let y="NHWC"===o?g.shape[3]:g.shape[1];L(m.shape[2]===y,()=>"Error in conv2d: depth of input (".concat(y,") must match ")+"input depth for filter ".concat(m.shape[2],".")),L(iw(i,l),()=>"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(l,"'"));let b=id(g.shape,m.shape,i,l,s,c);if(null!=u&&(t=aV(u,"bias","fused conv2d"),[t]=ak(t,f),"NHWC"===o?r8(b.outShape,t.shape):(L(t.shape.length<=1,()=>"Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of "+"rank-".concat(t.shape.length,".")),L(0===t.shape.length||t.shape[0]===b.outChannels||1===t.shape[0],()=>"Error in fused conv2d: bias shape (".concat(t.shape,") is not ")+"compatible with the number of output channels "+"(".concat(b.outChannels,")")))),null!=d){let e=d.shape;if(L(e.length<=1||3===e.length,()=>"Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of "+"rank-".concat(e.length,".")),1===e.length)L(1===e[0]||e[0]===b.outChannels,()=>"Error in fused conv2d: PReLU activation weights "+"(".concat(e,") is not compatible with the number of output ")+"channels (".concat(b.outChannels,")."));else if(3===e.length)try{r8(e,b.outShape)}catch(t){throw Error("Error in fused conv2d: PReLU activation weights (".concat(e,") ")+"is not compatible with the output shape of the conv2d "+"(".concat(b.outShape,")."))}n=aV(d,"prelu weights","fused conv2d")}let v=(e,t)=>{L("NHWC"===o,()=>"Error in gradient of fused conv2D: got dataFormat of ".concat(o," but only NHWC is currently supported."));let[n,a,r,c]=t,u=sY(e,r,h);L(iv(l),()=>"Error in gradient of fused conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(l,"'"));let d=[ij(a.shape,u,n,i,s),iP(a,u,n.shape,i,s)];if(null!=c){let e=sZ(c,u);d.push(e)}return d},w={x:g,filter:m,bias:t,preluActivationWeights:n},N={strides:i,pad:s,dataFormat:o,dilations:l,dimRoundingMode:c,activation:h,leakyreluAlpha:p};return null==u?rW((e,t,n)=>{let a=aR.runKernel(nJ,w,N);return n([t,e,a]),x&&(a=io(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:v}})(g,m):rW((e,t,n,a)=>{let r=aR.runKernel(nJ,w,N);return a([t,e,r,n]),x&&(r=io(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:v}})(g,m,t)}}),cZ=aG({fusedDepthwiseConv2d_:function(e){let t,n,{x:a,filter:r,strides:i,pad:s,dataFormat:o="NHWC",dilations:l=[1,1],dimRoundingMode:c,bias:u,activation:h="linear",preluActivationWeights:d,leakyreluAlpha:p}=e;if(!1===sJ(aR.state.gradientDepth,h)){let e=lo(a,r,i,s,o,l,c);return null!=u&&(e=rP(e,u)),sQ(e,h,d,p)}let f=aV(a,"x","depthwiseConv2d","float32"),m=aV(r,"filter","depthwiseConv2d","float32"),g=f,x=!1;3===f.rank&&(x=!0,g=io(f,[1,f.shape[0],f.shape[1],f.shape[2]])),L(4===g.rank,()=>"Error in fused depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(g.rank,".")),L(4===m.rank,()=>"Error in fused depthwiseConv2d: filter must be rank 4, "+"but got rank ".concat(m.rank,".")),L(g.shape[3]===m.shape[2],()=>"Error in fused depthwiseConv2d: number of input channels "+"(".concat(g.shape[3],") must match the inChannels dimension in ")+"filter ".concat(m.shape[2],".")),null==l&&(l=[1,1]),L(iw(i,l),()=>"Error in fused depthwiseConv2d: Either strides or dilations must "+"be 1. Got strides ".concat(i," and dilations '").concat(l,"'")),iS("fused depthwiseConv2d",s,c);let y=id(g.shape,m.shape,i,l,s,c,!0);null!=u&&(t=aV(u,"bias","fused conv2d"),[t]=ak(t,f),r8(y.outShape,t.shape)),null!=d&&(n=aV(d,"prelu weights","fused depthwiseConv2d"));let b=(e,n)=>{L(iv(l),()=>"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(l,"'"));let[a,r,o,u]=n,d=sY(e,o,h),p=i2(r.shape,d,a,i,s,l,c),f=i1(r,d,a.shape,i,s,l,c);return null!=u?[p,f,sZ(t,d)]:[p,f]},v={x:g,filter:m,bias:t,preluActivationWeights:n},w={strides:i,pad:s,dataFormat:o,dilations:l,dimRoundingMode:c,activation:h,leakyreluAlpha:p};return null==u?rW((e,t,n)=>{let a=aR.runKernel(n$,v,w);return n([t,e,a]),x&&(a=io(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:b}})(g,m):rW((e,t,n,a)=>{let r=aR.runKernel(n$,v,w);return a([t,e,r,n]),x&&(r=io(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:b}})(g,m,t)}}),cQ=aG({fusedMatMul_:function(e){let t,n,{a,b:r,transposeA:i=!1,transposeB:s=!1,bias:o,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u=.2}=e;if(!1===sJ(aR.state.gradientDepth,l)){let e=iI(a,r,i,s);return null!=o&&(e=rP(e,o)),sQ(e,l,c,u)}let h=aV(a,"a","fused matMul"),d=aV(r,"b","fused matMul");[h,d]=ak(h,d);let p=i?h.shape[h.rank-2]:h.shape[h.rank-1],f=s?d.shape[d.rank-1]:d.shape[d.rank-2],m=i?h.shape[h.rank-1]:h.shape[h.rank-2],g=s?d.shape[d.rank-2]:d.shape[d.rank-1],x=h.shape.slice(0,-2),y=d.shape.slice(0,-2),b=V(x),v=V(y);L(p===f,()=>"Error in fused matMul: inner shapes (".concat(p,") and (")+"".concat(f,") of Tensors with shapes ").concat(h.shape," and ")+"".concat(d.shape," and transposeA=").concat(i)+" and transposeB=".concat(s," must match."));let w=r8(h.shape.slice(0,-2),d.shape.slice(0,-2)).concat([m,g]),N=i?io(h,[b,p,m]):io(h,[b,m,p]),k=s?io(d,[v,g,f]):io(d,[v,f,g]);null!=o&&(t=aV(o,"bias","fused matMul"),[t]=ak(t,h),r8(w,t.shape)),null!=c&&(n=aV(c,"prelu weights","fused matMul"));let S=(e,t)=>{let n,a,[r,c,u,h]=t,d=sY(io(e,u.shape),u,l);return(i||s?!i&&s?(n=iI(d,c,!1,!1),a=iI(d,r,!0,!1)):i&&!s?(n=iI(c,d,!1,!0),a=iI(r,d,!1,!1)):(n=iI(c,d,!0,!0),a=iI(d,r,!0,!0)):(n=iI(d,c,!1,!0),a=iI(r,d,!0,!1)),null!=o)?[n,a,sZ(h,d)]:[n,a]},C={a:N,b:k,bias:t,preluActivationWeights:n},T={transposeA:i,transposeB:s,activation:l,leakyreluAlpha:u};return null==o?rW((e,t,n)=>{let a=aR.runKernel(nQ,C,T);return n([e,t,a]),{value:io(a,w),gradFunc:S}})(N,k):rW((e,t,n,a)=>{let r=aR.runKernel(nQ,C,T);return a([e,t,r,n]),{value:io(r,w),gradFunc:S}})(N,k,t)}});e.i(29746);var cJ=e.i(85474);function c$(e,t){B(e);let n=az(e,t);if(1!==n.length)throw Error("tensor1d() requires values to be a flat/TypedArray");return aq(e,null,n,t)}function c0(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function c1(e,t,n){let a=1-e%2,r=new Float32Array(e);for(let i=0;i<e;++i){let s=2*Math.PI*i/(e+a-1);r[i]=t-n*Math.cos(s)}return c$(r,"float32")}e.s(["cosineWindow",()=>c1,"enclosingPowerOfTwo",()=>c0],96851);let c2=aG({hammingWindow_:function(e){return c1(e,.54,.46)}}),c3=aG({hannWindow_:function(e){return c1(e,.5,.5)}});function c4(e,t,n){if(B(e),null!=t&&2!==t.length)throw Error("tensor2d() requires shape to have two numbers");let a=az(e,n);if(2!==a.length&&1!==a.length)throw Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===a.length&&null==t)throw Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return aq(e,t,a,n)}let c5=aG({frame_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=0,s=[];for(;i+t<=e.size;)s.push(su(e,i,t)),i+=n;if(a)for(;i<e.size;){let a=i+t-e.size,o=oY([su(e,i,t-a),r$([a],r)]);s.push(o),i+=n}return 0===s.length?c4([],[0,t]):io(oY(s),[s.length,t])}}),c6=aG({stft_:function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:c3;return null==a&&(a=c0(t)),lG(rz(c5(e,t,n),r(t)),a)}}),c8=aG({cropAndResize_:function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bilinear",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=aV(e,"image","cropAndResize"),o=aV(t,"boxes","cropAndResize","float32"),l=aV(n,"boxInd","cropAndResize","int32"),c=o.shape[0];return L(4===s.rank,()=>"Error in cropAndResize: image must be rank 4,"+"but got rank ".concat(s.rank,".")),L(2===o.rank&&4===o.shape[1],()=>"Error in cropAndResize: boxes must be have size [".concat(c,",4] ")+"but had shape ".concat(o.shape,".")),L(1===l.rank&&l.shape[0]===c,()=>"Error in cropAndResize: boxInd must be have size [".concat(c,"] ")+"but had shape ".concat(o.shape,".")),L(2===a.length,()=>"Error in cropAndResize: cropSize must be of length 2, but got "+"length ".concat(a.length,".")),L(a[0]>=1&&a[1]>=1,()=>"cropSize must be atleast [1,1], but was ".concat(a)),L("bilinear"===r||"nearest"===r,()=>"method must be bilinear or nearest, but was ".concat(r)),aR.runKernel(e7,{image:s,boxes:o,boxInd:l},{method:r,extrapolationValue:i,cropSize:a})}}),c9=aG({flipLeftRight_:function(e){let t=aV(e,"image","flipLeftRight","float32");return L(4===t.rank,()=>"Error in flipLeftRight: image must be rank 4,"+"but got rank ".concat(t.rank,".")),aR.runKernel(tx,{image:t},{})}}),c7=aG({grayscaleToRGB_:function(e){let t=aV(e,"image","grayscaleToRGB"),n=t.rank-1,a=t.shape[n];L(t.rank>=2,()=>"Error in grayscaleToRGB: images must be at least rank 2, "+"but got rank ".concat(t.rank,".")),L(1===a,()=>"Error in grayscaleToRGB: last dimension of a grayscale image "+"should be size 1, but got size ".concat(a,"."));let r=Array(t.rank);return r.fill(1,0,n),r[n]=3,i5(t,r)}}),ue=aG({einsum_:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];let r=n.map((e,t)=>aV(e,"tensors".concat(t),"einsum"));return aR.runKernel(th,r,{equation:e})}}),ut=aG({rgbToGrayscale_:function(e){let t,n=aV(e,"image","RGBToGrayscale"),a=n.rank-1,r=n.shape[a];L(n.rank>=2,()=>"Error in RGBToGrayscale: images must be at least rank 2, "+"but got rank ".concat(n.rank,".")),L(3===r,()=>"Error in RGBToGrayscale: last dimension of an RGB image "+"should be size 3, but got size ".concat(r,"."));let i=n.dtype,s=rM(n,"float32"),o=c$([.2989,.587,.114]);switch(n.rank){case 2:t=ue("ij,j->i",s,o);break;case 3:t=ue("ijk,k->ij",s,o);break;case 4:t=ue("ijkl,l->ijk",s,o);break;case 5:t=ue("ijklm,m->ijkl",s,o);break;case 6:t=ue("ijklmn,n->ijklm",s,o);break;default:throw Error("Not a valid tensor rank.")}return rM(t=oQ(t,-1),i)}}),un=aG({rotateWithOffset_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=aV(e,"image","rotateWithOffset","float32");return L(4===r.rank,()=>"Error in rotateWithOffset: image must be rank 4,"+"but got rank ".concat(r.rank,".")),aR.runKernel(nZ,{image:r},{radians:t,fillValue:n,center:a})}});function ua(e,t,n,a,r,i){null==a&&(a=.5),null==r&&(r=-1/0),null==i&&(i=0);let s=e.shape[0];return n=Math.min(n,s),L(0<=a&&a<=1,()=>"iouThreshold must be in [0, 1], but was '".concat(a,"'")),L(2===e.rank,()=>"boxes must be a 2D tensor, but was of rank '".concat(e.rank,"'")),L(4===e.shape[1],()=>"boxes must have 4 columns, but 2nd dimension was ".concat(e.shape[1])),L(1===t.rank,()=>"scores must be a 1D tensor"),L(t.shape[0]===s,()=>"scores has incompatible shape with boxes. Expected ".concat(s,", ")+"but was ".concat(t.shape[0])),L(0<=i&&i<=1,()=>"softNmsSigma must be in [0, 1], but was '".concat(i,"'")),{maxOutputSize:n,iouThreshold:a,scoreThreshold:r,softNmsSigma:i}}let ur=aG({nonMaxSuppression_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1/0,i=aV(e,"boxes","nonMaxSuppression","float32"),s=aV(t,"scores","nonMaxSuppression","float32"),o=ua(i,s,n,a,r);n=o.maxOutputSize;let l={maxOutputSize:n,iouThreshold:a=o.iouThreshold,scoreThreshold:r=o.scoreThreshold};return aR.runKernel(tJ,{boxes:i,scores:s},l)}});function ui(e,t){return e>t?1:e<t?-1:0}function us(e,t,n,a,r){return uc(e,t,n,a,r,0)}function uo(e,t,n,a,r,i){return uc(e,t,n,a,r,0,!1,i,!0)}function ul(e,t,n,a,r,i){return uc(e,t,n,a,r,i,!0)}function uc(e,t,n,a,r,i){let s=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8&&void 0!==arguments[8]&&arguments[8],c=[];for(let e=0;e<t.length;e++)t[e]>r&&c.push({score:t[e],boxIndex:e,suppressBeginIndex:0});c.sort(uu);let u=i>0?-.5/i:0,h=[],d=[];for(;h.length<n&&c.length>0;){let t=c.pop(),{score:n,boxIndex:i,suppressBeginIndex:s}=t;if(n<r)break;let o=!1;for(let n=h.length-1;n>=s;--n){let s=function(e,t,n){let a=e.subarray(4*t,4*t+4),r=e.subarray(4*n,4*n+4),i=Math.min(a[0],a[2]),s=Math.min(a[1],a[3]),o=Math.max(a[0],a[2]),l=Math.max(a[1],a[3]),c=Math.min(r[0],r[2]),u=Math.min(r[1],r[3]),h=Math.max(r[0],r[2]),d=Math.max(r[1],r[3]),p=(o-i)*(l-s),f=(h-c)*(d-u);if(p<=0||f<=0)return 0;let m=Math.max(Math.min(o,h)-Math.max(i,c),0)*Math.max(Math.min(l,d)-Math.max(s,u),0);return m/(p+f-m)}(e,i,h[n]);if(s>=a){o=!0;break}if(t.score=t.score*function(e,t,n){let a=Math.exp(t*n*n);return n<=e?a:0}(a,u,s),t.score<=r)break}t.suppressBeginIndex=h.length,!o&&(t.score===n?(h.push(i),d.push(t.score)):t.score>r&&function(e,t,n){let a=function(e,t,n){let a=0,r=e.length,i=0,s=!1;for(;a<r;){let o=n(t,e[i=a+(r-a>>>1)]);o>0?a=i+1:(r=i,s=!o)}return s?a:-a-1}(e,t,n||ui);e.splice(a<0?-(a+1):a,0,t)}(c,t,uu))}let p=h.length,f=n-p;o&&f>0&&(h.push(...Array(f).fill(0)),d.push(...Array(f).fill(0)));let m={selectedIndices:h};return s&&(m.selectedScores=d),l&&(m.validOutputs=p),m}function uu(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}async function uh(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1/0,i=aV(e,"boxes","nonMaxSuppressionAsync"),s=aV(t,"scores","nonMaxSuppressionAsync"),o=ua(i,s,n,a,r);n=o.maxOutputSize,a=o.iouThreshold,r=o.scoreThreshold;let l=await Promise.all([i.data(),s.data()]),{selectedIndices:c}=us(l[0],l[1],n,a,r);return i!==e&&i.dispose(),s!==t&&s.dispose(),c$(c,"int32")}let ud=aG({nonMaxSuppressionWithScore_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1/0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=aV(e,"boxes","nonMaxSuppression"),o=aV(t,"scores","nonMaxSuppression"),l=ua(s,o,n,a,r,i);n=l.maxOutputSize,a=l.iouThreshold,r=l.scoreThreshold;let c={maxOutputSize:n,iouThreshold:a,scoreThreshold:r,softNmsSigma:i=l.softNmsSigma},u=aR.runKernel(t0,{boxes:s,scores:o},c);return{selectedIndices:u[0],selectedScores:u[1]}}});async function up(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1/0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=aV(e,"boxes","nonMaxSuppressionAsync"),o=aV(t,"scores","nonMaxSuppressionAsync"),l=ua(s,o,n,a,r,i);n=l.maxOutputSize,a=l.iouThreshold,r=l.scoreThreshold,i=l.softNmsSigma;let c=await Promise.all([s.data(),o.data()]),{selectedIndices:u,selectedScores:h}=ul(c[0],c[1],n,a,r,i);return s!==e&&s.dispose(),o!==t&&o.dispose(),{selectedIndices:c$(u,"int32"),selectedScores:c$(h)}}let uf=aG({nonMaxSuppressionPadded_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1/0,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=aV(e,"boxes","nonMaxSuppression"),o=aV(t,"scores","nonMaxSuppression"),l=ua(s,o,n,a,r,null),c=l.maxOutputSize,u=l.iouThreshold,h=l.scoreThreshold,d=aR.runKernel(t$,{boxes:s,scores:o},{maxOutputSize:c,iouThreshold:u,scoreThreshold:h,padToMaxOutputSize:i});return{selectedIndices:d[0],validOutputs:d[1]}}});async function um(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1/0,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=aV(e,"boxes","nonMaxSuppressionAsync"),o=aV(t,"scores","nonMaxSuppressionAsync"),l=ua(s,o,n,a,r,null),c=l.maxOutputSize,u=l.iouThreshold,h=l.scoreThreshold,[d,p]=await Promise.all([s.data(),o.data()]),{selectedIndices:f,validOutputs:m}=uo(d,p,c,u,h,i);return s!==e&&s.dispose(),o!==t&&o.dispose(),{selectedIndices:c$(f,"int32"),validOutputs:rG(m,"int32")}}let ug=aG({bincount_:function(e,t,n){let a=aV(e,"x","bincount"),r=aV(t,"weights","bincount");return L("int32"===a.dtype,()=>"Error in bincount: input "+"dtype must be int32, but got ".concat(a.dtype)),L(n>=0,()=>"size must be non-negative, but got ".concat(n,".")),L(r.size===a.size||0===r.size,()=>"Error in bincount: weights must have the same size as input or"+"0-length, but got input shape: ".concat(a.shape,", weights shape: ")+"".concat(r.shape,".")),aR.runKernel(eH,{x:a,weights:r},{size:n})}});function ux(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";if(0===n)throw Error("Cannot have a step of zero");return aR.runKernel(ne,{},{start:e,stop:t,step:n,dtype:a})}let uy=aG({threshold_:function(e){let t,n,a,r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"binary",s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,l=aV(e,"image","threshold"),c=l.shape[0]*l.shape[1],u=rz(c$([o]),255);if(L(3===l.rank,()=>"Error in threshold: image must be rank 3,"+"but got rank ".concat(l.rank,".")),L(3===l.shape[2]||1===l.shape[2],()=>"Error in threshold: image color channel must be equal to 3 or 1"+"but got ".concat(l.shape[2],".")),L("int32"===l.dtype||"float32"===l.dtype,()=>"Error in dtype: image dtype must be int32 or float32,"+"but got dtype ".concat(l.dtype,".")),L("otsu"===i||"binary"===i,()=>"Method must be binary or otsu, but was ".concat(i)),3===l.shape[2]){[t,n,a]=iO(l,[1,1,1],-1);let e=rz(t,.2989),i=rz(n,.587),s=rz(a,.114);r=rP(rP(e,i),s)}else r=e;return"otsu"===i&&(u=function(e,t){let n,a,r,i,s,o,l=c$([-1]),c=c$([0]),u=c$([0]);for(let h=0;h<e.size-1;h++){n=su(e,0,h+1),a=su(e,h+1),s=rL(il(n),t),o=rL(il(a),t),r=rL(il(rz(n,ux(0,n.size))),il(n));let d=r$(a.shape,n.size),p=rP(ux(0,a.size),d),f=r2(r,i=rL(il(rz(a,p)),il(a))),m=r2(r,i),g=rz(s,o),x=se(u=rz(rz(g,f),m),c);c=iM(x,u,c),l=iM(x,c$([h]),l)}return l}(ug(rM(lH(r),"int32"),aK([]),256),c)),rM(rz(s?iA(r,u):se(r,u),255),"int32")}}),ub=aG({transform_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"nearest",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"constant",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5?arguments[5]:void 0,s=aV(e,"image","transform","float32"),o=aV(t,"transforms","transform","float32");return L(4===s.rank,()=>"Error in transform: image must be rank 4,"+"but got rank ".concat(s.rank,".")),L(2===o.rank&&(o.shape[0]===s.shape[0]||1===o.shape[0])&&8===o.shape[1],()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),L(null==i||2===i.length,()=>"Error in transform: outputShape must be [height, width] or null, "+"but got ".concat(i,".")),aR.runKernel(nU,{image:s,transforms:o},{interpolation:n,fillMode:a,fillValue:r,outputShape:i})}}),uv=aG({bandPart_:function(e,t,n){let a,r,i=aV(e,"a","bandPart");L(i.rank>=2,()=>"bandPart(): Rank must be at least 2, got ".concat(i.rank,"."));let s=i.shape,[o,l]=i.shape.slice(-2);"number"==typeof t?(L(t%1==0,()=>"bandPart(): numLower must be an integer, got ".concat(t,".")),L(t<=o,()=>"bandPart(): numLower (".concat(t,")")+" must not be greater than the number of rows (".concat(o,").")),a=aV(t<0?o:t,"numLower","bandPart")):(L("int32"===t.dtype,()=>"bandPart(): numLower's dtype must be an int32."),a=iM(si(t,0),o,lM(t,o))),"number"==typeof n?(L(n%1==0,()=>"bandPart(): numUpper must be an integer, got ".concat(n,".")),L(n<=l,()=>"bandPart(): numUpper (".concat(n,")")+" must not be greater than the number of columns (".concat(l,").")),r=aV(n<0?l:n,"numUpper","bandPart")):(L("int32"===n.dtype,()=>"bandPart(): numUpper's dtype must be an int32."),r=iM(si(n,0),l,lM(n,l)));let c=r2(io(ux(0,o,1,"int32"),[-1,1]),ux(0,l,1,"int32")),u=iR(iA(c,a),i_(c,is(r))),h=sl([o,l],i.dtype);return io(i6(sd(io(i,[-1,o,l])).map(e=>iM(u,e,h))),s)}}),uw=aG({gramSchmidt_:function(e){let t;if(Array.isArray(e)){t=!1,L(null!=e&&e.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");let n=e[0].shape[0];for(let t=1;t<e.length;++t)L(e[t].shape[0]===n,()=>"Gram-Schmidt: Non-unique lengths found in the input vectors: "+"(".concat(e[t].shape[0]," vs. ").concat(n,")"))}else t=!0,e=iO(e,e.shape[0],0).map(e=>lQ(e,[0]));L(e.length<=e[0].shape[0],()=>"Gram-Schmidt: Number of vectors (".concat(e.length,") exceeds ")+"number of dimensions (".concat(e[0].shape[0],")."));let n=[],a=e;for(let t=0;t<e.length;++t)n.push(aR.tidy(()=>{let e=a[t];if(t>0)for(let a=0;a<t;++a){let t=rz(il(rz(n[a],e)),n[a]);e=r2(e,t)}return rL(e,lf(e,"euclidean"))}));return t?i6(n,0):n}});function uN(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return aR.tidy(()=>{L(2===e.shape.length,()=>"qr2d() requires a 2D Tensor, but got a ".concat(e.shape.length,"D Tensor."));let n=e.shape[0],a=e.shape[1],r=cX(n),i=rF(e),s=c4([[1]],[1,1]),o=rF(s),l=n>=a?a:n;for(let e=0;e<l;++e){let t=i,l=o,c=r;[o,i,r]=aR.tidy(()=>{let t=su(i,[e,e],[n-e,1]),l=lf(t),c=su(i,[e,e],[1,1]),u=iM(se(c,0),c4([[-1]]),c4([[1]])),h=r2(c,rz(u,l)),d=rL(t,h);o=1===d.shape[0]?rF(s):oY([s,su(d,[1,0],[d.shape[0]-1,d.shape[1]])],0);let p=is(rL(iI(u,h),l)),f=su(i,[e,0],[n-e,a]),m=rz(p,o),g=i0(o);if(0===e)i=r2(f,iI(m,iI(g,f)));else{let t=r2(f,iI(m,iI(g,f)));i=oY([su(i,[0,0],[e,a]),t],0)}let x=i0(m),y=su(r,[0,e],[n,r.shape[1]-e]);if(0===e)r=r2(y,iI(iI(y,o),x));else{let t=r2(y,iI(iI(y,o),x));r=oY([su(r,[0,0],[n,e]),t],1)}return[o,i,r]}),aJ([t,l,c])}return!t&&n>a&&(r=su(r,[0,0],[n,a]),i=su(i,[0,0],[a,a])),[r,i]})}let uk=aG({qr_:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(L(e.rank>=2,()=>"qr() requires input tensor to have a rank >= 2, but got rank ".concat(e.rank)),2===e.rank)return uN(e,t);{let n=e.shape.slice(0,e.shape.length-2).reduce((e,t)=>e*t),a=sd(io(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),r=[],i=[];return a.forEach(e=>{let[n,a]=uN(e,t);r.push(n),i.push(a)}),[io(i6(r,0),e.shape),io(i6(i,0),e.shape)]}}});!function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(m||(m={}));let uS=aG({computeWeightedLoss_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:m.SUM_BY_NONZERO_WEIGHTS,a=aV(e,"losses","computeWeightedLoss"),r=null;null!=t&&(r=aV(t,"weights","computeWeightedLoss"));let i=null==r?a:rz(a,r);if(n===m.NONE)return i;if(n===m.SUM)return il(i);if(n===m.MEAN)if(null==r)return lD(i);else{let e=a.size/r.size,t=rL(il(i),il(r));return e>1?rL(t,rG(e)):t}if(n===m.SUM_BY_NONZERO_WEIGHTS)if(null==r)return rL(il(i),rG(a.size));else{let e=rM(il(lP(rz(r,sc(a.shape)),rG(0))),"float32");return rL(il(i),e)}throw Error("Unknown reduction: ".concat(n))}}),uC=aG({absoluteDifference_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:m.SUM_BY_NONZERO_WEIGHTS,r=aV(e,"labels","absoluteDifference"),i=aV(t,"predictions","absoluteDifference"),s=null;return null!=n&&(s=aV(n,"weights","absoluteDifference")),z(r.shape,i.shape,"Error in absoluteDifference: "),uS(r4(r2(r,i)),s,a)}}),uT=aG({cosineDistance_:function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:m.SUM_BY_NONZERO_WEIGHTS,i=aV(e,"labels","cosineDistance"),s=aV(t,"predictions","cosineDistance"),o=null;return null!=a&&(o=aV(a,"weights","cosineDistance")),z(i.shape,s.shape,"Error in cosineDistance: "),uS(r2(rG(1),il(rz(i,s),n,!0)),o,r)}}),uI=aG({hingeLoss_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:m.SUM_BY_NONZERO_WEIGHTS,r=aV(e,"labels","hingeLoss"),i=aV(t,"predictions","hingeLoss"),s=null;null!=n&&(s=aV(n,"weights","hingeLoss")),z(r.shape,i.shape,"Error in hingeLoss: ");let o=rG(1);return r=r2(rz(rG(2),r),o),uS(sq(r2(o,rz(r,i))),s,a)}}),uE=aG({huberLoss_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:m.SUM_BY_NONZERO_WEIGHTS,i=aV(e,"labels","huberLoss"),s=aV(t,"predictions","huberLoss"),o=null;null!=n&&(o=aV(n,"weights","huberLoss")),z(i.shape,s.shape,"Error in huberLoss: ");let l=rG(a),c=r4(r2(s,i)),u=lM(c,l),h=r2(c,u);return uS(rP(rz(rG(.5),rV(u)),rz(l,h)),o,r)}}),u_=aG({logLoss_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-7,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:m.SUM_BY_NONZERO_WEIGHTS,i=aV(e,"labels","logLoss"),s=aV(t,"predictions","logLoss"),o=null;null!=n&&(o=aV(n,"weights","logLoss")),z(i.shape,s.shape,"Error in logLoss: ");let l=rG(1),c=rG(a),u=is(rz(i,sf(rP(s,c)))),h=rz(r2(l,i),sf(rP(r2(l,s),c)));return uS(r2(u,h),o,r)}}),uA=aG({meanSquaredError_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:m.SUM_BY_NONZERO_WEIGHTS,r=aV(e,"labels","meanSquaredError"),i=aV(t,"predictions","meanSquaredError"),s=null;return null!=n&&(s=aV(n,"weights","meanSquaredError")),z(r.shape,i.shape,"Error in meanSquaredError: "),uS(lZ(r,i),s,a)}}),uR=aG({sigmoidCrossEntropy_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:m.SUM_BY_NONZERO_WEIGHTS,i=aV(e,"multiClassLabels","sigmoidCrossEntropy"),s=aV(t,"logits","sigmoidCrossEntropy"),o=null;if(null!=n&&(o=aV(n,"weights","sigmoidCrossEntropy")),z(i.shape,s.shape,"Error in sigmoidCrossEntropy: "),a>0){let e=rG(a),t=rG(1),n=rG(.5);i=rP(rz(i,r2(t,e)),rz(n,e))}return uS(function(e,t){let n=aV(e,"labels","sigmoidCrossEntropyWithLogits"),a=aV(t,"logits","sigmoidCrossEntropyWithLogits");z(n.shape,a.shape,"Error in sigmoidCrossEntropyWithLogits: ");let r=sq(a),i=rz(a,n),s=lE(i3(is(r4(a))));return rP(r2(r,i),s)}(i,s),o,r)}}),uD=aG({softmaxCrossEntropy_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:m.SUM_BY_NONZERO_WEIGHTS,i=aV(e,"onehotLabels","softmaxCrossEntropy"),s=aV(t,"logits","softmaxCrossEntropy"),o=null;if(null!=n&&(o=aV(n,"weights","softmaxCrossEntropy")),z(i.shape,s.shape,"Error in softmaxCrossEntropy: "),a>0){let e=rG(a),t=rG(1),n=rG(i.shape[1]);i=rP(rz(i,r2(t,e)),rL(e,n))}return uS(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet "+"supported. Labels / logits was rank ".concat(t.rank," ")+"and dim was ".concat(n));return rW((e,t,a)=>{let r=lI(t,[n],!0),i=r2(rM(t,"float32"),r);return a([e,i]),{value:il(is(rz(i,e)),[n]),gradFunc:(e,t)=>{let[a,r]=t,i=iq(e.shape,[n]);return[rz(io(e,i),r2(rM(a,"float32"),i3(r))),rz(io(e,i),r2(i3(r),rM(a,"float32")))]}}})(e,t)}(i,s),o,r)}}),uM=aG({sparseFillEmptyRows_:function(e,t,n,a){let r=aV(e,"indices","sparseFillEmptyRows","int32"),i=aV(t,"values","sparseFillEmptyRows"),s=aV(n,"denseShape","sparseFillEmptyRows","int32"),o=aV(a,"defaultValue","sparseFillEmptyRows",i.dtype);if(2!==r.rank)throw Error("Indices should be Tensor2D but received shape\n        ".concat(r.shape));if(1!==i.rank)throw Error("Values should be Tensor1D but received shape ".concat(i.shape));if(1!==s.rank)throw Error("Dense shape should be Tensor1D but received shape ".concat(s.shape));if(0!==o.rank)throw Error("Default value should be a scalar but received shape ".concat(o.shape));let l=aR.runKernel(nI,{indices:r,values:i,denseShape:s,defaultValue:o});return{outputIndices:l[0],outputValues:l[1],emptyRowIndicator:l[2],reverseIndexMap:l[3]}}}),uF=aG({sparseReshape_:function(e,t,n){let a=aV(e,"inputIndices","sparseReshape","int32"),r=aV(t,"inputShape","sparseReshape","int32"),i=aV(n,"newShape","sparseReshape","int32");if(2!==a.rank)throw Error("Input indices should be Tensor2D but received shape\n        ".concat(a.shape));if(1!==r.rank)throw Error("Input shape should be Tensor1D but received shape ".concat(r.shape));if(1!==i.rank)throw Error("New shape should be Tensor1D but received shape ".concat(i.shape));let s=aR.runKernel(nE,{inputIndices:a,inputShape:r,newShape:i});return{outputIndices:s[0],outputShape:s[1]}}}),uO=aG({sparseSegmentMean_:function(e,t,n){let a=aV(e,"data","sparseSegmentMean"),r=aV(t,"indices","sparseSegmentMean","int32"),i=aV(n,"segmentIds","sparseSegmentMean","int32");if(a.rank<1)throw Error("Data should be at least 1 dimensional but received scalar");if(1!==r.rank)throw Error("Indices should be Tensor1D but received shape\n          ".concat(r.shape));if(1!==i.rank)throw Error("Segment ids should be Tensor1D but received shape\n          ".concat(i.shape));return aR.runKernel(n_,{data:a,indices:r,segmentIds:i})}}),uP=aG({sparseSegmentSum_:function(e,t,n){let a=aV(e,"data","sparseSegmentSum"),r=aV(t,"indices","sparseSegmentSum","int32"),i=aV(n,"segmentIds","sparseSegmentSum","int32");if(a.rank<1)throw Error("Data should be at least 1 dimensional but received scalar");if(1!==r.rank)throw Error("Indices should be Tensor1D but received shape\n         ".concat(r.shape));if(1!==i.rank)throw Error("Segment ids should be Tensor1D but received shape\n         ".concat(i.shape));return aR.runKernel(nA,{data:a,indices:r,segmentIds:i})}}),uj=aG({stringNGrams_:function(e,t,n,a,r,i,s,o){let l=aV(e,"data","stringNGrams","string");if("string"!==l.dtype)throw Error("Data must be of datatype string");if(1!==l.shape.length)throw Error("Data must be a vector, saw: ".concat(l.shape));let c=aV(t,"dataSplits","stringNGrams");if("int32"!==c.dtype)throw Error("Data splits must be of datatype int32");let u=aR.runKernel(nP,{data:l,dataSplits:c},{separator:n,nGramWidths:a,leftPad:r,rightPad:i,padWidth:s,preserveShortSequences:o});return{nGrams:u[0],nGramsSplits:u[1]}}}),uL=aG({stringSplit_:function(e,t){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],a=aV(e,"input","stringSplit","string"),r=aV(t,"delimiter","stringSplit","string");if(1!==a.rank)throw Error("Input should be Tensor1D but received shape ".concat(a.shape));if(0!==r.rank)throw Error("Delimiter should be a scalar but received shape ".concat(r.shape));let i=aR.runKernel(nj,{input:a,delimiter:r},{skipEmpty:n});return{indices:i[0],values:i[1],shape:i[2]}}}),uz=aG({stringToHashBucketFast_:function(e,t){let n=aV(e,"input","stringToHashBucketFast","string");if(t<=0)throw Error("Number of buckets must be at least 1");return aR.runKernel(nL,{input:n},{numBuckets:t})}}),uB=aG({staticRegexReplace_:function(e,t,n){let a=!(arguments.length>3)||void 0===arguments[3]||arguments[3],r=aV(e,"input","staticRegexReplace","string");return aR.runKernel(nF,{x:r},{pattern:t,rewrite:n,replaceGlobal:a})}}),uV={fft:lx,ifft:ly,rfft:lG,irfft:lb},uU={hammingWindow:c2,hannWindow:c3,frame:c5,stft:c6},uW={flipLeftRight:c9,grayscaleToRGB:c7,resizeNearestNeighbor:lW,resizeBilinear:lU,rgbToGrayscale:ut,rotateWithOffset:un,cropAndResize:c8,nonMaxSuppression:ur,nonMaxSuppressionAsync:uh,nonMaxSuppressionWithScore:ud,nonMaxSuppressionWithScoreAsync:up,nonMaxSuppressionPadded:uf,nonMaxSuppressionPaddedAsync:um,threshold:uy,transform:ub},uG={bandPart:uv,gramSchmidt:uw,qr:uk},uH={absoluteDifference:uC,computeWeightedLoss:uS,cosineDistance:uT,hingeLoss:uI,huberLoss:uE,logLoss:u_,meanSquaredError:uA,sigmoidCrossEntropy:uR,softmaxCrossEntropy:uD},uq={sparseFillEmptyRows:uM,sparseReshape:uF,sparseSegmentMean:uO,sparseSegmentSum:uP},uK={stringNGrams:uj,stringSplit:uL,stringToHashBucketFast:uz,staticRegexReplace:uB};var uX=e.i(89378);class uY{nextValue(){let e,t;if(!isNaN(this.nextVal)){let e=this.nextVal;return this.nextVal=NaN,e}let n=!1;for(;!n;){let a,r,i;do i=(a=2*this.random()-1)*a+(r=2*this.random()-1)*r;while(i>=1||0===i)let s=Math.sqrt(-2*Math.log(i)/i);e=this.mean+this.stdDev*a*s,t=this.mean+this.stdDev*r*s,(!this.truncated||this.isValidTruncated(e))&&(n=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}constructor(e,t,n,a,r){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);let i=r||Math.random();this.random=uX.alea(i.toString())}}class uZ{nextValue(){let e,t,n,a,r,i;for(;;){do a=this.randn.nextValue(),i=1+this.c*a;while(i<=0)if(i*=i*i,t=1-.331*(e=a*a)*e,n=.5*e+this.d*(1-i+Math.log(i)),(r=this.randu())<t||Math.log(r)<n)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}convertValue(e){return"float32"===this.dtype?e:Math.round(e)}constructor(e,t,n,a){this.alpha=e,this.beta=1/t,this.dtype=n;let r=a||Math.random();this.randu=uX.alea(r.toString()),this.randn=new uY(0,1,n,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}}class uQ{convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}constructor(e=0,t=1,n,a){if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=e,this.range=t-e,this.dtype=n,null==a&&(a=Math.random()),"number"==typeof a&&(a=a.toString()),!this.canReturnFloat()&&this.range<=1)throw Error("The difference between ".concat(e," - ").concat(t," <= 1 and dtype is not float"));this.random=uX.alea(a)}}let uJ=aG({randomUniform_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",r=arguments.length>4?arguments[4]:void 0;eb(e);let i=rD(e,a),s=new uQ(t,n,null,r);for(let e=0;e<i.values.length;e++)i.values[e]=s.nextValue();return i.toTensor()}});var c_=c_;let u$=aG({truncatedNormal_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;if(eb(e),null!=a&&"bool"===a)throw Error("Unsupported data type $ { dtype }");let i=new uY(t,n,a,!0,r),s=rD(e,a);for(let e=0;e<s.values.length;e++)s.values[e]=i.nextValue();return s.toTensor()}});var cs=cs;let u0=aG({slice1d_:function(e,t,n){let a=aV(e,"x","slice1d");return L(1===a.rank,()=>"slice1d expects a rank-1 tensor, but got a rank-".concat(a.rank," tensor")),su(a,[t],[n])}}),u1=aG({slice2d_:function(e,t,n){let a=aV(e,"x","slice2d");return L(2===a.rank,()=>"slice2d expects a rank-2 tensor, but got a rank-".concat(a.rank," tensor")),su(a,t,n)}}),u2=aG({slice3d_:function(e,t,n){let a=aV(e,"x","slice3d");return L(3===a.rank,()=>"slice3d expects a rank-3 tensor, but got a rank-".concat(a.rank," tensor")),su(a,t,n)}}),u3=aG({slice4d_:function(e,t,n){let a=aV(e,"x","slice4d");return L(4===a.rank,()=>"slice4d expects a rank-4 tensor, but got a rank-".concat(a.rank," tensor")),su(a,t,n)}}),u4=aG({concat1d_:function(e){return oY(e,0)}}),u5=aG({concat2d_:function(e,t){return oY(e,t)}}),u6=aG({concat3d_:function(e,t){return oY(e,t)}}),u8=aG({concat4d_:function(e,t){return oY(e,t)}}),u9=aG({randomNormal_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;if(eb(e),null!=a&&"bool"===a)throw Error("Unsupported data type ".concat(a));let i=new uY(t,n,a,!1,r),s=rD(e,a);for(let e=0;e<s.values.length;e++)s.values[e]=i.nextValue();return s.toTensor()}});var u7=cJ;e.s(["dropout",()=>he],16738);let he=aG({dropout_:function(e,t,n,a){let r=aV(e,"x","dropout");if(L("float32"===r.dtype,()=>"x has to be a floating point tensor since it's going to be "+"scaled, but got a ".concat(r.dtype," tensor instead.")),L(t>=0&&t<1,()=>"rate must be a float in the range [0, 1), but got ".concat(t,".")),0===t)return e instanceof am?r.clone():r;let i=function(e,t){if(null==t)return e.shape.slice();if(G(e.shape,t))return t;if(e.shape.length===t.length){let n=[];for(let a=0;a<e.shape.length;a++)null==t[a]&&null!=e.shape[a]?n.push(e.shape[a]):n.push(t[a]);return n}return t}(r,n),s=1-t;return rz(r,rL(sh(rP(uJ(i,0,1,"float32",a),s)),s))}});function ht(e,t,n){null==t&&(t=0),null==n&&(n=e.length);let a=1;for(let r=t;r<n;++r)a*=e[r];return a}function hn(e){if(0===e.length)return NaN;let t=1/0;for(let n=0;n<e.length;n++){let a=e[n];a<t&&(t=a)}return t}function ha(e){if(0===e.length)return NaN;let t=-1/0;for(let n=0;n<e.length;n++){let a=e[n];a>t&&(t=a)}return t}function hr(e,t){if(t<e)throw new cc("end (".concat(t,") < begin (").concat(e,") is forbidden."));let n=[];for(let a=e;a<t;++a)n.push(a);return n}function hi(){return null==r&&(r=aR.backend.epsilon()),r}function hs(){return"channelsLast"}function ho(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),io(e,n)}function hl(e,t,n){return aQ(()=>{switch(e.rank){case 1:return u0(e,t,n);case 2:return u1(e,[t,0],[n,e.shape[1]]);case 3:return u2(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return u3(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return su(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return su(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new cc("sliceAlongFirstAxis() received an unsupported tensor rank: "+"".concat(e.rank))}})}function hc(e,t,n){return aQ(()=>{switch(e.rank){case 1:return u0(e,t,n);case 2:return u1(e,[0,t],[e.shape[0],n]);case 3:return u2(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return u3(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new cc("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(e.rank))}})}function hu(e,t,n,a){return aQ(()=>{switch(e.rank){case 1:return u0(e,t,n);case 2:switch(a){case 1:return hl(e,t,n);case 2:return hc(e,t,n);default:throw new cc("The axis is not within the rank of the tensor "+"".concat(a))}case 3:switch(a){case 1:return hl(e,t,n);case 2:return u2(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return hc(e,t,n);default:throw new cc("The axis is not within the rank of the tensor "+"".concat(a))}case 4:switch(a){case 1:return hl(e,t,n);case 2:return u3(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return u3(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return hc(e,t,n);default:throw new cc("The axis is not within the rank of the tensor "+"".concat(a))}default:throw new cc("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(e.rank))}})}function hh(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return n<0&&(n=0!==(t=e[0].rank)?t:0),n===e[0].rank&&(n=-1),oY(e,n)}function hd(e,t){switch(e.rank){case 1:return u4([e,t]);case 2:return u5([e,t],0);case 3:return u6([e,t],0);case 4:return u8([e,t],0);default:throw new cc("concatAlongFirstAxis() received an unsupported "+"tensor rank: ".concat(e.rank))}}function hp(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new cc("The length of input n (".concat(t.length,") does not match ")+"the number of dimensions in input x (".concat(e.rank,")"));return i5(e,t)}function hf(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;return u9(e,t,n,a,r)}function hm(e,t,n,a){if(e.rank<2||t.rank<2)throw new cu("dot requires both inputs to be rank >= 2"+" but got x shape = ".concat(e.shape," and y shape = ").concat(t.shape));if(t.rank>=3&&e.shape.slice(-1)[0]!==t.shape.slice(-2)[0])throw new cu("If rank y >= 3, then the second last dim"+" of y must equal the last dim of x but got x shape = ".concat(e.shape," and ")+" y shape = ".concat(t.shape));if(2===e.rank&&2===t.rank)return u7.matMul({a:e,b:t,transposeA:!1,transposeB:!1,bias:a?hx(e.rank,a,hs()):null,activation:n});{let r=e.shape.slice();e=io(e,[-1,r.pop()]);let i=t.shape.slice(),s=i.pop(),o=i.pop(),l=[...i,s],c=Array.from({length:t.rank},(e,n)=>0===n?t.rank-2:n<=t.rank-2?n-1:n);t=io(i0(t,c),[o,-1]);let u=[...r,...l];return io(u7.matMul({a:e,b:t,transposeA:!1,transposeB:!1,bias:a?hx(e.rank,a,hs()):null,activation:n}),u)}}function hg(e,t,n){return aQ(()=>oJ(e,t=Array.isArray(t)?c$(t,"int32"):rM(t,"int32"),n))}function hx(e,t,n){let a=t.shape;if(1!==t.rank&&t.rank!==e)throw new cc("Unexpected bias dimensions: ".concat(t.rank)+"; expected it to be 1 or ".concat(e));if(5===e){if("channelsFirst"===n)if(1===a.length)return io(t,[1,a[0],1,1,1]);else return io(t,[1,a[3],a[0],a[1],a[2]]);else if("channelsLast"===n)if(1===a.length)return io(t,[1,1,1,1,a[0]]);else return io(t,[1].concat(a))}else if(4===e){if("channelsFirst"===n)if(1===a.length)return io(t,[1,a[0],1,1]);else return io(t,[1,a[2],a[0],a[1]]);else if("channelsLast"===n)if(1===a.length)return io(t,[1,1,1,a[0]]);else return io(t,[1].concat(a))}else if(3===e){if("channelsFirst"===n)if(1===a.length)return io(t,[1,a[0],1]);else return io(t,[1,a[1],a[0]]);else if("channelsLast"===n)if(1===a.length)return io(t,[1,1,a[0]]);else return io(t,[1].concat(a))}else if(e<3)return t;throw new cc("Unsupported input rank by biasAdd: ".concat(t.rank))}function hy(e,t,n){return aQ(()=>(null==n&&(n=hs()),cz(n),rP(e,hx(e.rank,t,n))))}function hb(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n?e():t()}let hv=["fanIn","fanOut","fanAvg"],hw=["normal","uniform","truncatedNormal"];class hN extends c_.Serializable{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class hk extends hN{apply(e,t){return sl(e,t)}}hk.className="Zeros",c_.registerClass(hk);class hS extends hN{apply(e,t){return sc(e,t)}}hS.className="Ones",c_.registerClass(hS);class hC extends hN{apply(e,t){return aQ(()=>rz(rG(this.value),sc(e,t)))}getConfig(){return{value:this.value}}constructor(e){if(super(),"object"!=typeof e)throw new cc("Expected argument of type ConstantConfig but got ".concat(e));if(void 0===e.value)throw new cc("config must have value set but got ".concat(e));this.value=e.value}}hC.className="Constant",c_.registerClass(hC);class hT extends hN{apply(e,t){return uJ(e,this.minval,this.maxval,t,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}}hT.className="RandomUniform",c_.registerClass(hT);class hI extends hN{apply(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new cu("randomNormal does not support dType ".concat(t,"."));return hf(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}}hI.className="RandomNormal",c_.registerClass(hI);class hE extends hN{apply(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new cu("truncatedNormal does not support dType ".concat(t,"."));return u$(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}}hE.className="TruncatedNormal",c_.registerClass(hE);class h_ extends hN{apply(e,t){return aQ(()=>{if(2===e.length&&e[0]===e[1])return rz(this.gain,cX(e[0]));throw new cc("Identity matrix initializer can only be used for 2D square matrices.")})}getConfig(){return{gain:this.gain}}constructor(e){super(),this.gain=null!=e.gain?e.gain:1}}h_.className="Identity",c_.registerClass(h_);class hA extends hN{apply(e,t){let n=function(e){let t,n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"channelsLast";if(cz(a),2===e.length)t=e[0],n=e[1];else if(-1!==[3,4,5].indexOf(e.length)){if("channelsFirst"===a){let a=ht(e,2);t=e[1]*a,n=e[0]*a}else if("channelsLast"===a){let a=ht(e,0,e.length-2);t=e[e.length-2]*a,n=e[e.length-1]*a}}else{let a=ht(e);t=Math.sqrt(a),n=Math.sqrt(a)}return[t,n]}(e),a=n[0],r=n[1],i=this.scale;if("fanIn"===this.mode?i/=Math.max(1,a):"fanOut"===this.mode?i/=Math.max(1,r):i/=Math.max(1,(a+r)/2),"normal"===this.distribution){let n=Math.sqrt(i);if("float32"!==(t=t||"float32")&&"int32"!==t)throw new cu("".concat(this.getClassName()," does not support dType ").concat(t,"."));return u$(e,0,n,t,this.seed)}{let n=Math.sqrt(3*i);return uJ(e,-n,n,t,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}constructor(e){if(super(),e.scale<0)throw new cc("scale must be a positive float. Got: ".concat(e.scale));this.scale=null==e.scale?1:e.scale,this.mode=null==e.mode?"fanIn":e.mode,cC(hv,"FanMode",this.mode),this.distribution=null==e.distribution?"normal":e.distribution,cC(hw,"Distribution",this.distribution),this.seed=e.seed}}hA.className="VarianceScaling",c_.registerClass(hA);class hR extends hA{getClassName(){return hA.className}constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:null==e?null:e.seed})}}hR.className="GlorotUniform",c_.registerClass(hR);class hD extends hA{getClassName(){return hA.className}constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:null==e?null:e.seed})}}hD.className="GlorotNormal",c_.registerClass(hD);class hM extends hA{getClassName(){return hA.className}constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}}hM.className="HeNormal",c_.registerClass(hM);class hF extends hA{getClassName(){return hA.className}constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}}hF.className="HeUniform",c_.registerClass(hF);class hO extends hA{getClassName(){return hA.className}constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}}hO.className="LeCunNormal",c_.registerClass(hO);class hP extends hA{getClassName(){return hA.className}constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}}hP.className="LeCunUniform",c_.registerClass(hP);class hj extends hN{apply(e,t){return aQ(()=>{if(e.length<2)throw new cu("Shape must be at least 2D.");if("int32"!==t&&"float32"!==t&&void 0!==t)throw TypeError("Unsupported data type ".concat(t,"."));let n=cs.sizeFromShape(e.slice(0,-1)),a=e[e.length-1],r=n*a;r>this.ELEMENTS_WARN_SLOW&&console.warn("Orthogonal initializer is being called on a matrix with more "+"than ".concat(this.ELEMENTS_WARN_SLOW," (").concat(r,") elements: ")+"Slowness may result.");let i=hf([Math.max(a,n),Math.min(a,n)],0,1,t,this.seed),s=uG.qr(i,!1),o=s[0];return o=rz(o,s[1].flatten().stridedSlice([0],[Math.min(a,n)*Math.min(a,n)],[Math.min(a,n)+1]).sign()),n<a&&(o=o.transpose()),rz(rG(this.gain),o.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=null==e.gain?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}}hj.className="Orthogonal",c_.registerClass(hj);let hL={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function hz(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return cN(e,c_.SerializationMap.getMap().classNameMap,t,"initializer")}function hB(e){if("string"==typeof e){let t=e in hL?hL[e]:e;if("GlorotNormal"===t)return new hD;{if("GlorotUniform"===t)return new hR;if("HeNormal"===t)return new hM;if("HeUniform"===t)return new hF;if("LeCunNormal"===t)return new hO;if("LeCunUniform"===t)return new hP;let e={};return e.className=t,e.config={},hz(e)}}return e instanceof hN?e:hz(e)}function hV(e){return Array.isArray(e)&&Array.isArray(e[0])}function hU(e){return 0===e.length?[]:Array.isArray(e[0])?e:[e]}function hW(e){let t;if(Array.isArray(e)){if(1!==e.length)throw new cc("Expected Tensor length to be 1; got ".concat(e.length));t=e[0]}else t=e;return t}function hG(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))return e;if(1===e.length)return e[0];throw new cc("Expected exactly 1 Shape; got ".concat(e.length))}function hH(e){let t=0;for(let n of e)0===n.shape.length?t+=1:t+=n.shape.reduce((e,t)=>e*t);return t}function hq(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;return aR.makeVariable(e,t,n,a)}let hK="Variable";class hX{read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),function(e,t){if(e.shape.toString()!==t.shape.toString())throw Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}(this.val,e),this.val.id!==e.id&&(this.val.assign(e),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw Error("LayersVariable ".concat(this.name," is already disposed."))}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}constructor(e,t="float32",n=hK,a=!0,r=null){this.dtype=null==t?"float32":t,this.shape=e.shape,this.id=cA++,n=null==n?hK:n,this.originalName=cG(n),this.name=cH(this.originalName),this.trainable_=a,this.constraint=r,this.val=hq(e,this.trainable_,this.name,this.dtype)}}function hY(e){return e.map(e=>e.read())}function hZ(e){e.forEach(e=>{e[0].write(e[1])})}class hQ{constructor(e){this.dtype=e.dtype,this.shape=e.shape,null!=e.shape?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class hJ{constructor(e,t,n,a,r,i,s){this.dtype=e,this.shape=t,this.sourceLayer=n,this.inputs=a,this.callArgs=r,this.outputTensorIndex=s,this.id=cA++,null!=i&&(this.originalName=cG(i),this.name=cH(this.originalName)),this.rank=t.length}}let h$=0;class h0{getConfig(){let e=[];for(let t of this.inboundLayers)null!=t?e.push(t.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}constructor(e,t){for(let n of(this.callArgs=t,this.id=h$++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes,e.inboundLayers))null!=n&&n.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}}let h1=0;class h2 extends c_.Serializable{static nodeKey(e,t){return e.name+"_ib-"+t.toString()}getNodeAtIndex(e,t){if(0===this.inboundNodes.length)throw new cl("The layer has never been called "+"and thus has no defined ".concat(t,"."));if(this.inboundNodes.length<=e)throw new cc("Asked to get ".concat(t," at node ").concat(e,", ")+"but the layer has only ".concat(this.inboundNodes.length," inbound nodes."));return this.inboundNodes[e]}getInputAt(e){return cg(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return cg(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new co("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new co("Layer ".concat(this.name)+" is not connected, no input to return.");return cg(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(0===this.inboundNodes.length)throw new co("Layer ".concat(this.name)+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new co("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return cg(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(t=>t.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){let t=cx(e);if(null==this.inputSpec||0===this.inputSpec.length)return;let n=cx(this.inputSpec);if(t.length!==n.length)throw new cc("Layer ".concat(this.name," expects ").concat(n.length," inputs, ")+"but it received ".concat(t.length," input tensors. ")+"Input received: ".concat(e));for(let e=0;e<t.length;e++){let a=t[e],r=n[e];if(null==r)continue;let i=a.rank;if(null!=r.ndim&&i!==r.ndim)throw new cc("Input ".concat(e," is incompatible with layer ").concat(this.name,": ")+"expected ndim=".concat(r.ndim,", found ndim=").concat(i));if(null!=r.maxNDim&&i>r.maxNDim)throw new cc("Input ".concat(e," is incompatible with layer ").concat(this.name)+": expected max_ndim=".concat(r.maxNDim,", found ndim=").concat(i));if(null!=r.minNDim&&i<r.minNDim)throw new cc("Input ".concat(e," is incompatible with layer ").concat(this.name)+": expected min_ndim=".concat(r.minNDim,", found ndim=").concat(i,"."));if(null!=r.dtype&&a.dtype!==r.dtype)throw new cc("Input ".concat(e," is incompatible with layer ").concat(this.name," ")+": expected dtype=".concat(r.dtype,", found dtype=").concat(a.dtype,"."));if(r.axes){let t=a.shape;for(let n in r.axes){let a=Number(n),i=r.axes[n],s=a>=0?t[a]:t[t.length+a];if(null!=i&&-1===[i,null].indexOf(s))throw new cc("Input ".concat(e," is incompatible with layer ")+"".concat(this.name,": expected axis ").concat(a," of input shape to ")+"have value ".concat(i," but got shape ").concat(t,"."))}}if(null!=r.shape)for(let t=0;t<r.shape.length;++t){let n=r.shape[t],i=a.shape[t];if(null!=n&&null!=i&&n!==i)throw new cc("Input ".concat(e," is incompatible with layer ")+"".concat(this.name,": expected shape=").concat(r.shape,", ")+"found shape=".concat(a.shape,"."))}}}call(e,t){return e}invokeCallHook(e,t){null!=this._callHook&&this._callHook(e,t)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,t){t=t||{},this.assertNotDisposed();let n=cx(e),a=function(e){let t=!0;for(let n of cx(e))if(!(n instanceof hJ)){t=!1;break}return t}(e),r=function(e){let t=!0;for(let n of cx(e))if(n instanceof hJ){t=!1;break}return t}(e);if(a===r)throw new cc("Arguments to apply() must be all SymbolicTensors or all Tensors");return cW(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);let t=[];for(let n of cx(e))t.push(n.shape);this.build(cg(t)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),null===this._refCount&&r&&(this._refCount=1)}if(this.assertInputCompatibility(e),r){let a=this.call(e,t);this.supportsMasking&&this.setMaskMetadata(e,a);let r=cx(a),i=[];for(let e of r)-1!==n.indexOf(e)&&(e=e.clone()),i.push(e);if(a=cg(i),null!=this.activityRegularizer)throw new cu("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return a}{let n,a=function(e){e=cx(e);let t=[];for(let n of e)t.push(n.shape);return cg(t)}(e),r=this.computeOutputShape(a),i="float32";if(this.warnOnIncompatibleInputShape(Array.isArray(e)?a[0]:a),n=null!=r&&r.length>0&&Array.isArray(r[0])?r.map((n,a)=>new hJ(i,n,this,cx(e),t,this.name,a)):new hJ(i,r,this,cx(e),t,this.name),this.addInboundNode(e,n,null,null,a,r,t),this._refCount++,null!=this.activityRegularizer)throw new cu("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return n}})}warnOnIncompatibleInputShape(e){if(null!=this.batchInputShape)if(e.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+"".concat(JSON.stringify(e),") does not match that of the ")+"batchInputShape (".concat(JSON.stringify(this.batchInputShape),") ")+"of the layer ".concat(this.name));else{let t=!1;this.batchInputShape.forEach((n,a)=>{null!=n&&null!=e[a]&&e[a]!==n&&(t=!0)}),t&&console.warn("The shape of the input tensor "+"(".concat(JSON.stringify(e),") does not ")+"match the expectation of layer ".concat(this.name,": ")+"".concat(JSON.stringify(this.batchInputShape)))}}get outputShape(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new co("The layer ".concat(this.name," has never been called and thus has no ")+"defined output shape.");let e=[];for(let t of this.inboundNodes){let n=JSON.stringify(t.outputShapes);-1===e.indexOf(n)&&e.push(n)}if(1===e.length){let e=this.inboundNodes[0].outputShapes;return Array.isArray(e)&&Array.isArray(e[0])&&1===e.length?e[0]:e}throw new co("The layer ".concat(this.name," has multiple inbound nodes with different ")+'output shapes. Hence the notion of "output shape" is ill-defined for the layer.')}countParams(){if(!this.built)throw new cl("You tried to call countParams() on ".concat(this.name,", ")+"but the layer is not built yet. Build it first by calling build(batchInputShape).");return hH(this.weights)}build(e){this.built=!0}getWeights(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return hY(e?this.trainableWeights:this.weights)}setWeights(e){aQ(()=>{let t=this.weights;if(t.length!==e.length)throw new cc('You called setWeights(weights) on layer "'.concat(this.name,'" ')+"with a weight list of length ".concat(e.length,", ")+"but the layer was expecting ".concat(t.length," weights. ")+"Provided weights: ".concat(e,"..."));if(0===t.length)return;let n=[],a=hY(t);for(let r=0;r<a.length;++r){let i=a[r],s=t[r],o=e[r];if(!cs.arraysEqual(i.shape,o.shape))throw new cc("Layer weight shape ".concat(i.shape," ")+"not compatible with provided weight shape ".concat(o.shape));n.push([s,o])}hZ(n)})}addWeight(e,t,n,a,r,i,s,o){if(-1!==this._addedWeightNames.indexOf(e))throw new cc("Duplicate weight name ".concat(e," for layer ").concat(this.name));this._addedWeightNames.push(e),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(a=null!=o?o():hB("zeros"));let l=a.apply(t,n),c=new hX(l,n,e,i,s);return l.dispose(),null!=r&&this.addLoss(()=>r.apply(c.read())),null==i&&(i=!0),i?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){null==e||Array.isArray(e)&&0===e.length||(e=cx(e),void 0!==this._losses&&null!==this._losses&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,t){if(!this.supportsMasking){if(null!=t)if(Array.isArray(t))t.forEach(e=>{if(null!=e)throw TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.")});else throw TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.");return null}return t}setMaskMetadata(e,t,n){if(!this.supportsMasking)return;let a=this.computeMask(e,n),r=cx(t),i=cx(a);if(r.length!==i.length)throw Error("".concat(this.name," outputs ").concat(r.length," tensors ")+"but ".concat(r.length," masks for those tensors"));for(let e=0;e<r.length;e++)r[e].kerasMask=i[e]}addInboundNode(e,t,n,a,r,i){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=cx(e);t=cx(t),n=cx(n),a=cx(a),r=hU(r),i=hU(i);let l=[],c=[],u=[];for(let e of o)l.push(e.sourceLayer),c.push(e.nodeIndex),u.push(e.tensorIndex);new h0({outboundLayer:this,inboundLayers:l,nodeIndices:c,tensorIndices:u,inputTensors:o,outputTensors:t,inputMasks:n,outputMasks:a,inputShapes:r,outputShapes:i},s);for(let e=0;e<t.length;e++)t[e].sourceLayer=this,t[e].nodeIndex=this.inboundNodes.length-1,t[e].tensorIndex=e}getConfig(){let e={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(e.batchInputShape=this.batchInputShape),null!=this.dtype&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(0===this._refCount)throw Error("Layer '".concat(this.name,"' is already disposed."))}dispose(){if(!this.built)throw Error("Cannot dispose Layer ".concat(this.name," because it has not been ")+"built yet.");if(null===this._refCount)throw Error("Cannot dispose Layer ".concat(this.name," because it has not been used ")+"yet.");this.assertNotDisposed();let e=0;return 0==--this._refCount&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=h1++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let t=e.name;if(!t){let e=this.getClassName();t=cy(e)+"_"+cD(e)}if(this.name=t,this.trainable_=null==e.trainable||e.trainable,null!=e.inputShape||null!=e.batchInputShape){let t;if(null!=e.batchInputShape)t=e.batchInputShape;else if(null!=e.inputShape){let n=null;null!=e.batchSize&&(n=e.batchSize),t=[n].concat(e.inputShape)}this.batchInputShape=t;let n=e.dtype;null==n&&(n=e.inputDType),null==n&&(n="float32"),this.dtype=n}null!=e.weights?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}}class h3 extends h2{apply(e,t){throw new cc("Cannot pass any input to an "+"InputLayer's apply() method. InputLayer name: ".concat(this.name))}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}constructor(e){if(super({dtype:e.dtype,name:null!=e.name?e.name:cD("input").toString()}),null==e.batchSize&&(e.batchSize=null),null==e.sparse&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,null!=e.inputShape&&null!=e.batchInputShape)throw new cc("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let t=e.batchInputShape;if(null==t)if(null==e.inputShape)throw new cc("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");else t=[e.batchSize].concat(e.inputShape);else if(null!=e.batchSize)throw new cc("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");let n=e.dtype||"float32";this.batchInputShape=t,this.dtype=n,this.inputSpec=[{shape:t}];let a=new hJ(this.dtype,this.batchInputShape,this,[],{},this.name);a.nodeIndex=0,a.tensorIndex=0,new h0({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[a],outputTensors:[a],inputMasks:[null],outputMasks:[null],inputShapes:[t],outputShapes:[t]})}}function h4(e){if(null==e.batchShape&&null==e.shape)throw Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=e.batchShape&&null!=e.shape)throw new cc("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=e.batchShape;null!=e.shape&&null==t&&(t=[null].concat(e.shape));let n=e.dtype;return null==n&&(n="float32"),new h3({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}h3.className="InputLayer",c_.registerClass(h3);class h5{add(e,t,n){if(null==this.id2Value[e.id])this.id2Value[e.id]=function(e,t){if(null==e.dtype||e.dtype===t.dtype)return t;try{return rM(t,e.dtype)}catch(n){throw new cc("The dtype of the feed (".concat(t.dtype,") can not be cast to the dtype ")+"of the key '".concat(e.name,"' (").concat(e.dtype,")."))}}(e,t),this.name2Id[e.name]=e.id,null!=n&&(this.id2Mask[e.id]=n);else throw new cc("Duplicate key: name=".concat(e.name,", id=").concat(e.id));return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return null!=this.id2Value[e.id]}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof hJ)if(null!=this.id2Value[e.id])return this.id2Value[e.id];else throw new cc("Nonexistent key: ".concat(e.name));{let t=this.name2Id[e];if(null==t)throw new cc("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Value[t]}}getMask(e){if(e instanceof hJ)if(null!=this.id2Value[e.id])return this.id2Mask[e.id];else throw new cc("Nonexistent key: ".concat(e.name));{let t=this.name2Id[e];if(null==t)throw new cc("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Mask[t]}}disposeMasks(){null!=this.id2Mask&&aJ(this.id2Mask)}constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof h5)for(let t in e.id2Value)this.id2Value[t]=e.id2Value[t],t in e.id2Mask&&(this.id2Mask[t]=e.id2Mask[t]);else{if(null==e)return;for(let t of e)this.add(t.key,t.value)}}}let h6=new cd,h8=new cd;function h9(e,t,n,a){let r,i=null!=n&&n.training,s=Array.isArray(e),o=s?e:[e],l=o.map(e=>e.name),c=[],u=t.names();for(let e of l)-1!==u.indexOf(e)?c.push(t.getValue(e)):c.push(null);null!=a&&(a.maxNumTensors=-1/0,a.minNumTensors=1/0);let h=l.join(",")+"|"+t.names().sort().join(","),d=h6.get(h);if(null==d){let e=function(e,t){cs.assert(null!=e&&e.length>0,()=>"Expected at least one fetch, got none");let n=[],a={};if(1===e.length){let r=h7(e[0],t);n=r.sorted,a=r.recipientMap}else{let r=new Set;for(let i of e){let{sorted:e,recipientMap:s}=h7(i,t);for(let t of e)r.has(t.name)||(n.push(t),r.add(t.name));for(let e in s)null==a[e]&&(a[e]=new Set),s[e].forEach(t=>a[e].add(t))}}return{sorted:n,recipientCounts:function(e){let t={};for(let n in e)t[n]=e[n].size;return t}(a)}}(o,t);d=e.sorted,r=e.recipientCounts,h6.put(h,d),h8.put(h,r)}r={},i||Object.assign(r,h8.get(h));let p=new h5(t);for(let e=0;e<d.length;++e){if(null!=a){let e=aZ().numTensors;e>a.maxNumTensors&&(a.maxNumTensors=e),e<a.minNumTensors&&(a.minNumTensors=e)}let s=d[e],o=s.sourceLayer;if(o instanceof h3)continue;let u=[],h=[],f=[],m=!1;for(let e of s.inputs){let n=p.getValue(e),a=p.getMask(e);u.push(n),h.push(a),null!=a&&(m=!0),!i&&(r[e.name]--,0!==r[e.name]||t.hasKey(e)||-1!==l.indexOf(e.name)||n.isDisposed||!0===e.sourceLayer.stateful||f.push(n))}m&&((n=n||{}).mask=h[0]);let g=cx(o.apply(u,n)),x=null;o.supportsMasking&&(x=o.computeMask(u,h));let y=function(e){let t;if(1===e.sourceLayer.inboundNodes.length)t=e.sourceLayer.output;else{let n=null;for(let t=0;t<e.sourceLayer.inboundNodes.length;++t)for(let a of e.sourceLayer.inboundNodes[t].outputTensors)if(a.id===e.id){n=t;break}t=e.sourceLayer.getOutputAt(n)}return t}(s),b=Array.isArray(y)?y:[y];for(let e=0;e<b.length;++e){p.hasKey(b[e])||p.add(b[e],g[e],Array.isArray(x)?x[0]:x);let t=l.indexOf(b[e].name);-1!==t&&(c[t]=g[e])}i||aJ(f)}return p.disposeMasks(),s?c:c[0]}function h7(e,t){let n=new Set,a=[],r={};for(let e of t.names())n.add(e);let i=[],s=[];for(i.push(e);i.length>0;){let e=i[i.length-1];if(n.has(e.name)){i.pop();continue}let t=s[s.length-1]===i.length-1;if(0===e.inputs.length||t)i.pop(),a.push(e),n.add(e.name),t&&s.pop();else for(let t of(s.push(i.length-1),e.inputs))null==r[t.name]&&(r[t.name]=new Set),r[t.name].add(e.name),n.has(t.name)||i.push(t)}return{sorted:a,recipientMap:r}}eT.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,function(e){null!=h6&&h6.setMaxEntries(e),null!=h8&&h8.setMaxEntries(e)}),e.s(["maxNorm",()=>du,"minMaxNorm",()=>dp,"nonNeg",()=>dd,"unitNorm",()=>dh],60755);var c_=c_;function de(e,t){return aQ(()=>rB(il(rz(e,e),t,!0)))}class dt extends c_.Serializable{getConfig(){return{}}}class dn extends dt{apply(e){return aQ(()=>{let t=de(e,this.axis);return rz(e,rL(la(t,0,this.maxValue),rP(hi(),t)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=null!=e.maxValue?e.maxValue:this.defaultMaxValue,this.axis=null!=e.axis?e.axis:this.defaultAxis}}dn.className="MaxNorm",c_.registerClass(dn);class da extends dt{apply(e){return aQ(()=>rL(e,rP(hi(),de(e,this.axis))))}getConfig(){return{axis:this.axis}}constructor(e){super(),this.defaultAxis=0,this.axis=null!=e.axis?e.axis:this.defaultAxis}}da.className="UnitNorm",c_.registerClass(da);class dr extends dt{apply(e){return sq(e)}}dr.className="NonNeg",c_.registerClass(dr);class di extends dt{apply(e){return aQ(()=>{let t=de(e,this.axis),n=rP(rz(this.rate,la(t,this.minValue,this.maxValue)),rz(1-this.rate,t));return rz(e,rL(n,rP(hi(),t)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=null!=e.minValue?e.minValue:this.defaultMinValue,this.maxValue=null!=e.maxValue?e.maxValue:this.defaultMaxValue,this.rate=null!=e.rate?e.rate:this.defaultRate,this.axis=null!=e.axis?e.axis:this.defaultAxis}}di.className="MinMaxNorm",c_.registerClass(di);let ds={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function dl(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return cN(e,c_.SerializationMap.getMap().classNameMap,t,"constraint")}function dc(e){return null==e?null:"string"==typeof e?dl({className:e in ds?ds[e]:e,config:{}}):e instanceof dt?e:dl(e)}function du(e){return new dn(e)}function dh(e){return new da(e)}function dd(){return new dr}function dp(e){return new di(e)}function df(){return new hk}function dm(){return new hS}function dg(e){return new hC(e)}function dx(e){return new hT(e)}function dy(e){return new hI(e)}function db(e){return new hE(e)}function dv(e){return new h_(e)}function dw(e){return new hA(e)}function dN(e){return new hR(e)}function dk(e){return new hD(e)}function dS(e){return new hM(e)}function dC(e){return new hF(e)}function dT(e){return new hO(e)}function dI(e){return new hP(e)}function dE(e){return new hj(e)}e.i(60755),e.s(["constant",()=>dg,"glorotNormal",()=>dk,"glorotUniform",()=>dN,"heNormal",()=>dS,"heUniform",()=>dC,"identity",()=>dv,"leCunNormal",()=>dT,"leCunUniform",()=>dI,"ones",()=>dm,"orthogonal",()=>dE,"randomNormal",()=>dy,"randomUniform",()=>dx,"truncatedNormal",()=>db,"varianceScaling",()=>dw,"zeros",()=>df],2993),e.i(2993),e.s(["activation",()=>gn,"add",()=>gh,"alphaDropout",()=>g1,"average",()=>gd,"averagePooling1d",()=>gw,"averagePooling2d",()=>gS,"averagePooling3d",()=>gI,"avgPool1d",()=>gN,"avgPool2d",()=>gC,"avgPool3d",()=>gE,"avgPooling1d",()=>gk,"avgPooling2d",()=>gT,"avgPooling3d",()=>g_,"batchNormalization",()=>gy,"bidirectional",()=>gK,"categoryEncoding",()=>g6,"centerCrop",()=>g4,"concatenate",()=>gp,"conv1d",()=>m3,"conv2d",()=>m4,"conv2dTranspose",()=>m5,"conv3d",()=>m6,"conv3dTranspose",()=>m8,"convLstm2d",()=>gW,"convLstm2dCell",()=>gG,"cropping2D",()=>m7,"dense",()=>ga,"depthwiseConv2d",()=>gt,"dot",()=>gx,"dropout",()=>gr,"elu",()=>mQ,"embedding",()=>gu,"flatten",()=>gs,"gaussianDropout",()=>g0,"gaussianNoise",()=>g$,"globalAveragePooling1d",()=>gA,"globalAveragePooling2d",()=>gR,"globalMaxPool1d",()=>gY,"globalMaxPool2d",()=>gZ,"globalMaxPooling1d",()=>gD,"globalMaxPooling2d",()=>gM,"gru",()=>gj,"gruCell",()=>gL,"inputLayer",()=>mZ,"layerNormalization",()=>gb,"leakyReLU",()=>m$,"lstm",()=>gz,"lstmCell",()=>gB,"masking",()=>g2,"maxPool1d",()=>gQ,"maxPool2d",()=>gJ,"maxPooling1d",()=>gF,"maxPooling2d",()=>gO,"maxPooling3d",()=>gP,"maximum",()=>gf,"minimum",()=>gm,"multiply",()=>gg,"permute",()=>gc,"prelu",()=>m0,"randomWidth",()=>g8,"reLU",()=>mJ,"repeatVector",()=>go,"rescaling",()=>g3,"reshape",()=>gl,"resizing",()=>g5,"rnn",()=>gH,"separableConv2d",()=>m9,"simpleRNN",()=>gV,"simpleRNNCell",()=>gU,"softmax",()=>m1,"spatialDropout1d",()=>gi,"stackedRNNCells",()=>gq,"thresholdedReLU",()=>m2,"timeDistributed",()=>gX,"upSampling2d",()=>ge,"zeroPadding2d",()=>gv],75168);let d_="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate?setImmediate:e=>e();function dA(){return new Promise(e=>d_(()=>e()))}var cs=cs;async function dR(e){if(null==e)return;let t=[],n=[],a=[];for(let r in e){let i=e[r];"number"!=typeof i&&(t.push(i.data()),n.push(r),a.push(i))}if(t.length>0){let r=await Promise.all(t);for(let t=0;t<r.length;++t)e[n[t]]=r[t][0];aJ(a)}}function dD(e){if(null!=e)for(let t in e){let n=e[t];"number"!=typeof n&&n.dispose()}}!function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"}(g||(g={}));class dM{setParams(e){this.params=e}async onEpochBegin(e,t){}async onEpochEnd(e,t){}async onBatchBegin(e,t){}async onBatchEnd(e,t){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}constructor(){this.validationData=null}}class dF{append(e){this.callbacks.push(e)}setParams(e){for(let t of this.callbacks)t.setParams(e)}setModel(e){for(let t of this.callbacks)t.setModel(e)}async onEpochBegin(e,t){for(let n of(null==t&&(t={}),this.callbacks))await n.onEpochBegin(e,t)}async onEpochEnd(e,t){for(let n of(null==t&&(t={}),this.callbacks))await n.onEpochEnd(e,t)}async onBatchBegin(e,t){for(let n of(null==t&&(t={}),this.callbacks))await n.onBatchBegin(e,t)}async onBatchEnd(e,t){for(let n of(null==t&&(t={}),this.callbacks))await n.onBatchEnd(e,t)}async onTrainBegin(e){for(let t of(null==e&&(e={}),this.callbacks))await t.onTrainBegin(e)}async onTrainEnd(e){for(let t of(null==e&&(e={}),this.callbacks))await t.onTrainEnd(e)}constructor(e,t=10){null==e&&(e=[]),this.callbacks=e,this.queueLength=t}}class dO extends dM{async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,t){null==t&&(t={});let n=null==t.size?0:t.size;for(let e in this.seen+=n,t){let a=t[e];if("number"==typeof a)this.totals.hasOwnProperty(e)||(this.totals[e]=0),this.totals[e]=this.totals[e]+a*n;else{let t;e in this.totals?t=this.totals[e]:this.totals[e]=0;let r=aQ(()=>rP(this.totals[e],rz(a,n)));this.totals[e]=r,null!=t&&t.dispose()}}}async onEpochEnd(e,t){if(null!=t)for(let e of this.params.metrics)null!=this.totals[e]&&("number"==typeof this.totals[e]?t[e]=this.totals[e]/this.seen:aQ(()=>{let n=rz(rL(1,this.seen),this.totals[e]);t[e]=n,this.totals[e].dispose(),a$(t[e])}))}constructor(){super()}}class dP extends dM{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,t){for(let n in null==t&&(t={}),this.epoch.push(e),t)null==this.history[n]&&(this.history[n]=[]),this.history[n].push(t[n])}async syncData(){let e=[],t=[],n=[];for(let a in this.history){let r=this.history[a];for(let i=0;i<r.length;++i)if("number"!=typeof r[i]){let s=r[i];e.push(s.data()),t.push(a),n.push(i)}}let a=await Promise.all(e);for(let e=0;e<a.length;++e)this.history[t[e]][n[e]].dispose(),this.history[t[e]][n[e]]=a[e][0]}}class dj extends dM{async maybeWait(e,t,n){let a=[];null!=this.yield&&(await dR(n),a.push(this.yield(e,t,n))),a.push(this.nextFrameFunc()),await Promise.all(a)}async onEpochBegin(e,t){this.currentEpoch=e,null!=this.epochBegin&&(await dR(t),await this.epochBegin(e,t))}async onEpochEnd(e,t){let n=[];null!=this.epochEnd&&(await dR(t),n.push(this.epochEnd(e,t))),"epoch"===this.yieldEvery&&n.push(this.nextFrameFunc()),await Promise.all(n)}async onBatchBegin(e,t){null!=this.batchBegin&&(await dR(t),await this.batchBegin(e,t))}async onBatchEnd(e,t){let n=[];null!=this.batchEnd&&(await dR(t),n.push(this.batchEnd(e,t))),"batch"===this.yieldEvery?n.push(this.nextFrameFunc()):cs.isNumber(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,e,t)),await Promise.all(n)}async onTrainBegin(e){null!=this.trainBegin&&(await dR(e),await this.trainBegin(e))}async onTrainEnd(e){null!=this.trainEnd&&(await dR(e),await this.trainEnd(e))}constructor(e,t){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||dA,this.yieldEvery=t||"auto","auto"===this.yieldEvery&&(this.yieldEvery=125),"never"===this.yieldEvery&&null!=e.onYield)throw Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");cs.isNumber(this.yieldEvery)&&(this.maybeWait=function(e,t,n){let a,r=null!=n?n():cs.now();return function(){for(var i=arguments.length,s=Array(i),o=0;o<i;o++)s[o]=arguments[o];let l=null!=n?n():cs.now();return l-r<t?a:(r=l,a=e(...s))}}(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}}function dL(e,t){return(null==e&&(e={}),e instanceof dM)?[e]:Array.isArray(e)&&e[0]instanceof dM?e:cx(e).map(e=>new dj(e,t))}class dz{static registerCallbackConstructor(e,t){cs.assert(e>=0&&Number.isInteger(e),()=>"Verbosity level is expected to be an integer >= 0, "+"but got ".concat(e)),dz.checkForDuplicate(t),null==dz.constructors[e]&&(dz.constructors[e]=[]),dz.constructors[e].push(t)}static checkForDuplicate(e){for(let t in dz.constructors)dz.constructors[+t].forEach(t=>{if(t===e)throw new cc("Duplicate callback constructor.")})}static clear(){dz.constructors={}}static createCallbacks(e){let t=[];for(let n in dz.constructors){let a=+n;e>=a&&t.push(...dz.constructors[a])}return t.map(e=>new e)}constructor(){}}function dB(e,t,n,a,r,i,s,o,l){let c=new dP,u=[new dO,...dz.createCallbacks(t)];null!=e&&u.push(...e),u.push(c);let h=new dF(u);return h.setParams({epochs:n,initialEpoch:a,samples:r,steps:i,batchSize:s,verbose:t,doValidation:o,metrics:l}),{callbackList:h,history:c}}function dV(e){return new Promise(e=>setTimeout(e)).then(e)}dz.constructors={},e.s(["CompositeArrayBuffer",()=>aY,"browserFiles",()=>dG,"browserHTTPRequest",()=>d$,"concatenateArrayBuffers",()=>a7,"copyModel",()=>r_,"decodeWeights",()=>a2,"decodeWeightsStream",()=>a6,"encodeWeights",()=>a1,"fromMemory",()=>d3,"fromMemorySync",()=>d4,"getLoadHandlers",()=>ru,"getModelArtifactsForJSON",()=>ra,"getModelArtifactsForJSONSync",()=>rn,"getModelArtifactsInfoForJSON",()=>rr,"getSaveHandlers",()=>rc,"getWeightSpecs",()=>ri,"http",()=>dJ,"isHTTPScheme",()=>dZ,"listModels",()=>rI,"loadWeights",()=>dK,"moveModel",()=>rA,"registerLoadRouter",()=>rl,"registerSaveRouter",()=>ro,"removeModel",()=>rE,"weightsLoaderFactory",()=>dX,"withSaveHandler",()=>d5,"withSaveHandlerSync",()=>d6],61898),e.s([],59966);class dU{async save(e){if("undefined"==typeof document)throw Error("Browser downloads are not supported in this environment since `document` is not present");let t=aY.join(e.weightData),n=window.URL.createObjectURL(new Blob([t],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{let t=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],a=rt(e,t),r=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),i=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor;if(i.download=this.modelJsonFileName,i.href=r,await dV(()=>i.dispatchEvent(new MouseEvent("click"))),null!=e.weightData){let e=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor;e.download=this.weightDataFileName,e.href=n,await dV(()=>e.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:rr(e)}}}constructor(e){if(!eT.getBool("IS_BROWSER"))throw Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(dU.URL_SCHEME)&&(e=e.slice(dU.URL_SCHEME.length)),(null==e||0===e.length)&&(e="model"),this.modelJsonFileName=e+".json",this.weightDataFileName=e+".weights.bin"}}dU.URL_SCHEME="downloads://";class dW{async load(){return new Promise((e,t)=>{let n=new FileReader;n.onload=n=>{let a=JSON.parse(n.target.result),r=a.modelTopology;return null==r?void t(Error("modelTopology field is missing from file ".concat(this.jsonFile.name))):null==a.weightsManifest?void t(Error("weightManifest field is missing from file ".concat(this.jsonFile.name))):0===this.weightsFiles.length?void e({modelTopology:r}):void e(ra(a,e=>this.loadWeights(e)))},n.onerror=e=>t("Failed to read model topology and weights manifest JSON "+"from file '".concat(this.jsonFile.name,"'. BrowserFiles supports loading ")+"Keras-style tf.Model artifacts only."),n.readAsText(this.jsonFile)})}loadWeights(e){let t=[],n=[];for(let a of e)t.push(...a.weights),n.push(...a.paths);let a=this.checkManifestAndWeightFiles(e);return Promise.all(n.map(e=>this.loadWeightsFile(e,a[e]))).then(e=>[t,e])}loadWeightsFile(e,t){return new Promise((n,a)=>{let r=new FileReader;r.onload=e=>{n(e.target.result)},r.onerror=t=>a("Failed to weights data from file of path '".concat(e,"'.")),r.readAsArrayBuffer(t)})}checkManifestAndWeightFiles(e){let t=[],n=this.weightsFiles.map(e=>re(e.name)),a={};for(let r of e)r.paths.forEach(e=>{let r=re(e);if(-1!==t.indexOf(r))throw Error("Duplicate file basename found in weights manifest: "+"'".concat(r,"'"));if(t.push(r),-1===n.indexOf(r))throw Error("Weight file with basename '".concat(r,"' is not provided."));a[e]=this.weightsFiles[n.indexOf(r)]});if(t.length!==this.weightsFiles.length)throw Error("Mismatch in the number of files in weights manifest "+"(".concat(t.length,") and the number of weight files provided ")+"(".concat(this.weightsFiles.length,")."));return a}constructor(e){if(null==e||e.length<1)throw Error("When calling browserFiles, at least 1 file is required, "+"but received ".concat(e));this.jsonFile=e[0],this.weightsFiles=e.slice(1)}}function dG(e){return new dW(e)}function dH(e,t,n,a){var r,i,s;L(null!=(r=e)&&Array.isArray(r)&&r.length>0,()=>"promises must be a none empty array"),i=n=null==n?0:n,s=a=null==a?1:a,L(i>=0&&i<=1,()=>"Progress fraction must be in range [0, 1], but "+"got startFraction ".concat(i)),L(s>=0&&s<=1,()=>"Progress fraction must be in range [0, 1], but "+"got endFraction ".concat(s)),L(s>=i,()=>"startFraction must be no more than endFraction, but "+"got startFraction ".concat(i," and endFraction ")+"".concat(s));let o=0;return Promise.all(e.map(r=>(r.then(r=>(t(n+ ++o/e.length*(a-n)),r)),r)))}async function dq(e,t){null==t&&(t={});let n=null==t.fetchFunc?eT.platform.fetch:t.fetchFunc,a=e.map(e=>n(e,t.requestInit,{isBinary:!0})),r=(null==t.onProgress?await Promise.all(a):await dH(a,t.onProgress,0,.5)).map(e=>e.arrayBuffer());return null==t.onProgress?await Promise.all(r):await dH(r,t.onProgress,.5,1)}async function dK(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;return dX(e=>dq(e,{requestInit:a}))(e,t,n)}function dX(e){return async function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2?arguments[2]:void 0,r=t.map(()=>!1),i={},s=null!=a?a.map(()=>!1):[],o=[];if(t.forEach((e,t)=>{let n=0;e.weights.forEach(e=>{let l=aX["quantization"in e?e.quantization.dtype:e.dtype]*V(e.shape),c=()=>{r[t]=!0,null==i[t]&&(i[t]=[]),i[t].push({manifestEntry:e,groupOffset:n,sizeBytes:l})};null!=a?a.forEach((t,n)=>{t===e.name&&(c(),s[n]=!0)}):c(),o.push(e.name),n+=l})}),!s.every(e=>e)){let e=a.filter((e,t)=>!s[t]);throw Error("Could not find weights in manifest with names: "+"".concat(e.join(", "),". \n")+"Manifest JSON has weights with names: "+"".concat(o.join(", "),"."))}let l=r.reduce((e,t,n)=>(t&&e.push(n),e),[]),c=[];l.forEach(e=>{t[e].paths.forEach(e=>{let t=n+(n.endsWith("/")?"":"/")+e;c.push(t)})});let u=await e(c),h={},d=0;return l.forEach(e=>{let n=t[e].paths.length,a=new aY(u.slice(d,d+n));i[e].forEach(e=>{let t=a2(a.slice(e.groupOffset,e.groupOffset+e.sizeBytes),[e.manifestEntry]);for(let e in t)h[e]=t[e]}),d+=n}),h}}rs.registerSaveRouter(e=>eT.getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(dU.URL_SCHEME)?function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model";return new dU(e)}(e.slice(dU.URL_SCHEME.length)):null);class dY{async save(e){if(e.modelTopology instanceof ArrayBuffer)throw Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");let t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;let n=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],a=rt(e,n);if(t.body.append("model.json",new Blob([JSON.stringify(a)],{type:"application/json"}),"model.json"),null!=e.weightData){let n=aY.join(e.weightData);t.body.append("model.weights.bin",new Blob([n],{type:"application/octet-stream"}),"model.weights.bin")}let r=await this.fetch(this.path,t);if(r.ok)return{modelArtifactsInfo:rr(e),responses:[r]};throw Error("BrowserHTTPRequest.save() failed due to HTTP response status "+"".concat(r.status,"."))}async loadModelJSON(){let e,t=await this.fetch(this.path,this.requestInit);if(!t.ok)throw Error("Request to ".concat(this.path," failed with status code ")+"".concat(t.status,". Please verify this URL points to ")+"the model JSON of the model to load.");try{e=await t.json()}catch(t){let e="Failed to parse model JSON of response from ".concat(this.path,".");throw this.path.endsWith(".pb")?e+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":e+=" Please make sure the server is serving valid JSON for this request.",Error(e)}let n=e.modelTopology,a=e.weightsManifest;if(null==n&&null==a)throw Error("The JSON from HTTP path ".concat(this.path," contains neither model ")+"topology or manifest for weights.");return e}async load(){return this.loadOptions.streamWeights?this.loadStream():ra(await this.loadModelJSON(),e=>this.loadWeights(e))}async loadStream(){let e=await this.loadModelJSON(),t=await this.getWeightUrls(e.weightsManifest),n=ri(e.weightsManifest),a=()=>(function(e,t){var n;let a,r=null==t.fetchFunc?eT.platform.fetch:t.fetchFunc,i=0;return null==(n=t.onProgress)||n.call(t,0),new ReadableStream({pull:async n=>{for(var s;i<e.length;){a||(a=(await r(e[i],t.requestInit,{isBinary:!0})).body.getReader());let{done:o,value:l}=await a.read();if(o){i++,a=void 0,null==(s=t.onProgress)||s.call(t,i/e.length);continue}n.enqueue(l);return}n.close()}})})(t,this.loadOptions);return Object.assign(Object.assign({},e),{weightSpecs:n,getWeightStream:a})}async getWeightUrls(e){let[t,n]=function(e){let t=e.lastIndexOf("/"),n=e.lastIndexOf("?");return[e.substring(0,t)+"/",n>t?e.substring(n):""]}(Array.isArray(this.path)?this.path[1]:this.path),a=this.weightPathPrefix||t,r=[],i=[];for(let t of e)for(let e of t.paths)null!=this.weightUrlConverter?i.push(this.weightUrlConverter(e)):r.push(a+e+n);return this.weightUrlConverter&&r.push(...await Promise.all(i)),r}async loadWeights(e){let t=await this.getWeightUrls(e);return[ri(e),await dq(t,this.loadOptions)]}constructor(e,t){if(this.DEFAULT_METHOD="POST",null==t&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.weightUrlConverter=t.weightUrlConverter,null!=t.fetchFunc?(L("function"==typeof t.fetchFunc,()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=t.fetchFunc):this.fetch=eT.platform.fetch,L(null!=e&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&L(2===e.length,()=>"URL paths for http must have a length of 2, "+"(actual length is ".concat(e.length,").")),this.path=e,null!=t.requestInit&&null!=t.requestInit.body)throw Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{},this.loadOptions=t}}function dZ(e){return null!=e.match(dY.URL_SCHEME_REGEX)}dY.URL_SCHEME_REGEX=/^https?:\/\//;let dQ=(e,t)=>{if("undefined"==typeof fetch&&(null==t||null==t.fetchFunc));else if(Array.isArray(e)?e.every(e=>dZ(e)):dZ(e))return dJ(e,t);return null};function dJ(e,t){return new dY(e,t)}function d$(e,t){return dJ(e,t)}rs.registerSaveRouter(dQ),rs.registerLoadRouter(dQ);class d0{load(){return this.modelArtifacts}constructor(e){this.modelArtifacts=e}}class d1{save(e){return this.saveHandler(e)}constructor(e){this.saveHandler=e}}class d2{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=t=>Promise.resolve(e.save(t)))}}function d3(e,t,n,a){let r=arguments;return new d2(d4(...r))}function d4(e,t,n,a){return 1!=arguments.length?(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new d0({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:a})):null!=e.modelTopology||null!=e.weightSpecs?new d0(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new d0({modelTopology:e}))}function d5(e){return new d1(e)}function d6(e){return new d1(e)}e.i(59966);var d8=e.i(61898),d8=d8,c_=c_,cs=cs,c_=c_;function d9(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return cN(e,c_.SerializationMap.getMap().classNameMap,t,"layer",n)}var cs=cs;function d7(e,t){return aQ(()=>{var n;"float32"!==e.dtype&&(e=rM(e,"float32"));let a=il(rz(n=e,n),t,!0),r=r$(a.shape,hi()),i=rB(r9(a,r));return rL(e,i)})}function pe(e,t){return aQ(()=>{var n;return lD(rz(n=r2(t,e),n),-1)})}function pt(e,t){return aQ(()=>lD(r4(r2(t,e)),-1))}function pn(e,t){return aQ(()=>{let n=r2(e,t),a=la(r4(e),hi(),Number.MAX_VALUE);return rz(100,lD(r4(rL(n,a)),-1))})}function pa(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return aQ(()=>{if(n)t=lY(t);else{let e=il(t,t.shape.length-1,!0);t=rL(t,e)}return t=la(t,hi(),1-hi()),is(il(rz(rM(e,"float32"),sf(t)),t.shape.length-1))})}function pr(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return aQ(()=>{let a=rM(sh(function(e){let t=[ht(e.shape)];return io(e,t)}(e)),"int32"),r=(t=la(t,hi(),1-hi())).shape;return pa(io(lj(a,r[r.length-1]),r),t,n)})}function pi(e,t){return aQ(()=>{let n;return lD(function(e,t){if(!cs.arraysEqual(e.shape,t.shape))throw new cc("logits and labels must have the same shape, but got shapes "+"".concat(JSON.stringify(e.shape)," and ").concat(JSON.stringify(t.shape)));return aQ(()=>{let n=sq(t),a=is(r4(t));return rP(r2(n,rz(t,e)),lE(i3(a)))})}(e,n=sf(rL(n=la(t,hi(),1-hi()),r2(1,n)))),-1)})}function ps(e,t){return aQ(()=>is(il(rz(d7(e,-1),d7(t,-1)),-1)))}let po={meanSquaredError:pe,meanAbsoluteError:pt,meanAbsolutePercentageError:pn,meanSquaredLogarithmicError:function(e,t){return aQ(()=>{var n;return lD(rz(n=r2(sf(rP(1,la(t,hi(),Number.MAX_VALUE))),sf(rP(1,la(e,hi(),Number.MAX_VALUE)))),n),-1)})},squaredHinge:function(e,t){return aQ(()=>{let n=r9(0,r2(1,rz(e,t)));return lD(rz(n,n),-1)})},hinge:function(e,t){return aQ(()=>lD(r9(0,r2(1,rz(e,t))),-1))},categoricalHinge:function(e,t){return aQ(()=>{let n=il(rz(e,t),-1),a=ld(rz(r2(1,e),t),-1);return r9(0,rP(1,r2(a,n)))})},logcosh:function(e,t){return aQ(()=>{let n=Math.log(2),a=r2(t,e);return lD(r2(rP(a,lS(rz(-2,a))),n),-1)})},categoricalCrossentropy:pa,sparseCategoricalCrossentropy:pr,binaryCrossentropy:pi,kullbackLeiblerDivergence:function(e,t){return aQ(()=>{let n=la(e,hi(),1);return il(rz(e,sf(rL(n,la(t,hi(),1)))),-1)})},poisson:function(e,t){return aQ(()=>{let n=sf(rP(hi(),t));return lD(r2(t,rz(e,n)),-1)})},cosineProximity:ps};function pl(e){if("string"!=typeof e)return e;{if(e in po)return po[e];let t="Unknown loss ".concat(e);throw e.toLowerCase().includes("softmaxcrossentropy")&&(t="Unknown loss ".concat(e,". ")+'Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new cc(t)}}function pc(e,t){return aQ(()=>{let n=rz(.5,lL(t)),a=rM(se(t,n),e.dtype);return lD(sn(e,a),-1)})}function pu(e,t){return aQ(()=>rM(sn(o3(e,-1),o3(t,-1)),"float32"))}function ph(e,t){return aQ(()=>rM(il(iR(sn(e,1),sn(t,1))),"float32"))}function pd(e,t){return aQ(()=>{let n=ph(e,t),a=rP(n,aQ(()=>rM(il(iR(sn(e,0),sn(t,1))),"float32")));return rM(iM(se(a,0),rL(n,a),0),"float32")})}function pp(e,t){return pi(e,t)}function pf(e,t){return e.rank===t.rank&&(e=lQ(e,[e.rank-1])),(t=o3(t,-1)).dtype!==e.dtype&&(t=rM(t,e.dtype)),rM(sn(e,t),"float32")}let pm={binaryAccuracy:pc,categoricalAccuracy:pu,precision:pd,categoricalCrossentropy:pa,sparseCategoricalCrossentropy:pr,mse:pe,MSE:pe,mae:pt,MAE:pt,mape:pn,MAPE:pn,cosine:ps};function pg(e){if(cf(null!==e,"Unknown LossOrMetricFn ".concat(e)),"string"==typeof e)return e;{let t;for(let n of Object.keys(po))if(po[n]===e){t=n;break}if(void 0!==t)return t;for(let n of Object.keys(pm))if(pm[n]===e){t=n;break}return void 0!==t?t:e.name}}let px=class{static sgd(e){return new ie(e)}static momentum(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new it(e,t,n)}static rmsprop(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return new ia(e,t,n,a,r)}static adam(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new r3(e,t,n,a)}static adadelta(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new rJ(e,t,n)}static adamax(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.002,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return new r7(e,t,n,a,r)}static adagrad(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return new r0(e,t)}};function py(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||!function e(t){if(null===t)return!0;if("object"==typeof t)if(Object.getPrototypeOf(t)===Object.prototype){for(let n of Object.keys(t))if("string"!=typeof n||!e(t[n]))return!1;return!0}else{if(!Array.isArray(t))return!1;for(let n of t)if(!e(n))return!1;return!0}{let e=typeof t;return"string"===e||"number"===e||"boolean"===e}}(e))throw Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){let n=JSON.stringify(e);n.length>1048576&&console.warn('User-defined metadata of model "'.concat(t,'" is too large in ')+"size (length=".concat(n.length," when serialized). It is not ")+"recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= "+"".concat(1048576,"."))}}function pb(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log,a="";for(let n=0;n<e.length;++n)n>0&&(a=a.slice(0,a.length-1)+" "),a+=e[n],a=a.slice(0,t[n]),a+=" ".repeat(t[n]-a.length);n(a)}function pv(e,t,n){return("inboundNodes"===e||"outputLayers"===e||"inputLayers"===e)&&0===t&&"string"==typeof n}function pw(e,t){if(null===e)return null;if("string"==typeof e)return cb(e);if("number"==typeof e||"boolean"==typeof e)return e;if(e instanceof Array){let n=[],a=e.length;for(let r=0;r<a;++r){let a=e[r];pv(t,r,a)?n.push(a):n.push(pw(a,t))}return n}{let t={};for(let n of Object.keys(e)){let a=e[n];if("name"===n&&"string"==typeof a)t[n]=a;else{let e=cb(n);t[e]=pw(a,e)}}return t}}let pN="4.22.0";class pk extends h2{assertNotDisposed(){if(0===this._refCount)throw Error("Container '".concat(this.name,"' is already disposed."))}dispose(){this.assertNotDisposed();let e={refCountAfterDispose:null,numDisposedVariables:0};if(0==--this._refCount){for(let t of this.layers)e.numDisposedVariables+=t.dispose().numDisposedVariables;for(let t of this.internalContainerRefs)e.numDisposedVariables+=t.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(t=>{t._trainableWeights.forEach(t=>t.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new cc("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(let t of this.layers)e=e.concat(t.trainableWeights);return e}get nonTrainableWeights(){let e=[];for(let t of this.layers)e.push(...t.nonTrainableWeights);if(!this.trainable){let t=[];for(let e of this.layers)t.push(...e.trainableWeights);return t.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n={},a=0,r=(e=>{let t=Object.keys(e);if(0===t.length)return!1;let n=t[0].split("/");return!isNaN(parseInt(n[n.length-1],10))})(e);for(let t of(r&&this.parseWeights(e),this.layers))for(let[e,i]of t.weights.entries()){let t=r?"".concat(i.name.split("/").slice(0,-1).join("/")+"/").concat(e):i.originalName;if(null!=n[t])throw new cc("Duplicate weight name: ".concat(t));n[t]=i,a++}let i=[];for(let a in e){let r=a;if(null==n[a]){let e=a.split("/");r=e.slice(0,-2).concat([e[e.length-1]]).join("/")}if(null!=n[r])i.push([n[r],e[a]]);else if(t)throw new cc("Provided weight data has no target variable: ".concat(a));delete n[r]}if(t){let e=[];for(let t in n)e.push(t);if(e.length>0)throw new cc("".concat(e.length," of ").concat(a," weights are not set: ")+"".concat(e))}hZ(i)}parseWeights(e){for(let t in Object.keys(e)){let n=t.split("/"),a=["vars","layer_checkpoint_dependencies"],r=n.map(e=>e.startsWith("_")?e.slice(1):e).filter(e=>!a.includes(e)).join("/");r!==t&&(e[r]=e[t],delete e[t])}}updatedConfig(){let e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion="tfjs-layers ".concat(pN),t.backend="TensorFlow.js",t}toJSON(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=function e(t,n){if(null==t)return null;if("string"==typeof t)return cy(t);if("number"==typeof t||"boolean"==typeof t)return t;if(t instanceof Array){let a=[],r=t.length;for(let i=0;i<r;++i){let r=t[i];pv(n,i,r)?a.push(r):a.push(e(r,n))}return a}{let n={};for(let a of Object.keys(t)){let r=t[a],i=cy(a);("name"===a||"className"===a)&&"string"==typeof r?n[i]=r:n[i]=e(r,a)}return n}}(this.updatedConfig());return t?JSON.stringify(n):n}call(e,t){return aQ(()=>{e=cx(e);let n=new h5;for(let t=0;t<this.inputs.length;++t)n.add(this.inputs[t],e[t]);return h9(this.outputs,n,t)})}computeMask(e,t){return aQ(()=>{let n;return e=cx(e),n=null==t?cp(null,e.length):cx(t),this.runInternalGraph(e,n)[1]})}computeOutputShape(e){let t=hU(e);if(t.length!==this.inputLayers.length)throw new cc("Invalid inputShape argument ".concat(e,": ")+"model has ".concat(this.inputLayers.length," tensor inputs."));let n={};for(let e=0;e<t.length;e++){let a=this.inputLayers[e],r=t[e];n[a.name+"_0_0"]=r}let a=Object.keys(this.nodesByDepth).map(e=>parseInt(e,10)).sort(ck);if(a.length>1)for(let e of a)for(let t of this.nodesByDepth[e]){let e=t.outboundLayer;if(-1!==this.inputLayers.map(e=>e.id).indexOf(e.id))continue;let a=[];for(let e=0;e<t.inboundLayers.length;e++){let r=t.inboundLayers[e],i=t.nodeIndices[e],s=t.tensorIndices[e],o=n["".concat(r.name,"_").concat(i,"_").concat(s)];a.push(o)}let r=hU(e.computeOutputShape(cg(a))),i=e.inboundNodes.indexOf(t);for(let t=0;t<r.length;t++)n["".concat(e.name,"_").concat(i,"_").concat(t)]=r[t]}let r=[],i=[];for(let e=0;e<this.outputLayers.length;e++){let t=this.outputLayers[e],n=this.outputLayersNodeIndices[e],a=this.outputLayersTensorIndices[e],r="".concat(t.name,"_").concat(n,"_").concat(a);i.push(r)}for(let e=0;e<i.length;e++){let t=i[e];cf(t in n),r.push(n[t])}return cg(r)}runInternalGraph(e,t){null==t&&(t=cp(null,e.length));let n={};for(let a=0;a<this.inputs.length;++a){let r=this.inputs[a],i=e[a],s=t[a];n[r.id]=[i,s]}for(let e of Object.keys(this.nodesByDepth).map(e=>parseInt(e,10)).sort(ck))for(let t of this.nodesByDepth[e]){let e=t.outboundLayer,a=t.inputTensors,r=t.outputTensors,i=[];for(let e of a)e.id in n&&i.push(n[e.id]);if(i.length===a.length){let a,s,o,l,c={};if(null!=t.callArgs&&(c=t.callArgs),1===i.length){let[t,n]=i[0];null==c.mask&&(c.mask=n),o=cx(e.call(t,c)),l=cx(e.computeMask(t,n)),a=[t],s=[n]}else a=i.map(e=>e[0]),s=i.map(e=>e[1]),null==c.mask&&(c.mask=s),o=cx(e.call(a,c)),l=cx(e.computeMask(a,s));if(e.activityRegularizer)throw new cu("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let e=0;e<r.length;++e){let t=r[e],a=o[e],i=l[e];n[t.id]=[a,i]}}}let a=[],r=[],i=[];for(let e of this.outputs){cf(e.id in n,"Could not compute output ".concat(e.name," : ").concat(e.id));let[t,s]=n[e.id];i.push(t.shape),a.push(t),r.push(s)}return[a,r,i]}buildNodeConversionMap(e){let t,n={};for(let e of this.layers){t=+(e instanceof pk);for(let a=0;a<e.inboundNodes.length;a++){let r=pk.nodeKey(e,a);this.containerNodes.has(r)&&(n[r]=t,t+=1)}}return n}getLayer(e,t){if(null!=t)return this.findLayer(t);if(null==e)throw new cc("Provide either a layer name or layer index");if("number"==typeof e)return this.findLayer(e);for(let t of this.layers)if(t.name===e)return t;throw new cc("No such layer: ".concat(e))}findLayer(e){if(!(this.layers.length<=e))return this.layers[e];throw new cc("Was asked to retrieve layer at index ".concat(e,", but model only ")+"has ".concat(this.layers.length," layer(s)."))}calculateLosses(){return aQ(()=>{let e=[];for(let t of this.layers)for(let n=0;n<t.inboundNodes.length;++n){let a=pk.nodeKey(t,n);this.containerNodes.has(a)&&e.push(...t.calculateLosses())}return e})}getConfig(){let e={name:this.name},t=this.buildNodeConversionMap(this.layers),n=[];for(let e of this.layers){let a=e.getClassName(),r=e.getConfig(),i=[];for(let n=0;n<e.inboundNodes.length;n++){let a=e.inboundNodes[n],r=pk.nodeKey(e,n),s={};if(this.containerNodes.has(r)){if(a.callArgs)try{JSON.stringify(a.callArgs),s=a.callArgs}catch(t){console.warn("Layer ".concat(e.name," was passed ")+"non-serializable keyword arguments: "+"".concat(a.callArgs,". They will not be included ")+"in the serialized model (and thus will be missing at deserialization time)."),s={}}if(a.inboundLayers.length>0){let e=[];for(let n=0;n<a.inboundLayers.length;n++){let r=a.inboundLayers[n],i=a.nodeIndices[n],o=a.tensorIndices[n],l=t[pk.nodeKey(r,i)];null==l&&(l=0),e.push([r.name,l,o,s])}i.push(e)}}}let s={};s.name=e.name,s.className=a,s.config=r,s.inboundNodes=i,n.push(s)}e.layers=n;let a=[];for(let e=0;e<this.inputLayers.length;e++){let n=this.inputLayers[e],r=this.inputLayersNodeIndices[e],i=pk.nodeKey(n,r);if(!this.containerNodes.has(i))continue;let s=t[i];null==s&&(s=0);let o=this.inputLayersTensorIndices[e];a.push([n.name,s,o])}e.inputLayers=a;let r=[];for(let e=0;e<this.outputLayers.length;e++){let n=this.outputLayers[e],a=this.outputLayersNodeIndices[e],i=pk.nodeKey(n,a);if(!this.containerNodes.has(i))continue;let s=t[i];null==s&&(s=0);let o=this.outputLayersTensorIndices[e];r.push([n.name,s,o])}return e.outputLayers=r,e}static fromConfig(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a={},r={};function i(e,t){e.name in r?r[e.name].push(t):r[e.name]=[t]}let s=t.name,o=t.layers;for(let e of o){let r=e.name,s=d9(e,null!=t.customObjects?t.customObjects:{});s.setFastWeightInitDuringBuild(n),a[r]=s,e.inboundNodes.forEach(e=>{if(!(e instanceof Array))throw new cc("Corrupted configuration, expected array for nodeData: ".concat(e));i(s,e)})}for(;!function(e){if(null==e)throw new cc("Invalid value in obj: ".concat(JSON.stringify(e)));for(let t in e)if(e.hasOwnProperty(t))return!1;return!0}(r);)for(let e of o){let t=a[e.name];if(t.name in r){let e=r[t.name];for(let n of(delete r[t.name],e))!function(e,t){let n,r=[];for(let s of t){let o=s[0],l=s[1],c=s[2];if(n=null==s[3]?{}:s[3],!(o in a))return void i(e,t);let u=a[o];if(u.inboundNodes.length<=l)return void i(e,t);let h=u.inboundNodes[l];r.push(h.outputTensors[c])}r.length>0&&e.apply(cg(r),n)}(t,n)}}let l=[],c=[];for(let e of t.inputLayers){let t=e[0],n=e[1],r=e[2];cf(t in a);let i=a[t].inboundNodes[n].outputTensors;l.push(i[r])}for(let e of t.outputLayers){let t=e[0],n=e[1],r=e[2];cf(t in a);let i=a[t].inboundNodes[n].outputTensors;c.push(i[r])}return new e({inputs:l,outputs:c,name:s})}get stateful(){if(this._stateful)throw new cc("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(let e of this.layers)if(e.stateful)return!0;return!1}resetStates(){aQ(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,null==this.name){let e=this.getClassName().toLowerCase();this.name=cD(e)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],cS(this.inputs).length!==this.inputs.length)throw new cc("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+"".concat(this.inputs.map(e=>e.name)));for(let e of(cS(this.outputs).length!==this.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+"".concat(this.outputs.map(e=>e.name))),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[],this.outputs)){let t=e.sourceLayer,n=e.nodeIndex,a=e.tensorIndex;this.outputLayers.push(t),this.outputLayersNodeIndices.push(n),this.outputLayersTensorIndices.push(a)}for(let e of this.inputs){let t=e.sourceLayer,n=e.nodeIndex,a=e.tensorIndex;cf(0===n,"input layer has >1 nodes"),cf(0===a,"input layer has >1 tensors"),this.inputLayers.push(t),this.inputLayersNodeIndices.push(n),this.inputLayersTensorIndices.push(a)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let t=0;t<this.inputLayers.length;t++){let n=this.inputLayers[t];if(!(n instanceof h3))throw TypeError("Input layers to a LayersModel must be InputLayer objects. "+"Received inputs: ".concat(e.inputs,". ")+"Input ".concat(t," (0-based) originates ")+"from layer type ".concat(n.getClassName(),"."));this.inputNames.push(n.name),this.feedInputShapes.push(n.batchInputShape),this.feedInputNames.push(n.name)}for(let e of this.outputLayers)this.outputNames.push(e.name);this.internalInputShapes=this.inputs.map(e=>e.shape),this.internalOutputShapes=this.outputs.map(e=>e.shape);let t={},n={},a={},r={},i={},s=[],o=(e,t,n,a,r,l)=>{(null==a||null==r||null==l)&&(a=e.sourceLayer,r=e.nodeIndex,l=e.tensorIndex);let c=a.inboundNodes[r];if(-1!==n.indexOf(c))throw new cl("The tensor ".concat(e.name,' at layer "').concat(a.name,'" ')+"is part of a cycle.");if(-1!==t.indexOf(c))return;this.containerNodes.add(pk.nodeKey(a,r)),a.id in i||(i[a.id]=Object.keys(i).length),-1===n.indexOf(c)&&n.push(c);let u=c.inboundLayers.length;for(let e=0;e<u;e++){let a=c.inputTensors[e],r=c.inboundLayers[e];o(a,t,n,r,c.nodeIndices[e],c.tensorIndices[e])}for(t.push(c);n.indexOf(c)>=0;)n.splice(n.indexOf(c),1);s.push(c)},l=[],c=[];for(let e of this.outputs)o(e,l,c);for(let e of s.slice().reverse()){n[e.id]=e,e.id in t||(t[e.id]=0);let i=t[e.id];i=Math.max(i,null==a[e.outboundLayer.id]?0:a[e.outboundLayer.id]),a[e.outboundLayer.id]=i,r[e.outboundLayer.id]=e.outboundLayer,t[e.id]=i;for(let a=0;a<e.inboundLayers.length;a++){let r=e.inboundLayers[a],s=e.nodeIndices[a],o=r.inboundNodes[s],l=null==t[o.id]?0:t[o.id];t[o.id]=Math.max(i+1,l),n[o.id]=o}}let u={};for(let e in t){let a=t[e];a in u||(u[a]=[]),u[a].push(n[e])}let h={};for(let e in a){let t=a[e];t in h||(h[t]=[]),h[t].push(r[e])}let d=Object.keys(h).map(e=>parseInt(e,10)).sort(ck);for(let e of(this.layers=[],d)){let t=h[e];for(let e of(t.sort((e,t)=>{let n=i[e.id],a=i[t.id];return n<a?-1:+(n>a)}),t))e instanceof pk&&this.internalContainerRefs.push(e),this.layers.push(e)}this.layersByDepth=h,d=Object.keys(u).map(e=>parseInt(e,10)).sort(ck);let p=this.inputs.slice(),f=[];for(let e of d)for(let t of u[e]){let e=t.outboundLayer;if(null!=e){for(let n of t.inputTensors)if(-1===p.indexOf(n))throw new cl("Graph disconnected: cannot obtain value for tensor ".concat(n)+' at layer "'.concat(e.name,'". ')+"The following previous layers were accessed without "+"issue: ".concat(f));for(let e of t.outputTensors)p.push(e);f.push(e.name)}}this.nodesByDepth=u;let m=this.layers.map(e=>e.name);for(let e of m){let t=m.filter(t=>t===e).length;if(1!==t)throw new cl('The name "'.concat(e,'" is used ').concat(t," times ")+"in the model. All layer names should be unique. Layer names: "+JSON.stringify(m))}this.outboundNodes=[],this.inboundNodes=[],new h0({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(e=>null),outputMasks:this.outputs.map(e=>null),inputShapes:this.inputs.map(e=>e.shape),outputShapes:this.outputs.map(e=>e.shape)}),this.built=!0,this._refCount=1}}var cs=cs;function pS(e,t){var n="classWeight";let a=t.length;if(null==e||Array.isArray(e)&&0===e.length)return t.map(e=>null);if(1===a)if(Array.isArray(e)&&1===e.length)return e;else if("object"==typeof e&&t[0]in e)return[e[t[0]]];else return[e];if(Array.isArray(e)){if(e.length!==a)throw Error("Provided ".concat(n," is an array of ").concat(e.length," ")+"element(s), but the model has ".concat(a," outputs. ")+"Make sure a set of weights is provided for each model output.");return e}if("object"==typeof e&&Object.keys(e).length>0&&"object"==typeof e[Object.keys(e)[0]]){let n=[];return t.forEach(t=>{t in e?n.push(e[t]):n.push(null)}),n}throw Error("The model has multiple (".concat(a,") outputs, ")+"so ".concat(n," must be either an array with ")+"".concat(a," elements or an object with ").concat(t," keys. ")+"Provided ".concat(n," not understood: ").concat(JSON.stringify(e)))}async function pC(e,t,n,a){if(null!=t||null!=a)throw Error("Support sampleWeight is not implemented yet");if(null==n)return null;{let t=aQ(()=>{if(1===e.shape.length)return rF(e);if(2===e.shape.length)if(e.shape[1]>1)return o3(e,1);else if(1===e.shape[1])return io(e,[e.shape[0]]);else throw Error("Encountered unexpected last-dimension size (".concat(e.shape[1],") ")+"during handling of class weights. The size is expected to be >= 1.");throw Error("Unexpected rank of target (y) tensor (".concat(e.rank,") during ")+"handling of class weights. The rank is expected to be 1 or 2.")}),a=Array.from(await t.data());aJ(t);let r=[];return a.forEach(e=>{if(null==n[e])throw Error("classWeight must contain all classes in the training data. "+"The class ".concat(e," exists in the data but not in ")+"classWeight");r.push(n[e])}),c$(r,"float32")}}function pT(e,t){let n,a;n=t.xs,a=t.ys,cs.assert(null!=n&&null!=a,()=>"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+"".concat(t));let r=pI("input",e.inputNames,n),i=pI("output",e.outputNames,a),s=r[0].shape[0];cs.assert(r.length===e.inputs.length,()=>"LayersModel has ".concat(e.inputs.length," inputs, but the dataset ")+"provides ".concat(r.length," inputs.  (Expected input keys: ")+"".concat(JSON.stringify(e.inputNames),")")),cs.assert(i.length===e.outputs.length,()=>"LayersModel has ".concat(e.outputs.length," outputs, but the dataset ")+"provides ".concat(i.length," outputs.  (Expected output keys: ")+"".concat(JSON.stringify(e.outputNames),")"));for(let t=0;t<r.length;t++)cs.assert(r[t].shape[0]===s,()=>"Batch size mismatch: input "+"".concat(e.inputNames[t]," has ").concat(r[t].shape[0],"; ")+"expected  ".concat(s," based on input ").concat(e.inputNames[0],"."));for(let t=0;t<i.length;t++)cs.assert(i[t].shape[0]===s,()=>"Batch size mismatch: output "+"".concat(e.outputNames[t]," has ").concat(i[t].shape[0],"; ")+"expected  ".concat(s," based on input ").concat(e.inputNames[0],"."));return{xs:r,ys:i}}function pI(e,t,n){if(n instanceof am)return[n];if(Array.isArray(n))return cs.assert(n.length===t.length,()=>"Received an array of ".concat(n.length," Tensors, but expected ").concat(t.length," to match the ").concat(e," keys ").concat(t,".")),n;{let a=[];for(let r of t){if(null==n[r])throw new cc("The feature data generated by the dataset lacks the required "+"".concat(e," key '").concat(r,"'."));a.push(n[r])}return a}}async function pE(e,t,n){let a=null!=n.batchesPerEpoch;if(cs.assert(null!=e.optimizer,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),cs.assert(null!=n,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),cs.assert(null!=n.epochs&&n.epochs>0&&Number.isInteger(n.epochs),()=>"For fitDataset(), config.epochs is expected to be a positive "+"integer, but got ".concat(n.epochs)),cs.assert(!a||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>"For fitDataset(), config.batchesPerEpoch is expected to be a "+"positive integer if specified, but got ".concat(n.batchesPerEpoch)),cs.assert(null==n.validationSplit,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),e.isTraining)throw Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0;try{var r,i;let s,o,l,c,u=null!=n.validationData;if(u)if(p_(n.validationData))cs.assert(null==n.validationBatches||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, "+"but got ".concat(n.validationBatches));else{let e=function(e){if(3===e.length)throw new cu("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}(n.validationData);s=e.xs,o=e.ys}let h=e.makeTrainFunction(),d=e.getDedupedMetricsNames();l=u?d.slice().concat(d.map(e=>"val_"+e)):d.slice();let p=dL(n.callbacks,n.yieldEvery),f=null==n.verbose?1:n.verbose,{callbackList:m,history:g}=dB(p,f,n.epochs,null,null,(r=t,i=n,c=null,null!=i.batchesPerEpoch?c=i.batchesPerEpoch:Number.isFinite(r.size)&&(c=r.size),c),null,u,l);m.setModel(e),e.history=g,await m.onTrainBegin(),e.stopTraining_=!1;let x=null==n.initialEpoch?0:n.initialEpoch,y=await t.iterator();for(;x<n.epochs;){let r={};await m.onEpochBegin(x);let i=0,l=0;for(a||(y=await t.iterator());!a||i<n.batchesPerEpoch;){let t=await y.next();if(a&&t.done){console.warn("You provided `batchesPerEpoch` as "+"".concat(n.batchesPerEpoch,", ")+"but your dataset iterator ran out of data after "+"".concat(i," batches; ")+"interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+"".concat(n.batchesPerEpoch*n.epochs," batches). ")+"You may need to use the repeat() function when building your dataset.");break}if(null!=t.value){let{xs:a,ys:r}=pT(e,t.value),s={};s.batch=l,s.size=a[0].shape[0],await m.onBatchBegin(l,s);let o=[];if(null!=n.classWeight){let t=pS(n.classWeight,e.outputNames);for(let e=0;e<t.length;++e)o.push(await pC(r[e],null,t[e]))}let c=a.concat(r).concat(o),u=h(c);aJ(c);for(let e=0;e<d.length;++e){let t=d[e],n=u[e];s[t]=n,a$(n)}await m.onBatchEnd(l,s),dD(s),l++,i++}if(a?i>=n.batchesPerEpoch:t.done){if(u){let t;t=p_(n.validationData)?cx(await e.evaluateDataset(n.validationData,{batches:n.validationBatches})):cx(e.evaluate(s,o,{batchSize:null==n.validationBatchSize?32:n.validationBatchSize,verbose:0}));for(let n=0;n<e.metricsNames.length;++n)r["val_".concat(e.metricsNames[n])]=t[n]}break}if(e.stopTraining_)break}if(await m.onEpochEnd(x,r),x++,e.stopTraining_)break}return await m.onTrainEnd(),await e.history.syncData(),e.history}finally{e.isTraining=!1}}function p_(e){return"function"==typeof e.iterator}async function pA(e,t,n){let a=null!=(n=n||{}).batches,r=e.testFunction,i=[];if(n.verbose>0)throw new cu("Verbose mode is not implemented yet.");cs.assert(!a||n.batches>0&&Number.isInteger(n.batches),()=>"Test loop expects `batches` to be a positive integer, but "+"received ".concat(JSON.stringify(n.batches)));let s="function"==typeof t.next?t:await t.iterator(),o=0,l=0;for(;!a||l<n.batches;){let t=await s.next();if(i=aQ(()=>{if(t.value){let{xs:n,ys:a}=pT(e,t.value),s=n.concat(a),c=aQ(()=>r(s));if(aJ(s),0===l)for(let e=0;e<c.length;++e)i.push(rG(0));let u=s[0].shape[0];for(let e=0;e<c.length;++e){let t=c[e],n=i[e];i[e]=aQ(()=>rP(i[e],rz(u,t))),l>0&&aJ(n)}aJ(c),o+=u,++l}return i}),t.done){a&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` "+"batches (in this case, ".concat(n.batches," batches). ")+"You may need to use the repeat() function when building your dataset.");break}}for(let e=0;e<i.length;++e){let t=i[e];i[e]=rL(i[e],o),aJ(t)}return cg(i)}var cs=cs;function pR(e){cs.assert(e>0&&Number.isInteger(e),()=>"batchSize is required to be a positive integer, but got ".concat(e))}function pD(e,t,n){return null==e?[null]:Array.isArray(e)?e.map(e=>hl(e,t,n-t)):hl(e,t,n-t)}function pM(e,t){return aQ(()=>null==e?null:Array.isArray(e)?e.map(e=>pM(e,t)):hg(e,"int32"===t.dtype?t:rM(t,"int32")))}function pF(e,t){let n=[],a=0,r=null;for(;a<e;)(r=a+t)>=e&&(r=e),n.push([a,r]),a=r;return n}function pO(e){let t=[];e instanceof am&&(e=[e]);for(let n=0;n<e.length;++n){let a=e[n];if(1===a.rank)t.push(ho(a,1));else if(0===a.rank)throw Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");else t.push(a)}return t}function pP(e,t){if(null==e)return;let n=[];if(t instanceof am)n.push(t.id);else if(Array.isArray(t))t.forEach(e=>n.push(e.id));else if(null!=t)for(let e in t){let a=t[e];n.push(a.id)}let a=[];if(e instanceof am)-1===n.indexOf(e.id)&&a.push(e);else if(Array.isArray(e))e.forEach(e=>{-1===n.indexOf(e.id)&&a.push(e)});else if(null!=e)for(let t in e){let r=e[t];-1===n.indexOf(r.id)&&a.push(r)}a.forEach(e=>{e.isDisposed||e.dispose()})}function pj(e){return Array.isArray(e)}function pL(e){return!(e instanceof am)&&!pj(e)}function pz(e,t,n){let a,r=!(arguments.length>3)||void 0===arguments[3]||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(null==t||0===t.length){if(null!=e){let t=!1;if(pj(e)&&e.length>0)t=!0;else if(pL(e)){for(let n in e)if(e.hasOwnProperty(n)){t=!0;break}}else t=!0;if(t)throw new cc("Error when checking model ".concat(i," expected no data, ")+"but got ".concat(e))}return[]}if(null==e)return t.map(e=>null);if(pL(e))for(let n of(a=[],t)){if(null==e[n])throw new cc('No data provided for "'.concat(n,'". Need data for each key in: ')+"".concat(t));a.push(e[n])}else if(pj(e)){if(e.length!==t.length)throw new cc("Error when checking model ".concat(i,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"model expected. Expected to see ".concat(t.length," Tensor(s), but ")+"instead got the following list of Tensor(s): ".concat(e));a=e}else{if(t.length>1)throw new cc("The model ".concat(i," expects ").concat(t.length," Tensor(s), ")+"but only received one Tensor. Found: Tensor with shape ".concat(e.shape));a=[e]}if(a=pO(a),null!=n)for(let e=0;e<t.length;++e){if(null==n[e])continue;let s=a[e];if(s.shape.length!==n[e].length)throw new cc("Error when checking ".concat(i,": expected ").concat(t[e]," ")+"to have ".concat(n[e].length," dimension(s). but got array with ")+"shape ".concat(s.shape));for(let t=0;t<n[e].length;++t){if(0===t&&!r)continue;let a=s.shape[t],o=n[e][t];if(null!=o&&o>=0&&a!==o)throw new cc("".concat(i," expected a batch of elements where each ")+"example has shape [".concat(n[e].slice(1,n[e].length),"] ")+"(i.e.,tensor shape [*,".concat(n[e].slice(1,n[e].length),"])")+" but the ".concat(i," received an input with ").concat(s.shape[0])+" examples, each with shape [".concat(s.shape.slice(1,s.shape.length),"]")+" (tensor shape [".concat(s.shape,"])"))}}return a}function pB(e,t,n){let a,r=!(arguments.length>3)||void 0===arguments[3]||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(Array.isArray(e)){if(e.length!==t.length)throw new cc("Error when checking model ".concat(i,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"the model expected. Expected to see ".concat(t.length," Tensor(s),")+" but instead got ".concat(e.length," Tensors(s)."));a=e}else{if(t.length>1)throw new cc("The model expects ".concat(t.length," ").concat(i," Tensors, ")+"but only received one Tensor. Found: array with shape "+"".concat(JSON.stringify(e.shape),"."));a=[e]}if(null!=n)for(let e=0;e<t.length;++e){if(null==n[e])continue;let s=a[e];if(s.shape.length!==n[e].length)throw new cc("Error when checking ".concat(i,": expected ").concat(t[e]," ")+"to have ".concat(n[e].length," dimension(s), but got array with ")+"shape ".concat(JSON.stringify(s.shape)));for(let a=0;a<n[e].length;++a){if(0===a&&!r)continue;let o=s.shape[a],l=n[e][a];if(null!=l&&l!==o)throw new cc("Error when checking ".concat(i,": expected ")+"".concat(t[e]," to have shape ").concat(JSON.stringify(n[e])," but ")+"got array with shape ".concat(JSON.stringify(s.shape),"."))}}}class pV extends pk{summary(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;if(!this.built)throw new cc("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");!function(e,t,n){var a;let r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:console.log,s=function(e){let t=!0,n=[],a=[];for(let t in e.nodesByDepth)n.push(e.nodesByDepth[t]);for(let e of n){if(e.length>1||1===e.length&&e[0].inboundLayers.length>1){t=!1;break}a.push(...e)}if(t)for(let n of e.layers){let e=!1;for(let r of n.inboundNodes)if(-1!==a.indexOf(r))if(e){t=!1;break}else e=!0;if(!t)break}return t}(e),o=["Layer (type)","Input Shape","Output shape","Param #"];if(s?(t=t||90,n=n||[.32,.61,.89,1]):(t=t||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(e=>Math.floor(t*e))),!s)for(let t in o.push("Receives inputs"),r=[],e.nodesByDepth)r.push(...e.nodesByDepth[t]);i("_".repeat(t)),pb(o,n,i),i("=".repeat(t));let l=e.layers;for(let e=0;e<l.length;++e)s?function(e,t,n){let a,r;try{r=e.inboundNodes.map(e=>JSON.stringify(e.inputShapes)).join(",")}catch(e){r="multiple"}try{a=JSON.stringify(e.outputShape)}catch(e){a="multiple"}let i=e.name,s=e.getClassName();pb(["".concat(i," (").concat(s,")"),r,a,e.countParams().toString()],t,n)}(l[e],n,i):function(e,t,n,a){let r,i;try{i=e.inboundNodes.map(e=>JSON.stringify(e.inputShapes)).join(",")}catch(e){i="multiple"}try{r=JSON.stringify(e.outputShape)}catch(e){r="multiple"}let s=[];for(let t of e.inboundNodes)if(null==n||!(n.length>0)||-1!==n.indexOf(t))for(let e=0;e<t.inboundLayers.length;++e){let n=t.inboundLayers[e].name,a=t.nodeIndices[e],r=t.tensorIndices[e];s.push("".concat(n,"[").concat(a,"][").concat(r,"]"))}let o=e.name,l=e.getClassName(),c=0===s.length?"":s[0];pb(["".concat(o," (").concat(l,")"),i,r,e.countParams().toString(),c],t,a);for(let e=1;e<s.length;++e)pb(["","","","",s[e]],t,a)}(l[e],n,r,i),i((e===l.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();let c=null!=(a=e).collectedTrainableWeights?hH(a.collectedTrainableWeights):hH(a.trainableWeights),u=hH(e.nonTrainableWeights);i("Total params: ".concat(c+u)),i("Trainable params: ".concat(c)),i("Non-trainable params: ".concat(u)),i("_".repeat(t))}(this,e,t,n)}compile(e){if(null==e.loss&&(e.loss=[]),this.loss=e.loss,"string"==typeof e.optimizer)this.optimizer_=function(e){let t={Adagrad:()=>px.adagrad(.01),Adadelta:()=>px.adadelta(1,.95,hi()),Adam:()=>px.adam(.001,.9,.999,hi()),Adamax:()=>px.adamax(.002,.9,.999,hi(),0),RMSProp:()=>px.rmsprop(.001,.9,0,hi()),SGD:()=>px.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new cc("Unknown Optimizer ".concat(e))}(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof rQ))throw new cc("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let t=[];if(Array.isArray(e.loss)||"string"==typeof e.loss||"function"==typeof e.loss)if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new cc("When passing an Array as loss, it should have one entry per "+"model output. The model has ".concat(this.outputs.length," output(s), ")+"but you passed loss=".concat(e.loss,"."));t=e.loss.map(e=>pl(e))}else{let n=pl(e.loss);this.outputs.forEach(e=>{t.push(n)})}else{for(let t in e.loss=e.loss,e.loss)if(-1===this.outputNames.indexOf(t))throw new cc('Unknown entry in loss dictionary: "'.concat(t,'". ')+"Only expected the following keys: ".concat(this.outputNames));for(let n of this.outputNames)null==e.loss[n]&&console.warn('Output "'.concat(n,'" is missing from loss dictionary. We assume ')+"this was done on purpose, and we will not be expecting data "+"to be passed to ".concat(n," during training")),t.push(pl(e.loss[n]))}this.lossFunctions=t,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let e=0;e<this.outputs.length;++e){let t=this.internalOutputShapes[e],n=this.outputNames[e];this.feedOutputNames.push(n),this.feedOutputShapes.push(t),this.feedLossFns.push(this.lossFunctions[e])}let n=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],cW("loss",()=>{for(let e=0;e<this.outputs.length;++e){if(-1!==n.indexOf(e))continue;let t=this.lossFunctions[e];this.outputs.length>1&&(this.metricsTensors.push([t,e]),this.metricsNames.push(this.outputNames[e]+"_loss"))}});let a=function(e,t){let n;if(null==e||Array.isArray(e)&&0===e.length)return t.map(e=>[]);if("string"==typeof e||"function"==typeof e)n=[e];else if(Array.isArray(e)||"object"==typeof e)n=e;else throw TypeError("Type of metrics argument not understood. Expected an string,"+"function, Array, or Object, found: ".concat(e));if(Array.isArray(n))return t.map(e=>n);{let e=[];for(let a of t){let t=n.hasOwnProperty(a)?n[a]:[];Array.isArray(t)||(t=[t]),e.push(t)}return e}}(e.metrics,this.outputNames),r=(e,t,n)=>{this.outputNames.length>1&&(t=this.outputNames[e]+"_"+t),this.metricsNames.push(t),this.metricsTensors.push([n,e])};cW("metric",()=>{for(let e=0;e<this.outputs.length;++e){if(-1===n.indexOf(e))(t=>{let n,a,i;for(let s of t){let t;if("string"==typeof s&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(s)){let t,r=this.internalOutputShapes[e];1===r[r.length-1]||this.lossFunctions[e]===pi?-1!==["accuracy","acc"].indexOf(s)?a=pc:-1!==["crossentropy","ce"].indexOf(s)&&(a=pp):this.lossFunctions[e]===pr?-1!==["accuracy","acc"].indexOf(s)?a=pf:-1!==["crossentropy","ce"].indexOf(s)&&(a=pr):-1!==["accuracy","acc"].indexOf(s)?a=pu:-1!==["crossentropy","ce"].indexOf(s)&&(a=pa),-1!==["accuracy","acc"].indexOf(s)?t="acc":-1!==["crossentropy","ce"].indexOf(s)&&(t="ce"),i=a,n=""+t}else i=function(e){if("string"==typeof e&&e in pm)return pm[e];if("string"!=typeof e&&null!=e)return e;throw new cc("Unknown metric ".concat(e))}(s),n=""+pg(s);cW(n,()=>{t=i}),r(e,n,t)}})(a[e])}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=null==n.batchSize?32:n.batchSize;pR(a);let r=this.standardizeUserDataXY(e,t,!0,a);try{let e=r[0].concat(r[1]);this.makeTestFunction();let t=this.testFunction,i=this.testLoop(t,e,a,n.verbose,n.steps);return cg(i)}finally{pP(r[0],e),pP(r[1],t)}}async evaluateDataset(e,t){return this.makeTestFunction(),pA(this,e,t)}checkNumSamples(e,t,n){let a,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"steps";if(null!=n){if(a=null,null!=t)throw new cc("If ".concat(r," is set, batchSize must be null or undefined.")+"Got batchSize = ".concat(t))}else if(null!=e)a=Array.isArray(e)?e[0].shape[0]:e.shape[0];else throw new cc("Either the input data should have a defined shape, or "+"".concat(r," shoud be specified."));return a}execute(e,t){if(Array.isArray(t)&&0===t.length)throw new cc("`outputs` is an empty Array, which is not allowed.");let n=Array.isArray(t),a=n?t:[t],r=this.retrieveSymbolicTensors(a),i=new h5;if(e instanceof am&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new cc("The number of inputs provided (".concat(e.length,") ")+"does not match the number of inputs of this model "+"(".concat(this.inputs.length,")."));for(let t=0;t<this.inputs.length;++t)i.add(this.inputs[t],e[t])}else for(let t of this.inputs){let n=e[t.name];if(null==n)throw new cc("No value is provided for the model's input ".concat(t.name));i.add(t,n)}let s=h9(r,i);return n?s:s[0]}retrieveSymbolicTensors(e){let t=cp(null,e.length),n=e.length;for(let a of this.layers){let r=Array.isArray(a.output)?a.output:[a.output],i=r.map(e=>e.name);for(let a=0;a<e.length;++a){let s=i.indexOf(e[a]);if(-1!==s&&(t[a]=r[s],n--),0===n)break}if(0===n)break}if(n>0){let n=[];throw t.forEach((t,a)=>{null==t&&n.push(e[a])}),new cc("Cannot find SymbolicTensors for output name(s): "+"".concat(JSON.stringify(n)))}return t}predictLoop(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return aQ(()=>{let a=this.checkNumSamples(e);if(n)throw new cu("Verbose predictLoop() is not implemented yet.");let r=pF(a,t),i=this.outputs.map(e=>[]);for(let t=0;t<r.length;++t)aQ(()=>{let n=pD(e,r[t][0],r[t][1]),a=[];if(Array.isArray(n))for(let e=0;e<n.length;++e)a.push({key:this.inputs[e],value:n[e]});else a.push({key:this.inputs[0],value:n});let i=new h5(a);return h9(this.outputs,i)}).forEach((e,t)=>i[t].push(e));return cg(i.map(e=>oY(e,0)))})}predict(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=pO(e);pB(n,this.inputNames,this.feedInputShapes,!1);try{let e=null==t.batchSize?32:t.batchSize;return pR(e),this.predictLoop(n,e)}finally{pP(n,e)}}predictOnBatch(e){pB(e,this.inputNames,this.feedInputShapes,!0);let t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}standardizeUserDataXY(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];let n=arguments.length>3?arguments[3]:void 0;if(null==this.optimizer_)throw new cl("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");let a=[];for(let e=0;e<this.feedOutputShapes.length;++e){let t=this.feedOutputShapes[e];this.feedLossFns[e]===pr?a.push(t.slice(0,t.length-1).concat([1])):a.push(t)}e=pz(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=pz(t,this.feedOutputNames,a,!1,"target");var r=e,i=t;let s=cS(r.map(e=>e.shape[0]));s.sort();let o=cS(i.map(e=>e.shape[0]));if(o.sort(),s.length>1)throw new cc("All input Tensors (x) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(r.map(e=>e.shape))));if(o.length>1)throw new cc("All target Tensors (y) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(i.map(e=>e.shape))));if(s.length>0&&o.length>0&&!cs.arraysEqual(s,o))throw new cc("Input Tensors should have the same number of samples as target "+"Tensors. Found ".concat(s[0]," input sample(s) and ").concat(o[0]," target ")+"sample(s).");if(!function(e,t,n){let a=[pe,pi,pa];for(let r=0;r<e.length;++r){let i=e[r],s=t[r],o=n[r];if(null!=s){if(s===pa&&1===i.shape[i.shape.length-1])throw new cc("You are passing a target array of shape ".concat(i.shape," while using ")+"a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(-1!==a.indexOf(s)){let e=i.shape.slice(1),t=o.slice(1);for(let n=0;n<e.length;++n){let a=e[n],r=t[n];if(null!=r&&a!==r)throw new cc("A target Tensor with shape ".concat(i.shape," was passed for an ")+"output of shape ".concat(o,", while using a loss function that ")+"expects targets to have the same shape as the output.")}}}}}(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=n&&n>0&&e[0].shape[0]%n!=0)throw new cc("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+"".concat(n,". Found: ").concat(e[0].shape[0]," sample(s)."));return[e,t]}async standardizeUserData(e,t,n,a){let r=!(arguments.length>4)||void 0===arguments[4]||arguments[4],i=arguments.length>5?arguments[5]:void 0,[s,o]=this.standardizeUserDataXY(e,t,r,i);if(null!=n)throw Error("sample weight is not supported yet.");let l=null;if(null!=a){let e=pS(a,this.outputNames);l=[];for(let t=0;t<e.length;++t)l.push(await pC(o[t],null,e[t]))}return[s,o,l]}testLoop(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4?arguments[4]:void 0;return aQ(()=>{let i=this.checkNumSamples(t,n,r,"steps"),s=[];if(a>0)throw new cu("Verbose mode is not implemented yet.");if(null!=r)throw new cu("steps mode in testLoop() is not implemented yet");{let a=pF(i,n),r=c$(hr(0,i));for(let n=0;n<a.length;++n){let i=a[n][0],o=a[n][1],l=e(pM(t,hl(r,i,o-i)));if(0===n)for(let e=0;e<l.length;++e)s.push(rG(0));for(let e=0;e<l.length;++e){let t=l[e];s[e]=rP(s[e],rz(o-i,t))}}for(let e=0;e<s.length;++e)s[e]=rL(s[e],i)}return s})}getDedupedMetricsNames(){let e=this.metricsNames,t=[];for(let n=0;n<e.length;++n){let a=e[n],r=a;if(cm(e,a)>1){let t=cm(e.slice(0,n),a);r+="_".concat(t)}t.push(r)}return t}makeTrainFunction(){return e=>{let t=[],n=e.slice(0,this.inputs.length),a=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),r=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+2*this.outputs.length),i=[],s=()=>{let e,s=[];for(let e=0;e<this.inputs.length;++e)s.push({key:this.inputs[e],value:n[e]});let o=new h5(s),l=h9(this.outputs,o,{training:!0});for(let n=0;n<this.lossFunctions.length;++n){let i=(0,this.lossFunctions[n])(a[n],l[n]);null!=r[n]&&(i=rz(i,r[n]));let s=lD(i);t.push(s),e=0===n?i:rP(e,i)}for(let e=0;e<this.metricsTensors.length;++e){let n;if(this.outputs.length>1&&e<this.outputs.length)n=t[e];else{let t=this.metricsTensors[e][0],r=this.metricsTensors[e][1];n=lD(t(a[r],l[r]))}a$(n),i.push(n)}return e=lD(e),this.calculateLosses().forEach(t=>{e=rP(e,t)}),e},o=this.collectedTrainableWeights.map(e=>e.read());return[this.optimizer_.minimize(s,!0,o)].concat(i)}}makeTestFunction(){this.testFunction=e=>aQ(()=>{let t,n=[],a=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=[];for(let e=0;e<this.inputs.length;++e)i.push({key:this.inputs[e],value:a[e]});let s=new h5(i),o=h9(this.outputs,s);for(let e=0;e<this.lossFunctions.length;++e){let a=lD((0,this.lossFunctions[e])(r[e],o[e]));t=0===e?a:rP(t,a),n.push(t)}for(let e=0;e<this.metricsTensors.length;++e){let t=this.metricsTensors[e][0],a=this.metricsTensors[e][1],i=lD(t(r[a],o[a]));n.push(i)}return n})}async fit(e,t){let n,a,r,i,s,o,l,c,u,h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.isTraining)throw Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;try{let d,p,f,m=null==h.batchSize?32:h.batchSize;pR(m);let g=await this.standardizeUserData(e,t,h.sampleWeight,h.classWeight,!1,m);n=g[0],a=g[1],u=g[2];let x=!1;if(null!=h.validationData&&h.validationData.length>0){if(x=!0,2===h.validationData.length)s=h.validationData[0],o=h.validationData[1];else if(3===h.validationData.length)throw new cu("validationData including sample weights is not supported yet.");else throw new cc("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+"".concat(h.validationData," is invalid."));let e=await this.standardizeUserData(s,o,null,null,!0,m);l=e[0],c=e[1],d=l.concat(c)}else if(null!=h.validationSplit&&h.validationSplit>0&&h.validationSplit<1){x=!0;let e=Math.floor(n[0].shape[0]*(1-h.validationSplit)),t=n[0].shape[0];l=pD(n,e,t),r=n,n=pD(n,0,e),c=pD(a,e,t),i=a,a=pD(a,0,e),d=l.concat(c)}else null!=h.validationSteps&&(x=!0);let y=n.concat(a).concat(u);this.checkTrainableWeightsConsistency();let b=this.makeTrainFunction(),v=this.getDedupedMetricsNames();x?(this.makeTestFunction(),p=this.testFunction,f=v.slice().concat(v.map(e=>"val_"+e))):(p=null,d=[],f=v.slice());let w=dL(h.callbacks,h.yieldEvery);return await this.fitLoop(b,y,v,m,h.epochs,h.verbose,w,p,d,h.shuffle,f,h.initialEpoch,null,null)}finally{this.isTraining=!1,pP(n,e),pP(a,t),pP(r,e),pP(i,t),pP(l,s),pP(c,o),null!=u&&aJ(u)}}async fitLoop(e,t,n,a,r,i,s,o,l,c,u,h,d,p){let f;null==a&&(a=32),null==r&&(r=1),null==c&&(c=!0),null==h&&(h=0);let m=!1;if(null!=o&&null!=l&&(m=!0),null!=p&&(m=!0,null==d))throw new cc("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");let g=this.checkNumSamples(t,a,d,"steps_per_epoch");null!=g&&(f=hr(0,g)),null==i&&(i=1);let{callbackList:x,history:y}=dB(s,i,r,h,g,d,a,m,u);x.setModel(this),this.history=y,await x.onTrainBegin(),this.stopTraining_=!1;for(let i=h;i<r;++i){await x.onEpochBegin(i);let r={};if(null!=d)throw new cu("stepsPerEpoch mode is not implemented yet.");{if("batch"===c)throw new cu("batch shuffling is not implemneted yet");c&&cs.shuffle(f);let i=c$(f),s=pF(g,a);for(let c=0;c<s.length;++c){let u={};if(await x.onBatchBegin(c,u),aQ(()=>{let h=s[c][0],d=s[c][1],p=hl(i,h,d-h);u.batch=c,u.size=d-h;let f=e(pM(t,p));for(let e=0;e<n.length;++e){let t=n[e],a=f[e];u[t]=a,a$(a)}if(c===s.length-1&&m){let e=this.testLoop(o,l,a);for(let t=0;t<n.length;++t){let a=n[t],i=e[t];a$(i),r["val_"+a]=i}}}),await x.onBatchEnd(c,u),dD(u),this.stopTraining_)break}i.dispose()}if(await x.onEpochEnd(i,r),this.stopTraining_)break}return await x.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,t){return pE(this,e,t)}async trainOnBatch(e,t){let n=await this.standardizeUserData(e,t),a=n[0],r=n[1],i=this.makeTrainFunction()(a.concat(r)),s=[];for(let e of i){let t=await e.data();s.push(t[0])}return aJ(i),pP(n[0],e),pP(n[1],t),cg(s)}getNamedWeights(e){let t=[],n=null!=e&&e.trainableOnly,a=n?this.trainableWeights:this.weights,r=this.getWeights(n);for(let e=0;e<a.length;++e)(!n||a[e].trainable)&&t.push({name:a[e].originalName,tensor:r[e]});return t}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){let e=super.dispose();if(0===e.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){let t=aZ().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-aZ().numTensors}return e}getLossIdentifiers(){let e;if("string"==typeof this.loss)e=cy(this.loss);else if(Array.isArray(this.loss)){for(let e of this.loss)if("string"!=typeof e)throw Error("Serialization of non-string loss is not supported.");e=this.loss.map(e=>cy(e))}else{let t=Object.keys(this.loss);e={};let n=this.loss;for(let a of t)if("string"==typeof n[a])e[a]=cy(n[a]);else throw Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if("string"==typeof this.metrics||"function"==typeof this.metrics)return[cy(pg(this.metrics))];{if(Array.isArray(this.metrics))return this.metrics.map(e=>cy(pg(e)));let e={};for(let t in this.metrics)e[t]=cy(pg(this.metrics[t]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){let t,n;if(null!=e.weighted_metrics)throw Error("Loading weight_metrics is not supported yet.");if(null!=e.loss_weights)throw Error("Loading loss_weights is not supported yet.");if(null!=e.sample_weight_mode)throw Error("Loading sample_weight_mode is not supported yet.");let a=d9(pw(e.optimizer_config));if("string"==typeof e.loss)t=cb(e.loss);else if(Array.isArray(e.loss))t=e.loss.map(e=>cb(e));else if(null!=e.loss)for(let n in t={},e.loss)t[n]=cb(e.loss[n]);if(Array.isArray(e.metrics))n=e.metrics.map(e=>cb(e));else if(null!=e.metrics)for(let t in n={},e.metrics)n[t]=cb(e.metrics[t]);this.compile({loss:t,metrics:n,optimizer:a})}async save(e,t){if("string"==typeof e){let t=d8.getSaveHandlers(e);if(0===t.length)throw new cc("Cannot find any save handlers for URL '".concat(e,"'"));if(t.length>1)throw new cc("Found more than one (".concat(t.length,") save handlers for ")+"URL '".concat(e,"'"));e=t[0]}if(null==e.save)throw new cc("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");let n=await d8.encodeWeights(this.getNamedWeights(t)),a={modelTopology:this.toJSON(null,!1),format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v".concat(pN),convertedBy:null};if(null!=t&&t.includeOptimizer&&null!=this.optimizer){a.trainingConfig=this.getTrainingConfig();let{data:e,specs:t}=await d8.encodeWeights(await this.optimizer.getWeights(),"optimizer");n.specs.push(...t),n.data=d8.concatenateArrayBuffers([n.data,e])}return null!=this.userDefinedMetadata&&(py(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=n.data,a.weightSpecs=n.specs,e.save(a)}setUserDefinedMetadata(e){py(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}constructor(e){super(e),this.isTraining=!1}}pV.className="Model",c_.registerClass(pV);class pU extends pV{}pU.className="Functional",c_.registerClass(pU);var d8=d8,c_=c_,cs=cs;async function pW(e,t){"modelTopology"in e||(e={modelTopology:e});let n=e.modelTopology;null!=n.model_config&&(n=n.model_config);let a=d9(pw(n),t);if(null!=e.weightsManifest){let t=await d8.loadWeights(e.weightsManifest,e.pathPrefix,a.weights.map(e=>e.originalName)),n={};for(let e of a.weights)n[e.originalName]=t[e.originalName];a.loadWeights(n),aJ(t)}return a}class pG extends pV{checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(e=>e<0))throw new cc("Negative dimension size caused by adding layer "+"".concat(e.name," with input shape [")+"".concat(e.inboundNodes[0].inputTensors[0].shape,"]"))}add(e){let t,n=e instanceof pG||e instanceof pV;if(n){if(1!==(t=e).outputs.length)throw new cc("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==t.inputs.length)throw new cc("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===e.inboundNodes.length){if(null==e.batchInputShape)throw new cc("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");let t=h4({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(t)}if(n)this.outputs=t.outputs,this.inputs=t.inputs;else{if(1!==e.inboundNodes.length)throw new cc("A layer added to a Sequential model must not already be "+"connected somewhere else. LayersModel received layer ".concat(e.name," ")+"which has ".concat(e.inboundNodes.length," pre-existing inbound ")+"connections.");if(1!==e.inboundNodes[0].outputTensors.length)throw new cc("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=function e(t,n,a){if((null==n||null!=a&&a>0)&&(n=t.sourceLayer,a=t.nodeIndex),0===n.inboundNodes.length)return[t];{let t=n.inboundNodes[a];if(0===t.inboundLayers.length)return t.inputTensors;{let n=[];for(let a=0;a<t.inboundLayers.length;a++){let r=t.inputTensors[a];for(let i of e(r,t.inboundLayers[a],t.nodeIndices[a]))-1===n.indexOf(i)&&n.push(i)}return n}}}(this.outputs[0])}this.inboundNodes=[],new h0({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:cp(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(e=>e.shape),outputShapes:this.outputs[0].shape})}else{let t=e.apply(this.outputs[0]);if(Array.isArray(t))throw TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[t],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(0===this.layers.length)throw TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{let e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,t){return null==this.model&&this.build(),this.model.call(e,t)}build(e){if(hG(e),0===this.inputs.length||0===this.outputs.length)throw TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new pV({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;this.built||this.build(),super.summary(e,t,n)}setWeights(e){null==this.model&&this.build(),this.model.setWeights(e)}evaluate(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new cl("The model needs to be compiled before being used.");return this.model.evaluate(e,t,n)}async evaluateDataset(e,t){if(!this.built)throw new cl("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,t)}predict(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==this.model&&this.build(),this.model.predict(e,t)}predictOnBatch(e){return null==this.model&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return null==this.model?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new cl("The model needs to be compiled before being used.");return this.model.fit(e,t,n)}async fitDataset(e,t){if(!this.built)throw new cl("The model needs to be compiled before being used.");return this.model.fitDataset(e,t)}async trainOnBatch(e,t){return this.model.trainOnBatch(e,t)}static fromConfig(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];let n,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r={};if(t instanceof Array){if(null==t[0].className||"Merge"===t[0].className)throw new cc("Legacy serialization format not supported yet.");n=t}else cs.assert(null!=t.layers,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),n=t.layers,delete t.layers,r=t;let i=new e(r);if(!(i instanceof pG))throw new cu("Sequential.fromConfig called on non-Sequential input: ".concat(i));for(let e of n){let t=d9(e,void 0,a);a&&t.setFastWeightInitDuringBuild(!0),i.add(t)}return i}set stopTraining(e){if(null==this.model)throw new cc("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(null==this.model)throw new cc("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){let e=[];for(let t of this.layers){let n={};n.className=t.getClassName(),n.config=t.getConfig(),e.push(n)}return{name:this.name,layers:e}}constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=null!=e.name?e.name:cD("sequential_"),null!=e.layers)for(let t of e.layers)this.add(t)}}function pH(e){return h4(e)}pG.className="Sequential",c_.registerClass(pG);var c_=c_,c_=c_;class pq extends c_.Serializable{getConfig(){return{}}}class pK extends pq{apply(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(1!==t)throw new cu("Support for alpha values other than 1 (".concat(t,") is not implemented ")+"yet.");return sW(e)}(e,t)}}pK.className="elu",c_.registerClass(pK);class pX extends pq{apply(e){return lq(e)}}pX.className="selu",c_.registerClass(pX);class pY extends pq{apply(e){return sq(e)}}pY.className="relu",c_.registerClass(pY);class pZ extends pq{apply(e){return aQ(()=>lM(6,sq(e)))}}pZ.className="relu6",c_.registerClass(pZ);class pQ extends pq{apply(e){return e}}pQ.className="linear",c_.registerClass(pQ);class pJ extends pq{apply(e){return sX(e)}}pJ.className="sigmoid",c_.registerClass(pJ);class p$ extends pq{apply(e){return aQ(()=>la(rP(.5,rz(.2,e)),0,1))}}p$.className="hardSigmoid",c_.registerClass(p$);class p0 extends pq{apply(e){return lS(e)}}p0.className="softplus",c_.registerClass(p0);class p1 extends pq{apply(e){return aQ(()=>rL(e,rP(r4(e),1)))}}p1.className="softsign",c_.registerClass(p1);class p2 extends pq{apply(e){return l0(e)}}p2.className="tanh",c_.registerClass(p2);class p3 extends pq{apply(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return lY(e,t)}}p3.className="softmax",c_.registerClass(p3);class p4 extends pq{apply(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return lT(e,t)}}p4.className="logSoftmax",c_.registerClass(p4);class p5 extends pq{apply(e){return aQ(()=>aQ(()=>{let t=rz(.5,rP(1,lh(rL(e,Math.sqrt(2)))));return rz(e,t)}))}}p5.className="gelu",c_.registerClass(p5);class p6 extends pq{apply(e){return aQ(()=>rz(.5,rz(e,rP(1,l0(rz(rB(rL(2,Math.PI)),rP(e,rz(.044715,r1(e,3)))))))))}}p6.className="gelu_new",c_.registerClass(p6);class p8 extends pq{apply(e){return aQ(()=>rz(e,l0(lS(e))))}}p8.className="mish",c_.registerClass(p8);class p9 extends pq{apply(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return aQ(()=>rz(sX(rz(e,t)),e))}}function p7(e){return e.getClassName()}function fe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return cN(e,c_.SerializationMap.getMap().classNameMap,t,"activation")}function ft(e){if(null==e){let e={};return e.className="linear",e.config={},fe(e)}if("string"==typeof e){let t={};return t.className=e,t.config={},fe(t)}return e instanceof pq?e:fe(e)}p9.className="swish",c_.registerClass(p9);var c_=c_;function fn(e){if(null!=e&&"object"!=typeof e)throw Error("Argument to L1L2 regularizer's constructor is expected to be an "+"object, but received: ".concat(e))}class fa extends c_.Serializable{}class fr extends fa{apply(e){return aQ(()=>{let t=sl([1]);return this.hasL1&&(t=rP(t,il(rz(this.l1,r4(e))))),this.hasL2&&(t=rP(t,il(rz(this.l2,rz(e,e))))),io(t,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,t){return new e({l1:t.l1,l2:t.l2})}constructor(e){super(),fn(e),this.l1=null==e||null==e.l1?.01:e.l1,this.l2=null==e||null==e.l2?.01:e.l2,this.hasL1=0!==this.l1,this.hasL2=0!==this.l2}}fr.className="L1L2",c_.registerClass(fr);let fi={l1l2:"L1L2"};function fs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return cN(e,c_.SerializationMap.getMap().classNameMap,t,"regularizer")}function fo(e){return null==e?null:"string"==typeof e?fs({className:e in fi?fi[e]:e,config:{}}):e instanceof fa?e:fs(e)}class fl extends h2{call(e,t){let n=sq(e=hW(e));return null!=this.maxValue&&(n=la(n,0,this.maxValue)),n}computeOutputShape(e){return e}getConfig(){let e={maxValue:this.maxValue};return Object.assign(e,super.getConfig()),e}constructor(e){super(null==e?{}:e),this.supportsMasking=!0,null!=e&&(this.maxValue=e.maxValue)}}fl.className="ReLU",c_.registerClass(fl);class fc extends h2{call(e,t){return sG(hW(e),this.alpha)}computeOutputShape(e){return e}getConfig(){let e={alpha:this.alpha};return Object.assign(e,super.getConfig()),e}constructor(e){super(null==e?{}:e),this.DEFAULT_ALPHA=.3,null==e&&(e={}),this.alpha=null==e.alpha?this.DEFAULT_ALPHA:e.alpha}}fc.className="LeakyReLU",c_.registerClass(fc);class fu extends h2{build(e){let t=(e=hG(e)).slice(1);if(null!=this.sharedAxes)for(let e of this.sharedAxes)t[e-1]=1;this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);let n={};if(null!=this.sharedAxes)for(let t=1;t<e.length;++t)n[t]=e[t];this.inputSpec=[new hQ({ndim:e.length,axes:n})],this.built=!0}call(e,t){return sH(e=hW(e),this.alpha.read())}getConfig(){let e={alphaInitializer:cw(this.alphaInitializer),alphaRegularizer:cw(this.alphaRegularizer),alphaConstraint:cw(this.alphaConstraint),sharedAxes:this.sharedAxes};return Object.assign(e,super.getConfig()),e}constructor(e){if(super(null==e?{}:e),this.DEFAULT_ALPHA_INITIALIZER="zeros",null==e&&(e={}),this.supportsMasking=!0,this.alphaInitializer=hB(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=fo(e.alphaRegularizer),this.alphaConstraint=dc(e.alphaConstraint),null==e.sharedAxes)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if("number"==typeof e.sharedAxes)this.sharedAxes=[e.sharedAxes];else throw new cc("Expected sharedAxes to be a number or an array of numbers, "+"but got ".concat(e.sharedAxes))}}fu.className="PReLU",c_.registerClass(fu);class fh extends h2{call(e,t){return sW(hW(e))}computeOutputShape(e){return e}getConfig(){let e={alpha:this.alpha};return Object.assign(e,super.getConfig()),e}constructor(e){if(super(null==e?{}:e),this.DEFAULT_ALPHA=1,null==e&&(e={}),null!=e.alpha&&e.alpha!==this.DEFAULT_ALPHA)throw new cu("Non-default alpha value (".concat(e.alpha,") is not supported by the ")+"ELU layer yet.");this.alpha=null==e.alpha?this.DEFAULT_ALPHA:e.alpha}}fh.className="ELU",c_.registerClass(fh);class fd extends h2{call(e,t){let n=hW(e);return rz(n,rM(se(n,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){let e={theta:this.theta};return Object.assign(e,super.getConfig()),e}constructor(e){super(null==e?{}:e),this.DEFAULT_THETA=1,null==e&&(e={}),this.theta=null==e.theta?this.DEFAULT_THETA:e.theta}}fd.className="ThresholdedReLU",c_.registerClass(fd);class fp extends h2{call(e,t){return aQ(()=>{let n=hW(e),a=t.mask;if(null!=a){let e=rz(r2(sc(n.shape),rM(a,n.dtype)),rG(-1e9));n=rP(n,e)}if(this.axis instanceof Array)if(this.axis.length>1)return i3(r2(n,lI(n,this.axis,!0)));else return this.softmax(n,this.axis[0]);return this.softmax(n,this.axis)})}computeOutputShape(e){return e}getConfig(){let e={axis:this.axis};return Object.assign(e,super.getConfig()),e}constructor(e){super(null==e?{}:e),this.DEFAULT_AXIS=1,null==e&&(e={}),this.softmax=new p3().apply,this.axis=null==e.axis?this.DEFAULT_AXIS:e.axis}}fp.className="Softmax",c_.registerClass(fp);let ff=aG({conv3dTranspose_:function(e,t,n,a,r){return iB(n,aV(e,"x","conv3dTranspose"),aV(t,"filter","conv3dTranspose"),a,r)}});var u7=cJ;let fm=aG({conv3d_:function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NDHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1],s=aV(e,"x","conv3d"),o=aV(t,"filter","conv3d"),l=s,c=!1;4===s.rank&&(c=!0,l=io(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),L(5===l.rank,()=>"Error in conv3d: input must be rank 5, but got rank ".concat(l.rank,".")),L(5===o.rank,()=>"Error in conv3d: filter must be rank 5, but got rank "+"".concat(o.rank,".")),L(l.shape[4]===o.shape[3],()=>"Error in conv3d: depth of input (".concat(l.shape[4],") must match ")+"input depth for filter ".concat(o.shape[3],".")),L(iw(n,i),()=>"Error in conv3D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(i,"'")),L("NDHWC"===r,()=>"Error in conv3d: got dataFormat of ".concat(r," but only NDHWC is currently supported.")),L(iN(i),()=>"Error in conv3D: Dilated rates should be larger than 0."),L(iN(n),()=>"Error in conv3D: Strides should be larger than 0.");let u={x:l,filter:o},h=aR.runKernel(e3,u,{strides:n,pad:a,dataFormat:r,dilations:i});return c?io(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});var c_=c_;function fg(e,t,n){if("number"==typeof e)return cp(e,t);if(e.length!==t)throw new cc("The ".concat(n," argument must be an integer or tuple of ").concat(t," integers.")+" Received: ".concat(e.length," elements."));for(let a=0;a<t;++a){let r=e[a];if(r!==parseInt(r.toString(),10))throw new cc("The ".concat(n," argument must be an integer or tuple of ").concat(t)+" integers. Received: ".concat(JSON.stringify(e)," including a")+" non-integer number ".concat(r))}return e}function fx(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return null==e?e:Math.floor((("same"===n?e:e-(t+(t-1)*(r-1))+1)+a-1)/a)}function fy(e,t,n,a){if(null==e)return null;if("valid"===a)e=e*t+ha([n-t,0]);else if("same"===a)e*=t;else throw new cc("Unsupport padding mode: ".concat(a,"."));return e}function fb(e,t){return aQ(()=>(cz(t),"channelsFirst"===t)?i0(e,[0,2,3,1]):e)}function fv(e,t){return aQ(()=>(cz(t),"channelsFirst"===t)?i0(e,[0,2,3,4,1]):e)}function fw(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;return aQ(()=>{if(null==i&&(i=hs()),cz(i),3!==e.rank&&4!==e.rank)throw new cc("conv2dWithBiasActivation expects input to be of rank 3 or 4, "+"but received ".concat(e.rank,"."));if(3!==t.rank&&4!==t.rank)throw new cc("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, "+"but received ".concat(e.rank,"."));let l=fb(e,i);if("causal"===r)throw new cu("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=u7.conv2d({x:l,filter:t,strides:a,pad:"same"===r?"same":"valid",dilations:s,dataFormat:"NHWC",bias:n,activation:o}),"channelsFirst"===i&&(l=i0(l,[0,3,1,2])),l})}class fN extends h2{static verifyArgs(e){if(cf("kernelSize"in e,"required key 'kernelSize' not in config"),"number"!=typeof e.kernelSize&&!cT(e.kernelSize,"number",1,3))throw new cc("BaseConv expects config.kernelSize to be number or number[] with "+"length 1, 2, or 3, but received ".concat(JSON.stringify(e.kernelSize),"."))}getConfig(){let e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:p7(this.activation),useBias:this.useBias,biasInitializer:cw(this.biasInitializer),biasRegularizer:cw(this.biasRegularizer),activityRegularizer:cw(this.activityRegularizer),biasConstraint:cw(this.biasConstraint)};return Object.assign(e,super.getConfig()),e}constructor(e,t){if(super(t),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",fN.verifyArgs(t),this.rank=e,cI(this.rank,"rank"),1!==this.rank&&2!==this.rank&&3!==this.rank)throw new cu("Convolution layer for rank other than 1, 2, or 3 (".concat(this.rank,") is ")+"not implemented yet.");if(this.kernelSize=fg(t.kernelSize,e,"kernelSize"),this.strides=fg(null==t.strides?1:t.strides,e,"strides"),this.padding=null==t.padding?"valid":t.padding,cB(this.padding),this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,cz(this.dataFormat),this.activation=ft(t.activation),this.useBias=null==t.useBias||t.useBias,this.biasInitializer=hB(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=dc(t.biasConstraint),this.biasRegularizer=fo(t.biasRegularizer),this.activityRegularizer=fo(t.activityRegularizer),this.dilationRate=fg(null==t.dilationRate?1:t.dilationRate,e,"dilationRate"),1===this.rank&&Array.isArray(this.dilationRate)&&1!==this.dilationRate.length)throw new cc("dilationRate must be a number or an array of a single number for 1D convolution, but received "+"".concat(JSON.stringify(this.dilationRate)));if(2===this.rank){if("number"==typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate];else if(2!==this.dilationRate.length)throw new cc("dilationRate must be a number or array of two numbers for 2D "+"convolution, but received ".concat(JSON.stringify(this.dilationRate)))}else if(3===this.rank){if("number"==typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(3!==this.dilationRate.length)throw new cc("dilationRate must be a number or array of three numbers for 3D "+"convolution, but received ".concat(JSON.stringify(this.dilationRate)))}}}class fk extends fN{build(e){e=hG(e);let t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new cc("The channel dimension of the input should be defined. "+"Found ".concat(e[t]));let n=e[t],a=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[t]:n}}],this.built=!0}call(e,t){return aQ(()=>{let t;e=hW(e);let n=null==this.bias?null:this.bias.read(),a=cE(this.activation.getClassName());if(null!=a&&2===this.rank)t=fw(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate,a);else{if(1===this.rank)t=function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return aQ(()=>{if(null==i&&(i=hs()),cz(i),3!==e.shape.length)throw new cc("The input of a conv1dWithBias operation should be 3, but is "+"".concat(e.shape.length," instead."));if(3!==t.shape.length)throw new cc("The kernel for a conv1dWithBias operation should be 3, but is "+"".concat(t.shape.length," instead"));if(null!=n&&1!==n.shape.length)throw new cc("The bias for a conv1dWithBias operation should be 1, but is "+"".concat(n.shape.length," instead"));if("channelsFirst"===i&&(e=i0(e,[0,2,1])),"causal"===r)throw new cu("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let o=lr(e,t,a,"same"===r?"same":"valid","NWC",s);return null!=n&&(o=hy(o,n)),o})}(e,this.kernel.read(),n,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(2===this.rank)t=fw(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(3===this.rank)t=function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0;return aQ(()=>{if(null==i&&(i=hs()),cz(i),4!==e.rank&&5!==e.rank)throw new cc("conv3dWithBias expects input to be of rank 4 or 5, but received "+"".concat(e.rank,"."));if(4!==t.rank&&5!==t.rank)throw new cc("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+"".concat(e.rank,"."));let o=fv(e,i);if("causal"===r)throw new cu("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return o=fm(o,t,a,"same"===r?"same":"valid","NDHWC",s),null!=n&&(o=hy(o,n)),"channelsFirst"===i&&(o=i0(o,[0,4,1,2,3])),o})}(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new cu("convolutions greater than 3D are not implemented yet.");null!=this.activation&&(t=this.activation.apply(t))}return t})}computeOutputShape(e){e=hG(e);let t=[],n="channelsLast"===this.dataFormat?e.slice(1,e.length-1):e.slice(2);for(let e=0;e<n.length;++e){let a=fx(n[e],this.kernelSize[e],this.padding,this.strides[e],"number"==typeof this.dilationRate?this.dilationRate:this.dilationRate[e]);t.push(a)}let a=[e[0]];return"channelsLast"===this.dataFormat?(a=a.concat(t)).push(this.filters):(a.push(this.filters),a=a.concat(t)),a}getConfig(){let e={filters:this.filters,kernelInitializer:cw(this.kernelInitializer),kernelRegularizer:cw(this.kernelRegularizer),kernelConstraint:cw(this.kernelConstraint)};return Object.assign(e,super.getConfig()),e}static verifyArgs(e){if(!("filters"in e)||"number"!=typeof e.filters||e.filters<1)throw new cc("Convolution layer expected config.filters to be a 'number' > 0 "+"but got ".concat(JSON.stringify(e.filters)))}constructor(e,t){super(e,t),this.kernel=null,fk.verifyArgs(t),this.filters=t.filters,cI(this.filters,"filters"),this.kernelInitializer=hB(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=dc(t.kernelConstraint),this.kernelRegularizer=fo(t.kernelRegularizer)}}class fS extends fk{getConfig(){let e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if("number"!=typeof e.kernelSize&&!cT(e.kernelSize,"number",1,2))throw new cc("Conv2D expects config.kernelSize to be number or number[] with "+"length 1 or 2, but received ".concat(JSON.stringify(e.kernelSize),"."))}constructor(e){super(2,e),fS.verifyArgs(e)}}fS.className="Conv2D",c_.registerClass(fS);class fC extends fk{getConfig(){let e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if("number"!=typeof e.kernelSize&&!(Array.isArray(e.kernelSize)&&(1===e.kernelSize.length||3===e.kernelSize.length)))throw new cc("Conv3D expects config.kernelSize to be number or"+" [number, number, number], but received ".concat(JSON.stringify(e.kernelSize),"."))}constructor(e){super(3,e),fC.verifyArgs(e)}}fC.className="Conv3D",c_.registerClass(fC);class fT extends fS{build(e){if(4!==(e=hG(e)).length)throw new cc("Input should have rank 4; Received input shape: "+JSON.stringify(e));let t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new cc("The channel dimension of the inputs should be defined. Found `None`.");let n=e[t],a=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",a,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new hQ({ndim:4,axes:{[t]:n}})],this.built=!0}call(e,t){return aQ(()=>{let t,n,a=hW(e);if(4!==a.shape.length)throw new cc("Conv2DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(a.shape.length));let r=a.shape,i=r[0];"channelsFirst"===this.dataFormat?(t=2,n=3):(t=1,n=2);let s=r[t],o=r[n],l=this.kernelSize[0],c=this.kernelSize[1],u=this.strides[0],h=this.strides[1],d=[i,fy(s,u,l,this.padding),fy(o,h,c,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(a=i0(a,[0,2,3,1]));let p=li(a,this.kernel.read(),d,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(p=i0(p,[0,3,1,2])),null!=this.bias&&(p=hy(p,this.bias.read(),this.dataFormat)),null!=this.activation&&(p=this.activation.apply(p)),p})}computeOutputShape(e){let t,n,a,r=(e=hG(e)).slice();"channelsFirst"===this.dataFormat?(t=1,n=2,a=3):(t=3,n=1,a=2);let i=this.kernelSize[0],s=this.kernelSize[1],o=this.strides[0],l=this.strides[1];return r[t]=this.filters,r[n]=fy(r[n],o,i,this.padding),r[a]=fy(r[a],l,s,this.padding),r}getConfig(){let e=super.getConfig();return delete e.dilationRate,e}constructor(e){if(super(e),this.inputSpec=[new hQ({ndim:4})],"same"!==this.padding&&"valid"!==this.padding)throw new cc("Conv2DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(this.padding))}}fT.className="Conv2DTranspose",c_.registerClass(fT);class fI extends fC{build(e){if(5!==(e=hG(e)).length)throw new cc("Input should have rank 5; Received input shape: "+JSON.stringify(e));let t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new cc("The channel dimension of the inputs should be defined. Found `None`.");let n=e[t],a=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",a,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new hQ({ndim:5,axes:{[t]:n}})],this.built=!0}call(e,t){return aQ(()=>{let t,n,a,r=hW(e);if(5!==r.shape.length)throw new cc("Conv3DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(r.shape.length));let i=r.shape,s=i[0];"channelsFirst"===this.dataFormat?(a=2,t=3,n=4):(a=1,t=2,n=3);let o=i[a],l=i[t],c=i[n],u=this.kernelSize[0],h=this.kernelSize[1],d=this.kernelSize[2],p=this.strides[0],f=this.strides[1],m=this.strides[2],g=fy(o,p,u,this.padding),x=[s,g,fy(l,f,h,this.padding),fy(c,m,d,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(r=i0(r,[0,2,3,4,1]));let y=ff(r,this.kernel.read(),x,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(y=i0(y,[0,4,1,2,3])),null!==this.bias&&(y=hy(y,this.bias.read(),this.dataFormat)),null!==this.activation&&(y=this.activation.apply(y)),y})}computeOutputShape(e){let t,n,a,r,i=(e=hG(e)).slice();"channelsFirst"===this.dataFormat?(t=1,n=2,a=3,r=4):(t=4,n=1,a=2,r=3);let s=this.kernelSize[0],o=this.kernelSize[1],l=this.kernelSize[2],c=this.strides[0],u=this.strides[1],h=this.strides[2];return i[t]=this.filters,i[n]=fy(i[n],c,s,this.padding),i[a]=fy(i[a],u,o,this.padding),i[r]=fy(i[r],h,l,this.padding),i}getConfig(){let e=super.getConfig();return delete e.dilationRate,e}constructor(e){if(super(e),this.inputSpec=[new hQ({ndim:5})],"same"!==this.padding&&"valid"!==this.padding)throw new cc("Conv3DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(this.padding))}}fI.className="Conv3DTranspose",c_.registerClass(fI);class fE extends fk{build(e){if((e=hG(e)).length<this.rank+2)throw new cc("Inputs to SeparableConv".concat(this.rank,"D should have rank ")+"".concat(this.rank+2,", but received input shape: ")+"".concat(JSON.stringify(e)));let t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t]||e[t]<0)throw new cc("The channel dimension of the inputs should be defined, "+"but found ".concat(JSON.stringify(e[t])));let n=e[t],a=this.kernelSize.concat([n,this.depthMultiplier]),r=[];for(let e=0;e<this.rank;++e)r.push(1);r.push(n*this.depthMultiplier,this.filters),this.depthwiseKernel=this.addWeight("depthwise_kernel",a,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",r,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,!0,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.inputSpec=[new hQ({ndim:this.rank+2,axes:{[t]:n}})],this.built=!0}call(e,t){return aQ(()=>{let t;if(e=hW(e),1===this.rank)throw new cu("1D separable convolution is not implemented yet.");return 2===this.rank&&("channelsFirst"===this.dataFormat&&(e=i0(e,[0,2,3,1])),t=lK(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(t=hy(t,this.bias.read(),this.dataFormat)),null!=this.activation&&(t=this.activation.apply(t)),"channelsFirst"===this.dataFormat&&(t=i0(t,[0,3,1,2])),t})}getConfig(){let e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=cw(this.depthwiseInitializer),e.pointwiseInitializer=cw(this.pointwiseInitializer),e.depthwiseRegularizer=cw(this.depthwiseRegularizer),e.pointwiseRegularizer=cw(this.pointwiseRegularizer),e.depthwiseConstraint=cw(this.depthwiseConstraint),e.pointwiseConstraint=cw(this.pointwiseConstraint),e}constructor(e,t){if(super(e,t),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,null==t.filters)throw new cc("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=t.kernelInitializer||null!=t.kernelRegularizer||null!=t.kernelConstraint)throw new cc("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=t.padding&&"same"!==t.padding&&"valid"!==t.padding)throw new cc("SeparableConv".concat(this.rank,"D supports only padding modes: ")+"'same' and 'valid', but received ".concat(JSON.stringify(t.padding)));this.depthMultiplier=null==t.depthMultiplier?1:t.depthMultiplier,this.depthwiseInitializer=hB(t.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=fo(t.depthwiseRegularizer),this.depthwiseConstraint=dc(t.depthwiseConstraint),this.pointwiseInitializer=hB(t.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=fo(t.pointwiseRegularizer),this.pointwiseConstraint=dc(t.pointwiseConstraint)}}fE.className="SeparableConv";class f_ extends fE{constructor(e){super(2,e)}}f_.className="SeparableConv2D",c_.registerClass(f_);class fA extends fk{getConfig(){let e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if("number"!=typeof e.kernelSize&&!cT(e.kernelSize,"number",1,1))throw new cc("Conv1D expects config.kernelSize to be number or number[] with "+"length 1, but received ".concat(JSON.stringify(e.kernelSize),"."))}constructor(e){super(1,e),fA.verifyArgs(e),this.inputSpec=[{ndim:3}]}}fA.className="Conv1D",c_.registerClass(fA);class fR extends h2{computeOutputShape(e){return"channelsFirst"===this.dataFormat?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,t){return aQ(()=>{if(e=hW(e),"channelsLast"===this.dataFormat){let t=hu(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return hu(t,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}{let t=hu(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return hu(t,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){let e={cropping:this.cropping,dataFormat:this.dataFormat};return Object.assign(e,super.getConfig()),e}constructor(e){super(e),"number"==typeof e.cropping?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:"number"==typeof e.cropping[0]?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=void 0===e.dataFormat?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}}fR.className="Cropping2D",c_.registerClass(fR);class fD extends h2{computeOutputShape(e){if("channelsFirst"===this.dataFormat){let t=null==e[2]?null:this.size[0]*e[2],n=null==e[3]?null:this.size[1]*e[3];return[e[0],e[1],t,n]}{let t=null==e[1]?null:this.size[0]*e[1],n=null==e[2]?null:this.size[1]*e[2];return[e[0],t,n,e[3]]}}call(e,t){return aQ(()=>{let t=hW(e),n=t.shape;if("channelsFirst"===this.dataFormat){t=i0(t,[0,2,3,1]);let e=this.size[0]*n[2],a=this.size[1]*n[3];return i0("nearest"===this.interpolation?uW.resizeNearestNeighbor(t,[e,a]):uW.resizeBilinear(t,[e,a]),[0,3,1,2])}{let e=this.size[0]*n[1],a=this.size[1]*n[2];return"nearest"===this.interpolation?uW.resizeNearestNeighbor(t,[e,a]):uW.resizeBilinear(t,[e,a])}})}getConfig(){let e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation};return Object.assign(e,super.getConfig()),e}constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=null==e.size?this.DEFAULT_SIZE:e.size,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,cz(this.dataFormat),this.interpolation=null==e.interpolation?"nearest":e.interpolation,cC(cF,"InterpolationFormat",this.interpolation)}}fD.className="UpSampling2D",c_.registerClass(fD);var c_=c_;class fM extends fN{build(e){if((e=hG(e)).length<4)throw new cc("Inputs to DepthwiseConv2D should have rank 4. "+"Received input shape: ".concat(JSON.stringify(e),"."));let t="channelsFirst"===this.dataFormat?1:3;if(null==e[t]||e[t]<0)throw new cc("The channel dimension of the inputs to DepthwiseConv2D should "+"be defined, but is not (".concat(e[t],")."));let n=e[t],a=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",a,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return aQ(()=>{let t=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"valid",r=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0;return aQ(()=>{null==r&&(r=hs()),cz(r);let s=fb(e,r);if(4!==e.rank)throw new cc("Input for depthwiseConv2d is required to be 4-D, but is instead "+"".concat(e.rank,"-D"));if(4!==t.rank)throw new cc("depthwiseKernel is required to be 4-D, but is instead "+"".concat(t.rank,"-D"));return s=lo(s,t,n,"same"===a?"same":"valid","NHWC",i),"channelsFirst"===r&&(s=i0(s,[0,3,1,2])),s})}(e=hW(e),this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(t=hy(t,this.bias.read(),this.dataFormat)),null!=this.activation&&(t=this.activation.apply(t)),t})}computeOutputShape(e){e=hG(e);let t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],a="channelsFirst"===this.dataFormat?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,r=fx(t,this.kernelSize[0],this.padding,this.strides[0]),i=fx(n,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[e[0],a,r,i]:[e[0],r,i,a]}getConfig(){let e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=cw(this.depthwiseInitializer),e.depthwiseRegularizer=cw(this.depthwiseRegularizer),e.depthwiseConstraint=cw(this.depthwiseRegularizer),e}constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,this.depthwiseInitializer=hB(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=dc(e.depthwiseConstraint),this.depthwiseRegularizer=fo(e.depthwiseRegularizer)}}fM.className="DepthwiseConv2D",c_.registerClass(fM);var c_=c_,cs=cs,c_=c_,cs=cs;function fF(e,t,n,a){if(Array.isArray(e)){if(null!=t||null!=n)throw new cc("When inputs is an array, neither initialState or constants should be provided");null!=a&&(n=e.slice(e.length-a,e.length),e=e.slice(0,e.length-a)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function r(e){return null==e||Array.isArray(e)?e:[e]}return{inputs:e,initialState:t=r(t),constants:n=r(n)}}function fO(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,s=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return aQ(()=>{let l,c,u,h=t.shape.length;if(h<3)throw new cc("Input should be at least 3D, but is ".concat(h,"D."));let d=[1,0].concat(hr(2,h));if(t=i0(t,d),null!=i)throw new cu("The rnn() functoin of the deeplearn.js backend does not support constants yet.");s&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=r&&((r=rM(rM(r,"bool"),"float32")).rank===h-1&&(r=oQ(r,-1)),r=i0(r,d)),a&&(t=oU(t,0),null!=r&&(r=oU(r,0)));let p=[],f=n,m=t.shape[0],g=sd(t);null!=r&&(c=sd(r));for(let t=0;t<m;++t){let n=g[t],a=aQ(()=>e(n,f));if(null==r)l=a[0],f=a[1];else{let e=aQ(()=>{let e=c[t],n=r2(lL(e),e);return{output:rP(rz(a[0],e),rz(f[0],n)),newStates:f.map((t,r)=>rP(rz(a[1][r],e),rz(t,n)))}});l=e.output,f=e.newStates}o&&p.push(l)}return o&&(u=i6(p,1)),[l,u,f]})}class fP extends h2{getStates(){return null==this.states_?hr(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map(e=>null):this.states_}setStates(e){this.states_=e}computeOutputShape(e){let t;hV(e)&&(e=e[0]);let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);let a=n[0];if(t=this.returnSequences?[e[0],e[1],a]:[e[0],a],!this.returnState)return t;{let a=[];for(let t of n)a.push([e[0],t]);return[t].concat(a)}}computeMask(e,t){return aQ(()=>{Array.isArray(t)&&(t=t[0]);let e=this.returnSequences?t:null;return this.returnState?[e].concat(this.states.map(e=>null)):e})}get states(){if(null!=this.states_)return this.states_;{let e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[];for(let n=0;n<e;++n)t.push(null);return t}}set states(e){this.states_=e}build(e){let t;if(null!=this.numConstants)throw new cu("Constants support is not implemented in RNN yet.");hV(e)&&(e=e[0]);let n=this.stateful?e[0]:null,a=e.slice(2);this.inputSpec[0]=new hQ({shape:[n,null,...a]});let r=[e[0]].concat(e.slice(2));if(this.cell.build(r),t=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!cs.arraysEqual(this.stateSpec.map(e=>e.shape[e.shape.length-1]),t))throw new cc("An initialState was passed that is not compatible with "+"cell.stateSize. Received stateSpec=".concat(this.stateSpec,"; ")+"However cell.stateSize is ".concat(this.cell.stateSize))}else this.stateSpec=t.map(e=>new hQ({shape:[null,e]}));this.stateful&&this.resetStates()}resetStates(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];aQ(()=>{if(!this.stateful)throw new co("Cannot call resetStates() on an RNN Layer that is not stateful.");let n=this.inputSpec[0].shape[0];if(null==n)throw new cc("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.states_)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(e=>sl([n,e])):this.states_=[sl([n,this.cell.stateSize])];else if(null==e)aJ(this.states_),null!=this.keptStates&&(aJ(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(e=>sl([n,e])):this.states_[0]=sl([n,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new cc("Layer ".concat(this.name," expects ").concat(this.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));!0===t?this.keptStates.push(this.states_.slice()):aJ(this.states_);for(let t=0;t<this.states_.length;++t){let a=e[t],r=[n,Array.isArray(this.cell.stateSize)?this.cell.stateSize[t]:this.cell.stateSize];if(!cs.arraysEqual(a.shape,r))throw new cc("State ".concat(t," is incompatible with layer ").concat(this.name,": ")+"expected shape=".concat(r,", received shape=").concat(a.shape));this.states_[t]=a}}this.states_=this.states_.map(e=>a$(e.clone()))})}apply(e,t){let n=null==t?null:t.initialState,a=null==t?null:t.constants;null==t&&(t={});let r=fF(e,n,a,this.numConstants);e=r.inputs,n=r.initialState,a=r.constants;let i=[],s=[];if(null!=n){for(let e of(t.initialState=n,i=i.concat(n),this.stateSpec=[],n))this.stateSpec.push(new hQ({shape:e.shape}));s=s.concat(this.stateSpec)}if(null!=a&&(t.constants=a,i=i.concat(a),this.numConstants=a.length),!(i[0]instanceof hJ))return super.apply(e,t);{let n=[e].concat(i),a=this.inputSpec.concat(s),r=this.inputSpec;this.inputSpec=a;let o=super.apply(n,t);return this.inputSpec=r,o}}call(e,t){return aQ(()=>{let n=null==t?null:t.mask,a=null==t?null:t.training,r=null==t?null:t.initialState;e=hW(e),null==r&&(r=this.stateful?this.states_:this.getInitialState(e));let i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(r.length!==i)throw new cc("RNN Layer has ".concat(i," state(s) but was passed ")+"".concat(r.length," initial state(s)."));this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");let s={training:a},o=fO((e,t)=>{let n=this.cell.call([e].concat(t),s);return[n[0],n.slice(1)]},e,r,this.goBackwards,n,null,this.unroll,this.returnSequences),l=o[0],c=o[1],u=o[2];this.stateful&&this.resetStates(u,a);let h=this.returnSequences?c:l;return this.returnState?[h].concat(u):h})}getInitialState(e){return aQ(()=>{let t=sl(e.shape);return(t=ho(t=il(t,[1,2])),Array.isArray(this.cell.stateSize))?this.cell.stateSize.map(e=>e>1?hp(t,[1,e]):t):this.cell.stateSize>1?[hp(t,[1,this.cell.stateSize])]:[t]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){let e=super.getConfig(),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(t.numConstants=this.numConstants);let n=this.cell.getConfig();return this.getClassName()===fP.className&&(t.cell={className:this.cell.getClassName(),config:n}),Object.assign(Object.assign(Object.assign({},n),e),t)}static fromConfig(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=d9(t.cell,n);return new e(Object.assign(t,{cell:a}))}constructor(e){let t;if(super(e),null==e.cell)throw new cc("cell property is missing for the constructor of RNN.");if(null==(t=Array.isArray(e.cell)?new fG({cells:e.cell}):e.cell).stateSize)throw new cc("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=t,this.returnSequences=null!=e.returnSequences&&e.returnSequences,this.returnState=null!=e.returnState&&e.returnState,this.goBackwards=null!=e.goBackwards&&e.goBackwards,this._stateful=null!=e.stateful&&e.stateful,this.unroll=null!=e.unroll&&e.unroll,this.supportsMasking=!0,this.inputSpec=[new hQ({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}}fP.className="RNN",c_.registerClass(fP);class fj extends h2{}class fL extends fj{build(e){e=hG(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return aQ(()=>{let n;if(2!==e.length)throw new cc("SimpleRNNCell expects 2 input Tensors, got ".concat(e.length,"."));let a=e[1];e=e[0];let r=null!=t.training&&t.training;0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=fH({ones:()=>lL(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=fH({ones:()=>lL(a),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));let i=this.dropoutMask,s=this.recurrentDropoutMask;n=null!=i?hm(rz(e,i),this.kernel.read()):hm(e,this.kernel.read()),null!=this.bias&&(n=hy(n,this.bias.read())),null!=s&&(a=rz(a,s));let o=rP(n,hm(a,this.recurrentKernel.read()));return null!=this.activation&&(o=this.activation.apply(o)),[o,o]})}getConfig(){let e=super.getConfig(),t={units:this.units,activation:p7(this.activation),useBias:this.useBias,kernelInitializer:cw(this.kernelInitializer),recurrentInitializer:cw(this.recurrentInitializer),biasInitializer:cw(this.biasInitializer),kernelRegularizer:cw(this.kernelRegularizer),recurrentRegularizer:cw(this.recurrentRegularizer),biasRegularizer:cw(this.biasRegularizer),activityRegularizer:cw(this.activityRegularizer),kernelConstraint:cw(this.kernelConstraint),recurrentConstraint:cw(this.recurrentConstraint),biasConstraint:cw(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,cI(this.units,"units"),this.activation=ft(null==e.activation?this.DEFAULT_ACTIVATION:e.activation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=hB(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=hB(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=hB(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=fo(e.kernelRegularizer),this.recurrentRegularizer=fo(e.recurrentRegularizer),this.biasRegularizer=fo(e.biasRegularizer),this.kernelConstraint=dc(e.kernelConstraint),this.recurrentConstraint=dc(e.recurrentConstraint),this.biasConstraint=dc(e.biasConstraint),this.dropout=hn([1,ha([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=hn([1,ha([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}}fL.className="SimpleRNNCell",c_.registerClass(fL);class fz extends fP{call(e,t){return aQ(()=>{null!=this.cell.dropoutMask&&(aJ(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(aJ(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let n=null==t?null:t.mask,a=null==t?null:t.training,r=null==t?null:t.initialState;return super.call(e,{mask:n,training:a,initialState:r})})}static fromConfig(e,t){return new e(t)}constructor(e){e.cell=new fL(e),super(e)}}fz.className="SimpleRNN",c_.registerClass(fz);class fB extends fj{build(e){let t=(e=hG(e))[e.length-1];this.kernel=this.addWeight("kernel",[t,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return aQ(()=>{let n,a;if(2!==e.length)throw new cc("GRUCell expects 2 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));let r=null!=t.training&&t.training,i=e[1];e=e[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=fH({ones:()=>lL(e),rate:this.dropout,training:r,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=fH({ones:()=>lL(i),rate:this.recurrentDropout,training:r,count:3,dropoutFunc:this.dropoutFunc}));let s=this.dropoutMask,o=this.recurrentDropoutMask;0<this.dropout&&this.dropout<1&&(e=rz(e,s[0]));let l=hm(e,this.kernel.read());this.useBias&&(l=hy(l,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(i=rz(i,o[0]));let c=this.recurrentKernel.read(),[u,h]=iO(c,[2*this.units,this.units],c.rank-1),d=hm(i,u),[p,f,m]=iO(l,3,l.rank-1),[g,x]=iO(d,2,d.rank-1);n=this.recurrentActivation.apply(rP(p,g));let y=hm(rz(this.recurrentActivation.apply(rP(f,x)),i),h);a=this.activation.apply(rP(m,y));let b=rP(rz(n,i),rz(rP(1,is(n)),a));return[b,b]})}getConfig(){let e=super.getConfig(),t={units:this.units,activation:p7(this.activation),recurrentActivation:p7(this.recurrentActivation),useBias:this.useBias,kernelInitializer:cw(this.kernelInitializer),recurrentInitializer:cw(this.recurrentInitializer),biasInitializer:cw(this.biasInitializer),kernelRegularizer:cw(this.kernelRegularizer),recurrentRegularizer:cw(this.recurrentRegularizer),biasRegularizer:cw(this.biasRegularizer),activityRegularizer:cw(this.activityRegularizer),kernelConstraint:cw(this.kernelConstraint),recurrentConstraint:cw(this.recurrentConstraint),biasConstraint:cw(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new cc("GRUCell does not support reset_after parameter set to true.");this.units=e.units,cI(this.units,"units"),this.activation=ft(void 0===e.activation?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=ft(void 0===e.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=hB(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=hB(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=hB(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=fo(e.kernelRegularizer),this.recurrentRegularizer=fo(e.recurrentRegularizer),this.biasRegularizer=fo(e.biasRegularizer),this.kernelConstraint=dc(e.kernelConstraint),this.recurrentConstraint=dc(e.recurrentConstraint),this.biasConstraint=dc(e.biasConstraint),this.dropout=hn([1,ha([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=hn([1,ha([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}}fB.className="GRUCell",c_.registerClass(fB);class fV extends fP{call(e,t){return aQ(()=>{null!=this.cell.dropoutMask&&(aJ(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(aJ(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let n=null==t?null:t.mask,a=null==t?null:t.training,r=null==t?null:t.initialState;return super.call(e,{mask:n,training:a,initialState:r})})}static fromConfig(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}constructor(e){0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new fB(e),super(e)}}fV.className="GRU",c_.registerClass(fV);class fU extends fj{build(e){var t;let n,a=(e=hG(e))[e.length-1];if(this.kernel=this.addWeight("kernel",[a,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){let e=this.biasInitializer,a=this.units;n=new((t=class extends hN{apply(t,n){let r=e.apply([a]),i=new hS().apply([a]),s=e.apply([2*a]);return hd(hd(r,i),s)}}).className="CustomInit",t)}else n=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,n,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,t){return aQ(()=>{let n,a,r=null!=t.training&&t.training;if(3!==e.length)throw new cc("LSTMCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));let i=e[1],s=e[2];e=e[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=fH({ones:()=>lL(e),rate:this.dropout,training:r,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=fH({ones:()=>lL(i),rate:this.recurrentDropout,training:r,count:4,dropoutFunc:this.dropoutFunc}));let o=this.dropoutMask,l=this.recurrentDropoutMask;0<this.dropout&&this.dropout<1&&(e=rz(e,o[0]));let c=hm(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(i=rz(i,l[0])),c=rP(c,hm(i,this.recurrentKernel.read())),this.useBias&&(c=hy(c,this.bias.read()));let[u,h,d,p]=iO(c,4,c.rank-1);n=this.recurrentActivation.apply(u),a=rP(rz(this.recurrentActivation.apply(h),s),rz(n,this.activation.apply(d)));let f=rz(this.recurrentActivation.apply(p),this.activation.apply(a));return[f,f,a]})}getConfig(){let e=super.getConfig(),t={units:this.units,activation:p7(this.activation),recurrentActivation:p7(this.recurrentActivation),useBias:this.useBias,kernelInitializer:cw(this.kernelInitializer),recurrentInitializer:cw(this.recurrentInitializer),biasInitializer:cw(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:cw(this.kernelRegularizer),recurrentRegularizer:cw(this.recurrentRegularizer),biasRegularizer:cw(this.biasRegularizer),activityRegularizer:cw(this.activityRegularizer),kernelConstraint:cw(this.kernelConstraint),recurrentConstraint:cw(this.recurrentConstraint),biasConstraint:cw(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,cI(this.units,"units"),this.activation=ft(void 0===e.activation?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=ft(void 0===e.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=hB(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=hB(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=hB(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=fo(e.kernelRegularizer),this.recurrentRegularizer=fo(e.recurrentRegularizer),this.biasRegularizer=fo(e.biasRegularizer),this.kernelConstraint=dc(e.kernelConstraint),this.recurrentConstraint=dc(e.recurrentConstraint),this.biasConstraint=dc(e.biasConstraint),this.dropout=hn([1,ha([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=hn([1,ha([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}}fU.className="LSTMCell",c_.registerClass(fU);class fW extends fP{call(e,t){return aQ(()=>{null!=this.cell.dropoutMask&&(aJ(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(aJ(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let n=null==t?null:t.mask,a=null==t?null:t.training,r=null==t?null:t.initialState;return super.call(e,{mask:n,training:a,initialState:r})})}static fromConfig(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}constructor(e){0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new fU(e),super(e)}}fW.className="LSTM",c_.registerClass(fW);class fG extends fj{get stateSize(){let e=[];for(let t of this.cells.slice().reverse())Array.isArray(t.stateSize)?e.push(...t.stateSize):e.push(t.stateSize);return e}call(e,t){return aQ(()=>{let n,a=e.slice(1),r=[];for(let e of this.cells.slice().reverse())Array.isArray(e.stateSize)?r.push(a.splice(0,e.stateSize.length)):r.push(a.splice(0,1));r.reverse();let i=[];for(let s=0;s<this.cells.length;++s){let o=this.cells[s];a=r[s],n=0===s?[e[0]].concat(a):[n[0]].concat(a),n=o.call(n,t),i.push(n.slice(1))}for(let e of(a=[],i.slice().reverse()))a.push(...e);return[n[0]].concat(a)})}build(e){let t;hV(e)&&(e=e[0]),this.cells.forEach((n,a)=>{cW("RNNCell_".concat(a),()=>{n.build(e),t=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,e=[e[0],t]})}),this.built=!0}getConfig(){let e=super.getConfig(),t=this.cells.map(e=>({className:e.getClassName(),config:e.getConfig()}));return Object.assign(Object.assign({},e),{cells:t})}static fromConfig(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=[];for(let e of t.cells)a.push(d9(e,n));return new e({cells:a})}get trainableWeights(){if(!this.trainable)return[];let e=[];for(let t of this.cells)e.push(...t.trainableWeights);return e}get nonTrainableWeights(){let e=[];for(let t of this.cells)e.push(...t.nonTrainableWeights);if(!this.trainable){let t=[];for(let e of this.cells)t.push(...e.trainableWeights);return t.concat(e)}return e}getWeights(){let e=[];for(let t of this.cells)e.push(...t.weights);return hY(e)}setWeights(e){let t=[];for(let n of this.cells){let a=n.weights.length,r=e.splice(a);for(let e=0;e<n.weights.length;++e)t.push([n.weights[e],r[e]])}hZ(t)}constructor(e){super(e),this.cells=e.cells}}function fH(e){let{ones:t,rate:n,training:a=!1,count:r=1,dropoutFunc:i}=e,s=()=>{var e;return null!=i?i(t(),n):(e=t(),aQ(()=>he(e,n,void 0,void 0)))},o=()=>hb(s,t,a);return!r||r<=1?a$(o().clone()):Array(r).fill(void 0).map(o).map(e=>a$(e.clone()))}fG.className="StackedRNNCells",c_.registerClass(fG);var fq=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&0>t.indexOf(a)&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,a=Object.getOwnPropertySymbols(e);r<a.length;r++)0>t.indexOf(a[r])&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]]);return n};class fK extends fP{call(e,t){return aQ(()=>{if(null!=this.cell.dropoutMask&&(aJ(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(aJ(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),t&&t.constants)throw new cc("ConvRNN2D cell does not support constants");let n=null==t?null:t.mask,a=null==t?null:t.training,r=null==t?null:t.initialState;return super.call(e,{mask:n,training:a,initialState:r})})}computeOutputShape(e){let t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0],...t.slice(2)]),this.returnState&&(t=[t,...[,,].fill([e[0],...t.slice(-3)])]),t}getInitialState(e){return aQ(()=>{let{stateSize:t}=this.cell,n=e.shape,a=this.computeSingleOutputShape(n),r=sl([a[0],...a.slice(2)]);return Array.isArray(t)?Array(t.length).fill(r):[r]})}resetStates(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];aQ(()=>{if(!this.stateful)throw new co("Cannot call resetStates() on an RNN Layer that is not stateful.");let n=this.inputSpec[0].shape,a=this.computeSingleOutputShape(n),r=[a[0],...a.slice(2)];if(null==n[0])throw new cc("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.getStates())Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>sl(r)):this.states_=[sl(r)];else if(null==e)aJ(this.states_),null!=this.keptStates&&(aJ(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>sl(r)):this.states_[0]=sl(r);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new cc("Layer ".concat(this.name," expects ").concat(this.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));t?this.keptStates.push(this.states_.slice()):aJ(this.states_);for(let t=0;t<this.states_.length;++t){let n=e[t];if(!cs.arraysEqual(n.shape,r))throw new cc("State ".concat(t," is incompatible with layer ").concat(this.name,": ")+"expected shape=".concat(r,", received shape=").concat(n.shape));this.states_[t]=n}}this.states_=this.states_.map(e=>a$(e.clone()))})}computeSingleOutputShape(e){let{dataFormat:t,filters:n,kernelSize:a,padding:r,strides:i,dilationRate:s}=this.cell,o="channelsFirst"===t,l=e[o?3:2],c=e[o?4:3],u=fx(l,a[0],r,i[0],s[0]),h=fx(c,a[1],r,i[1],s[1]);return[...e.slice(0,2),...o?[n,u,h]:[u,h,n]]}constructor(e){if(e.unroll)throw new cu("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new cu("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new hQ({ndim:5})]}}fK.className="ConvRNN2D";class fX extends fU{build(e){var t;e=hG(e);let n="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[n])throw new cc("The channel dimension of the input should be defined. "+"Found ".concat(e[n]));let a=e[n],r=this.kernelSize.concat([a,4*this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);let i=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",i,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let e;if(this.unitForgetBias){let n=this.biasInitializer,a=this.filters;e=new((t=class extends hN{apply(e,t){let r=n.apply([a]);return hh([r,sc([a]),n.apply([2*a])])}}).className="CustomInit",t)}else e=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,e,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,t){return aQ(()=>{if(3!==e.length)throw new cc("ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));let n=t.training||!1,a=e[0],r=e[1],i=e[2];0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=fH({ones:()=>lL(a),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));let s=this.dropoutMask,o=(e,t,n)=>t&&t[n]?rz(t[n],e):e,l=o(a,s,0),c=o(a,s,1),u=o(a,s,2),h=o(a,s,3);0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=fH({ones:()=>lL(r),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));let d=this.recurrentDropoutMask,p=o(r,d,0),f=o(r,d,1),m=o(r,d,2),g=o(r,d,3),[x,y,b,v]=iO(this.kernel.read(),4,3),[w,N,k,S]=this.useBias?iO(this.bias.read(),4):[null,null,null,null];l=this.inputConv(l,x,w,this.padding),c=this.inputConv(c,y,N,this.padding),u=this.inputConv(u,b,k,this.padding),h=this.inputConv(h,v,S,this.padding);let[C,T,I,E]=iO(this.recurrentKernel.read(),4,3);p=this.recurrentConv(p,C),f=this.recurrentConv(f,T),m=this.recurrentConv(m,I),g=this.recurrentConv(g,E);let _=this.recurrentActivation.apply(rP(l,p)),A=this.recurrentActivation.apply(rP(c,f)),R=rP(rz(A,i),rz(_,this.activation.apply(rP(u,m)))),D=rz(this.recurrentActivation.apply(rP(h,g)),this.activation.apply(R));return[D,D,R]})}getConfig(){let e=super.getConfig(),{units:t}=e,n=fq(e,["units"]),a={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),a)}inputConv(e,t,n,a){let r=iL(e,t,this.strides,a||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return n?hy(r,n,this.dataFormat):r}recurrentConv(e,t){return iL(e,t,1,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}constructor(e){let{filters:t,kernelSize:n,strides:a,padding:r,dataFormat:i,dilationRate:s}=e;super(Object.assign(Object.assign({},e),{units:t})),this.filters=t,cI(this.filters,"filters"),this.kernelSize=fg(n,2,"kernelSize"),this.kernelSize.forEach(e=>cI(e,"kernelSize")),this.strides=fg(a||1,2,"strides"),this.strides.forEach(e=>cI(e,"strides")),this.padding=r||"valid",cB(this.padding),this.dataFormat=i||"channelsLast",cz(this.dataFormat),this.dilationRate=fg(s||1,2,"dilationRate"),this.dilationRate.forEach(e=>cI(e,"dilationRate"))}}fX.className="ConvLSTM2DCell",c_.registerClass(fX);class fY extends fK{static fromConfig(e,t){return new e(t)}constructor(e){super(Object.assign(Object.assign({},e),{cell:new fX(e)}))}}fY.className="ConvLSTM2D",c_.registerClass(fY);var c_=c_,cs=cs;class fZ extends h2{getNoiseShape(e){if(null==this.noiseShape)return this.noiseShape;let t=e.shape,n=[];for(let e=0;e<this.noiseShape.length;++e)n.push(null==this.noiseShape[e]?t[e]:this.noiseShape[e]);return n}call(e,t){return aQ(()=>{this.invokeCallHook(e,t);let n=hW(e);if(0<this.rate&&this.rate<1){let e=null!=t.training&&t.training,a=this.getNoiseShape(n);return hb(()=>{var e,t;return e=this.rate,t=this.seed,aQ(()=>he(n,e,a,t))},()=>n,e)}return e})}getConfig(){let e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed};return Object.assign(e,super.getConfig()),e}dispose(){return super.dispose()}constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}}fZ.className="Dropout",c_.registerClass(fZ);class fQ extends fZ{getNoiseShape(e){let t=e.shape;return[t[0],1,t[2]]}constructor(e){super(e),this.inputSpec=[{ndim:3}]}}fQ.className="SpatialDropout1D",c_.registerClass(fQ);class fJ extends h2{build(e){let t=(e=hG(e))[e.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:t}}],this.built=!0}computeOutputShape(e){let t=(e=hG(e)).slice();return t[t.length-1]=this.units,t}call(e,t){return aQ(()=>{let n;this.invokeCallHook(e,t);let a=hW(e),r=cE(this.activation.getClassName());return null!=r?n=hm(a,this.kernel.read(),r,this.bias?this.bias.read():null):(n=hm(a,this.kernel.read()),null!=this.bias&&(n=hy(n,this.bias.read())),null!=this.activation&&(n=this.activation.apply(n))),n})}getConfig(){let e={units:this.units,activation:p7(this.activation),useBias:this.useBias,kernelInitializer:cw(this.kernelInitializer),biasInitializer:cw(this.biasInitializer),kernelRegularizer:cw(this.kernelRegularizer),biasRegularizer:cw(this.biasRegularizer),activityRegularizer:cw(this.activityRegularizer),kernelConstraint:cw(this.kernelConstraint),biasConstraint:cw(this.biasConstraint)};return Object.assign(e,super.getConfig()),e}constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",null==e.batchInputShape&&null==e.inputShape&&null!=e.inputDim){let t=null;null!=e.batchSize&&(t=e.batchSize),this.batchInputShape=[t,e.inputDim]}this.units=e.units,cI(this.units,"units"),this.activation=ft(e.activation),null!=e.useBias&&(this.useBias=e.useBias),this.kernelInitializer=hB(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=hB(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=dc(e.kernelConstraint),this.biasConstraint=dc(e.biasConstraint),this.kernelRegularizer=fo(e.kernelRegularizer),this.biasRegularizer=fo(e.biasRegularizer),this.activityRegularizer=fo(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}}fJ.className="Dense",c_.registerClass(fJ);class f$ extends h2{computeOutputShape(e){for(let t of(e=hG(e)).slice(1))if(null==t)throw new cc('The shape of the input to "Flatten" is not fully defined '+"(got ".concat(e.slice(1),"). Make sure to pass a complete ")+'"input_shape" or "batch_input_shape" argument to the first layer in your model.');return[e[0],ht(e,1)]}call(e,t){return aQ(()=>{this.invokeCallHook(e,t);let n=hW(e);if("channelsFirst"===this.dataFormat&&n.rank>1){let e=[0];for(let t=2;t<n.rank;++t)e.push(t);e.push(1),n=i0(n,e)}var a=n;if(a.rank<=1)throw new cc("batchFlatten requires a minimum rank of 2. Got rank: ".concat(a.rank,"."));let r=[a.shape[0],ht(a.shape,1)];return io(a,r)})}getConfig(){let e={};return null!=this.dataFormat&&(e.dataFormat=this.dataFormat),Object.assign(e,super.getConfig()),e}constructor(e){super(e=e||{}),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}}f$.className="Flatten",c_.registerClass(f$);class f0 extends h2{call(e,t){return aQ(()=>{this.invokeCallHook(e,t);let n=hW(e);return this.activation.apply(n)})}getConfig(){let e={activation:p7(this.activation)};return Object.assign(e,super.getConfig()),e}constructor(e){super(e),this.supportsMasking=!0,this.activation=ft(e.activation)}}f0.className="Activation",c_.registerClass(f0);class f1 extends h2{computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,t){return aQ(()=>{var t,n;return t=e=hW(e),n=this.n,aQ(()=>{if(2!==t.shape.length)throw new cc("repeat() expects a rank-2 tensor, but received a "+"rank-".concat(t.shape.length," tensor."));return hp(ho(t,1),[1,n,1])})})}getConfig(){let e={n:this.n};return Object.assign(e,super.getConfig()),e}constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}}f1.className="RepeatVector",c_.registerClass(f1);class f2 extends h2{isUnknown(e){return e<0||null==e}fixUnknownDimension(e,t){let n="Total size of new array must be unchanged.",a=t.slice(),r=1,i=null;for(let e=0;e<a.length;++e){let t=a[e];if(this.isUnknown(t))if(null===i)i=e;else throw new cc("Can only specifiy one unknown dimension.");else r*=t}let s=ht(e);if(null!==i){if(0===r||s%r!=0)throw new cc(n);a[i]=s/r}else if(s!==r)throw new cc(n);return a}computeOutputShape(e){let t=!1;for(let n=0;n<e.length;++n)if(this.isUnknown(e[n])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,t){return aQ(()=>{this.invokeCallHook(e,t);let n=hW(e),a=n.shape;return io(n,a.slice(0,1).concat(this.fixUnknownDimension(a.slice(1),this.targetShape)))})}getConfig(){let e={targetShape:this.targetShape};return Object.assign(e,super.getConfig()),e}constructor(e){super(e),this.targetShape=e.targetShape;for(let e=0;e<this.targetShape.length;++e)this.isUnknown(this.targetShape[e])&&(this.targetShape[e]=null)}}f2.className="Reshape",c_.registerClass(f2);class f3 extends h2{computeOutputShape(e){let t=(e=hG(e)).slice();return this.dims.forEach((n,a)=>{t[a+1]=e[n]}),t}call(e,t){return i0(hW(e),this.dimsIncludingBatch)}getConfig(){let e={dims:this.dims};return Object.assign(e,super.getConfig()),e}constructor(e){if(super(e),null==e.dims)throw Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw Error("Permute constructor requires `dims` to be an Array, but received "+"".concat(e.dims," instead."));let t=hr(1,e.dims.length+1);if(!cs.arraysEqual(e.dims.slice().sort(),t))throw Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new hQ({ndim:this.dims.length+1})]}}f3.className="Permute",c_.registerClass(f3);class f4 extends h2{computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={maskValue:this.maskValue};return Object.assign(t,e),t}computeMask(e,t){return o2(lP(hW(e),this.maskValue),-1)}call(e,t){return aQ(()=>{this.invokeCallHook(e,t);let n=hW(e),a=o2(lP(n,this.maskValue),-1,!0);return rz(n,rM(a,n.dtype))})}constructor(e){super(null==e?{}:e),this.supportsMasking=!0,null!=e?this.maskValue=null==e.maskValue?0:e.maskValue:this.maskValue=0}}f4.className="Masking",c_.registerClass(f4);var c_=c_;class f5 extends h2{build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,t){return aQ(()=>this.maskZero?lP(e=hW(e),rU(e)):null)}computeOutputShape(e){if(e=hG(e),null==this.inputLength)return[...e,this.outputDim];let t=cx(this.inputLength);if(t.length!==e.length-1)throw new cc('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));{let n=0;for(let a=0;a<t.length;++a){let r=t[a],i=e[a+1];if(null!=r&&null!=i&&r!==i)throw new cc('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));null==r&&(t[n]=i),n++}}return[e[0],...t,this.outputDim]}call(e,t){return aQ(()=>{this.invokeCallHook(e,t);let n=hW(e);"int32"!==n.dtype&&(n=rM(n,"int32"));let a=hg(this.embeddings.read(),io(n,[n.size]));return io(a,hG(this.computeOutputShape(n.shape)))})}getConfig(){let e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:cw(this.embeddingsInitializer),embeddingsRegularizer:cw(this.embeddingsRegularizer),activityRegularizer:cw(this.activityRegularizer),embeddingsConstraint:cw(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength};return Object.assign(e,super.getConfig()),e}constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==e.batchInputShape&&null==e.inputShape){let t=null;null!=e.batchSize&&(t=e.batchSize),null==e.inputLength?this.batchInputShape=[t,null]:this.batchInputShape=[t].concat(cx(e.inputLength))}this.inputDim=e.inputDim,cI(this.inputDim,"inputDim"),this.outputDim=e.outputDim,cI(this.outputDim,"outputDim"),this.embeddingsInitializer=hB(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=fo(e.embeddingsRegularizer),this.activityRegularizer=fo(e.activityRegularizer),this.embeddingsConstraint=dc(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}}f5.className="Embedding",c_.registerClass(f5);var cs=cs,c_=c_;class f6 extends h2{mergeFunction(e){throw new cu}computeElementwiseOpOutputShape(e,t){if(null==e||null==t)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(0===t.length)return e;let n=e.slice(0,e.length-t.length);for(let a=0;a<t.length;++a){let r=e[e.length-t.length+a],i=t[a];if(null==r||null==i||r<0||i<0)n.push(null);else if(1===r)n.push(i);else if(1===i)n.push(r);else{if(r!==i)throw new cc("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));n.push(r)}}return n}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[hG(e)]),e.length<2)throw new cc("A merge layer should be called on an Array of at least 2 inputs."+" Got ".concat(e.length," input(s)."));let t=[];for(let n of e)null!=n&&null!==n[0]&&t.push(n[0]);if((t=cS(t)).length>1)throw new cc("Can not merge tensors with different batch sizes. "+"Got tensors with shapes: ".concat(JSON.stringify(e),"."));let n=null==e[0]?null:e[0].slice(1);for(let t=1;t<e.length;++t){let a=null==e[t]?null:e[t].slice(1);n=this.computeElementwiseOpOutputShape(n,a)}let a=e.map(e=>e.length);-1===e.indexOf(null)&&1===cS(a).length?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,t){return aQ(()=>{if(!this.reshapeRequired)return this.mergeFunction(e);{let t=[],n=e.map(e=>e.rank);if(-1===n.indexOf(null)){let a=ha(n);for(let n of e){let e=n.rank;for(let t=0;t<a-e;++t)n=ho(n,1);t.push(n)}return this.mergeFunction(t)}{let n=!1;for(let a of e){let e=a.rank;if(null==e){let e=a.shape,r=e[0],i=e.slice(1).concat([r]),s=io(a,[r].concat(ht(e.slice(1))));s=io(s=i0(s,[1,0]),i),t.push(s),n=!0}else if(e>1){let r=hr(1,e).concat([0]);t.push(i0(a,r)),n=!0}else t.push(a)}let a=this.mergeFunction(t),r=a.rank;if(n)if(null==r){let e=a.shape,t=e.length,n=e[t-1],r=[n].concat(e.slice(0,e.length-1));a=io(i0(io(a,[-1,n]),[1,0]),r)}else r>1&&(a=i0(a,[r-1].concat(hr(0,r-1))));return a}}})}computeOutputShape(e){let t;t=null==e[0]?null:e[0].slice(1);for(let n=1;n<e.length;++n){let a=null==e[n]?null:e[n].slice(1);t=this.computeElementwiseOpOutputShape(t,a)}let n=[];for(let t of e)null!=t&&null!==t[0]&&n.push(t[0]);return 1===(n=cS(n)).length?n.concat(t):[null].concat(t)}computeMask(e,t){return aQ(()=>{if(null==t)return null;if(!Array.isArray(t))throw new cc("`mask` should be an Array");if(!Array.isArray(e))throw new cc("`inputs` should be an Array");if(t.length!==e.length)throw new cc("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths "+"(".concat(e.length," vs ").concat(t.length,")"));if(t.every(e=>null==e))return null;let n=(t=t.map(e=>null==e?e:oQ(e,0)))[0];for(let e=1;e<t.length-1;++e)n=iR(n,t[e]);return n})}constructor(e){super(e||{}),this.supportsMasking=!0}}class f8 extends f6{mergeFunction(e){return aQ(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=rP(t,e[n]);return t})}constructor(e){super(e)}}f8.className="Add",c_.registerClass(f8);class f9 extends f6{mergeFunction(e){return aQ(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=rz(t,e[n]);return t})}constructor(e){super(e)}}f9.className="Multiply",c_.registerClass(f9);class f7 extends f6{mergeFunction(e){return aQ(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=rP(t,e[n]);return rz(1/e.length,t)})}constructor(e){super(e)}}f7.className="Average",c_.registerClass(f7);class me extends f6{mergeFunction(e){return aQ(()=>{let t=e[0];for(let n=1;n<e.length;++n)t=r9(t,e[n]);return t})}constructor(e){super(e)}}me.className="Maximum",c_.registerClass(me);class mt extends f6{mergeFunction(e){return aQ(()=>{let t=e[0];for(let n=1;n<e.length;++n)t=lM(t,e[n]);return t})}constructor(e){super(e)}}mt.className="Minimum",c_.registerClass(mt);class mn extends f6{build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||1===e.length)throw new cc("A `Concatenate` layer should be called on a list of at least 2 inputs");let t=!0;for(let n of e)if(null!=n){t=!1;break}if(t)return;let n=[];for(let t=0;t<e.length;++t){let a=e[t].slice();a.splice(this.axis,1);let r=!1;for(let e of n)if(cs.arraysEqual(e,a)){r=!0;break}r||n.push(a)}if(n.length>1)throw new cc("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return aQ(()=>hh(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new cc("A `Concatenate` layer should be called on a list of inputs.");let t=e[0].slice(),n=this.axis<0?t.length+this.axis:this.axis;for(let a of e.slice(1)){if(null==t[n]||null==a[n]){t[n]=null;break}t[n]+=a[n]}return t}computeMask(e,t){if(null==t)return null;if(!Array.isArray(t))throw new cc("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new cc("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new cc("Mismatch in the length of mask (".concat(t.length,") ")+"and the legnth of inputs (".concat(e.length,")"));return aQ(()=>{let n=!0;if(t.forEach(e=>{if(null!=e){n=!1;return}}),n)return null;let a=[];for(let n=0;n<e.length;++n)null==t[n]?a.push(rM(lL(e[n]),"bool")):t[n].rank<e[n].rank?a.push(oQ(t[n],-1)):a.push(t[n]);return o1(oY(a,this.axis),-1,!1)})}getConfig(){let e={axis:this.axis};return Object.assign(e,super.getConfig()),e}constructor(e){super(e),this.DEFAULT_AXIS=-1,null==e&&(e={}),this.axis=null==e.axis?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}}function ma(e,t){for(;e<0;)e+=t;return e}mn.className="Concatenate",c_.registerClass(mn);class mr extends f6{build(e){cs.assert(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");let t=e[0],n=e[1];if(t.length>3||n.length>3)throw new cu("Dot layer does not support tensors of 4D or higher rank yet.");let a=this.interpretAxes(t,n);if(t[a[0]]!==n[a[1]])throw new cc("Dimension incompatibility: "+"".concat(t[a[0]]," !== ").concat(n[a[1]]))}mergeFunction(e){let t;if(2!==e.length)throw new cc("A `Dot` layer must be called on exactly 2 inputs, "+"but received ".concat(e.length," input(s)."));let n=e[0],a=e[1];t=Array.isArray(this.axes)?this.axes.map((t,n)=>ma(t,e[n].shape.length)):[ma(this.axes,n.shape.length),ma(this.axes,a.shape.length)],this.normalize&&(n=d7(n,t[0]),a=d7(a,t[1]));var r=n,i=a,s=t;if(r.shape.length>3||i.shape.length>3)throw new cu("batchDot is not implemented for tensors of 4D or higher rank yet");if(cs.assert(r.shape.length>=2,()=>"batchDot requires the rank of x to be >= 2, "+"but got ".concat(r.shape.length)),cs.assert(r.shape.length>=2,()=>"batchDot requires the rank of y to be >= 2, "+"but got ".concat(i.shape.length)),"number"==typeof s&&(s=[s,s]),"complex64"===r.dtype||"complex64"===i.dtype)throw new cu("batchDot is not implemented for complex64-type Tensors yet.");let o=r.shape.length,l=i.shape.length;null==s&&(s=[o-1,l-2]);let c=s;return aQ(()=>{let e,t;if(o>l){e=o-l;let t=[];for(let n=0;n<e;++n)t.push(1);i=io(i,i.shape.concat(t))}else if(l>o){e=l-o;let t=[];for(let n=0;n<e;++n)t.push(1);r=io(r,r.shape.concat(t))}else e=0;if(2===r.shape.length&&2===i.shape.length)t=c[0]===c[1]?il(rz(r,i),c[0]):il(rz(i0(r,[1,0]),i),c[1]);else{let e=c[0]!==r.shape.length-1,n=c[1]===i.shape.length-1;t=iI(r,i,e,n)}if(e>0){let n;n=o>l?o+l-3:o-1;let a=[];for(let t=n;t<n+e;++t)a.push(t);t=lQ(t,a)}return 1===t.shape.length&&(t=oQ(t,1)),t})}interpretAxes(e,t){return Array.isArray(this.axes)?this.axes:[ma(this.axes,e.length),ma(this.axes,t.length)]}computeOutputShape(e){cs.assert(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");let t=e[0].slice(),n=e[1].slice();if(t.length>3||n.length>3)throw new cu("Dot layer does not support tensors of 4D or higher rank yet.");let a=this.interpretAxes(t,n);t.splice(a[0],1),n.splice(a[1],1),n.splice(0,1);let r=t.concat(n);return 1===r.length&&r.push(1),r}computeMask(e,t){return null}getConfig(){let e={axes:this.axes,normalize:this.normalize};return Object.assign(e,super.getConfig()),e}constructor(e){super(e),this.axes=e.axes,this.normalize=null!=e.normalize&&e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}}mr.className="Dot",c_.registerClass(mr);var c_=c_;class mi extends h2{computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={stddev:this.stddev};return Object.assign(t,e),t}call(e,t){return aQ(()=>{this.invokeCallHook(e,t);let n=hW(e);return hb(()=>rP(hf(n.shape,0,this.stddev),n),()=>n,t.training||!1)})}constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}}mi.className="GaussianNoise",c_.registerClass(mi);class ms extends h2{computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return aQ(()=>{this.invokeCallHook(e,t);let n=hW(e);return this.rate>0&&this.rate<1?hb(()=>{let e=Math.sqrt(this.rate/(1-this.rate));return rz(n,hf(n.shape,1,e))},()=>n,t.training||!1):n})}constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}}ms.className="GaussianDropout",c_.registerClass(ms);class mo extends h2{_getNoiseShape(e){return this.noiseShape||hW(e).shape}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return aQ(()=>{if(this.rate<1&&this.rate>0){let n=this._getNoiseShape(e);return hb(()=>{let t=hW(e),a=i_(uJ(n),this.rate);a=rM(a,"float32");let r=((1-this.rate)*(1+3.09091329228798*this.rate))**-.5,i=-(-1.7580993408473766*r)*this.rate,s=rP(rz(t,a),rz(rP(a,-1),-1.7580993408473766));return rP(rz(s,r),i)},()=>hW(e),t.training||!1)}return e})}constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}}mo.className="AlphaDropout",c_.registerClass(mo);let ml=aG({batchNorm4d_:function(e,t,n,a,r,i){let s,o,l=aV(e,"x","batchNorm"),c=aV(t,"mean","batchNorm"),u=aV(n,"variance","batchNorm");return null!=r&&(s=aV(r,"scale","batchNorm")),null!=a&&(o=aV(a,"offset","batchNorm")),L(4===l.rank,()=>"Error in batchNorm4D: x must be rank 4 but got rank "+"".concat(l.rank,".")),L(4===c.rank||1===c.rank,()=>"Error in batchNorm4D: mean must be rank 4 or rank 1 but "+"got rank ".concat(c.rank,".")),L(4===u.rank||1===u.rank,()=>"Error in batchNorm4D: variance must be rank 4 or rank 1 "+"but got rank ".concat(u.rank,".")),null!=s&&L(4===s.rank||1===s.rank,()=>"Error in batchNorm4D: scale must be rank 4 or rank 1 "+"but got rank ".concat(s.rank,".")),null!=o&&L(4===o.rank||1===o.rank,()=>"Error in batchNorm4D: offset must be rank 4 or rank 1 "+"but got rank ".concat(o.rank,".")),lt(l,c,u,o,s,i)}}),mc=aG({batchNorm3d_:function(e,t,n,a,r,i){let s,o,l=aV(e,"x","batchNorm"),c=aV(t,"mean","batchNorm"),u=aV(n,"variance","batchNorm");return null!=r&&(s=aV(r,"scale","batchNorm")),null!=a&&(o=aV(a,"offset","batchNorm")),L(3===l.rank,()=>"Error in batchNorm3D: x must be rank 3 but got rank "+"".concat(l.rank,".")),L(3===c.rank||1===c.rank,()=>"Error in batchNorm3D: mean must be rank 3 or rank 1 but "+"got rank ".concat(c.rank,".")),L(3===u.rank||1===u.rank,()=>"Error in batchNorm3D: variance must be rank 3 or rank 1 "+"but got rank ".concat(u.rank,".")),null!=s&&L(3===s.rank||1===s.rank,()=>"Error in batchNorm3D: scale must be rank 3 or rank 1 "+"but got rank ".concat(s.rank,".")),null!=o&&L(3===o.rank||1===o.rank,()=>"Error in batchNorm3D: offset must be rank 3 or rank 1 "+"but got rank ".concat(o.rank,".")),lt(l,c,u,o,s,i)}}),mu=aG({batchNorm2d_:function(e,t,n,a,r,i){let s,o,l=aV(e,"x","batchNorm"),c=aV(t,"mean","batchNorm"),u=aV(n,"variance","batchNorm");return null!=r&&(s=aV(r,"scale","batchNorm")),null!=a&&(o=aV(a,"offset","batchNorm")),L(2===l.rank,()=>"Error in batchNorm2D: x must be rank 2 but got rank "+"".concat(l.rank,".")),L(2===c.rank||1===c.rank,()=>"Error in batchNorm2D: mean must be rank 2 or rank 1 but "+"got rank ".concat(c.rank,".")),L(2===u.rank||1===u.rank,()=>"Error in batchNorm2D: variance must be rank 2 or rank 1 "+"but got rank ".concat(u.rank,".")),null!=s&&L(2===s.rank||1===s.rank,()=>"Error in batchNorm2D: scale must be rank 2 or rank 1 "+"but got rank ".concat(s.rank,".")),null!=o&&L(2===o.rank||1===o.rank,()=>"Error in batchNorm2D: offset must be rank 2 or rank 1 "+"but got rank ".concat(o.rank,".")),lt(l,c,u,o,s,i)}}),mh=aG({moments_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=J(t,(e=aV(e,"x","moments")).shape),r=lD(e,a,n),i=r.shape;n||(i=iq(r.shape,a));let s=lD(rV(r2(rM(e,"float32"),io(r,i))),a,n);return{mean:r,variance:s}}});var c_=c_,cs=cs;function md(e,t,n,a,r){let i,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.001;if(2===e.rank)i=mu(e,t,n,a,r,s);else if(3===e.rank)i=mc(e,t,n,a,r,s);else if(4===e.rank)i=ml(e,t,n,a,r,s);else throw new cu("batchNormalization is not implemented for array of rank ".concat(e.rank," ")+"yet");return i}class mp extends h2{build(e){e=hG(e);let t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(null==n)throw new cc("Axis ".concat(t," of input tensor should have a defined dimension but ")+"the layer received an input with shape "+"".concat(JSON.stringify(e),"."));this.inputSpec=[new hQ({ndim:e.length,axes:{[t]:n}})];let a=[n];this.scale&&(this.gamma=this.addWeight("gamma",a,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",a,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",a,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",a,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,t){return aQ(()=>{let n=null!=t.training&&t.training,a=hW(e),r=a.shape,i=r.length,s=hr(0,i),o=this.axis>=0?this.axis:this.axis+i;s.splice(o,1);let l=cp(1,i);l[o]=r[o];let c=s.slice();c.sort();let u=!cs.arraysEqual(c,hr(0,i).slice(0,i-1)),h=()=>{if(!u)return md(a,this.movingMean.read(),this.movingVariance.read(),null==this.beta?null:this.beta.read(),null==this.gamma?null:this.gamma.read(),this.epsilon);{let e=io(this.movingMean.read(),l),t=io(this.movingVariance.read(),l);return md(a,e,t,this.center?io(this.beta.read(),l):null,this.scale?io(this.gamma.read(),l):null,this.epsilon)}};if(!n)return h();let[d,p,f]=function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return cs.arraysEqual(a.slice().sort(),hr(0,e.rank-1))?function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return aQ(()=>{let i=mh(e,a),s=i.mean,o=i.variance;return[md(e,s,o,n,t,r),s,o]})}(e,t,n,a,r):function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return aQ(()=>{let i=mh(e,a),s=i.mean,o=i.variance,l=[];for(let t of hr(0,e.rank))-1!==a.indexOf(t)?l.push(1):l.push(e.shape[t]);let c=io(s,l),u=io(o,l),h=null==t?null:io(t,l);return[md(e,c,u,null==n?null:io(n,l),h,r),s,o]})}(e,t,n,a,r)}(a,this.gamma.read(),this.beta.read(),s,this.epsilon),m=(e,t,n)=>{aQ(()=>{let a=e.read(),r=rz(r2(a,t),1-n);e.write(r2(a,r))})};return m(this.movingMean,p,this.momentum),m(this.movingVariance,f,this.momentum),d})}getConfig(){let e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:cw(this.betaInitializer),gammaInitializer:cw(this.gammaInitializer),movingMeanInitializer:cw(this.movingMeanInitializer),movingVarianceInitializer:cw(this.movingVarianceInitializer),betaRegularizer:cw(this.betaRegularizer),gammaRegularizer:cw(this.gammaRegularizer),betaConstraint:cw(this.betaConstraint),gammaConstraint:cw(this.gammaConstraint)};return Object.assign(e,super.getConfig()),e}constructor(e){null==e&&(e={}),super(e),this.supportsMasking=!0,this.axis=null==e.axis?-1:e.axis,this.momentum=null==e.momentum?.99:e.momentum,this.epsilon=null==e.epsilon?.001:e.epsilon,this.center=null==e.center||e.center,this.scale=null==e.scale||e.scale,this.betaInitializer=hB(e.betaInitializer||"zeros"),this.gammaInitializer=hB(e.gammaInitializer||"ones"),this.movingMeanInitializer=hB(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=hB(e.movingVarianceInitializer||"ones"),this.betaConstraint=dc(e.betaConstraint),this.gammaConstraint=dc(e.gammaConstraint),this.betaRegularizer=fo(e.betaRegularizer),this.gammaRegularizer=fo(e.gammaRegularizer)}}mp.className="BatchNormalization",c_.registerClass(mp);class mf extends h2{build(e){let t=(e=hG(e)).length;"number"==typeof this.axis&&(this.axis=[this.axis]);for(let e=0;e<this.axis.length;++e)this.axis[e]<0&&(this.axis[e]+=t);for(let e of this.axis)if(e<0||e>=t)throw Error("Invalid axis: ".concat(e));if(this.axis.length!==cS(this.axis).length)throw Error("Found duplicate axes in: ".concat(this.axis));let n=this.axis.map(t=>e[t]);this.scale?this.gamma=this.addWeight("gamma",n,"float32",this.gammaInitializer,this.gammaRegularizer,!0):this.gamma=null,this.center?this.beta=this.addWeight("beta",n,"float32",this.betaInitializer,this.betaRegularizer,!0):this.beta=null,this.built=!0}call(e,t){let n=hW(e),a=n.shape,r=a.length;return aQ(()=>{let{mean:e,variance:t}=mh(n,this.axis,!0),i=cp(1,r);for(let e of this.axis)i[e]=a[e];let s=e=>null!=e&&e.shape.length!==r?io(e,i):e,o=this.scale?s(this.gamma.read()):null,l=this.center?s(this.beta.read()):null,c=[],u=[];for(let e=0;e<r;++e)-1!==this.axis.indexOf(e)?(c.push(a[e]),u.push(1)):(c.push(1),u.push(a[e]));return e=i5(e,c),t=i5(t,c),null!=o&&(o=i5(o,u)),null!=l&&(l=i5(l,u)),md(n,e,t,l,o,this.epsilon)})}getConfig(){let e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:cw(this.betaInitializer),gammaInitializer:cw(this.gammaInitializer),betaRegularizer:cw(this.betaRegularizer),gammaRegularizer:cw(this.gammaRegularizer)};return Object.assign(e,super.getConfig()),e}constructor(e){if(null==e&&(e={}),super(e),this.axis=null==e.axis?-1:e.axis,"number"==typeof this.axis){if(!Number.isInteger(this.axis))throw Error("Expected axis to be an integer, but received ".concat(this.axis))}else if(Array.isArray(this.axis)){for(let e of this.axis)if(!Number.isInteger(e))throw Error("Expected axis to be an array of integers, "+"but received ".concat(JSON.stringify(this.axis)))}else throw Error("Expected axis to be an integer or an array of integers, "+"but received ".concat(JSON.stringify(this.axis)));this.epsilon=null==e.epsilon?.001:e.epsilon,this.center=null==e.center||e.center,this.scale=null==e.scale||e.scale,this.betaInitializer=hB(e.betaInitializer||"zeros"),this.gammaInitializer=hB(e.gammaInitializer||"ones"),this.betaRegularizer=fo(e.betaRegularizer),this.gammaRegularizer=fo(e.gammaRegularizer),this.supportsMasking=!0}}mf.className="LayerNormalization",c_.registerClass(mf);var c_=c_;class mm extends h2{computeOutputShape(e){let t,n;return(e=hG(e),"channelsFirst"===this.dataFormat)?(t=null!=e[2]&&e[2]>=0?e[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[3]&&e[3]>=0?e[3]+this.padding[1][0]+this.padding[1][1]:null,[e[0],e[1],t,n]):(t=null!=e[1]&&e[1]>=0?e[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[2]&&e[2]>=0?e[2]+this.padding[1][0]+this.padding[1][1]:null,[e[0],t,n,e[3]])}call(e,t){return aQ(()=>{var t,n,a;return t=hW(e),n=this.padding,a=this.dataFormat,aQ(()=>{if(4!==t.rank)throw new cc("temporalPadding expects input tensor to be 4-D, but received a "+"".concat(t.rank,"-D tensor."));if(null==n&&(n=[[1,1],[1,1]]),2!==n.length||2!==n[0].length||2!==n[1].length)throw new cc("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==a&&(a=hs()),"channelsLast"!==a&&"channelsFirst"!==a)throw new cc("Unknown data format: ".concat(a,". ")+"Supported data formats are 'channelsLast' and 'channelsFirst.");return oq(t,"channelsFirst"===a?[[0,0],[0,0],n[0],n[1]]:[[0,0],n[0],n[1],[0,0]])})})}getConfig(){let e={padding:this.padding,dataFormat:this.dataFormat};return Object.assign(e,super.getConfig()),e}constructor(e){if(null==e&&(e={}),super(e),this.dataFormat=null==e.dataFormat?hs():e.dataFormat,null==e.padding)this.padding=[[1,1],[1,1]];else if("number"==typeof e.padding)this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{let t,n;if(e.padding=e.padding,2!==e.padding.length)throw new cc("ZeroPadding2D expects padding to be a length-2 array, but "+"received a length-".concat(e.padding.length," array."));if("number"==typeof e.padding[0])t=[e.padding[0],e.padding[0]],n=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,2!==e.padding[0].length)throw new cc("ZeroPadding2D expects height padding to be a length-2 array, "+"but received a length-".concat(e.padding[0].length," array."));if(t=e.padding[0],2!==e.padding[1].length)throw new cc("ZeroPadding2D expects width padding to be a length-2 array, "+"but received a length-".concat(e.padding[1].length," array."));n=e.padding[1]}this.padding=[t,n]}this.inputSpec=[new hQ({ndim:4})]}}mm.className="ZeroPadding2D",c_.registerClass(mm);let mg=aG({avgPool3d_:function(e,t,n,a,r){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",s=aV(e,"x","avgPool3d","float32"),o=s,l=!1;4===s.rank&&(l=!0,o=io(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),L(5===o.rank,()=>"Error in avgPool3d: x must be rank 5 but got rank ".concat(o.rank,".")),L("NDHWC"===i,()=>"Error in avgPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(i)),L("number"==typeof n&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>"Error in avgPool3d: Stride must be > 0, but got '".concat(n,"'")),iS("avgPool3d",a,r);let c={x:o},u=aR.runKernel(eV,c,{filterSize:t,strides:n,pad:a,dimRoundingMode:r,dataFormat:i});return(u=rM(u,o.dtype),l)?io(u,[u.shape[1],u.shape[2],u.shape[3],u.shape[4]]):u}}),mx=aG({maxPool3d_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",s=aV(e,"x","maxPool3d"),o=s,l=!1;4===s.rank&&(l=!0,o=io(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),L(5===o.rank,()=>"Error in maxPool3d: x must be rank 5 but got rank ".concat(o.rank,".")),L("NDHWC"===i,()=>"Error in maxPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(i)),iS("maxPool3d",a,r);let c={x:o},u=aR.runKernel(tW,c,{filterSize:t,strides:n,pad:a,dimRoundingMode:r,dataFormat:i});return l?io(u,[u.shape[1],u.shape[2],u.shape[3],u.shape[4]]):u}});var c_=c_;function my(e,t,n,a,r,i){return aQ(()=>{let s;cz(r),cV(i),cB(a),null==n&&(n=[1,1]),null==a&&(a="valid"),null==r&&(r=hs()),null==i&&(i="max"),e=fb(e,r);let o="same"===a?"same":"valid";return s="max"===i?lR(e,t,n,o):le(e,t,n,o),"channelsFirst"===r&&(s=i0(s,[0,3,1,2])),s})}function mb(e,t,n,a,r,i){return aQ(()=>{let s;cz(r),cV(i),cB(a),null==n&&(n=[1,1,1]),null==a&&(a="valid"),null==r&&(r=hs()),null==i&&(i="max"),e=fv(e,r);let o="same"===a?"same":"valid";return s="max"===i?mx(e,t,n,o):mg(e,t,n,o),"channelsFirst"===r&&(s=i0(s,[0,4,1,2,3])),s})}class mv extends h2{computeOutputShape(e){let t=fx((e=hG(e))[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}call(e,t){return aQ(()=>(this.invokeCallHook(e,t),e=ho(hW(e),2),lQ(this.poolingFunction(hW(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast"),[2])))}getConfig(){let e={poolSize:this.poolSize,padding:this.padding,strides:this.strides};return Object.assign(e,super.getConfig()),e}constructor(e){if(null==e.poolSize&&(e.poolSize=2),super(e),"number"==typeof e.poolSize)this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&1===e.poolSize.length&&"number"==typeof e.poolSize[0])this.poolSize=e.poolSize;else throw new cc("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.poolSize)));if(cI(this.poolSize,"poolSize"),null==e.strides)this.strides=this.poolSize;else if("number"==typeof e.strides)this.strides=[e.strides];else if(Array.isArray(e.strides)&&1===e.strides.length&&"number"==typeof e.strides[0])this.strides=e.strides;else throw new cc("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.strides)));cI(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,cB(this.padding),this.inputSpec=[new hQ({ndim:3})]}}class mw extends mv{poolingFunction(e,t,n,a,r){return cz(r),cB(a),my(e,t,n,a,r,"max")}constructor(e){super(e)}}mw.className="MaxPooling1D",c_.registerClass(mw);class mN extends mv{poolingFunction(e,t,n,a,r){return cz(r),cB(a),my(e,t,n,a,r,"avg")}constructor(e){super(e)}}mN.className="AveragePooling1D",c_.registerClass(mN);class mk extends h2{computeOutputShape(e){e=hG(e);let t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2];return(t=fx(t,this.poolSize[0],this.padding,this.strides[0]),n=fx(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat)?[e[0],e[1],t,n]:[e[0],t,n,e[3]]}call(e,t){return aQ(()=>(this.invokeCallHook(e,t),this.poolingFunction(hW(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){let e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat};return Object.assign(e,super.getConfig()),e}constructor(e){if(null==e.poolSize&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],null==e.strides)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(2!==e.strides.length)throw new cc("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+"".concat(e.strides.length,"."));this.strides=e.strides}else this.strides=[e.strides,e.strides];cI(this.poolSize,"poolSize"),cI(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,cz(this.dataFormat),cB(this.padding),this.inputSpec=[new hQ({ndim:4})]}}class mS extends mk{poolingFunction(e,t,n,a,r){return cz(r),cB(a),my(e,t,n,a,r,"max")}constructor(e){super(e)}}mS.className="MaxPooling2D",c_.registerClass(mS);class mC extends mk{poolingFunction(e,t,n,a,r){return cz(r),cB(a),my(e,t,n,a,r,"avg")}constructor(e){super(e)}}mC.className="AveragePooling2D",c_.registerClass(mC);class mT extends h2{computeOutputShape(e){e=hG(e);let t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],a="channelsFirst"===this.dataFormat?e[4]:e[3];return(t=fx(t,this.poolSize[0],this.padding,this.strides[0]),n=fx(n,this.poolSize[1],this.padding,this.strides[1]),a=fx(a,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat)?[e[0],e[1],t,n,a]:[e[0],t,n,a,e[4]]}call(e,t){return aQ(()=>(this.invokeCallHook(e,t),this.poolingFunction(hW(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){let e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat};return Object.assign(e,super.getConfig()),e}constructor(e){if(null==e.poolSize&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],null==e.strides)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(3!==e.strides.length)throw new cc("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+"".concat(e.strides.length,"."));this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];cI(this.poolSize,"poolSize"),cI(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,cz(this.dataFormat),cB(this.padding),this.inputSpec=[new hQ({ndim:5})]}}class mI extends mT{poolingFunction(e,t,n,a,r){return cz(r),cB(a),mb(e,t,n,a,r,"max")}constructor(e){super(e)}}mI.className="MaxPooling3D",c_.registerClass(mI);class mE extends mT{poolingFunction(e,t,n,a,r){return cz(r),cB(a),mb(e,t,n,a,r,"avg")}constructor(e){super(e)}}mE.className="AveragePooling3D",c_.registerClass(mE);class m_ extends h2{computeOutputShape(e){return[e[0],e[2]]}call(e,t){throw new cu}constructor(e){super(e),this.inputSpec=[new hQ({ndim:3})]}}class mA extends m_{call(e,t){return aQ(()=>lD(hW(e),1))}constructor(e){super(e||{})}}mA.className="GlobalAveragePooling1D",c_.registerClass(mA);class mR extends m_{call(e,t){return aQ(()=>ld(hW(e),1))}constructor(e){super(e||{})}}mR.className="GlobalMaxPooling1D",c_.registerClass(mR);class mD extends h2{computeOutputShape(e){return"channelsLast"===this.dataFormat?[e[0],e[3]]:[e[0],e[1]]}call(e,t){throw new cu}getConfig(){let e={dataFormat:this.dataFormat};return Object.assign(e,super.getConfig()),e}constructor(e){super(e),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,cz(this.dataFormat),this.inputSpec=[new hQ({ndim:4})]}}class mM extends mD{call(e,t){return aQ(()=>{let t=hW(e);return"channelsLast"===this.dataFormat?lD(t,[1,2]):lD(t,[2,3])})}}mM.className="GlobalAveragePooling2D",c_.registerClass(mM);class mF extends mD{call(e,t){return aQ(()=>{let t=hW(e);return"channelsLast"===this.dataFormat?ld(t,[1,2]):ld(t,[2,3])})}}mF.className="GlobalMaxPooling2D",c_.registerClass(mF);var c_=c_;class mO extends h2{build(e){this.built=!0}get trainable(){return null!=this.layer&&this.layer.trainable}set trainable(e){null!=this.layer&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){let e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}};return Object.assign(e,super.getConfig()),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=d9(t.layer,n);delete t.layer;let r={layer:a};return Object.assign(r,t),new e(r)}constructor(e){super(e),this.layer=e.layer}}class mP extends mO{build(e){if((e=hG(e)).length<3)throw new cc("TimeDistributed layer expects an input shape >= 3D, but received "+"input shape ".concat(JSON.stringify(e)));this.inputSpec=[{shape:e}];let t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),super.build(e)}computeOutputShape(e){let t=[(e=hG(e))[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t),a=e[1];return[n[0],a].concat(n.slice(1))}call(e,t){return aQ(()=>fO((e,n)=>[hW(this.layer.call(e,t)),[]],e=hW(e),[],!1,null,null,!1,!0)[1])}constructor(e){super(e),this.supportsMasking=!0}}mP.className="TimeDistributed",c_.registerClass(mP);class mj extends mO{get trainable(){return this._trainable}set trainable(e){this._trainable=e,null!=this.forwardLayer&&(this.forwardLayer.trainable=e),null!=this.backwardLayer&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){let t=Math.floor(e.length/2);this.forwardLayer.setWeights(e.slice(0,t)),this.backwardLayer.setWeights(e.slice(t))}computeOutputShape(e){let t,n,a,r=this.forwardLayer.computeOutputShape(e);return(Array.isArray(r)&&Array.isArray(r[0])||(r=[r]),this.returnState&&(a=r.slice(1)),t=r[0],"concat"===this.mergeMode?(t[t.length-1]*=2,n=[t]):n=null==this.mergeMode?[t,t.slice()]:[t],this.returnState)?null==this.mergeMode?n.concat(a).concat(a.slice()):[t].concat(a).concat(a.slice()):cg(n)}apply(e,t){let n=null==t?null:t.initialState,a=null==t?null:t.constants;null==t&&(t={});let r=fF(e,n,a,this.numConstants);if(e=r.inputs,n=r.initialState,a=r.constants,Array.isArray(e)&&(n=e.slice(1),e=e[0]),(null==n||0===n.length)&&null==a)return super.apply(e,t);let i=[],s=[];if(null!=n){let e=n.length;if(e%2>0)throw new cc("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=n,i.push(...n);let a=n.map(e=>new hQ({shape:e.shape}));this.forwardLayer.stateSpec=a.slice(0,e/2),this.backwardLayer.stateSpec=a.slice(e/2),s.push(...a)}if(null!=a)throw new cu("Support for constants in Bidirectional layers is not implemented yet.");let o=i[0]instanceof hJ;for(let e of i)if(e instanceof hJ!==o)throw new cc("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(!o)return super.apply(e,t);{let n=[e].concat(i),a=this.inputSpec.concat(s),r=this.inputSpec;this.inputSpec=a;let o=super.apply(n,t);return this.inputSpec=r,o}}call(e,t){return aQ(()=>{let n,a,r,i,s=t.initialState;if(null==s)n=this.forwardLayer.call(e,t),a=this.backwardLayer.call(e,t);else{let r=s.slice(0,s.length/2),i=s.slice(s.length/2);n=this.forwardLayer.call(e,Object.assign(t,{initialState:r})),a=this.backwardLayer.call(e,Object.assign(t,{initialState:i}))}return(this.returnState&&(Array.isArray(n)&&(r=n.slice(1).concat(a.slice(1))),n=n[0],a=a[0]),this.returnSequences&&(a=oU(a,1)),"concat"===this.mergeMode?i=hh([n,a]):"sum"===this.mergeMode?i=rP(n,a):"ave"===this.mergeMode?i=rz(.5,rP(n,a)):"mul"===this.mergeMode?i=rz(n,a):null==this.mergeMode&&(i=[n,a]),this.returnState)?null==this.mergeMode?i.concat(r):[i].concat(r):i})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){cW(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),cW(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,t){let n;if(Array.isArray(t)&&(t=t[0]),n=this.returnSequences?null==this.mergeMode?[t,t]:t:null==this.mergeMode?[null,null]:null,!this.returnState)return n;{let e=this.forwardLayer.states.map(e=>null);return Array.isArray(n)?n.concat(e).concat(e):[n].concat(e).concat(e)}}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(e),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){let e={mergeMode:this.mergeMode};return Object.assign(e,super.getConfig()),e}static fromConfig(e,t){let n=d9(t.layer);if(delete t.layer,null!=t.numConstants)throw new cu("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");return t.layer=n,new e(t)}constructor(e){super(e);let t=e.layer.getConfig(),n={};n.className=e.layer.getClassName(),n.config=t,this.forwardLayer=d9(n),t.goBackwards=!0!==t.goBackwards;let a={};if(a.className=e.layer.getClassName(),a.config=t,this.backwardLayer=d9(a),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=void 0===e.mergeMode?"concat":e.mergeMode,cC(cj,"BidirectionalMergeMode",this.mergeMode),e.weights)throw new cu("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}}mj.className="Bidirectional",c_.registerClass(mj);var c_=c_;class mL extends h2{getConfig(){let e={scale:this.scale,offset:this.offset};return Object.assign(e,super.getConfig()),e}call(e,t){return aQ(()=>("float32"!==(e=hW(e)).dtype&&(e=rM(e,"float32")),rP(rz(e,this.scale),this.offset)))}constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}}mL.className="Rescaling",c_.registerClass(mL);var c_=c_;let{resizeBilinear:mz,cropAndResize:mB}=uW;class mV extends h2{centerCrop(e,t,n,a,r,i,s,o){return aQ(()=>{let l,c=!1,u=[t/i,n/s,(a+t)/i,(r+n)/s],h=[];3===e.rank?(c=!0,l=i6([e])):l=e;for(let e=0;e<l.shape[0];e++)h.push(u);let d=aK(h,[h.length,4]),p=mB(l,d,ux(0,h.length,1,"int32"),[a,r],"nearest");if(c)return rM(hW(sd(p)),o);return rM(p,o)})}upsize(e,t,n,a){return aQ(()=>rM(mz(e,[t,n]),a))}call(e,t){return aQ(()=>{let t=hW(e),n=t.dtype,a=t.shape,r=a[a.length-3],i=a[a.length-2],s=0;r!==this.height&&(s=Math.floor((r-this.height)/2));let o=0;return(i!==this.width&&0===(o=Math.floor((i-this.width)/2))&&(o=1),s>=0&&o>=0)?this.centerCrop(t,s,o,this.height,this.width,r,i,n):this.upsize(e,this.height,this.width,n)})}getConfig(){let e={height:this.height,width:this.width};return Object.assign(e,super.getConfig()),e}computeOutputShape(e){let t=(e=hG(e)).length-3,n=e.length-2;return e[t]=this.height,e[n]=this.width,e}constructor(e){super(e),this.height=e.height,this.width=e.width}}mV.className="CenterCrop",c_.registerClass(mV);var c_=c_;let mU=aG({denseBincount_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=aV(e,"x","denseBincount"),i=aV(t,"weights","denseBincount");return L("int32"===r.dtype,()=>"Error in denseBincount: input "+"dtype must be int32, but got ".concat(r.dtype)),L(r.rank<=2,()=>"Error in denseBincount: input must be at most rank 2, but got "+"rank ".concat(r.rank,".")),L(n>=0,()=>"size must be non-negative, but got ".concat(n,".")),L(i.size===r.size||0===i.size,()=>"Error in denseBincount: weights must have the same shape as x or "+"0-length, but got x shape: ".concat(r.shape,", weights shape: ")+"".concat(i.shape,".")),aR.runKernel(te,{x:r,weights:i},{size:n,binaryOutput:a})}});class mW extends h2{getConfig(){let e={numTokens:this.numTokens,outputMode:this.outputMode};return Object.assign(e,super.getConfig()),e}computeOutputShape(e){return null==(e=hG(e))?[this.numTokens]:("oneHot"===this.outputMode&&1!==e[e.length-1]?e.push(this.numTokens):e[e.length-1]=this.numTokens,e)}call(e,t){return aQ(()=>{let n;if("int32"!==(e=hW(e)).dtype&&(e=rM(e,"int32")),void 0!==t.countWeights){if("count"!==this.outputMode)throw new cc("countWeights is not used when outputMode !== count.\n              Received countWeights=".concat(t.countWeights));n=hW(t.countWeights)}let a=ld(e),r=lp(e),i=se(this.numTokens,a).bufferSync().get(0),s=i_(r,0).bufferSync().get(0);if(!(i&&s))throw new cc("Input values must be between 0 < values <="+" numTokens with numTokens=".concat(this.numTokens));return function(e,t,n,a){let r,i=hW(e);if("int32"!==i.dtype&&(i=rM(i,"int32")),"int"===t)return i;let s=i.shape;if(0===i.rank&&(i=oQ(i,-1)),"oneHot"===t&&1!==i.shape[i.shape.length-1]&&(i=oQ(i,-1)),i.rank>2)throw new cc("When outputMode is not int, maximum output rank is 2"+" Received outputMode ".concat(t," and input shape ").concat(s)+" which would result in output rank ".concat(i.rank,"."));let o=["multiHot","oneHot"].includes(t),l=i;if(r=void 0!==a&&"count"===t?mU(l,a,n,o):mU(l,[],n,o),"tfIdf"!==t)return r;if(a)return rz(r,a);throw new cc("When outputMode is 'tfIdf', weights must be provided.")}(e,this.outputMode,this.numTokens,n)})}constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}}mW.className="CategoryEncoding",c_.registerClass(mW);var c_=c_;let mG=new Set(["bilinear","nearest"]);class mH extends h2{computeOutputShape(e){let t=(e=hG(e))[2];return[this.height,this.width,t]}getConfig(){let e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio};return Object.assign(e,super.getConfig()),e}call(e,t){return aQ(()=>{let t=[this.height,this.width];if("bilinear"===this.interpolation)return uW.resizeBilinear(e,t,!this.cropToAspectRatio);if("nearest"===this.interpolation)return uW.resizeNearestNeighbor(e,t,!this.cropToAspectRatio);throw Error("Interpolation is ".concat(this.interpolation," but only ").concat([...mG]," are supported"))})}constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(mG.has(e.interpolation))this.interpolation=e.interpolation;else throw new cc("Invalid interpolation parameter: ".concat(e.interpolation," is not implemented"));else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}}mH.className="Resizing",c_.registerClass(mH);var c_=c_;class mq{next(){if(void 0!==this.seed)return this.seed++}constructor(e){this.seed=e}}mq.className="RandomSeed";class mK extends h2{getConfig(){let e={seed:this.randomGenerator.seed};return Object.assign(e,super.getConfig()),e}constructor(e){super(e),this.randomGenerator=new mq(e.seed)}}mK.className="BaseRandomLayer";let mX=new Set(["bilinear","nearest"]);class mY extends mK{getConfig(){let e={factor:this.factor,interpolation:this.interpolation};return Object.assign(e,super.getConfig()),e}computeOutputShape(e){let t=(e=hG(e))[2];return[this.imgHeight,-1,t]}call(e,t){return aQ(()=>{let t=hW(e);this.imgHeight=t.shape[t.shape.length-3];let n=t.shape[t.shape.length-2];this.widthFactor=uJ([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let a=this.widthFactor.dataSync()[0]*n;a=Math.round(a);let r=[this.imgHeight,a];switch(this.interpolation){case"bilinear":return uW.resizeBilinear(e,r);case"nearest":return uW.resizeNearestNeighbor(e,r);default:throw Error("Interpolation is ".concat(this.interpolation,"\n          but only ").concat([...mX]," are supported"))}})}constructor(e){super(e);let{factor:t,interpolation:n="bilinear"}=e;if(this.factor=t,Array.isArray(this.factor)&&2===this.factor.length)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new cc("Invalid factor: ".concat(this.factor,". Must be positive number or tuple of 2 numbers"));if(this.widthLower<-1||this.widthUpper<-1)throw new cc("factor must have values larger than -1. Got: ".concat(this.factor));if(this.widthUpper<this.widthLower)throw new cc("factor cannot have upper bound less than lower bound.\n        Got upper bound: ".concat(this.widthUpper,".\n        Got lower bound: ").concat(this.widthLower,"\n      "));if(n)if(mX.has(n))this.interpolation=n;else throw new cc("Invalid interpolation parameter: ".concat(n," is not implemented"))}}function mZ(e){return new h3(e)}function mQ(e){return new fh(e)}function mJ(e){return new fl(e)}function m$(e){return new fc(e)}function m0(e){return new fu(e)}function m1(e){return new fp(e)}function m2(e){return new fd(e)}function m3(e){return new fA(e)}function m4(e){return new fS(e)}function m5(e){return new fT(e)}function m6(e){return new fC(e)}function m8(e){return new fI(e)}function m9(e){return new f_(e)}function m7(e){return new fR(e)}function ge(e){return new fD(e)}function gt(e){return new fM(e)}function gn(e){return new f0(e)}function ga(e){return new fJ(e)}function gr(e){return new fZ(e)}function gi(e){return new fQ(e)}function gs(e){return new f$(e)}function go(e){return new f1(e)}function gl(e){return new f2(e)}function gc(e){return new f3(e)}function gu(e){return new f5(e)}function gh(e){return new f8(e)}function gd(e){return new f7(e)}function gp(e){return new mn(e)}function gf(e){return new me(e)}function gm(e){return new mt(e)}function gg(e){return new f9(e)}function gx(e){return new mr(e)}function gy(e){return new mp(e)}function gb(e){return new mf(e)}function gv(e){return new mm(e)}function gw(e){return new mN(e)}function gN(e){return gw(e)}function gk(e){return gw(e)}function gS(e){return new mC(e)}function gC(e){return gS(e)}function gT(e){return gS(e)}function gI(e){return new mE(e)}function gE(e){return gI(e)}function g_(e){return gI(e)}function gA(e){return new mA(e)}function gR(e){return new mM(e)}function gD(e){return new mR(e)}function gM(e){return new mF(e)}function gF(e){return new mw(e)}function gO(e){return new mS(e)}function gP(e){return new mI(e)}function gj(e){return new fV(e)}function gL(e){return new fB(e)}function gz(e){return new fW(e)}function gB(e){return new fU(e)}function gV(e){return new fz(e)}function gU(e){return new fL(e)}function gW(e){return new fY(e)}function gG(e){return new fX(e)}function gH(e){return new fP(e)}function gq(e){return new fG(e)}function gK(e){return new mj(e)}function gX(e){return new mP(e)}mY.className="RandomWidth",c_.registerClass(mY);let gY=gD,gZ=gM,gQ=gF,gJ=gO;function g$(e){return new mi(e)}function g0(e){return new ms(e)}function g1(e){return new mo(e)}function g2(e){return new f4(e)}function g3(e){return new mL(e)}function g4(e){return new mV(e)}function g5(e){return new mH(e)}function g6(e){return new mW(e)}function g8(e){return new mY(e)}e.s(["Layer",()=>h2,"RNN",()=>fP,"RNNCell",()=>fj,"activation",()=>gn,"add",()=>gh,"alphaDropout",()=>g1,"average",()=>gd,"averagePooling1d",()=>gw,"averagePooling2d",()=>gS,"averagePooling3d",()=>gI,"avgPool1d",()=>gN,"avgPool2d",()=>gC,"avgPool3d",()=>gE,"avgPooling1d",()=>gk,"avgPooling2d",()=>gT,"avgPooling3d",()=>g_,"batchNormalization",()=>gy,"bidirectional",()=>gK,"categoryEncoding",()=>g6,"centerCrop",()=>g4,"concatenate",()=>gp,"conv1d",()=>m3,"conv2d",()=>m4,"conv2dTranspose",()=>m5,"conv3d",()=>m6,"conv3dTranspose",()=>m8,"convLstm2d",()=>gW,"convLstm2dCell",()=>gG,"cropping2D",()=>m7,"dense",()=>ga,"depthwiseConv2d",()=>gt,"dot",()=>gx,"dropout",()=>gr,"elu",()=>mQ,"embedding",()=>gu,"flatten",()=>gs,"gaussianDropout",()=>g0,"gaussianNoise",()=>g$,"globalAveragePooling1d",()=>gA,"globalAveragePooling2d",()=>gR,"globalMaxPool1d",()=>gY,"globalMaxPool2d",()=>gZ,"globalMaxPooling1d",()=>gD,"globalMaxPooling2d",()=>gM,"gru",()=>gj,"gruCell",()=>gL,"input",()=>pH,"inputLayer",()=>mZ,"layerNormalization",()=>gb,"leakyReLU",()=>m$,"lstm",()=>gz,"lstmCell",()=>gB,"masking",()=>g2,"maxPool1d",()=>gQ,"maxPool2d",()=>gJ,"maxPooling1d",()=>gF,"maxPooling2d",()=>gO,"maxPooling3d",()=>gP,"maximum",()=>gf,"minimum",()=>gm,"multiply",()=>gg,"permute",()=>gc,"prelu",()=>m0,"randomWidth",()=>g8,"reLU",()=>mJ,"repeatVector",()=>go,"rescaling",()=>g3,"reshape",()=>gl,"resizing",()=>g5,"rnn",()=>gH,"separableConv2d",()=>m9,"simpleRNN",()=>gV,"simpleRNNCell",()=>gU,"softmax",()=>m1,"spatialDropout1d",()=>gi,"stackedRNNCells",()=>gq,"thresholdedReLU",()=>m2,"timeDistributed",()=>gX,"upSampling2d",()=>ge,"zeroPadding2d",()=>gv],26196),e.i(75168);var g9=e.i(26196);function g7(e,t){return pc(e,t)}function xe(e,t){return pi(e,t)}function xt(e,t){return pf(e,t)}function xn(e,t){return pu(e,t)}function xa(e,t){return pa(e,t)}function xr(e,t){return pd(e,t)}function xi(e,t){return aQ(()=>{let n=ph(e,t),a=rP(n,aQ(()=>rM(il(iR(sn(e,1),sn(t,0))),"float32")));return rM(iM(se(a,0),rL(n,a),0),"float32")})}function xs(e,t){return ps(e,t)}function xo(e,t){return pt(e,t)}function xl(e,t){return pn(e,t)}function xc(e,t){return pn(e,t)}function xu(e,t){return pn(e,t)}function xh(e,t){return pe(e,t)}function xd(e,t){return pe(e,t)}function xp(e,t){return pe(e,t)}function xf(e,t){return aQ(()=>{let n=e.sub(t).square().sum(),a=e.sub(e.mean()).square().sum();return rG(1).sub(n.div(a))})}function xm(e){return new fr(e)}function xg(e){return fn(e),new fr({l1:null!=e?e.l1:null,l2:0})}function xx(e){return fn(e),new fr({l2:null!=e?e.l2:null,l1:0})}e.s(["MAPE",()=>xc,"MSE",()=>xd,"binaryAccuracy",()=>g7,"binaryCrossentropy",()=>xe,"categoricalAccuracy",()=>xn,"categoricalCrossentropy",()=>xa,"cosineProximity",()=>xs,"mape",()=>xu,"meanAbsoluteError",()=>xo,"meanAbsolutePercentageError",()=>xl,"meanSquaredError",()=>xh,"mse",()=>xp,"precision",()=>xr,"r2Score",()=>xf,"recall",()=>xi,"sparseCategoricalAccuracy",()=>xt],2923),e.i(2923),e.s([],35425),e.s(["modelFromJSON",()=>pW],12450),e.i(35425),e.i(12450),e.s(["l1",()=>xg,"l1l2",()=>xm,"l2",()=>xx],17096),e.i(17096);eT.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,e=>{e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});var d8=d8,cs=cs;!function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_QINT16=15]="DT_QINT16",e[e.DT_QUINT16=16]="DT_QUINT16",e[e.DT_UINT16=17]="DT_UINT16",e[e.DT_COMPLEX128=18]="DT_COMPLEX128",e[e.DT_HALF=19]="DT_HALF",e[e.DT_RESOURCE=20]="DT_RESOURCE",e[e.DT_VARIANT=21]="DT_VARIANT",e[e.DT_UINT32=22]="DT_UINT32",e[e.DT_UINT64=23]="DT_UINT64",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",e[e.DT_QINT16_REF=115]="DT_QINT16_REF",e[e.DT_QUINT16_REF=116]="DT_QUINT16_REF",e[e.DT_UINT16_REF=117]="DT_UINT16_REF",e[e.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",e[e.DT_HALF_REF=119]="DT_HALF_REF",e[e.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",e[e.DT_VARIANT_REF=121]="DT_VARIANT_REF",e[e.DT_UINT32_REF=122]="DT_UINT32_REF",e[e.DT_UINT64_REF=123]="DT_UINT64_REF"}(x||(x={})),function(e){var t;(t=e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"}(y||(y={}));var cs=cs;e.s(["json",()=>xy],28245);let xy=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}];e.i(28245),e.s(["json",()=>xb],9470);let xb=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}];e.i(9470),e.s(["json",()=>xv],82990);let xv=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}];e.i(82990),e.s(["json",()=>xw],21690);let xw=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}];e.i(21690),e.s(["json",()=>xN],67831);let xN=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}];e.i(67831),e.s(["json",()=>xk],14304);let xk=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}];e.i(14304),e.s(["json",()=>xS],22104);let xS=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}];e.i(22104),e.s(["json",()=>xC],90091);let xC=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}];e.i(90091),e.s(["json",()=>xT],46207);let xT=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}];e.i(46207),e.s(["json",()=>xI],95893);let xI=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}];e.i(95893),e.s(["json",()=>xE],46722);let xE=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}];e.i(46722),e.s(["json",()=>x_],49625);let x_=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}];e.i(49625),e.s(["json",()=>xA],4179);let xA=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}];e.i(4179),e.s(["json",()=>xR],72396);let xR=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}];e.i(72396),e.s(["json",()=>xD],74440);let xD=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}];e.i(74440),e.s(["json",()=>xM],35645);let xM=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}];e.i(35645),e.s(["json",()=>xF],95414);let xF=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}];e.i(95414),e.s(["json",()=>xO],76286);let xO=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}];e.i(76286),e.s(["json",()=>xP],38464);let xP=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}];e.i(38464);var cs=cs,cs=cs;e.s(["OP_SCOPE_SUFFIX",()=>aW,"abs",()=>r4,"acos",()=>o$,"acosh",()=>o0,"add",()=>rP,"addN",()=>xj,"all",()=>o1,"any",()=>o2,"argMax",()=>o3,"argMin",()=>o4,"asin",()=>o5,"asinh",()=>o6,"atan",()=>o8,"atan2",()=>o9,"atanh",()=>o7,"avgPool",()=>le,"avgPool3d",()=>mg,"basicLSTMCell",()=>xL,"batchNorm",()=>lt,"batchNorm2d",()=>mu,"batchNorm3d",()=>mc,"batchNorm4d",()=>ml,"batchToSpaceND",()=>oK,"bincount",()=>ug,"bitwiseAnd",()=>xz,"booleanMaskAsync",()=>yh,"broadcastArgs",()=>xB,"broadcastTo",()=>iD,"buffer",()=>rD,"cast",()=>rM,"ceil",()=>ln,"clipByValue",()=>la,"clone",()=>rF,"complex",()=>aH,"concat",()=>oY,"concat1d",()=>u4,"concat2d",()=>u5,"concat3d",()=>u6,"concat4d",()=>u8,"conv1d",()=>lr,"conv2d",()=>iL,"conv2dTranspose",()=>li,"conv3d",()=>fm,"conv3dTranspose",()=>ff,"cos",()=>oG,"cosh",()=>oH,"cosineWindow",()=>c1,"cumprod",()=>oV,"cumsum",()=>iQ,"denseBincount",()=>mU,"depthToSpace",()=>ls,"depthwiseConv2d",()=>lo,"diag",()=>xV,"dilation2d",()=>ll,"div",()=>rL,"divNoNan",()=>lc,"dot",()=>lu,"dropout",()=>he,"einsum",()=>ue,"elu",()=>sW,"enclosingPowerOfTwo",()=>c0,"ensureShape",()=>xU,"equal",()=>sn,"erf",()=>lh,"euclideanNorm",()=>lm,"exp",()=>i3,"expandDims",()=>oQ,"expm1",()=>lg,"eye",()=>cX,"fft",()=>lx,"fill",()=>r$,"floor",()=>sh,"floorDiv",()=>rj,"fused",()=>yx,"gather",()=>oJ,"gatherND",()=>ym,"greater",()=>se,"greaterEqual",()=>i_,"ifft",()=>ly,"imag",()=>iJ,"image",()=>uW,"inTopKAsync",()=>yg,"irfft",()=>lb,"isFinite",()=>lv,"isInf",()=>lw,"isNaN",()=>lN,"leakyRelu",()=>sG,"less",()=>si,"lessEqual",()=>iA,"linalg",()=>uG,"linspace",()=>xW,"localResponseNormalization",()=>lk,"log",()=>sf,"log1p",()=>lE,"logSigmoid",()=>lC,"logSoftmax",()=>lT,"logSumExp",()=>lI,"logicalAnd",()=>iR,"logicalNot",()=>oW,"logicalOr",()=>l_,"logicalXor",()=>lA,"losses",()=>uH,"lowerBound",()=>xH,"matMul",()=>iI,"max",()=>ld,"maxPool",()=>lR,"maxPool3d",()=>mx,"maxPoolWithArgmax",()=>xq,"maximum",()=>r9,"mean",()=>lD,"meshgrid",()=>xK,"min",()=>lp,"minimum",()=>lM,"mirrorPad",()=>lF,"mod",()=>lO,"moments",()=>mh,"movingAverage",()=>yd,"mul",()=>rz,"multiRNNCell",()=>xX,"multinomial",()=>xY,"neg",()=>is,"norm",()=>lf,"notEqual",()=>lP,"oneHot",()=>lj,"ones",()=>sc,"onesLike",()=>lL,"op",()=>aG,"outerProduct",()=>xZ,"pad",()=>oq,"pad1d",()=>xQ,"pad2d",()=>xJ,"pad3d",()=>x$,"pad4d",()=>x0,"pool",()=>lz,"pow",()=>r1,"prelu",()=>sH,"print",()=>rO,"prod",()=>lB,"raggedGather",()=>x1,"raggedRange",()=>x2,"raggedTensorToTensor",()=>x3,"rand",()=>x4,"randomGamma",()=>x5,"randomNormal",()=>u9,"randomStandardNormal",()=>x6,"randomUniform",()=>uJ,"randomUniformInt",()=>x8,"range",()=>ux,"real",()=>i$,"reciprocal",()=>lV,"relu",()=>sq,"relu6",()=>sK,"reshape",()=>io,"reverse",()=>oU,"reverse1d",()=>x9,"reverse2d",()=>x7,"reverse3d",()=>ye,"reverse4d",()=>yt,"rfft",()=>lG,"round",()=>lH,"rsqrt",()=>i4,"scalar",()=>rG,"scatterND",()=>yp,"searchSorted",()=>xG,"selu",()=>lq,"separableConv2d",()=>lK,"setdiff1dAsync",()=>yn,"sigmoid",()=>sX,"sign",()=>lX,"signal",()=>uU,"sin",()=>iV,"sinh",()=>iU,"slice",()=>su,"slice1d",()=>u0,"slice2d",()=>u1,"slice3d",()=>u2,"slice4d",()=>u3,"softmax",()=>lY,"softplus",()=>lS,"spaceToBatchND",()=>iE,"sparse",()=>uq,"sparseToDense",()=>yf,"spectral",()=>uV,"split",()=>iO,"sqrt",()=>rB,"square",()=>rV,"squaredDifference",()=>lZ,"squeeze",()=>lQ,"stack",()=>i6,"step",()=>ir,"stridedSlice",()=>lJ,"string",()=>uK,"sub",()=>r2,"sum",()=>il,"tan",()=>l$,"tanh",()=>l0,"tensor",()=>aK,"tensor1d",()=>c$,"tensor2d",()=>c4,"tensor3d",()=>ya,"tensor4d",()=>yr,"tensor5d",()=>yi,"tensor6d",()=>ys,"tensorScatterUpdate",()=>yo,"tile",()=>i5,"topk",()=>l1,"transpose",()=>i0,"truncatedNormal",()=>u$,"unique",()=>l2,"unsortedSegmentSum",()=>i8,"unstack",()=>sd,"upperBound",()=>yl,"variable",()=>hq,"where",()=>iM,"whereAsync",()=>yu,"zeros",()=>sl,"zerosLike",()=>rU],90802),e.s([],59835),e.i(59835),e.s(["OP_SCOPE_SUFFIX",()=>aW,"abs",()=>r4,"acos",()=>o$,"acosh",()=>o0,"add",()=>rP,"addN",()=>xj,"all",()=>o1,"any",()=>o2,"argMax",()=>o3,"argMin",()=>o4,"asin",()=>o5,"asinh",()=>o6,"atan",()=>o8,"atan2",()=>o9,"atanh",()=>o7,"avgPool",()=>le,"avgPool3d",()=>mg,"basicLSTMCell",()=>xL,"batchNorm",()=>lt,"batchNorm2d",()=>mu,"batchNorm3d",()=>mc,"batchNorm4d",()=>ml,"batchToSpaceND",()=>oK,"bincount",()=>ug,"bitwiseAnd",()=>xz,"booleanMaskAsync",()=>yh,"broadcastArgs",()=>xB,"broadcastTo",()=>iD,"buffer",()=>rD,"cast",()=>rM,"ceil",()=>ln,"clipByValue",()=>la,"clone",()=>rF,"complex",()=>aH,"concat",()=>oY,"concat1d",()=>u4,"concat2d",()=>u5,"concat3d",()=>u6,"concat4d",()=>u8,"conv1d",()=>lr,"conv2d",()=>iL,"conv2dTranspose",()=>li,"conv3d",()=>fm,"conv3dTranspose",()=>ff,"cos",()=>oG,"cosh",()=>oH,"cosineWindow",()=>c1,"cumprod",()=>oV,"cumsum",()=>iQ,"denseBincount",()=>mU,"depthToSpace",()=>ls,"depthwiseConv2d",()=>lo,"diag",()=>xV,"dilation2d",()=>ll,"div",()=>rL,"divNoNan",()=>lc,"dot",()=>lu,"dropout",()=>he,"einsum",()=>ue,"elu",()=>sW,"enclosingPowerOfTwo",()=>c0,"ensureShape",()=>xU,"equal",()=>sn,"erf",()=>lh,"euclideanNorm",()=>lm,"exp",()=>i3,"expandDims",()=>oQ,"expm1",()=>lg,"eye",()=>cX,"fft",()=>lx,"fill",()=>r$,"floor",()=>sh,"floorDiv",()=>rj,"fused",()=>yx,"gather",()=>oJ,"gatherND",()=>ym,"greater",()=>se,"greaterEqual",()=>i_,"ifft",()=>ly,"imag",()=>iJ,"image",()=>uW,"inTopKAsync",()=>yg,"irfft",()=>lb,"isFinite",()=>lv,"isInf",()=>lw,"isNaN",()=>lN,"leakyRelu",()=>sG,"less",()=>si,"lessEqual",()=>iA,"linalg",()=>uG,"linspace",()=>xW,"localResponseNormalization",()=>lk,"log",()=>sf,"log1p",()=>lE,"logSigmoid",()=>lC,"logSoftmax",()=>lT,"logSumExp",()=>lI,"logicalAnd",()=>iR,"logicalNot",()=>oW,"logicalOr",()=>l_,"logicalXor",()=>lA,"losses",()=>uH,"lowerBound",()=>xH,"matMul",()=>iI,"max",()=>ld,"maxPool",()=>lR,"maxPool3d",()=>mx,"maxPoolWithArgmax",()=>xq,"maximum",()=>r9,"mean",()=>lD,"meshgrid",()=>xK,"min",()=>lp,"minimum",()=>lM,"mirrorPad",()=>lF,"mod",()=>lO,"moments",()=>mh,"movingAverage",()=>yd,"mul",()=>rz,"multiRNNCell",()=>xX,"multinomial",()=>xY,"neg",()=>is,"norm",()=>lf,"notEqual",()=>lP,"oneHot",()=>lj,"ones",()=>sc,"onesLike",()=>lL,"op",()=>aG,"outerProduct",()=>xZ,"pad",()=>oq,"pad1d",()=>xQ,"pad2d",()=>xJ,"pad3d",()=>x$,"pad4d",()=>x0,"pool",()=>lz,"pow",()=>r1,"prelu",()=>sH,"print",()=>rO,"prod",()=>lB,"raggedGather",()=>x1,"raggedRange",()=>x2,"raggedTensorToTensor",()=>x3,"rand",()=>x4,"randomGamma",()=>x5,"randomNormal",()=>u9,"randomStandardNormal",()=>x6,"randomUniform",()=>uJ,"randomUniformInt",()=>x8,"range",()=>ux,"real",()=>i$,"reciprocal",()=>lV,"relu",()=>sq,"relu6",()=>sK,"reshape",()=>io,"reverse",()=>oU,"reverse1d",()=>x9,"reverse2d",()=>x7,"reverse3d",()=>ye,"reverse4d",()=>yt,"rfft",()=>lG,"round",()=>lH,"rsqrt",()=>i4,"scalar",()=>rG,"scatterND",()=>yp,"searchSorted",()=>xG,"selu",()=>lq,"separableConv2d",()=>lK,"setdiff1dAsync",()=>yn,"sigmoid",()=>sX,"sign",()=>lX,"signal",()=>uU,"sin",()=>iV,"sinh",()=>iU,"slice",()=>su,"slice1d",()=>u0,"slice2d",()=>u1,"slice3d",()=>u2,"slice4d",()=>u3,"softmax",()=>lY,"softplus",()=>lS,"spaceToBatchND",()=>iE,"sparse",()=>uq,"sparseToDense",()=>yf,"spectral",()=>uV,"split",()=>iO,"sqrt",()=>rB,"square",()=>rV,"squaredDifference",()=>lZ,"squeeze",()=>lQ,"stack",()=>i6,"step",()=>ir,"stridedSlice",()=>lJ,"string",()=>uK,"sub",()=>r2,"sum",()=>il,"tan",()=>l$,"tanh",()=>l0,"tensor",()=>aK,"tensor1d",()=>c$,"tensor2d",()=>c4,"tensor3d",()=>ya,"tensor4d",()=>yr,"tensor5d",()=>yi,"tensor6d",()=>ys,"tensorScatterUpdate",()=>yo,"tile",()=>i5,"topk",()=>l1,"transpose",()=>i0,"truncatedNormal",()=>u$,"unique",()=>l2,"unsortedSegmentSum",()=>i8,"unstack",()=>sd,"upperBound",()=>yl,"variable",()=>hq,"where",()=>iM,"whereAsync",()=>yu,"zeros",()=>sl,"zerosLike",()=>rU],9670),e.i(31445);let xj=aG({addN_:function(e){L(Array.isArray(e),()=>"The argument passed to tf.addN() must be a list of tensors"),L(e.length>=1,()=>"Must pass at least one tensor to tf.addN(), but got "+"".concat(e.length));let t=e.map((e,t)=>aV(e,"tensors".concat(t),"addN")),n=t[0];return t.forEach(e=>{if(e.dtype!==n.dtype)throw Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(e=>{if(!G(e.shape,n.shape))throw Error("All tensors passed to tf.addN() must have the same shape")}),aR.runKernel(eR,t)}}),xL=aG({basicLSTMCell_:function(e,t,n,a,r,i){let s=aV(e,"forgetBias","basicLSTMCell"),o=aV(t,"lstmKernel","basicLSTMCell"),l=aV(n,"lstmBias","basicLSTMCell"),c=aV(a,"data","basicLSTMCell"),u=aV(r,"c","basicLSTMCell"),h=rP(iI(oY([c,aV(i,"h","basicLSTMCell")],1),o),l),d=h.shape[0],p=h.shape[1]/4,f=[d,p],m=su(h,[0,0],f),g=su(h,[0,p],f),x=su(h,[0,2*p],f),y=su(h,[0,3*p],f),b=rP(rz(sX(m),l0(g)),rz(u,sX(rP(s,x)))),v=rz(l0(b),sX(y));return[b,v]}}),xz=aG({bitwiseAnd_:function(e,t){let n=aV(e,"x","bitwiseAnd"),a=aV(t,"y","bitwiseAnd");if(!G(n.shape,a.shape))throw Error("BitwiseAnd: Tensors must have the same shape. x: ".concat(n.shape,", y: ").concat(a.shape));if("int32"!==n.dtype||"int32"!==a.dtype)throw Error("BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ".concat(n.dtype," and type of y: ").concat(a.dtype));return aR.runKernel(eq,{a:n,b:a})}}),xB=aG({broadcastArgs_:function(e,t){let n=aV(e,"s0","broadcastArgs","int32"),a=aV(t,"s1","broadcastArgs","int32");if(1!==n.rank)throw Error("broadcastArgs(): first input must be a vector (rank=1). "+"Has rank ".concat(n.rank));if(1!==a.rank)throw Error("broadcastArgs(): second input must be a vector (rank=1). "+"Has rank ".concat(a.rank));return aR.runKernel(eK,{s0:n,s1:a})}}),xV=aG({diag_:function(e){let t=aV(e,"x","diag");return aR.runKernel(ti,{x:t})}}),xU=aG({ensureShape_:function(e,t){let n=aV(e,"x","ensureShape","string_or_numeric");if(!W(n.shape,t))throw Error("EnsureShape: Shape of tensor ".concat(n.shape," is not compatible with expected shape ").concat(t));return e}});function xW(e,t,n){if(n<=0)throw Error("The number of values should be positive.");return aR.runKernel(tF,{},{start:e,stop:t,num:n})}e.s(["searchSorted",()=>xG],36975);let xG=aG({searchSorted_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"left",a=aV(e,"sortedSequence","searchSorted"),r=aV(t,"values","searchSorted"),i=a.shape[a.shape.length-1],s=r.shape[r.shape.length-1],o=io(a,[-1,i]),l=io(r,[-1,s]);if(o.rank<2)throw Error("Sorted input argument must be at least 2-dimensional");if(o.shape[0]!==l.shape[0])throw Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(V(l.shape)>=0x80000000)throw Error("values tensor size must less than ".concat(0x80000000));if(o.shape[1]>=0x80000000)throw Error("trailing dim_size must less than ".concat(0x80000000," for int32 output type, was ").concat(o.shape[1]));return aR.runKernel(nm,{sortedSequence:o,values:l},{side:n})}});function xH(e,t){return xG(e,t,"left")}let xq=aG({maxPoolWithArgmax_:function(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=aV(e,"x","maxPoolWithArgmax"),s=aR.runKernel(tH,{x:i},{filterSize:t,strides:n,pad:a,includeBatchInIndex:r});return{result:s[0],indexes:s[1]}}});function xK(e,t){let{indexing:n="xy"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("xy"!==n&&"ij"!==n)throw TypeError("".concat(n," is not a valid third argument to meshgrid"));if(void 0===e)return[];let a=aV(e,"x","meshgrid",e instanceof am?e.dtype:"float32");if(void 0===t)return[a];let r=aV(t,"y","meshgrid",t instanceof am?t.dtype:"float32"),i=V(a.shape),s=V(r.shape);return"xy"===n?(a=io(a,[1,-1]),r=io(r,[-1,1]),[iI(sc([s,1],a.dtype),a),iI(r,sc([1,i],r.dtype))]):(a=io(a,[-1,1]),r=io(r,[1,-1]),[iI(a,sc([1,s],a.dtype)),iI(sc([i,1],r.dtype),r)])}let xX=aG({multiRNNCell_:function(e,t,n,a){let r=aV(t,"data","multiRNNCell"),i=aU(n,"c","multiRNNCell"),s=aU(a,"h","multiRNNCell"),o=r,l=[];for(let t=0;t<e.length;t++){let n=e[t](o,i[t],s[t]);l.push(n[0]),l.push(n[1]),o=n[1]}let c=[],u=[];for(let e=0;e<l.length;e+=2)c.push(l[e]),u.push(l[e+1]);return[c,u]}}),xY=aG({multinomial_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=aV(e,"logits","multinomial"),i=r.size,s=r.rank;if(i<2)throw Error("Error in multinomial: you need at least 2 outcomes, but got "+"".concat(i,"."));if(s>2)throw Error("Rank of probabilities must be 1 or 2, but is ".concat(s));n=n||Math.random();let o=1===s?io(r,[1,-1]):r,l={numSamples:t,seed:n,normalized:a},c=aR.runKernel(tY,{logits:o},l);return 1===s?io(c,[c.size]):c}}),xZ=aG({outerProduct_:function(e,t){let n=aV(e,"v1","outerProduct"),a=aV(t,"v2","outerProduct");return L(1===n.rank&&1===a.rank,()=>"Error in outerProduct: inputs must be rank 1, but got ranks "+"".concat(n.rank," and ").concat(a.rank,".")),iI(io(n,[-1,1]),io(a,[1,-1]))}}),xQ=aG({pad1d_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return L(2===t.length,()=>"Invalid number of paddings. Must be length of 2."),oq(e,[t],n)}}),xJ=aG({pad2d_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return L(2===t.length&&2===t[0].length&&2===t[1].length,()=>"Invalid number of paddings. Must be length of 2 each."),oq(e,t,n)}}),x$=aG({pad3d_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return L(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,()=>"Invalid number of paddings. Must be length of 2 each."),oq(e,t,n)}}),x0=aG({pad4d_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return L(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,()=>"Invalid number of paddings. Must be length of 2 each."),oq(e,t,n)}}),x1=aG({raggedGather_:function(e,t,n,a){let r=e.map((e,t)=>aV(e,"tensors".concat(t),"raggedGather","int32")),i=aV(t,"paramsDenseValues","raggedGather"),s=aV(n,"indices","raggedGather","int32"),o=aR.runKernel(t8,{paramsNestedSplits:r,paramsDenseValues:i,indices:s},{outputRaggedRank:a});return{outputNestedSplits:o.slice(0,o.length-1),outputDenseValues:o[o.length-1]}}}),x2=aG({raggedRange_:function(e,t,n){let a=aV(e,"starts","raggedRange"),r=aV(t,"limits","raggedRange",a.dtype),i=aV(n,"deltas","raggedRange",a.dtype),s=aR.runKernel(t9,{starts:a,limits:r,deltas:i});return{rtNestedSplits:s[0],rtDenseValues:s[1]}}}),x3=aG({raggedTensorToTensor_:function(e,t,n,a,r){let i=aV(e,"shape","raggedTensorToTensor","int32"),s=aV(t,"values","raggedTensorToTensor"),o=aV(n,"defaultValue","raggedTensorToTensor",s.dtype),l=a.map((e,t)=>aV(e,"tensors".concat(t),"raggedTensorToTensor","int32"));return aR.runKernel(t7,{shape:i,values:s,defaultValue:o,rowPartitionTensors:l},{rowPartitionTypes:r})}}),x4=aG({rand_:function(e,t,n){eb(e);let a=V(e),r=null;if(null==n||"float32"===n)r=new Float32Array(a);else if("int32"===n)r=new Int32Array(a);else if("bool"===n)r=new Uint8Array(a);else throw Error("Unknown data type ".concat(n));for(let e=0;e<a;e++)r[e]=t();return aR.makeTensor(r,e,n)}}),x5=aG({randomGamma_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",r=arguments.length>4?arguments[4]:void 0;if(eb(e),null==n&&(n=1),null==a&&(a="float32"),"float32"!==a&&"int32"!==a)throw Error("Unsupported data type ".concat(a));let i=new uZ(t,n,a,r),s=rD(e,a);for(let e=0;e<s.values.length;e++)s.values[e]=i.nextValue();return s.toTensor()}}),x6=aG({randomStandardNormal_:function(e,t,n){if(null!=t&&"bool"===t)throw Error("Unsupported data type ".concat(t));return u9(e,0,1,t,n)}}),x8=aG({randomUniformInt_:function(e,t,n,a){return uJ(e,t,n,"int32",a)}}),x9=aG({reverse1d_:function(e){let t=aV(e,"x","reverse");return L(1===t.rank,()=>"Error in reverse1D: x must be rank 1 but got rank ".concat(t.rank,".")),oU(t,0)}}),x7=aG({reverse2d_:function(e,t){let n=aV(e,"x","reverse");return L(2===n.rank,()=>"Error in reverse2D: x must be rank 2 but got rank ".concat(n.rank,".")),oU(n,t)}}),ye=aG({reverse3d_:function(e,t){let n=aV(e,"x","reverse");return L(3===n.rank,()=>"Error in reverse3D: x must be rank 3 but got rank ".concat(n.rank,".")),oU(n,t)}}),yt=aG({reverse4d_:function(e,t){let n=aV(e,"x","reverse");return L(4===n.rank,()=>"Error in reverse4D: x must be rank 4 but got rank ".concat(n.rank,".")),oU(n,t)}}),yn=async function(e,t){let n=aV(e,"x","setdiff1d"),a=aV(t,"y","setdiff1d");L(n.dtype===a.dtype,()=>"x and y should have the same dtype, but got x (".concat(n.dtype,") and y (").concat(a.dtype,").")),L(1===n.rank,()=>"x should be 1D tensor, but got x (".concat(n.shape,").")),L(1===a.rank,()=>"y should be 1D tensor, but got y (".concat(a.shape,")."));let r=await n.data(),i=new Set(await a.data()),s=0;for(let e=0;e<r.length;e++)!i.has(r[e])&&s++;let o=new ad([s],n.dtype),l=new ad([s],"int32");for(let e=0,t=0;e<r.length;e++)!i.has(r[e])&&(o.values[t]=r[e],l.values[t]=e,t++);return[o.toTensor(),l.toTensor()]};function ya(e,t,n){if(B(e),null!=t&&3!==t.length)throw Error("tensor3d() requires shape to have three numbers");let a=az(e,n);if(3!==a.length&&1!==a.length)throw Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===a.length&&null==t)throw Error("tensor3d() requires shape to be provided when `values` are a flat array");return aq(e,t,a,n)}function yr(e,t,n){if(B(e),null!=t&&4!==t.length)throw Error("tensor4d() requires shape to have four numbers");let a=az(e,n);if(4!==a.length&&1!==a.length)throw Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===a.length&&null==t)throw Error("tensor4d() requires shape to be provided when `values` are a flat array");return aq(e,t,a,n)}function yi(e,t,n){if(B(e),null!=t&&5!==t.length)throw Error("tensor5d() requires shape to have five numbers");let a=az(e,n);if(5!==a.length&&1!==a.length)throw Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===a.length&&null==t)throw Error("tensor5d() requires shape to be provided when `values` are a flat array");return aq(e,t,a,n)}function ys(e,t,n){if(B(e),null!=t&&6!==t.length)throw Error("tensor6d() requires shape to have six numbers");let a=az(e,n);if(6!==a.length&&1!==a.length)throw Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===a.length&&null==t)throw Error("tensor6d() requires shape to be provided when `values` are a flat array");return aq(e,t=t||a,a,n)}let yo=aG({tensorScatterUpdate_:function(e,t,n){let a=aV(e,"tensor","tensorScatterupdate"),r=aV(t,"indices","tensorScatterupdate","int32"),i=aV(n,"updates","tensorScatterupdate");if(on(i,r,a.shape),a.dtype!==i.dtype)throw Error("tensor and updates must have the same dtype, instead they are ".concat(a.dtype," and ").concat(i.dtype,"."));return aR.runKernel(nf,{tensor:a,indices:r,updates:i},{})}});function yl(e,t){return xG(e,t,"right")}function yc(e,t){let n=[];for(let e=0;e<t.length;e++)t[e]&&n.push(e);let a=rD(e,"int32"),r=rD([n.length,e.length],"int32");for(let t=0;t<n.length;t++){let i=a.indexToLoc(n[t]),s=t*e.length;r.values.set(i,s)}return r.toTensor()}let yu=async function(e){let t=aV(e,"condition","whereAsync","bool"),n=await t.data(),a=yc(t.shape,n);return e!==t&&t.dispose(),a};e.s(["booleanMaskAsync",()=>yh],14044);let yh=async function(e,t,n){let a=aV(e,"tensor","boolMask"),r=aV(t,"mask","boolMask","bool"),i=null==n?0:n,s=r.rank,o=a.shape;L(s>0,()=>"mask cannot be scalar"),z(o.slice(i,i+s),r.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let e=i;e<i+s;e++)l*=o[e];let c=io(a,o.slice(0,i).concat([l],o.slice(i+s))),u=io(r,[-1]),h=await yu(u),d=lQ(h,[1]),p=oJ(c,d,i);return e!==a&&a.dispose(),t!==r&&r.dispose(),d.dispose(),c.dispose(),u.dispose(),h.dispose(),p};e.i(14044),e.i(90049),e.i(99269),e.s(["movingAverage",()=>yd],54661);let yd=aG({movingAverage_:function(e,t,n,a){let r=!(arguments.length>4)||void 0===arguments[4]||arguments[4],i=aV(e,"v","movingAverage"),s=aV(t,"x","movingAverage"),o=aV(n,"decay","movingAverage");aS(i,s),L(G(i.shape,s.shape),()=>"Shape mismatch in v and x");let l=rG(1),c=r2(l,o),u=rz(r2(s,i),c);return r&&(L(null!=a,()=>"When using zeroDebias: true, step is required."),u=rL(u,r2(l,r1(o,aV(a,"step","movingAverage"))))),rP(i,u)}});e.i(54661),e.s(["scatterND",()=>yp],24308);let yp=aG({scatterND_:function(e,t,n){eb(n);let a=aV(e,"indices","scatterND","int32"),r=aV(t,"updates","scatterND");return on(r,a,n),aR.runKernel(np,{indices:a,updates:r},{shape:n})}});e.i(24308),e.i(36975),e.s(["sparseToDense",()=>yf],28546);let yf=aG({sparseToDense_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;eb(n);let r=aV(e,"sparseIndices","sparseToDense","int32"),i=aV(t,"sparseValues","sparseToDense","string_or_numeric"),s=aV(a,"defaultValue","sparseToDense",i.dtype);if("int32"!==r.dtype)throw Error("tf.sparseToDense() expects the indices to be int32 type,"+" but the dtype was ".concat(r.dtype,"."));if(r.rank>2)throw Error("sparseIndices should be a scalar, vector, or matrix,"+" but got shape ".concat(r.shape,"."));let o=r.rank>0?r.shape[0]:1,l=r.rank>1?r.shape[1]:1;if(n.length!==l)throw Error("outputShape has incorrect number of elements:,"+" ".concat(n.length,", should be: ").concat(l,"."));let c=i.size;if(0!==i.rank&&(1!==i.rank||c!==o))throw Error("sparseValues has incorrect shape "+"".concat(i.shape,", should be [] or [").concat(o,"]"));if(i.dtype!==s.dtype)throw Error("sparseValues.dtype must match defaultValues.dtype");return aR.runKernel(nR,{sparseIndices:r,sparseValues:i,defaultValue:s},{outputShape:n})}});e.i(28546),e.s(["gatherND",()=>ym],48708);let ym=aG({gatherND_:function(e,t){let n=aV(t,"indices","gatherND","int32"),a=aV(e,"x","gatherND","string_or_numeric");return aR.runKernel(tN,{params:a,indices:n})}});e.i(48708),e.i(16738),e.i(96851),e.s(["inTopKAsync",()=>yg],8760);let yg=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=aV(e,"predictions","inTopK"),r=aV(t,"targets","inTopK");L(a.rank>1,()=>"inTopK() expects the predictions to be of rank 2 or higher, "+"but got ".concat(a.rank)),L(a.rank-1===r.rank,()=>"predictions rank should be 1 larger than targets rank, but got predictions rank "+"".concat(a.rank," and targets rank ").concat(r.rank)),z(a.shape.slice(0,a.shape.length-1),r.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");let i=a.shape[a.shape.length-1];L(n>0&&n<=i,()=>"'k' passed to inTopK() must be > 0 && <= the predictions last "+"dimension (".concat(i,"), but got ").concat(n));let s=await a.data(),o=await r.data(),[l,c]=[s.length/i,i],u=et("bool",l);for(let e=0;e<l;e++){let t=e*c,a=s.subarray(t,t+c),r=[];for(let e=0;e<a.length;e++)r.push({value:a[e],index:e});r.sort((e,t)=>t.value-e.value),u[e]=0;for(let t=0;t<n;t++)if(r[t].index===o[e]){u[e]=1;break}}return e!==a&&a.dispose(),t!==r&&r.dispose(),aK(u,r.shape,"bool")};e.i(8760);var yx=cJ;e.i(9670),e.i(90802);var cs=cs,cs=cs,cs=cs;e.s([],15571);var cs=cs,yy=e.i(41175),yy=yy,cs=cs,cs=cs;function yb(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Set;if(null==e)return null;if("function"==typeof Blob&&e instanceof Blob)return e.slice();if(a.has(e))throw Error("Circular references are not supported.");if(n.has(e))return n.get(e);let r=t(e);if(r.recurse&&null!==r.value)throw Error("A deep map function may not return both a value and recurse=true.");if(!r.recurse)return n.set(e,r.value),r.value;if(yN(e)){let r=Array.isArray(e)?[]:{};for(let i in a.add(e),e){let s=yb(e[i],t,n,a);r[i]=s}return a.delete(e),e.__proto__&&(r.__proto__=e.__proto__),r}throw Error("Can't recurse into non-iterable type: ".concat(e))}function yv(e){return null===e?null:yN(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}async function yw(e,t){let n=new Map;for(let a of(yb(e,t,n),Array.from(n.keys()))){let e=n.get(a);if(cs.isPromise(e)){let t=await e;n.set(a,t)}}return yb(e,t,n)}function yN(e){let t=!1;if(eT.get("IS_BROWSER"))t=e instanceof TextDecoder;else{let{StringDecoder:n}={};t=e instanceof n}return null!=e&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||"object"==typeof e&&!(e instanceof am)&&!(e instanceof Promise)&&!t)}function yk(e){return e instanceof am?{value:e.clone(),recurse:!1}:yN(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}class yS{wrap(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}get(e){if(e<0)throw RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}set(e,t){if(e<0)throw RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=t}length(){let e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}isFull(){return this.length()===this.capacity}isEmpty(){return 0===this.length()}push(e){if(this.isFull())throw RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}pushAll(e){for(let t of e)this.push(t)}pop(){if(this.isEmpty())throw RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);let e=this.get(this.end);return this.set(this.end,void 0),e}unshift(e){if(this.isFull())throw RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}shift(){if(this.isEmpty())throw RangeError("Ring buffer is empty.");let e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}shuffleExcise(e){if(this.isEmpty())throw RangeError("Ring buffer is empty.");let t=this.wrap(this.begin+e),n=this.get(t);return this.set(t,this.pop()),n}constructor(e){if(this.capacity=e,this.begin=0,this.end=0,null==e)throw RangeError("Can't create a ring buffer of unknown capacity.");if(e<1)throw RangeError("Can't create ring buffer of capacity < 1.");this.data=Array(e),this.doubledCapacity=2*e}}class yC extends yS{isFull(){return!1}push(e){super.isFull()&&this.expand(),super.push(e)}unshift(e){super.isFull()&&this.expand(),super.unshift(e)}expand(){let e=2*this.capacity,t=Array(e),n=this.length();for(let e=0;e<n;e++)t[e]=this.get(this.wrap(this.begin+e));this.data=t,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}constructor(){super(yC.INITIAL_CAPACITY)}}yC.INITIAL_CAPACITY=32;class yT{async toArray(){let e=[],t=await this.next();for(;!t.done;)e.push(t.value),t=await this.next();return e}async toArrayForTest(){let e=this.prefetch(100),t=[],n=await e.next();for(;!n.done;)t.push(n.value),n=await e.next();return t}async resolveFully(){let e=await this.next();for(;!e.done;)e=await this.next()}async resolveWhile(e){let t=await this.next(),n=e(t.value);for(;!t.done&&n;)n=e((t=await this.next()).value)}handleErrors(e){return new yO(this,e)}filter(e){return new yM(this,e)}map(e){return new yF(this,e)}mapAsync(e){return new yP(this,e)}serialMapAsync(e){return new yP(this,e).serial()}flatmap(e){return new yL(this,e)}async forEachAsync(e){return this.map(e).resolveFully()}async serialForEach(e){return this.serialMapAsync(e).resolveWhile(e=>!0===e)}rowMajorBatch(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return new yD(this,e,t)}columnMajorBatch(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:yv;return this.rowMajorBatch(e,t).map(e=>(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:yv;return function e(t,n){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set,r=t[0];if(a.has(r))throw Error("Circular references are not supported.");let i=n(t);if(i.recurse&&null!==i.value)throw Error("A deep zip function may not return both a value and recurse=true.");if(!i.recurse)return i.value;if(yN(r)){let i=Array.isArray(r)?[]:{};for(let s in a.add(r),r){let r=e(t.map(e=>e[s]),n,a);i[s]=r}return a.delete(r),i}throw Error("Can't recurse into non-iterable type: ".concat(r))}(e,t)})(e,n))}concatenate(e,t){return new yz(new yI([this,e]),t)}take(e){return e<0||null==e?this:new yR(this,e)}skip(e){return e<0||null==e?this:new yA(this,e)}prefetch(e){return new yV(this,e)}shuffle(e,t){return new yU(this,e,t)}serial(){return new y_(this)}}class yI extends yT{summary(){return"Array of ".concat(this.items.length," items")}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};let e=this.items[this.trav];return this.trav++,{value:yb(e,yk),done:!1}}constructor(e){super(),this.items=e,this.trav=0}}class yE extends yT{summary(){return"Function call"}async next(){try{return this.nextFn()}catch(e){throw e.message="Error thrown while iterating through a dataset: ".concat(e.message),e}}constructor(e){super(),this.nextFn=e}}class y_ extends yT{summary(){return"".concat(this.upstream.summary()," -> Serial")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){return this.upstream.next()}constructor(e){super(),this.upstream=e,this.lastRead=Promise.resolve({value:null,done:!1})}}class yA extends yT{summary(){return"".concat(this.upstream.summary()," -> Skip")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){let e=await this.upstream.next();if(e.done)return e;aJ(e.value)}return this.upstream.next()}constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}}class yR extends yT{summary(){return"".concat(this.upstream.summary()," -> Take")}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0}}class yD extends yT{summary(){return"".concat(this.upstream.summary()," -> RowMajorBatch")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){let e=[];for(;e.length<this.batchSize;){let t=await this.upstream.next();if(t.done){if(this.enableSmallLastBatch&&e.length>0)return{value:e,done:!1};return{value:null,done:!0}}e.push(t.value)}return{value:e,done:!1}}constructor(e,t,n=!0){super(),this.upstream=e,this.batchSize=t,this.enableSmallLastBatch=n,this.lastRead=Promise.resolve({value:null,done:!1})}}class yM extends yT{summary(){return"".concat(this.upstream.summary()," -> Filter")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;){let e=await this.upstream.next();if(e.done||this.predicate(e.value))return e;aJ(e.value)}}constructor(e,t){super(),this.upstream=e,this.predicate=t,this.lastRead=Promise.resolve({value:null,done:!1})}}class yF extends yT{summary(){return"".concat(this.upstream.summary()," -> Map")}async next(){let e=await this.upstream.next();if(e.done)return{value:null,done:!0};let t=yy.getTensorsInContainer(e.value),n=this.transform(e.value),a=yy.getTensorsInContainer(n);for(let e of t)yy.isTensorInList(e,a)||e.dispose();return{value:n,done:!1}}constructor(e,t){super(),this.upstream=e,this.transform=t}}class yO extends yT{summary(){return"".concat(this.upstream.summary()," -> handleErrors")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(e){if(!this.handler(e))return{value:null,done:!0}}}constructor(e,t){super(),this.upstream=e,this.handler=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}}class yP extends yT{summary(){return"".concat(this.upstream.summary()," -> AsyncMap")}async next(){let e=await this.upstream.next();if(e.done)return{value:null,done:!0};let t=yy.getTensorsInContainer(e.value),n=await this.transform(e.value),a=yy.getTensorsInContainer(n);for(let e of t)yy.isTensorInList(e,a)||e.dispose();return{value:n,done:!1}}constructor(e,t){super(),this.upstream=e,this.transform=t}}class yj extends yT{async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;0===this.outputQueue.length();)if(!await this.pump())return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}constructor(){super(),this.outputQueue=new yC,this.lastRead=Promise.resolve({value:null,done:!1})}}class yL extends yj{summary(){return"".concat(this.upstream.summary()," -> Flatmap")}async pump(){let e=await this.upstream.next();if(e.done)return!1;let t=yy.getTensorsInContainer(e.value),n=this.transform(e.value),a=yy.getTensorsInContainer(n);for(let e of(this.outputQueue.pushAll(n),t))yy.isTensorInList(e,a)||e.dispose();return!0}constructor(e,t){super(),this.upstream=e,this.transform=t}}class yz extends yT{summary(){return"".concat("TODO: fill in upstream of chained summaries"," -> Chained")}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(e){if(await e,null==this.iterator){let e=await this.moreIterators.next();if(e.done)return{value:null,done:!0};this.iterator=e.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}let t=await this.iterator.next();return t.done?(this.iterator=null,this.readFromChain(e)):t}constructor(e,t){super(),this.baseErrorHandler=t,this.lastRead=null,this.iterator=null,this.moreIterators=e}}!function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"}(b||(b={}));class yB extends yT{summary(){return"{".concat("TODO: fill in upstream of zip summaries","} -> Zip")}async nextState(e){await e;let t=0,n=0,a=await yw(this.iterators,function(e){return e instanceof yT?{value:e.next().then(e=>(t++,e.done&&n++,e.value)),recurse:!1}:{value:null,recurse:!0}});if(t===n)return{value:null,done:!0};if(n>0)switch(this.mismatchMode){case b.FAIL:throw Error("Zipped streams should have the same length. "+"Mismatched at element ".concat(this.count,"."));case b.SHORTEST:return{value:null,done:!0};case b.LONGEST:}return this.count++,{value:a,done:!1}}async next(){return this.currentPromise=this.nextState(this.currentPromise),this.currentPromise}constructor(e,t=b.FAIL){super(),this.iterators=e,this.mismatchMode=t,this.count=0,this.currentPromise=null}}class yV extends yT{summary(){return"".concat(this.upstream.summary()," -> Prefetch")}refill(){for(;!this.buffer.isFull();){let e=this.upstream.next();this.buffer.push(e)}}next(){return this.refill(),this.buffer.shift()}constructor(e,t){super(),this.upstream=e,this.bufferSize=t,this.buffer=new yS(t)}}class yU extends yV{async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}randomInt(e){return Math.floor(this.random()*e)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){let e=this.chooseIndex(),t=await this.buffer.shuffleExcise(e);if(!t.done)return this.refill(),t;this.upstreamExhausted=!0}return{value:null,done:!0}}constructor(e,t,n){super(e,t),this.upstream=e,this.windowSize=t,this.upstreamExhausted=!1,this.random=uX.alea(n||cs.now().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}}class yW{batch(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=this;return cs.assert(e>0,()=>"batchSize needs to be positive, but it is\n      ".concat(e)),yG(async()=>(await n.iterator()).columnMajorBatch(e,t,yK),this.size===1/0||null==this.size?this.size:t?Math.ceil(this.size/e):Math.floor(this.size/e))}concatenate(e){let t=this;return yG(async()=>(await t.iterator()).concatenate(await e.iterator()),this.size===1/0||e.size===1/0?1/0:null!=this.size&&null!=e.size?this.size+e.size:null)}filter(e){let t=this;return yG(async()=>(await t.iterator()).filter(t=>aQ(()=>e(t))),this.size===1/0?1/0:null)}async forEachAsync(e){return(await this.iterator()).forEachAsync(e)}map(e){let t=this;return yG(async()=>(await t.iterator()).map(t=>aQ(()=>e(t))),this.size)}mapAsync(e){let t=this;return yG(async()=>(await t.iterator()).mapAsync(e),this.size)}prefetch(e){if(null==e)throw RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");let t=this;return yG(async()=>(await t.iterator()).prefetch(e),this.size)}repeat(e){let t=this;return yG(async()=>new yz(new yE(async()=>({value:await t.iterator(),done:!1})).take(e),void 0),null!=this.size&&e>0?this.size*e:0===e?0:null!=this.size&&(void 0===e||e<0)?1/0:null)}skip(e){let t=this;return yG(async()=>(await t.iterator()).skip(e),null!=this.size&&e>=0&&this.size>=e?this.size-e:null!=this.size&&(this.size<e||void 0===e||e<0)?0:null)}shuffle(e,t){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(null==e||e<0)if(null==this.size)throw RangeError("`Dataset.shuffle()` requires bufferSize to be specified.");else throw RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting "+"bufferSize to the dataset size (".concat(this.size," elements)"));let a=this,r=uX.alea(t||cs.now().toString());return yG(async()=>{let t=r.int32();return n&&(t+=r.int32()),(await a.iterator()).shuffle(e,t.toString())},this.size)}take(e){let t=this;return yG(async()=>(await t.iterator()).take(e),null!=this.size&&this.size>e?e:null!=this.size&&this.size<=e?this.size:null)}async toArray(){if(this.size===1/0)throw Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}constructor(){this.size=null}}function yG(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new class extends yW{async iterator(){return e()}constructor(){super(...arguments),this.size=t}}}function yH(e){return yG(async()=>new yI(e),e.length)}function yq(e){let t;if(!yN(e))throw Error("The argument to zip() must be an object or array.");if(Array.isArray(e))for(let n=0;n<e.length;n++)t=null==t?e[n].size:Math.min(t,e[n].size);else if(e instanceof Object)for(let n in e)t=null==t?e[n].size:Math.min(t,e[n].size);return yG(async()=>(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b.FAIL;return new yB(e,t)})(await yw(e,e=>{if(e instanceof yW)return{value:e.iterator(),recurse:!1};if(yN(e))return{value:null,recurse:!0};throw Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")}),b.SHORTEST),t)}function yK(e){var t,n;if(null===e)return null;return null==(t=e[0])||null===(n=t)||"object"!=typeof n&&"function"!=typeof n||Array.isArray(t)||"object"==typeof t&&t instanceof am||cs.isTypedArray(t)?{value:function(e){if(0===e.length)throw Error("Can't make a batch of zero elements.");return e[0]instanceof am?i6(e):aK(e)}(e),recurse:!1}:{value:null,recurse:!0}}yW.MAX_BUFFER_SIZE=1e4;var cs=cs;class yX extends yW{async iterator(){return(await this.input.iterator()).decodeUTF8().split("\n").map(e=>(e.endsWith("\r")&&(e=e.slice(0,-1)),e))}constructor(e){super(),this.input=e}}let yY=Symbol("out"),yZ=Symbol("field"),yQ=Symbol("quote"),yJ=Symbol("quoteafterquote"),y$=Symbol("quoteinquote");class y0 extends yW{async columnNames(){return this.columnNamesValidated||await this.setColumnNames(),this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames}async setColumnNames(){let e=await this.maybeReadHeaderLine();if(this.fullColumnNames||e)this.fullColumnNames&&e&&cs.assert(e.length===this.fullColumnNames.length,()=>"The length of provided columnNames ("+this.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+e.length.toString()+").");else throw Error("Column names must be provided if there is no header line.");this.fullColumnNames||(this.fullColumnNames=e);let t=this.fullColumnNames.reduce((e,t)=>(e[t]=e[t]+1||1,e),{}),n=Object.keys(t).filter(e=>t[e]>1);if(cs.assert(0===n.length,()=>"Duplicate column names found: "+n.toString()),this.columnConfigs){for(let e of Object.keys(this.columnConfigs))if(-1===this.fullColumnNames.indexOf(e))throw Error('The key "'+e+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").")}this.columnNamesValidated=!0}async maybeReadHeaderLine(){if(!this.hasHeader)return null;{let e=await this.base.iterator(),t=await e.next();if(t.done)throw Error("No data was found for CSV parsing.");let n=t.value;return this.parseRow(n,!1)}}async iterator(){this.columnNamesValidated||await this.setColumnNames();let e=await this.base.iterator();return this.hasHeader&&(e=e.skip(1)),e.map(e=>this.makeDataElement(e))}makeDataElement(e){let t=this.parseRow(e),n={},a={};for(let r=0;r<this.fullColumnNames.length;r++){let i=this.fullColumnNames[r],s=this.columnConfigs?this.columnConfigs[i]:null;if(!this.configuredColumnsOnly||s){let o=t[r],l=null;if(""===o)if(s&&void 0!==s.default)l=s.default;else if(s&&(s.required||s.isLabel))throw Error("Required column ".concat(i," is empty in this line: ").concat(e));else l=void 0;else{let e=Number(o);if(isNaN(e))l=s&&"bool"===s.dtype?this.getBoolean(o):o;else if(s&&s.dtype)switch(s.dtype){case"float32":default:l=e;break;case"int32":l=Math.floor(e);break;case"bool":l=this.getBoolean(o)}else l=e}s&&s.isLabel?a[i]=l:n[i]=l}}return 0===Object.keys(a).length?n:{xs:n,ys:a}}getBoolean(e){return+("1"===e||"true"===e.toLowerCase())}parseRow(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=[],a=0,r=e.length,i=yY;for(let t=0;t<r;t++)switch(i){case yY:switch(e.charAt(t)){case'"':a=t+1,i=yQ;break;case this.delimiter:if(a=t+1," "===this.delimiter&&this.delimWhitespace)break;n.push(""),i=yY;break;default:i=yZ,a=t}break;case yZ:e.charAt(t)===this.delimiter&&(n.push(e.substring(a,t)),i=yY,a=t+1);break;case yQ:'"'===e.charAt(t)&&(i=yJ);break;case yJ:switch(e.charAt(t)){case this.delimiter:n.push(e.substring(a,t-1)),i=yY,a=t+1;break;case'"':i=yQ;break;default:i=y$}break;case y$:'"'===e.charAt(t)&&(i=yQ)}if(i===yJ?n.push(e.substring(a,r-1)):n.push(e.substring(a)),t&&n.length!==this.fullColumnNames.length)throw Error("Invalid row in csv file. Should have ".concat(this.fullColumnNames.length," elements in a row, but got ").concat(n));return n}constructor(e,t){super(),this.input=e,this.hasHeader=!0,this.fullColumnNames=null,this.columnNamesValidated=!1,this.columnConfigs=null,this.configuredColumnsOnly=!1,this.delimiter=",",this.delimWhitespace=!1,this.base=new yX(e),t||(t={}),this.hasHeader=!1!==t.hasHeader,this.fullColumnNames=t.columnNames,this.columnConfigs=t.columnConfigs,this.configuredColumnsOnly=t.configuredColumnsOnly,t.delimWhitespace?(cs.assert(null==t.delimiter,()=>"Delimiter should not be provided when delimWhitespace is true."),this.delimWhitespace=!0,this.delimiter=" "):this.delimiter=t.delimiter?t.delimiter:","}}var cs=cs;class y1 extends yT{summary(){return"microphone"}static async create(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!eT.get("IS_BROWSER"))throw Error("microphone API is only supported in browser environment.");let t=new y1(e);return await t.start(),t}async start(){try{this.stream=await navigator.mediaDevices.getUserMedia({audio:null==this.audioTrackConstraints||this.audioTrackConstraints,video:!1})}catch(e){throw Error("Error thrown while initializing video stream: ".concat(e.message))}if(!this.stream)throw Error("Could not obtain audio from microphone.");let e=window.AudioContext||window.webkitAudioContext;if(this.audioContext=new e,this.sampleRateHz){if(this.audioContext.sampleRate!==this.sampleRateHz)throw Error("Mismatch in sampling rate: "+"Expected: ".concat(this.sampleRateHz,"; ")+"Actual: ".concat(this.audioContext.sampleRate))}else this.sampleRateHz=this.audioContext.sampleRate;let t=this.audioContext.createMediaStreamSource(this.stream);this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2*this.fftSize,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,t.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize)}async next(){let e,t;if(this.isClosed)return{value:null,done:!0};let n=await this.getAudioData();if(this.includeSpectrogram){let t=this.flattenQueue(n.freqDataQueue);e=this.getTensorFromAudioDataArray(t,[this.numFrames,this.columnTruncateLength,1])}if(this.includeWaveform){let e=this.flattenQueue(n.timeDataQueue);t=this.getTensorFromAudioDataArray(e,[this.numFrames*this.fftSize,1])}return{value:{spectrogram:e,waveform:t},done:!1}}async capture(){return(await this.next()).value}async getAudioData(){let e=[],t=[],n=0;return new Promise(a=>{let r=setInterval(()=>{this.includeSpectrogram&&(this.analyser.getFloatFrequencyData(this.freqData),this.freqData[0]===-1/0&&a({freqDataQueue:e,timeDataQueue:t}),e.push(this.freqData.slice(0,this.columnTruncateLength))),this.includeWaveform&&(this.analyser.getFloatTimeDomainData(this.timeData),t.push(this.timeData.slice())),++n===this.numFrames&&(clearInterval(r),a({freqDataQueue:e,timeDataQueue:t}))},this.fftSize/this.sampleRateHz*1e3)})}stop(){!this.isClosed&&(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),null!=this.stream&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())}toArray(){throw Error("Can not convert infinite audio stream to array.")}getSampleRate(){return this.sampleRateHz}flattenQueue(e){let t=e[0].length,n=new Float32Array(e.length*t);return e.forEach((e,a)=>n.set(e,a*t)),n}getTensorFromAudioDataArray(e,t){let n=new Float32Array(cs.sizeFromShape(t));return n.set(e,n.length-e.length),aK(n,t)}constructor(e){super(),this.microphoneConfig=e,this.isClosed=!1,this.fftSize=e.fftSize||1024;let t=Math.log2(this.fftSize);if(this.fftSize<0||t<4||t>14||!Number.isInteger(t))throw Error("Invalid fftSize: it must be a power of 2 between "+"2 to 4 and 2 to 14, but got ".concat(this.fftSize));if(this.numFrames=e.numFramesPerSpectrogram||43,this.sampleRateHz=e.sampleRateHz,this.columnTruncateLength=e.columnTruncateLength||this.fftSize,this.audioTrackConstraints=e.audioTrackConstraints,this.smoothingTimeConstant=e.smoothingTimeConstant||0,this.includeSpectrogram=!1!==e.includeSpectrogram,this.includeWaveform=!0===e.includeWaveform,!this.includeSpectrogram&&!this.includeWaveform)throw Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.")}}e.s(["draw",()=>y8,"fromPixels",()=>y9,"fromPixelsAsync",()=>y4,"toPixels",()=>y6],53988);let y2=!1;function y3(e){let t,n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(a>4)throw Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw Error("pixels passed to tf.browser.fromPixels() can not be null");let r=!1,s=!1,o=!1,l=!1,c=!1,u=!1;if(e.data instanceof Uint8Array)r=!0;else if("undefined"!=typeof ImageData&&e instanceof ImageData)s=!0;else if("undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement)o=!0;else if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement)l=!0;else if(null!=e.getContext)c=!0;else if("undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap)u=!0;else throw Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, "+"but was ".concat(e.constructor.name));if(null!=n4(nY,aR.backendName))return aR.runKernel(nY,{pixels:e},{numChannels:a});let[h,d]=o?[e.videoWidth,e.videoHeight]:[e.width,e.height];if(c)t=e.getContext("2d").getImageData(0,0,h,d).data;else if(s||r)t=e.data;else if(l||o||u){if(null==i)if("undefined"==typeof document)if("undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof OffscreenCanvasRenderingContext2D)i=new OffscreenCanvas(1,1).getContext("2d");else throw Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else i=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});i.canvas.width=h,i.canvas.height=d,i.drawImage(e,0,0,h,d),t=i.getImageData(0,0,h,d).data}if(4===a)n=new Int32Array(t);else{let e=h*d;n=new Int32Array(e*a);for(let r=0;r<e;r++)for(let e=0;e<a;++e)n[r*a+e]=t[4*r+e]}return ya(n,[d,h,a],"int32")}async function y4(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,a=null;if(eT.getBool("WRAP_TO_IMAGEBITMAP")&&"undefined"!=typeof window&&"undefined"!=typeof ImageBitmap&&window.hasOwnProperty("createImageBitmap")&&!(e instanceof ImageBitmap)&&null!=(t=e)&&0!==t.width&&0!==t.height&&!(null!=e&&e.data instanceof Uint8Array)){let t;try{t=await createImageBitmap(e,{premultiplyAlpha:"none"})}catch(e){t=null}a=null!=t&&t.width===e.width&&t.height===e.height?t:e}else a=e;return y3(a,n)}function y5(e){if(2!==e.rank&&3!==e.rank)throw Error("toPixels only supports rank 2 or 3 tensors, got rank ".concat(e.rank,"."));let t=2===e.rank?1:e.shape[2];if(t>4||2===t)throw Error("toPixels only supports depth of size "+"1, 3 or 4 but got ".concat(t));if("float32"!==e.dtype&&"int32"!==e.dtype)throw Error("Unsupported type for toPixels: ".concat(e.dtype,".")+" Please use float32 or int32 tensors.")}async function y6(e,t){let n=aV(e,"img","toPixels");if(!(e instanceof am)){let e=n;n=rM(e,"int32"),e.dispose()}y5(n);let[a,r]=n.shape.slice(0,2),i=2===n.rank?1:n.shape[2],s=await n.data(),o="float32"===n.dtype?255:1,l=new Uint8ClampedArray(r*a*4);for(let e=0;e<a*r;++e){let t=[0,0,0,255];for(let a=0;a<i;a++){let r=s[e*i+a];if("float32"===n.dtype){if(r<0||r>1)throw Error("Tensor values for a float32 Tensor must be in the "+"range [0 - 1] but encountered ".concat(r,"."))}else if("int32"===n.dtype&&(r<0||r>255))throw Error("Tensor values for a int32 Tensor must be in the "+"range [0 - 255] but encountered ".concat(r,"."));1===i?(t[0]=r*o,t[1]=r*o,t[2]=r*o):t[a]=r*o}let a=4*e;l[a+0]=Math.round(t[0]),l[a+1]=Math.round(t[1]),l[a+2]=Math.round(t[2]),l[a+3]=Math.round(t[3])}if(null!=t){y2||null!=n4(tc,aR.backendName)&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),y2=!0),t.width=r,t.height=a;let e=t.getContext("2d"),n=new ImageData(l,r,a);e.putImageData(n,0,0)}return n!==e&&n.dispose(),l}function y8(e,t,n){let a=aV(e,"img","draw");if(!(e instanceof am)){let e=a;a=rM(e,"int32"),e.dispose()}y5(a);var r=null==n?void 0:n.imageOptions;let i=(null==r?void 0:r.alpha)||1;if(i>1||i<0)throw Error("Alpha value ".concat(i," is suppoed to be in range [0 - 1]."));let s={image:a};aR.runKernel(tc,s,{canvas:t,options:n})}let y9=aG({fromPixels_:y3});var y7=e.i(53988),y7=y7,cs=cs;class be extends yT{summary(){return"webcam"}static async create(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!eT.get("IS_BROWSER"))throw Error("tf.data.webcam is only supported in browser environment.");if(!e){if(e=document.createElement("video"),!t.resizeWidth||!t.resizeHeight)throw Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");e.width=t.resizeWidth,e.height=t.resizeHeight}let n=new be(e,t);return await n.start(),n}async start(){this.webcamConfig.facingMode&&cs.assert("user"===this.webcamConfig.facingMode||"environment"===this.webcamConfig.facingMode,()=>"Invalid webcam facing mode: ".concat(this.webcamConfig.facingMode,". ")+"Please provide 'user' or 'environment'");try{this.stream=await navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})}catch(e){throw e.message="Error thrown while initializing video stream: ".concat(e.message),e}if(!this.stream)throw Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(e){console.log(e),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,new Promise(e=>{this.webcamVideoElement.onloadedmetadata=()=>{e()}})}async next(){let e;if(this.isClosed)return{value:null,done:!0};try{e=y7.fromPixels(this.webcamVideoElement)}catch(e){throw Error("Error thrown converting video to pixels: ".concat(JSON.stringify(e)))}if(!this.resize)return{value:e,done:!1};try{return{value:this.cropAndResizeFrame(e),done:!1}}catch(e){throw Error("Error thrown cropping the video: ".concat(e.message))}finally{e.dispose()}}needToResize(){return!!this.webcamConfig.resizeWidth&&!!this.webcamConfig.resizeHeight&&(this.webcamVideoElement.width!==this.webcamConfig.resizeWidth||this.webcamVideoElement.height!==this.webcamConfig.resizeHeight)}cropAndResizeFrame(e){return aQ(()=>{let t,n=oQ(rM(e,"float32"),0),a=(t=uW.cropAndResize(n,this.cropBox,this.cropBoxInd,this.cropSize,"bilinear")).shape;return io(t,a.slice(1))})}async capture(){return(await this.next()).value}stop(){this.stream.getTracks().forEach(e=>e.stop());try{this.webcamVideoElement.srcObject=null}catch(e){console.log(e),this.webcamVideoElement.src=null}this.isClosed=!0}toArray(){throw Error("Can not convert infinite video stream to array.")}constructor(e,t){if(super(),this.webcamVideoElement=e,this.webcamConfig=t,this.isClosed=!0,this.resize=!1,this.needToResize())if(this.resize=!0,this.cropSize=[this.webcamConfig.resizeHeight,this.webcamConfig.resizeWidth],this.cropBoxInd=c$([0],"int32"),this.webcamConfig.centerCrop){let e=this.webcamConfig.resizeWidth/this.webcamVideoElement.width,t=this.webcamConfig.resizeHeight/this.webcamVideoElement.height,n=(1-e)/2,a=(1-t)/2;this.cropBox=c4([a,n,t+a,n+e],[1,4])}else this.cropBox=c4([0,0,1,1],[1,4])}}class bt{}var cs=cs,cs=cs;class bn extends yT{split(e){return new ba(this,e)}}class ba extends bn{summary(){return this.impl.summary()}async next(){return this.impl.next()}constructor(e,t){super(),this.upstream=e,this.impl=new br(e,t)}}class br extends yj{summary(){return"".concat(this.upstream.summary()," -> Split('").concat(this.separator,"')")}async pump(){let e=await this.upstream.next();if(e.done)return""!==this.carryover&&(this.outputQueue.push(this.carryover),this.carryover="",!0);let t=e.value.split(this.separator);for(let e of(t[0]=this.carryover+t[0],t.slice(0,-1)))this.outputQueue.push(e);return this.carryover=t[t.length-1],!0}constructor(e,t){super(),this.upstream=e,this.separator=t,this.carryover=""}}class bi extends yT{decodeUTF8(){return new bs(this)}}class bs extends bn{summary(){return this.impl.summary()}async next(){return this.impl.next()}constructor(e){super(),this.upstream=e,this.impl=new bo(e)}}class bo extends yj{summary(){return"".concat(this.upstream.summary()," -> Utf8")}async pump(){let e,t,n=await this.upstream.next();return!n.done&&(e=n.value,t=eT.get("IS_BROWSER")?this.decoder.decode(e,{stream:!0}):this.decoder.write(aL.Buffer.from(e.buffer)),this.outputQueue.push(t),!0)}constructor(e){if(super(),this.upstream=e,eT.get("IS_BROWSER"))this.decoder=new TextDecoder("utf-8");else{let{StringDecoder:e}={};this.decoder=new e("utf8")}}}class bl extends bi{summary(){return"FileChunks ".concat(this.file)}async next(){if(this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size))return{value:null,done:!0};let e=new Promise((e,t)=>{let n=this.offset+this.chunkSize;if(this.file instanceof Uint8Array)e(new Uint8Array(this.file.slice(this.offset,n)));else{let a=new FileReader;a.onload=n=>{let r=a.result;if(r instanceof ArrayBuffer&&(r=new Uint8Array(r)),!(r instanceof Uint8Array))return t(TypeError("FileReader returned unknown type."));e(r)},a.onabort=e=>t(Error("Aborted")),a.onerror=e=>t(Error(e.type));let r=this.file.slice(this.offset,n);a.readAsArrayBuffer(r)}this.offset=n});return{value:await e,done:!1}}constructor(e,t={}){super(),this.file=e,this.options=t,cs.assert(e instanceof Uint8Array||!!eT.get("IS_BROWSER")&&(e instanceof File||e instanceof Blob),()=>"FileChunkIterator only supports File, Blob and Uint8Array right now."),this.offset=t.offset||0,this.chunkSize=t.chunkSize||1048576}}async function bc(e){let t,n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;"string"==typeof e?t=e:(t=e.url,n=bu(e));let i=await (r||cs.fetch)(t,n);if(i.ok)return new bl(new Uint8Array(await i.arrayBuffer()),a);throw Error(i.statusText)}let bu=e=>({method:e.method,headers:e.headers,body:e.body,mode:e.mode,credentials:e.credentials,cache:e.cache,redirect:e.redirect,referrer:e.referrer,integrity:e.integrity});function bh(e){return"string"==typeof e&&"file://"===e.slice(0,7)}class bd extends bt{async iterator(){return bh(this.input)&&eT.get("IS_NODE")&&(this.input=({}).readFileSync(this.input.slice(7))),new bl(this.input,this.options)}constructor(e,t={}){super(),this.input=e,this.options=t}}class bp extends bt{async iterator(){return bh(this.url)?new bd(this.url,this.fileOptions).iterator():bc(this.url,this.fileOptions)}constructor(e,t={}){super(),this.url=e,this.fileOptions=t}}function bf(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new y0(new bp(e),t)}function bm(e){let t=new yE(e);return yG(async()=>t)}function bg(e){return yG(async()=>{let t=await e();return new yE(()=>t.next())})}async function bx(e,t){return be.create(e,t)}async function by(e){return y1.create(e)}e.s(["CSVDataset",()=>y0,"Dataset",()=>yW,"FileDataSource",()=>bd,"TextLineDataset",()=>yX,"URLDataSource",()=>bp,"array",()=>yH,"csv",()=>bf,"func",()=>bm,"generator",()=>bg,"microphone",()=>by,"version_data",()=>"4.22.0","webcam",()=>bx,"zip",()=>yq],31594),e.i(15571),e.i(31594),e.s([],81217);var oB=oB;e.s(["nonMaxSuppressionV3Impl",()=>us,"nonMaxSuppressionV4Impl",()=>uo,"nonMaxSuppressionV5Impl",()=>ul,"whereImpl",()=>yc],17723),e.s([],1865),e.i(1865);var bb=e.i(17723),bb=bb,cs=cs,cs=cs;function bv(e,t){Array.isArray(e)||(e=[e]),e.forEach(e=>{null!=e&&cs.assert("complex64"!==e.dtype,()=>"".concat(t," does not support complex64 tensors in the CPU backend."))})}let bw=bb.whereImpl;class bN extends E{nextDataId(){return bN.nextDataId++}write(e,t,n){this.firstUse&&(this.firstUse=!1,eT.get("IS_NODE")&&oB.warn("\n============================\nHi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. \n============================"));let a={id:this.nextDataId()};return this.data.set(a,{values:e,dtype:n,refCount:1}),a}makeTensorInfo(e,t,n){let a;if("string"===t&&null!=n&&n.length>0&&cs.isString(n[0])){let r=n.map(e=>cs.encodeString(e));a=this.write(r,e,t)}else a=this.write(n,e,t);return{dataId:a,shape:e,dtype:t}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){let t=this.data.get(e);t.refCount++}decRef(e){if(this.data.has(e)){let t=this.data.get(e);t.refCount--}}move(e,t,n,a,r){this.data.set(e,{values:t,dtype:a,refCount:r})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){let{dtype:t,complexTensorInfos:n}=this.data.get(e);if("complex64"===t){let e=this.readSync(n.real.dataId),t=this.readSync(n.imag.dataId);return oB.mergeRealAndImagArrays(e,t)}return cs.convertBackendValuesAndArrayBuffer(this.data.get(e).values,t)}bufferSync(e){let t=this.readSync(e.dataId);if("string"===e.dtype)try{let n=t.map(e=>cs.decodeString(e));return rD(e.shape,e.dtype,n)}catch(e){throw Error("Failed to decode encoded string bytes into utf-8")}return rD(e.shape,e.dtype,t)}makeOutput(e,t,n){return aR.makeTensorFromTensorInfo(this.makeTensorInfo(t,n,e),this)}disposeData(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;let{complexTensorInfos:n}=this.data.get(e);null!=n&&(this.disposeData(n.real.dataId,!0),this.disposeData(n.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){let t=cs.now();return e(),{kernelMs:cs.now()-t}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){bv([e],"where");let t=this.readSync(e.dataId);return bw(e.shape,t)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new I(this,aR)}}bN.nextDataId=0,e.s(["addImpl",()=>bM,"bincountImpl",()=>bO,"bincountReduceImpl",()=>bP,"bitwiseAndImpl",()=>bj,"castImpl",()=>b_,"ceilImpl",()=>bU,"concatImpl",()=>bG,"equalImpl",()=>bH,"expImpl",()=>bK,"expm1Impl",()=>bY,"floorDivImpl",()=>b$,"floorImpl",()=>bQ,"gatherNdImpl",()=>b1,"gatherV2Impl",()=>b2,"greaterEqualImpl",()=>b5,"greaterImpl",()=>b3,"lessEqualImpl",()=>b7,"lessImpl",()=>b8,"linSpaceImpl",()=>vt,"logImpl",()=>vn,"maxImpl",()=>vr,"maximumImpl",()=>vi,"minimumImpl",()=>vo,"multiplyImpl",()=>vc,"negImpl",()=>vh,"notEqualImpl",()=>vd,"prodImpl",()=>vg,"raggedGatherImpl",()=>vy,"raggedRangeImpl",()=>vb,"raggedTensorToTensorImpl",()=>vS,"rangeImpl",()=>vC,"rsqrtImpl",()=>vT,"scatterImpl",()=>vE,"sigmoidImpl",()=>v_,"simpleAbsImpl",()=>bk,"sliceImpl",()=>vD,"sparseFillEmptyRowsImpl",()=>vF,"sparseReshapeImpl",()=>vO,"sparseSegmentReductionImpl",()=>vP,"sqrtImpl",()=>vj,"squaredDifferenceImpl",()=>vz,"staticRegexReplaceImpl",()=>vV,"stridedSliceImpl",()=>vW,"stringNGramsImpl",()=>vH,"stringSplitImpl",()=>vq,"stringToHashBucketFastImpl",()=>vK,"subImpl",()=>vX,"tileImpl",()=>vZ,"topKImpl",()=>vJ,"transposeImpl",()=>vf,"uniqueImpl",()=>v$],81235),e.s([],25164),e.i(25164);var cs=cs;function bk(e){let t=new Float32Array(e.length);for(let n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}var oB=oB,cs=cs;function bS(e){return(t,n,a,r,i)=>{let s=oB.assertAndGetBroadcastShape(t,n),o=s.length,l=cs.computeStrides(s),c=cs.sizeFromShape(s),u=cs.getTypedArrayFromDType(i,c),h=t.length,d=n.length,p=cs.computeStrides(t),f=cs.computeStrides(n),m=oB.getBroadcastDims(t,s),g=oB.getBroadcastDims(n,s);if(m.length+g.length===0)for(let t=0;t<u.length;++t)u[t]=e(a[t%a.length],r[t%r.length]);else for(let t=0;t<u.length;++t){let n=cs.indexToLoc(t,o,l),i=n.slice(-h);m.forEach(e=>i[e]=0);let s=cs.locToIndex(i,h,p),c=n.slice(-d);g.forEach(e=>c[e]=0);let x=cs.locToIndex(c,d,f);u[t]=e(a[s],r[x])}return[u,s]}}var oB=oB,cs=cs,cs=cs,cs=cs;function bC(e){let{inputs:t,backend:n}=e,{real:a,imag:r}=t,i=n.data.get(a.dataId).values,s=n.data.get(r.dataId).values,o=n.makeTensorInfo(a.shape,"complex64");return n.data.get(o.dataId).complexTensorInfos={real:n.makeTensorInfo(a.shape,"float32",i),imag:n.makeTensorInfo(r.shape,"float32",s)},o}function bT(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"float32";if("complex64"===n)return bC({inputs:{real:bT(e,t,"float32"),imag:bT(e,t,"float32")},backend:e});let a=cs.makeZerosTypedArray(cs.sizeFromShape(t),n);return e.makeTensorInfo(t,n,a)}function bI(e){let{inputs:t,backend:n}=e,{x:a}=t;return n.incRef(a.dataId),{dataId:a.dataId,shape:a.shape,dtype:a.dtype}}function bE(e){let{inputs:t,backend:n}=e,{input:a}=t,r=n.data.get(a.dataId).complexTensorInfos.real,i=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,i)}function b_(e,t,n,a){if("int32"===a)return[t,"int32",Int32Array.from(e)];if("bool"===a){let a=cs.toTypedArray([0],n),[r,i]=bS((e,t)=>+(e!==t))(t,[],e,a,"bool");return[i,"bool",r]}throw Error("Error in Cast: failed to cast ".concat(n," to ").concat(a))}function bA(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{dtype:i}=a;if("complex64"===i){if("complex64"===r.dtype)return bI({inputs:{x:r},backend:n});let e=bT(n,r.shape,r.dtype),t=bA({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),a=bC({inputs:{real:t,imag:e},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),a}if("complex64"===r.dtype){let e=bE({inputs:{input:r},backend:n}),t=bA({inputs:{x:e},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(e),t}if(!cs.hasEncodingLoss(r.dtype,i)){let e=bI({inputs:{x:r},backend:n});return{dataId:e.dataId,shape:e.shape,dtype:i}}let[s,o,l]=b_(n.data.get(r.dataId).values,r.shape,r.dtype,i);return n.makeTensorInfo(s,o,l)}function bR(e,t,n,a){return null==n?n=>{let{inputs:r,backend:i}=n,{a:s,b:o}=r;bv([s,o],e);let l=i.data.get(s.dataId).values,c=i.data.get(o.dataId).values,u="string"===s.dtype?oB.fromUint8ToStringArray(l):l,h="string"===s.dtype?oB.fromUint8ToStringArray(c):c,d=a||s.dtype,[p,f]=t(s.shape,o.shape,u,h,d);return i.makeTensorInfo(f,d,p)}:e=>{let{inputs:r,backend:i}=e,{a:s,b:o}=r;if("complex64"===s.dtype||"complex64"===o.dtype){let e=bA({inputs:{x:s},backend:i,attrs:{dtype:"complex64"}}),t=i.data.get(e.dataId),a=t.complexTensorInfos.real,r=t.complexTensorInfos.imag,l=i.data.get(a.dataId).values,c=i.data.get(r.dataId).values,u=bA({inputs:{x:o},backend:i,attrs:{dtype:"complex64"}}),h=i.data.get(u.dataId),d=h.complexTensorInfos.real,p=h.complexTensorInfos.imag,f=i.data.get(d.dataId).values,m=i.data.get(p.dataId).values,[g,x,y]=n(s.shape,o.shape,l,c,f,m),b=i.makeTensorInfo(y,"float32",g),v=i.makeTensorInfo(y,"float32",x),w=bC({inputs:{real:b,imag:v},backend:i});return i.disposeIntermediateTensorInfo(e),i.disposeIntermediateTensorInfo(u),i.disposeIntermediateTensorInfo(b),i.disposeIntermediateTensorInfo(v),w}{let e=i.data.get(s.dataId).values,n=i.data.get(o.dataId).values,r=a||s.dtype,[l,c]=t(s.shape,o.shape,e,n,r);return i.makeTensorInfo(c,r,l)}}}function bD(e){return(t,n,a,r,i,s)=>{let o=oB.assertAndGetBroadcastShape(t,n),l=cs.sizeFromShape(o),c=o.length,u=cs.computeStrides(o),h=cs.getTypedArrayFromDType("float32",l),d=cs.getTypedArrayFromDType("float32",l),p=oB.getBroadcastDims(t,o),f=oB.getBroadcastDims(n,o),m=oB.mergeRealAndImagArrays(a,r),g=oB.mergeRealAndImagArrays(i,s),x=t.length,y=cs.computeStrides(t),b=n.length,v=cs.computeStrides(n);if(p.length+f.length===0)for(let t=0;t<h.length;t++){let n=t%m.length,a=t%g.length,r=e(m[2*n],m[2*n+1],g[2*a],g[2*a+1]);h[t]=r.real,d[t]=r.imag}else for(let t=0;t<h.length;t++){let n=cs.indexToLoc(t,c,u),a=n.slice(-x);p.forEach(e=>a[e]=0);let r=cs.locToIndex(a,x,y),i=n.slice(-b);f.forEach(e=>i[e]=0);let s=cs.locToIndex(i,b,v),o=e(m[2*r],m[2*r+1],g[2*s],g[2*s+1]);h[t]=o.real,d[t]=o.imag}return[h,d,o]}}let bM=bS((e,t)=>e+t),bF=bR("Add",bM,bD((e,t,n,a)=>({real:e+n,imag:t+a})));var cs=cs;function bO(e,t,n,a,r){let i=cs.sizeFromShape(a),s=cs.makeZerosTypedArray(r,n);for(let n=0;n<e.length;n++){let a=e[n];if(a<0)throw Error("Input x must be non-negative!");a>=r||(i>0?s[a]+=t[n]:s[a]+=1)}return s}function bP(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=e.shape[0],i=e.shape[1],s=rD([r,n],t.dtype);for(let o=0;o<r;o++)for(let r=0;r<i;r++){let i=e.get(o,r);if(i<0)throw Error("Input x must be non-negative!");i>=n||(a?s.set(1,o,i):t.size>0?s.set(s.get(o,i)+t.get(o,r),o,i):s.set(s.get(o,i)+1,o,i))}return s}let bj=bS((e,t)=>e&t),bL=bR(eq,bj);var cs=cs;function bz(e){return(t,n,a)=>{let r=cs.getArrayFromDType(n,t.length);for(let n=0;n<t.length;++n)r[n]=e(t[n],a);return r}}var oB=oB;function bB(e,t,n){return bV(e,bz(t),n)}function bV(e,t,n){return a=>{let r,{inputs:i,attrs:s,backend:o}=a,{x:l}=i;bv(l,e);let c=o.data.get(l.dataId).values;if("string"===l.dtype){if(!Array.isArray(c))throw Error("String tensor's value was not an instance of Array");r=oB.fromUint8ToStringArray(c)}else r=c;let u=n||l.dtype,h=t(r,u,s);return o.makeTensorInfo(l.shape,u,h)}}let bU=bz(e=>Math.ceil(e)),bW=bV(eY,bU);var oB=oB,cs=cs;function bG(e,t,n,a){let r=cs.getArrayFromDType(n,cs.sizeFromShape(t));if(a&&"string"!==n){let t=0;e.forEach(e=>{let n=cs.sizeFromShape(e.shape);r.set(e.vals,t),t+=n})}else{let a=0;e.forEach(e=>{let i="string"===n?oB.fromUint8ToStringArray(e.vals):e.vals,s=0;for(let n=0;n<e.shape[0];++n){let o=n*t[1]+a;for(let t=0;t<e.shape[1];++t)r[o+t]=i[s++]}a+=e.shape[1]})}return r}let bH=bS((e,t)=>+(e===t)),bq=bR(tp,bH,null,"bool"),bK=bz(e=>Math.exp(e)),bX=bV("Exp",bK,"float32"),bY=bz(e=>Math.expm1(e)),bZ=bV(tm,bY),bQ=bz(e=>Math.floor(e)),bJ=bV(ty,bQ),b$=bS((e,t)=>Math.floor(e/t)),b0=bR(tb,b$,null,"int32");function b1(e,t,n,a,r,i,s,o,l){let c=rD([a,i],n);for(let n=0;n<a;n++){let a=[],u=0;for(let t=0;t<r;t++){let i=e[n*r+t];u+=i*s[t],a.push(i)}if(u<0||u>=l/i)throw Error("Invalid indices: ".concat(a," does not index into ").concat(o));for(let e=0;e<i;e++)c.values[n*i+e]=t.get(...t.indexToLoc(u*i+e))}return c}function b2(e,t,n){let a=rD(n,e.dtype);for(let n=0;n<a.size;++n){let r=a.indexToLoc(n).slice(),i=r[0],s=r[2],o=t.locToIndex([i,s]);r[2]=t.values[o];let l=e.locToIndex(r);0<=l&&l<e.values.length&&(a.values[n]=e.values[l])}return a}let b3=bS((e,t)=>+(e>t)),b4=bR(tk,b3,null,"bool"),b5=bS((e,t)=>+(e>=t)),b6=bR(tS,b5,null,"bool"),b8=bS((e,t)=>+(e<t)),b9=bR(tD,b8,null,"bool"),b7=bS((e,t)=>+(e<=t)),ve=bR(tM,b7,null,"bool");var cs=cs;function vt(e,t,n){let a=(t-e)/(n-1),r=cs.makeZerosTypedArray(n,"float32");r[0]=e;for(let e=1;e<r.length;e++)r[e]=r[e-1]+a;return r}let vn=bz(e=>Math.log(e)),va=bV("Log",vn);var cs=cs;function vr(e,t,n,a){let r=cs.getTypedArrayFromDType(a,cs.sizeFromShape(n));for(let n=0;n<r.length;++n){let a=n*t,i=e[a];for(let n=0;n<t;++n){let t=e[a+n];(Number.isNaN(t)||t>i)&&(i=t)}r[n]=i}return r}let vi=bS((e,t)=>Math.max(e,t)),vs=bR(tB,vi),vo=bS((e,t)=>Math.min(e,t)),vl=bR(tK,vo),vc=bS((e,t)=>e*t),vu=bR(tZ,vc,bD((e,t,n,a)=>({real:e*n-t*a,imag:e*a+t*n})));var cs=cs;function vh(e,t,n){return vc([],t,cs.createScalarValue(-1,n),e,n)}let vd=bS((e,t)=>+(e!==t)),vp=bR(tQ,vd,null,"bool");var oB=oB,cs=cs,cs=cs;function vf(e,t,n,a,r){let i=t.length,s=cs.sizeFromShape(t),o=cs.computeStrides(t),l=cs.computeStrides(r),c=cs.getTypedArrayFromDType(n,cs.sizeFromShape(r));for(let t=0;t<s;++t){let n=cs.indexToLoc(t,i,o),r=Array(n.length);for(let e=0;e<r.length;e++)r[e]=n[a[e]];c[cs.locToIndex(r,i,l)]=e[t]}return c}function vm(e){let{inputs:t,attrs:n,backend:a}=e,{x:r}=t,{perm:i}=n;bv(r,"transpose");let s=Array(r.shape.length);for(let e=0;e<s.length;e++)s[e]=r.shape[i[e]];let o=vf(a.data.get(r.dataId).values,r.shape,r.dtype,i,s);return{dataId:a.write(o,s,r.dtype),shape:s,dtype:r.dtype}}function vg(e,t,n,a){let[r,i]=oB.computeOutAndReduceShapes(e,a),s=ab(t,"int32"),o=cs.makeZerosTypedArray(cs.sizeFromShape(r),s),l=cs.sizeFromShape(i);for(let e=0;e<o.length;++e){let t=e*l,a=1;for(let e=0;e<l;++e)a*=n[t+e];o[e]=a}return{outVals:o,outShape:r,outDtype:s}}var cs=cs;function vx(e,t){let n=e.slice(0,t);for(;n.length<t;)n.push(1);for(let a=t;a<e.length;a++)n[t-1]*=e[a];return n}function vy(e,t,n,a,r,i,s,o){if(0===e.length)throw Error("paramsNestedSplits must be non empty");if(0===t[0].length)throw Error("Split tensors must not be scalars");let l=t[0][0]-1;if(i.forEach((e,t)=>{if(e<0||e>=l){let n=cs.indexToLoc(t,s.length,cs.computeStrides(s)).join(",");throw Error("indices[".concat(n,"] = ").concat(e," is not in [0, ").concat(l,")"))}}),0===a.length)throw Error("params.rank must be nonzero");let{outSplits:c,valueSlices:u,numValues:h}=function(e,t,n,a){let r=[],i=0,s=Array(t.length-1+n.length).fill(null).map(()=>[0]);for(let e=0;e<n.length;++e){let t=n[e],r=e===n.length-1?a:n[e+1].length;if(0===t.length)throw Error("Ragged splits may not be empty");if(t[0]<0)throw Error("Ragged splits must be non-negative");if(t[t.length-1]>r)throw Error("Ragged splits must not point past values");for(let e=1;e<t.length;++e)if(t[e-1]>t[e])throw Error("Ragged splits must be sorted in ascending order")}let o=1;for(let e=0;e<t.length-1;++e){o*=t[e];let n=t[e+1];for(let t=1;t<o+1;++t)s[e].push(t*n)}for(let a=0;a<e.length;++a){let o=e[a],l=e[a]+1;for(let e=0;e<n.length;++e){let a=n[e],r=e+t.length-1;if(r>=0){let e=s[r],t=e[e.length-1]-a[o];for(let e=o;e<l;++e)s[r].push(a[e+1]+t)}o=a[o],l=a[l]}l!==o&&(r.push([o,l]),i+=l-o)}return{outSplits:s,valueSlices:r,numValues:i}}(i,s,e,a[0]),d=function(e){let t=[];for(let n=0;n<e.length;++n){let a=e[n].length,r=cs.getArrayFromDType("int32",a);t.push(r),e[n].forEach((e,t)=>r[t]=e)}return t}(c),p=function(e,t,n,a,r){let i=t.slice();i[0]=r;let s=cs.getArrayFromDType(n,cs.sizeFromShape(i)),o=e.length,l=0===o?0:o/t[0];return!function(e,t,n,a,r,i){let s=vx(t,2)[1],o=vx(i,2)[1],l=0;for(let t of n)for(let n=t[0];n<t[1];++n){for(let t=0;t<a;++t)r[l*o+t]=e[n*s+t];++l}}(e,t,a,l,s,i),[s,i]}(n,a,r,u,h);return[d,p[0],p[1]]}var cs=cs;function vb(e,t,n,a,r,i,s){if(t.length>1)throw Error("starts must be a scalar or vector");if(r.length>1)throw Error("limits must be a scalar or vector");if(s.length>1)throw Error("deltas must be a scalar or vector");let o=0===t.length,l=0===r.length,c=0===s.length,u=[];o||u.push(t[0]),l||u.push(r[0]),c||u.push(s[0]);for(let e=1;e<u.length;++e)if(u[e]!==u[e-1])throw Error("starts, limits, and deltas must have the same shape");let h=0===u.length?1:u[0],d=cs.getArrayFromDType("int32",h+1);d[0]=0;for(let t=0;t<h;++t){let n,r=o?e[0]:e[t],s=l?a[0]:a[t],u=c?i[0]:i[t];if(0===u)throw Error("Requires delta != 0");if(u>0&&s<r||u<0&&s>r)n=0;else if((n=Math.ceil(Math.abs((s-r)/u)))>0x7fffffff)throw Error("Requires ((limit - start) / delta) <= ".concat(0x7fffffff));d[t+1]=d[t]+n}let p=d[h],f=cs.getArrayFromDType(n,p),m=0;for(let t=0;t<h;++t){let n=d[t+1]-d[t],a=o?e[0]:e[t],r=c?i[0]:i[t];for(let e=0;e<n;++e)f[m++]=a,a+=r}return[d,f]}var oB=oB,cs=cs,vv=oB.RowPartitionType;class vw{getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===vv.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===vv.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){let t=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case vv.VALUE_ROWIDS:return vw.getMaxWidthValueRowID(t);case vv.ROW_SPLITS:return vw.getMaxWidthRowSplit(t);default:throw Error("Cannot handle partition type ".concat(vv[this.getRowPartitionTypeByDimension(e-1)]))}}static getMaxWidthRowSplit(e){let t=e.length;if(0===t||1===t)return 0;let n=0;for(let a=0;a<t-1;++a){let t=e[a+1]-e[a];t>n&&(n=t)}return n}static getMaxWidthValueRowID(e){let t=e.length;if(0===t)return 0;let n=0,a=e[0],r=0;for(let i=1;i<t;++i){let t=e[i];t!==a&&(a=t,r=Math.max(i-n,r),n=i)}return Math.max(t-n,r)}tensorShapeFromTensor(e,t){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(0===t.length){if(-1===e[0])return[];throw Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return vk(e,n)}calculateOutputSize(e){let t=this.valuesShape,n=this.defaultValueShape;oB.validateDefaultValueShape(n,t);let a=this.tensorShapeFromTensor(this.shape,this.shapeShape),r=oB.combineRaggedTensorToTensorShapes(this.raggedRank,a,t);r[0]<0&&(r[0]=e);for(let e=1;e<=this.raggedRank;++e)r[e]<0&&(r[e]=this.getMaxWidth(e));return r}calculateFirstParentOutputIndex(e,t,n){let a=Math.min(e,n),r=[],i=0;for(let e=0;e<a;++e,i+=t)r.push(i);for(let t=a;t<e;++t)r.push(-1);return cs.assert(r.length===e,()=>"Final length of result must be equal to firstDimension."),r}calculateOutputIndexRowSplit(e,t,n,a){let r=e.length,i=[];for(let s=0;s<r-1;++s){let r=e[s+1]-e[s],o=Math.min(a,r),l=t[s];-1===l&&(o=0);for(let e=0;e<o;++e)i.push(l),l+=n;for(let e=0;e<r-o;++e)i.push(-1)}if(r>0&&i.length!==e[r-1])throw Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(e,t,n,a){let r=e.length,i=[];if(0===r)return[];let s=0,o=e[0];if(o>=t.length)throw Error("Got currentValueRowId=".concat(o,", which is not less than ").concat(t.length));let l=t[o];i.push(l);for(let c=1;c<r;++c){let r=e[c];if(r===o)l>=0&&(++s<a?l+=n:l=-1);else{if(s=0,o=r,r>=t.length)throw Error("Got nextValueRowId=".concat(r," which is not less than ").concat(t.length));l=t[r]}i.push(l)}if(i.length!==e.length)throw Error("Invalid row ids.");return i}calculateOutputIndex(e,t,n,a){let r=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case vv.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(r,t,n,a);case vv.ROW_SPLITS:if(r.length-1>t.length)throw Error("Row partition size is greater than output size: ".concat(r.length-1," > ").concat(t.length));return this.calculateOutputIndexRowSplit(r,t,n,a);default:throw Error("Unsupported partition type: ".concat(vv[i]))}}getFirstDimensionSize(){let e=this.rowPartitionValues[0];if(0===this.rowPartitionTypes.length)throw Error("No row_partition_types given.");let t=this.rowPartitionTypes[0];switch(t){case vv.FIRST_DIM_SIZE:return e[0];case vv.VALUE_ROWIDS:throw Error("Cannot handle VALUE_ROWIDS in first dimension.");case vv.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw Error("Cannot handle type ".concat(vv[t]))}}compute(){if(this.rowPartitionValues[0].length<=0)throw Error("Invalid first partition input. Tensor requires at least one element.");let e=this.getFirstDimensionSize(),t=this.calculateOutputSize(e),n=Array(this.raggedRank+1);n[n.length-1]=1;for(let e=n.length-2;e>=0;--e)n[e]=n[e+1]*t[e+1];let a=vk(t,!1),r=cs.getArrayFromDType(this.valuesDType,cs.sizeFromShape(a));if(n[0]*t[0]>0){let i=this.calculateFirstParentOutputIndex(e,n[0],t[0]);for(let e=1;e<=this.raggedRank;++e)i=this.calculateOutputIndex(e-1,i,n[e],t[e]);this.setOutput(this.raggedRank,i,r,a)}return[a,r]}setOutput(e,t,n,a){if(0===n.length)return;let r=this.values,i=a.slice();i=i.slice(e+1);let s=cs.sizeFromShape(i),o=t.length,l=this.defaultValue;if(l.length!==s&&1!==l.length){let e=this.defaultValueShape;aQ(()=>{l=iD(io(l,e),i).dataSync()})}let c=0,u=0,h=0;for(let e=0;e<=o;++e){let a=e<o?t[e]:-1;if(a===h){++h;continue}if(u<h){let e=r.subarray(c*s);vN(n.subarray(u*s),e,(h-u)*s)}if(e>=o&&(a=Math.floor(n.length/s)),a>h)if(1===this.defaultValue.length)n.subarray(h*s,a*s).fill(this.defaultValue[0]),h=a;else for(;a>h;)vN(n.slice(h*s),l,s),++h;a<0?(c=e+1,u=h):(c=e,h=(u=h)+1)}}constructor(e,t,n,a,r,i,s,o,l,c){this.shape=e,this.shapeShape=t,this.values=n,this.valuesShape=a,this.valuesDType=r,this.defaultValue=i,this.defaultValueShape=s,this.rowPartitionValues=o,this.rowPartitionValuesShapes=l,this.rowPartitionTypes=oB.getRowPartitionTypesHelper(c),this.raggedRank=oB.getRaggedRank(this.rowPartitionTypes)}}function vN(e,t,n){for(let a=0;a<n;a++)e[a]=t[a]}function vk(e,t){let n=[];for(let a of e){if(a<0){if(!t)throw Error("Dimension ".concat(a," must be >= 0"));if(a<-1)throw Error("Dimension ".concat(a," must be >= -1"));a=-1}n.push(a)}return n}function vS(e,t,n,a,r,i,s,o,l,c){return new vw(e,t,n,a,r,i,s,o,l,c).compute()}var cs=cs;function vC(e,t,n,a){let r=e===t,i=e<t&&n<0,s=t<e&&n>1;if(r||i||s)return cs.makeZerosTypedArray(0,a);let o=Math.abs(Math.ceil((t-e)/n)),l=cs.makeZerosTypedArray(o,a);t<e&&1===n&&(n=-1),l[0]=e;for(let e=1;e<l.length;e++)l[e]=l[e-1]+n;return l}let vT=bz(e=>1/Math.sqrt(e)),vI=bV(nd,vT);function vE(e,t,n,a,r,i,s,o,l,c){let u=e.values,h=t.values;if(0===a)return rD(n,t.dtype);let d=l instanceof ad?l:rD([a/r,r],t.dtype);"string"==typeof l||"number"==typeof l?d.values.fill(l):"boolean"==typeof l&&d.values.fill(+l);for(let e=0;e<i;e++){let i=[],l=0;for(let t=0;t<s;t++){let n=u[e*s+t];i.push(n),l+=n*o[t]}if(l<0||l>=a/r)throw Error("Invalid indices: ".concat(i," does not index into ").concat(n));for(let n=0;n<r;n++)c?d.values[l*r+n]+=h[e*r+n]:d.values[l*r+n]=0===t.rank?h[0]:h[e*r+n]}return d}let v_=bz(e=>1/(1+Math.exp(-e))),vA=bB(nw,e=>1/(1+Math.exp(-e)));var oB=oB,vR=sR,cs=cs;function vD(e,t,n,a,r){let i=vR.isSliceContinous(a,t,n),s=cs.sizeFromShape(n),o=cs.computeStrides(a);if(i){let n=vR.computeFlatOffset(t,o);return"string"===r?e.slice(n,n+s):e.subarray(n,n+s)}let l="string"===r?oB.fromUint8ToStringArray(e):e,c=rD(a,r,l),u=rD(n,r);for(let e=0;e<u.size;++e){let n=u.indexToLoc(e),a=n.map((e,n)=>e+t[n]);u.set(c.get(...a),...n)}return"string"===r?oB.fromStringArrayToUint8(u.values):u.values}function vM(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{begin:i,size:s}=a;bv(r,"slice");let[o,l]=vR.parseSliceParams(r,i,s);vR.assertParamsValid(r,o,l);let c=vD(n.data.get(r.dataId).values,o,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,c)}var oB=oB,cs=cs;function vF(e,t,n,a,r,i,s){let o=t[0],l=i[0],c=Array(l),u=Array(o),h=t[1];if(0===l){if(0!==o)throw Error(oB.getSparseFillEmptyRowsIndicesDenseShapeMismatch(o));return[cs.getArrayFromDType(n,0),[0,h],cs.getArrayFromDType(r,0),c,u]}let d=!0,p=0,f=Array(l).fill(0);for(let t=0;t<o;++t){let n=e[t*h];if(n<0)throw Error(oB.getSparseFillEmptyRowsNegativeIndexErrorMessage(t,n));if(n>=l)throw Error(oB.getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(t,n,l));++f[n],d=d&&n>=p,p=n}let m=!0;for(let e=0;e<l;++e){let t=0===f[e];c[e]=t,m=m&&!t,f[e]=Math.max(f[e],1),e>0&&(f[e]+=f[e-1])}if(m&&d){for(let e=0;e<o;++e)u[e]=e;return[e,[o,h],a,c,u]}{let t=f[l-1],i=cs.getArrayFromDType(n,t*h),d=cs.getArrayFromDType(r,t),p=Array(l).fill(0);for(let t=0;t<o;++t){let n=e[t*h],r=p[n],s=(0===n?0:f[n-1])+r;p[n]++;for(let n=0;n<h;++n)i[s*h+n]=e[t*h+n];d[s]=a[t],u[t]=s}for(let e=0;e<l;++e)if(0===p[e]){let t=0===e?0:f[e-1];i[t*h+0]=e;for(let e=1;e<h;++e)i[t*h+e]=0;d[t]=s}return[i,[t,h],d,c,u]}}var oB=oB,cs=cs;function vO(e,t,n,a,r){let i=cs.sizeFromShape(a),s=t[0],o=r.length,l=[],c=1,u=-1;for(let e=0;e<o;++e){let t=r[e];if(-1===t){if(-1!==u)throw Error(oB.getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(u,e));u=e,l.push(1)}else{if(t<0)throw Error(oB.getSparseReshapeNegativeOutputDimErrorMessage(e,t));c*=t,l.push(t)}}if(-1!==u){if(c<=0)throw Error(oB.getSparseReshapeEmptyTensorZeroOutputDimErrorMessage());let e=Math.trunc(i/c);if(c*e!==i)throw Error(oB.getSparseReshapeInputOutputMultipleErrorMessage(a,l));l[u]=e}if(cs.sizeFromShape(l)!==i)throw Error(oB.getSparseReshapeInputOutputMismatchErrorMessage(a,l));let h=a.length,d=[];if(h>0){d[h-1]=1;for(let e=h-2;e>=0;--e)d[e]=d[e+1]*a[e+1]}let p=[];if(o>0){p[o-1]=1;for(let e=o-2;e>=0;--e)p[e]=p[e+1]*l[e+1]}let f=cs.getArrayFromDType(n,s*o);for(let t=0;t<s;++t){let n=0;for(let a=0;a<h;++a)n+=e[t*h+a]*d[a];for(let e=0;e<o;++e)f[t*o+e]=Math.trunc(n/p[e]),n%=p[e]}return[f,[s,o],l]}var oB=oB,cs=cs;function vP(e,t,n,a,r){let i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=a.length,l=[t[0],e.length/t[0]],c=l[1],u=o>0?r[o-1]+1:0;if(u<0)throw Error(oB.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let h=t.slice();h[0]=u;let d=h.reduce((e,t)=>e*t,1),p=cs.getArrayFromDType(n,d);if(0===o)return u>0&&p.fill(s),[p,h];if(u<=0)throw Error(oB.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let f=0,m=1,g=0,x=r[0];for(;;){let t=0;if(m<o){if(x===(t=r[m])){++m;continue}if(x>=t)throw Error(oB.getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage())}if(x<0||x>=u)throw Error(oB.getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(x,u));x>g&&p.fill(s,g*c,x*c);for(let t=f;t<m;++t){let n=a[t];if(n<0||n>=l[0])throw Error(oB.getSparseSegmentReductionIndicesOutOfRangeErrorMessage(t,a[t],l[0]));for(let t=0;t<c;t++)p[x*c+t]+=e[n*c+t]}if(i)for(let e=0;e<c;e++)p[x*c+e]/=m-f;if(f=m,++m,g=x+1,x=t,m>o)break}return g<u&&p.fill(s,g*c,u*c),[p,h]}let vj=bz(e=>Math.sqrt(e)),vL=bB(nk,e=>Math.sqrt(e)),vz=bS((e,t)=>{let n=e-t;return n*n}),vB=bR(nD,vz),vV=bz((e,t)=>{let{pattern:n,replaceGlobal:a,rewrite:r}=t;return e.replace(new RegExp(n,a?"g":""),r)}),vU=bV(nF,vV);function vW(e,t,n,a){let r=rD(e,t.dtype);for(let e=0;e<r.size;e++){let i=r.indexToLoc(e),s=Array(i.length);for(let e=0;e<s.length;e++)s[e]=i[e]*n[e]+a[e];r.set(t.get(...s),...i)}return r}var cs=cs;class vG{getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){return Math.max(0,e+2*this.getPadWidth(t)-t+1)}createNGrams(e,t,n,a,r,i){for(let s=0;s<r;++s){let o,l=this.getPadWidth(i),c=Math.max(0,l-s),u=Math.max(0,l-(r-(s+1))),h=i-(c+u),d=t+(c>0?0:s-l);o=0+c*this.leftPad.length;for(let t=0;t<h;++t)o+=e[d+t].length;o+=u*this.rightPad.length,o+=(c+u+h-1)*this.separator.length,n[a+s]=new Uint8Array(o);let p=n[a+s],f=0,m=e=>e.forEach(e=>p[f++]=e);for(let e=0;e<c;++e)m(this.leftPad),m(this.separator);for(let t=0;t<h-1;++t)m(e[d+t]),m(this.separator);if(h>0){m(e[d+h-1]);for(let e=0;e<u;++e)m(this.separator),m(this.rightPad)}else{for(let e=0;e<u-1;++e)m(this.rightPad),m(this.separator);m(this.rightPad)}}}compute(e,t){let n=e.length,a=t.length;if(a>0){let e=t[0];if(0!==e)throw Error("First split value must be 0, got ".concat(e));for(let r=1;r<a;++r){let a=t[r]>=e;if(!(a=a&&t[r]<=n))throw Error("Invalid split value ".concat(t[r],", must be in [").concat(e,", ").concat(n,"]"));e=t[r]}if(e!==n)throw Error("Last split value must be data size. Expected ".concat(n,", got ").concat(e))}let r=a-1,i=cs.getArrayFromDType("int32",a);if(0===n||0===a){let e=Array(n);for(let e=0;e<=r;++e)i[e]=0;return[e,i]}i[0]=0;for(let e=1;e<=r;++e){let n=t[e]-t[e-1],a=0;this.nGramWidths.forEach(e=>{a+=this.getNumNGrams(n,e)}),this.preserveShort&&n>0&&0===a&&(a=1),i[e]=i[e-1]+a}let s=Array(i[r]);for(let n=0;n<r;++n){let a=t[n],r=i[n];if(this.nGramWidths.forEach(i=>{let o=t[n+1]-t[n],l=this.getNumNGrams(o,i);this.createNGrams(e,a,s,r,l,i),r+=l}),this.preserveShort&&r===i[n]){let i=t[n+1]-t[n];if(0===i)continue;let o=i+2*this.padWidth;this.createNGrams(e,a,s,r,1,o)}}return[s,i]}constructor(e,t,n,a,r,i){this.separator=cs.encodeString(e),this.nGramWidths=t,this.leftPad=cs.encodeString(n),this.rightPad=cs.encodeString(a),this.padWidth=r,this.preserveShort=i}}function vH(e,t,n,a,r,i,s,o){return new vG(n,a,r,i,s,o).compute(e,t)}var cs=cs;function vq(e,t,n){let a=e.length,r=[],i=0,s=0,o=Array(a);for(let l=0;l<a;++l){let a=r.length;!function(e,t,n,a){if(!e.length)return;if(0===t.length){for(let t=0;t<e.length;++t)a.push(e.subarray(t,t+1));return}if(1===t.length){let r=t[0],i=e.indexOf(r);for(;-1!==i;){let t=e.subarray(0,i);n&&0===t.length||a.push(t),i=(e=e.subarray(i+1)).indexOf(r)}n&&0===e.length||a.push(e);return}let r=0;for(let i=0;i<e.length+1;i++)if(i===e.length||-1!==t.indexOf(e[i])){let t=e.subarray(r,i);n&&0===t.length||a.push(t),r=i+1}}(e[l],t,n,r);let c=r.length-a;o[l]=c,i+=c,s=Math.max(s,c)}let l=cs.getArrayFromDType("int32",2*i),c=Array(i),u=[a,s],h=0;for(let e=0;e<a;++e)for(let t=0;t<o[e];++t)l[2*h]=e,l[2*h+1]=t,c[h]=r[h],++h;return[l,c,u]}var cs=cs;function vK(e,t){let n=cs.getArrayFromDType("int32",e.length);for(let a=0;a<e.length;++a)n[a]=cs.fingerPrint64(e[a]).modulo(t).getLowBitsUnsigned();return n}let vX=bS((e,t)=>e-t),vY=bR("Sub",vX,bD((e,t,n,a)=>({real:e-n,imag:t-a})));function vZ(e,t){let n=Array(e.rank);for(let a=0;a<n.length;a++)n[a]=e.shape[a]*t[a];let a=rD(n,e.dtype);for(let t=0;t<a.values.length;++t){let n=a.indexToLoc(t),r=Array(e.rank);for(let t=0;t<r.length;t++)r[t]=n[t]%e.shape[t];let i=e.locToIndex(r);a.values[t]=e.values[i]}return a}var cs=cs;let vQ=(e,t)=>{let n=t.value-e.value;return 0===n?e.index-t.index:n};function vJ(e,t,n,a,r){let i=t[t.length-1],[s,o]=[e.length/i,i],l=cs.getTypedArrayFromDType(n,s*a),c=cs.getTypedArrayFromDType("int32",s*a);for(let t=0;t<s;t++){let n=t*o,i=e.subarray(n,n+o),s=Array(i.length);i.forEach((e,t)=>s[t]={value:e,index:t}),a<s.length&&(!function e(t,n){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length-1;for(;r>a;){if(r-a>600){let i=r-a+1,s=n-a+1,o=Math.log(i),l=.5*Math.exp(2*o/3),c=.5*Math.sqrt(o*l*(i-l)/i)*Math.sign(s-i/2),u=Math.max(a,Math.floor(n-s*l/i+c)),h=Math.min(r,Math.floor(n+(i-s)*l/i+c));e(t,n,u,h)}let i=t[n],s=a,o=r;for(cs.swap(t,a,n),vQ(t[r],i)>0&&cs.swap(t,a,r);s<o;){for(cs.swap(t,s,o),s++,o--;0>vQ(t[s],i);)s+=1;for(;vQ(t[o],i)>0;)o-=1}0===vQ(t[a],i)?cs.swap(t,a,o):(o+=1,cs.swap(t,o,r)),o<=n&&(a=o+1),n<=o&&(r=o-1)}}(s,a),s=s.slice(0,a)),r&&s.sort(vQ);let u=t*a,h=l.subarray(u,u+a),d=c.subarray(u,u+a);for(let e=0;e<a;e++)h[e]=s[e].value,d[e]=s[e].index}let u=t.slice();return u[u.length-1]=a,[rD(u,n,l),rD(u,"int32",c)]}var cs=cs;function v$(e,t,n,a){let r=cs.parseAxisParam(t,n)[0],i=[1,n[0],1];for(let e=0;e<r;e++)i[0]*=n[e];i[1]=n[r];for(let e=r+1;e<n.length;e++)i[2]*=n[e];let s=new Map,o=new Int32Array(n[r]),l=new ad(i,a,e),c=[],u=1===i[0]&&1===i[2];for(let t=0;t<n[r];t++){let n;if(u)n=e[t].toString();else{let e=[];for(let n=0;n<i[0];n++)for(let a=0;a<i[2];a++)e.push(l.get(n,t,a));n=e.join(",")}let a=s.get(n);if(null!=a)o[t]=a;else{let e=s.size;s.set(n,e),o[t]=e,c.push(t)}}let h=i.slice();h[1]=s.size;let d=new ad(h,a);c.forEach((e,t)=>{for(let n=0;n<i[0];n++)for(let a=0;a<i[2];a++)d.set(l.get(n,e,a),n,t,a)});let p=n.slice();return p[r]=h[1],{outputValues:d.values,outputShape:p,indices:o}}var v0=e.i(81235);a0("cpu",()=>new bN,1);let v1=bB("Elu",e=>e>=0?e:Math.exp(e)-1);var cs=cs;function v2(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{alpha:i}=a;bv([r],"leakyRelu");let s=cs.sizeFromShape(r.shape),o=n.data.get(r.dataId).values,l=cs.getTypedArrayFromDType("float32",s);for(let e=0;e<o.length;e++)l[e]=o[e]<0?i*o[e]:o[e];return n.makeTensorInfo(r.shape,"float32",l)}let v3=bS((e,t)=>e<0?t*e:e);function v4(e){let{inputs:t,backend:n}=e,{x:a,alpha:r}=t;bv([a,r],"prelu");let i=n.data.get(a.dataId).values,s=n.data.get(r.dataId).values,[o,l]=v3(a.shape,r.shape,i,s,"float32");return n.makeTensorInfo(l,"float32",o)}let v5=bB(na,e=>Math.max(0,e)),v6=bB(nc,e=>Math.min(Math.max(0,e),6));function v8(e,t,n,a,r){if("linear"===n)return bI({inputs:{x:t},backend:e});if("relu"===n)return v5({inputs:{x:t},backend:e});if("elu"===n)return v1({inputs:{x:t},backend:e});if("relu6"===n)return v6({inputs:{x:t},backend:e});if("prelu"===n)return v4({inputs:{x:t,alpha:a},backend:e});else if("leakyrelu"===n)return v2({inputs:{x:t},backend:e,attrs:{alpha:r}});else if("sigmoid"===n)return vA({inputs:{x:t},backend:e});throw Error("Activation ".concat(n," has not been implemented for the CPU backend."))}var v9=sB,cs=cs,cs=cs;function v7(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{shape:i}=a,s=cs.sizeFromShape(r.shape),o=cs.inferFromImplicitShape(i,s),l=cs.sizeFromShape(o);cs.assert(s===l,()=>"The new shape (".concat(o,") has ").concat(l," elements and the old ")+"shape (".concat(r.shape,") has ").concat(s," elements. The new shape and old ")+"shape must have the same number of elements."),n.incRef(r.dataId);let c=n.data.get(r.dataId);if(null!=c.complexTensorInfos){let e=c.complexTensorInfos.real,t=c.complexTensorInfos.imag;e.shape=o,t.shape=o}return{dataId:r.dataId,shape:o,dtype:r.dtype}}function we(e){let{inputs:t,backend:n,attrs:a}=e,{a:r,b:i}=t,{transposeA:s,transposeB:o}=a;bv([r,i],"matMul");let l=r.shape.length,c=i.shape.length,u=s?r.shape[l-2]:r.shape[l-1],h=o?i.shape[c-1]:i.shape[c-2],d=s?r.shape[l-1]:r.shape[l-2],p=o?i.shape[c-2]:i.shape[c-1],f=r.shape.slice(0,-2),m=i.shape.slice(0,-2),g=cs.sizeFromShape(f),x=cs.sizeFromShape(m),y=v9.assertAndGetBroadcastShape(r.shape.slice(0,-2),i.shape.slice(0,-2)).concat([d,p]);cs.assert(u===h,()=>"Error in matMul: inner shapes (".concat(u,") and (")+"".concat(h,") of Tensors with shapes ").concat(r.shape," and ")+"".concat(i.shape," and transposeA=").concat(s)+" and transposeB=".concat(o," must match."));let b=v7({inputs:{x:r},backend:n,attrs:{shape:s?[g,u,d]:[g,d,u]}}),v=v7({inputs:{x:i},backend:n,attrs:{shape:o?[x,p,h]:[x,h,p]}}),w=s?b.shape[1]:b.shape[2],N=s?b.shape[2]:b.shape[1],k=o?v.shape[1]:v.shape[2],S=Math.max(g,x),C=n.data.get(b.dataId).values,T=n.data.get(v.dataId).values,I=cs.computeStrides(b.shape),E=cs.computeStrides(v.shape),[_,A,R]=s?[I[0],1,I[1]]:[I[0],I[1],1],[D,M,F]=o?[1,E[1],E[0]]:[E[1],1,E[0]],O=N*k,P=rD([S,N,k],b.dtype),j=P.values,L=n.blockSize;for(let e=0;e<S;e++){let t=e%g,n=e%x;for(let a=0;a<N;a+=L){let r=Math.min(a+L,N);for(let i=0;i<k;i+=L){let s=Math.min(i+L,k);for(let o=0;o<w;o+=L){let l=Math.min(o+L,w);for(let c=a;c<r;c++)for(let a=i;a<s;a++){let r=0;for(let e=o;e<l;e++)r+=C[t*_+c*A+e*R]*T[e*D+a*M+n*F];j[e*O+(c*k+a)]+=r}}}}}return n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(v),n.makeTensorInfo(y,P.dtype,P.values)}let wt=bB(e_,e=>Math.acos(e)),wn=bB(eA,e=>Math.acosh(e));var oB=oB,cs=cs,oB=oB,cs=cs,oB=oB,cs=cs,oB=oB,cs=cs;let wa=bB(eF,e=>Math.asin(e)),wr=bB(eO,e=>Math.asinh(e)),wi=bB(eP,e=>Math.atan(e)),ws=bR(eL,bS((e,t)=>Math.atan2(e,t))),wo=bB(ej,e=>Math.atanh(e));var oB=oB,cs=cs;function wl(e,t,n,a,r,i){let s=r.strideHeight,o=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,u=r.effectiveFilterHeight,h=r.effectiveFilterWidth,d=r.padInfo.top,p=r.padInfo.left,f="max"===i?-1/0:1/0,m=rD(r.outShape,n),g=m.values,x=r.outShape[1]*r.outShape[2]*r.outShape[3],y=r.outShape[2]*r.outShape[3],b=r.outShape[3];for(let t=0;t<r.batchSize;++t){let n=t*x,m=t*a[0];for(let t=0;t<r.inChannels;++t)for(let x=0;x<r.outHeight;++x){let v=x*s-d,w=Math.max(0,v),N=Math.min(r.inHeight,u+v),k=n+x*y;for(let n=0;n<r.outWidth;++n){let s=n*o-p,u=Math.max(0,s),d=Math.min(r.inWidth,h+s),x=f,y=0,v=0;for(let n=w;n<N;n+=l){let r=m+n*a[1];for(let n=u;n<d;n+=c){let s=e[r+n*a[2]+t];"max"===i&&s>x?x=s:"avg"===i&&(y+=s,v++)}if(isNaN(x))break}g[k+n*b+t]="avg"===i?y/v:x}}}return m}function wc(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=rD(a.outShape,"int32"),o=a.strideHeight,l=a.strideWidth,c=a.dilationHeight,u=a.dilationWidth,h=a.effectiveFilterHeight,d=a.effectiveFilterWidth,p=a.padInfo.top,f=a.padInfo.left,m=rD(t,n,e);for(let e=0;e<a.batchSize;++e)for(let t=0;t<a.inChannels;++t)for(let n=0;n<a.outHeight;++n){let g=n*o-p,x=g;for(;x<0;)x+=c;let y=Math.min(a.inHeight,h+g);for(let o=0;o<a.outWidth;++o){let h=o*l-f,p=h;for(;p<0;)p+=u;let b=Math.min(a.inWidth,d+h),v=-1/0,w=-1;for(let n=x;n<y;n+=c){let s=n-g;for(let o=p;o<b;o+=u){let l=o-h,c=m.get(e,n,o,t);c>v&&(v=c,w=r?i?((e*a.inHeight+n)*a.inWidth+o)*a.inChannels+t:(n*a.inWidth+o)*a.inChannels+t:s*d+l)}}s.set(w,e,n,o,t)}}return s}function wu(e,t,n,a,r,i){let s=r.strideDepth,o=r.strideHeight,l=r.strideWidth,c=r.dilationDepth,u=r.dilationHeight,h=r.dilationWidth,d=r.effectiveFilterDepth,p=r.effectiveFilterHeight,f=r.effectiveFilterWidth,m=r.padInfo.front,g=r.padInfo.top,x=r.padInfo.left,y="max"===i?-1/0:1/0,b=rD(r.outShape,n),v=b.values,w=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],N=r.outShape[2]*r.outShape[3]*r.outShape[4],k=r.outShape[3]*r.outShape[4],S=r.outShape[4];for(let t=0;t<r.batchSize;++t){let n=t*w,b=t*a[0];for(let t=0;t<r.inChannels;++t)for(let w=0;w<r.outDepth;++w){let C=w*s-m,T=C;for(;T<0;)T+=c;let I=Math.min(r.inDepth,d+C),E=n+w*N;for(let n=0;n<r.outHeight;++n){let s=n*o-g,d=s;for(;d<0;)d+=u;let m=Math.min(r.inHeight,p+s),w=E+n*k;for(let n=0;n<r.outWidth;++n){let s=n*l-x,o=s;for(;o<0;)o+=h;let p=Math.min(r.inWidth,f+s),g=w+n*S,N=y,k=0,C=0;for(let n=T;n<I;n+=c){let r=b+n*a[1];for(let n=d;n<m;n+=u){let s=r+n*a[2];for(let n=o;n<p;n+=h){let r=e[s+n*a[3]+t];if("max"===i&&r>N?N=r:"avg"===i&&(k+=r,C++),isNaN(N))break}if(isNaN(N))break}if(isNaN(N))break}v[g+t]="avg"===i?k/Math.max(C,1):N}}}}return b}var oB=oB,cs=cs,oB=oB,oB=oB,cs=cs,oB=oB,oB=oB;let wh=bB(eZ,(e,t)=>e>t.clipValueMax?t.clipValueMax:e<t.clipValueMin?t.clipValueMin:e);var cs=cs,oB=oB,cs=cs;function wd(e){let{inputs:t,backend:n}=e,{input:a}=t,r=n.data.get(a.dataId).complexTensorInfos.imag,i=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,i)}function wp(e){let{inputs:t,backend:n,attrs:a}=e,{axis:r}=a,i=cs.parseAxisParam(r,t[0].shape)[0],s=t.map(e=>e.shape);oB.assertParamsConsistent(s,i);let o=oB.computeOutShape(t.map(e=>e.shape),i);if(0===cs.sizeFromShape(o))return n.makeTensorInfo(o,t[0].dtype,[]);let l=t.filter(e=>cs.sizeFromShape(e.shape)>0);if(1===l.length)return bI({inputs:{x:l[0]},backend:n});if("complex64"===l[0].dtype){let e=l.map(e=>bE({inputs:{input:e},backend:n})),t=l.map(e=>wd({inputs:{input:e},backend:n})),a=wp({inputs:e,backend:n,attrs:{axis:i}}),r=wp({inputs:t,backend:n,attrs:{axis:i}}),s=bC({inputs:{real:a,imag:r},backend:n});return e.forEach(e=>n.disposeIntermediateTensorInfo(e)),t.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(r),s}let c=l.map(e=>{let t=cs.sizeFromShape(e.shape.slice(i));return v7({inputs:{x:e},backend:n,attrs:{shape:[-1,t]}})}),u=c.map(e=>({vals:n.data.get(e.dataId).values,shape:e.shape}));o=oB.computeOutShape(c.map(e=>e.shape),1);let h=1===c[0].shape[0],d=bG(u,o,t[0].dtype,h),p=oB.computeOutShape(l.map(e=>e.shape),i),f=n.makeTensorInfo(p,t[0].dtype,d);return c.forEach(e=>n.disposeIntermediateTensorInfo(e)),f}var oB=oB,cs=cs;function wf(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:i}=t,{strides:s,pad:o,dataFormat:l,dilations:c,dimRoundingMode:u}=a;bv([r,i],"conv2d");let h=oB.convertConv2DDataFormat(l),d=oB.computeConv2DInfo(r.shape,i.shape,s,c,o,u,!1,h),p=d.filterHeight,f=d.filterWidth,m=d.dilationHeight,g=d.dilationWidth,x=d.padInfo.left,y=d.padInfo.top,b="channelsLast"===d.dataFormat,v=new ad(d.outShape,r.dtype),w=cs.computeStrides(r.shape),N=cs.computeStrides(i.shape),k=w[0],S=b?w[1]:w[2],C=b?w[2]:1,T=b?1:w[1],I=v.strides[0],E=b?v.strides[1]:v.strides[2],_=b?v.strides[2]:1,A=b?1:v.strides[1],R=n.data.get(r.dataId).values,D=n.data.get(i.dataId).values,M=v.values;for(let e=0;e<d.batchSize;++e){let t=e*k,n=e*I;for(let e=0;e<d.outHeight;++e){let a=n+e*E,r=e*d.strideHeight-y;for(let e=0;e<p;++e){let n=r+e*m;if(n<0||n>=d.inHeight)continue;let i=e*N[0],s=t+n*S;for(let e=0;e<d.outWidth;++e){let t=a+e*_,n=e*d.strideWidth-x;for(let e=0;e<f;++e){let a=n+e*g;if(a<0||a>=d.inWidth)continue;let r=i+e*N[1],o=s+a*C,l=r;for(let e=0;e<d.inChannels;++e){let n=R[o+e*T];for(let e=0;e<d.outChannels;++e)M[t+e*A]+=n*D[l+e];l+=d.outChannels}}}}}}return n.makeTensorInfo(v.shape,v.dtype,M)}var oB=oB,oB=oB,cs=cs,oB=oB,cs=cs,oB=oB,cs=cs,oB=oB,cs=cs;let wm=bB("Cos",e=>Math.cos(e)),wg=bB(e6,e=>Math.cosh(e));var cs=cs,oB=oB,cs=cs,oB=oB,cs=cs,cs=cs,oB=oB,cs=cs;function wx(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:i}=t,{strides:s,pad:o,dilations:l,dimRoundingMode:c}=a;bv([r,i],"depthwiseConv2DNative");let u=cs.computeStrides(r.shape),h=cs.computeStrides(i.shape),d=l;null==d&&(d=[1,1]),cs.assert(oB.eitherStridesOrDilationsAreOne(s,d),()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(s," and dilations '").concat(d,"'"));let p=oB.computeConv2DInfo(r.shape,i.shape,s,d,o,c,!0),{filterHeight:f,filterWidth:m,dilationHeight:g,dilationWidth:x,padInfo:y}=p,b=y.left,v=y.top,w=p.outChannels/p.inChannels,N=new ad(p.outShape,r.dtype),k=n.data.get(r.dataId).values,S=n.data.get(i.dataId).values,C=N.values;for(let e=0;e<p.batchSize;++e){let t=e*u[0],n=e*N.strides[0];for(let e=0;e<p.outHeight;++e){let a=n+e*N.strides[1],r=e*p.strideHeight-v;for(let e=0;e<f;++e){let n=r+e*g;if(n<0||n>=p.inHeight)continue;let i=e*h[0],s=t+n*u[1];for(let e=0;e<p.outWidth;++e){let t=a+e*N.strides[2],n=e*p.strideWidth-b;for(let e=0;e<m;++e){let a=n+e*x;if(a<0||a>=p.inWidth)continue;let r=i+e*h[1],o=s+a*p.inChannels,l=t,c=r;for(let e=0;e<p.inChannels;++e){let t=k[o+e];for(let e=0;e<w;++e)C[l+e]+=t*S[c+e];l+=w,c+=w}}}}}}return n.makeTensorInfo(N.shape,N.dtype,N.values)}var oB=oB,oB=oB,cs=cs,cs=cs,oB=oB,cs=cs,oB=oB,cs=cs,oB=oB,cs=cs,oB=oB,cs=cs,oB=oB,cs=cs;function wy(e){let t,{inputs:n,backend:a,attrs:r}=e,{x:i}=n,{axis:s,keepDims:o}=r;bv(i,"sum");let l=(t="bool"===i.dtype?bA({inputs:{x:i},backend:a,attrs:{dtype:"int32"}}):bI({inputs:{x:i},backend:a})).shape.length,c=cs.parseAxisParam(s,t.shape),u=oB.getAxesPermutation(c,l),h=c,d=t;null!=u&&(d=vm({inputs:{x:t},backend:a,attrs:{perm:u}}),h=oB.getInnerMostAxes(h.length,l)),oB.assertAxesAreInnerMostDims("sum",h,d.shape.length);let[p,f]=oB.computeOutAndReduceShapes(d.shape,h),m=bT(a,p,oB.upcastType(d.dtype,"int32")),g=cs.sizeFromShape(f),x=a.data.get(m.dataId).values,y=a.data.get(d.dataId).values;for(let e=0;e<x.length;++e){let t=e*g,n=0;for(let e=0;e<g;++e)n+=y[t+e];x[e]=n}if(o){let e=oB.expandShapeToKeepDim(m.shape,c),t=m;m=v7({inputs:{x:m},backend:a,attrs:{shape:e}}),a.disposeIntermediateTensorInfo(t)}return a.disposeIntermediateTensorInfo(t),null!=u&&a.disposeIntermediateTensorInfo(d),m}var cs=cs,oB=oB;let wb=oB.ERF_P,wv=oB.ERF_A1,ww=oB.ERF_A2,wN=oB.ERF_A3,wk=oB.ERF_A4,wS=oB.ERF_A5,wC=bB("Erf",e=>{let t=Math.sign(e),n=Math.abs(e),a=1/(1+wb*n);return t*(1-((((wS*a+wk)*a+wN)*a+ww)*a+wv)*a*Math.exp(-n*n))});var cs=cs;function wT(e){let{inputs:t,backend:n,attrs:a}=e,{input:r}=t,{dim:i}=a,s=r.shape.length,o=r.shape.slice(),l=i;return i<0&&(cs.assert(-(s+1)<=i,()=>"Axis must be in the interval [".concat(-(s+1),", ").concat(s,"]")),l=s+i+1),o.splice(l,0,1),v7({inputs:{x:r},backend:n,attrs:{shape:o}})}var cs=cs,oB=oB,cs=cs;let wI=bR(tu,bS((e,t)=>e/t)),wE={kernelName:tu,backendName:"cpu",kernelFunc:wI};function w_(e,t,n){let a=e.shape,r=a[0],i=a[1],s=n.data.get(e.dataId),o=s.complexTensorInfos.real,l=s.complexTensorInfos.imag,c=[r,i],u=cs.sizeFromShape(c),h=cs.getTypedArrayFromDType("float32",u),d=cs.getTypedArrayFromDType("float32",u);for(let e=0;e<r;e++){let a=vM({inputs:{x:o},backend:n,attrs:{begin:[e,0],size:[1,i]}}),r=vM({inputs:{x:l},backend:n,attrs:{begin:[e,0],size:[1,i]}}),s=bC({inputs:{real:a,imag:r},backend:n}),{real:c,imag:u}=function(e,t,n){var a;let r=cs.sizeFromShape(e.shape),i=n.data.get(e.dataId),s=n.data.get(i.complexTensorInfos.real.dataId).values,o=n.data.get(i.complexTensorInfos.imag.dataId).values;if(((a=r)&a-1)==0){let a=function e(t,n,a,r,i){if(1===a)return{real:t,imag:n};let s=oB.mergeRealAndImagArrays(t,n),o=a/2,l=oB.complexWithEvenIndex(s),c=l.real,u=l.imag,h=[c.length],d=i.makeTensorInfo(h,"float32",c),p=i.makeTensorInfo(h,"float32",u),f=bC({inputs:{real:d,imag:p},backend:i}),m=oB.complexWithOddIndex(s),g=m.real,x=m.imag,y=[g.length],b=i.makeTensorInfo(y,"float32",g),v=i.makeTensorInfo(y,"float32",x),w=bC({inputs:{real:b,imag:v},backend:i}),N=e(c,u,o,r,i),k=N.real,S=N.imag,C=[k.length],T=i.makeTensorInfo(C,"float32",k),I=i.makeTensorInfo(C,"float32",S),E=bC({inputs:{real:T,imag:I},backend:i}),_=e(g,x,o,r,i),A=_.real,R=_.imag,D=[A.length],M=i.makeTensorInfo(D,"float32",A),F=i.makeTensorInfo(D,"float32",R),O=bC({inputs:{real:M,imag:F},backend:i}),P=oB.exponents(a,r),j=[P.real.length],L=i.makeTensorInfo(j,"float32",P.real),z=i.makeTensorInfo(j,"float32",P.imag),B=bC({inputs:{real:L,imag:z},backend:i}),V=vu({inputs:{a:B,b:O},backend:i}),U=bF({inputs:{a:E,b:V},backend:i}),W=vY({inputs:{a:E,b:V},backend:i}),G=bE({inputs:{input:U},backend:i}),H=bE({inputs:{input:W},backend:i}),q=wd({inputs:{input:U},backend:i}),K=wd({inputs:{input:W},backend:i}),X=wp({inputs:[G,H],backend:i,attrs:{axis:0}}),Y=wp({inputs:[q,K],backend:i,attrs:{axis:0}}),Z=i.data.get(X.dataId).values,Q=i.data.get(Y.dataId).values;return i.disposeIntermediateTensorInfo(d),i.disposeIntermediateTensorInfo(p),i.disposeIntermediateTensorInfo(f),i.disposeIntermediateTensorInfo(b),i.disposeIntermediateTensorInfo(v),i.disposeIntermediateTensorInfo(w),i.disposeIntermediateTensorInfo(T),i.disposeIntermediateTensorInfo(I),i.disposeIntermediateTensorInfo(E),i.disposeIntermediateTensorInfo(M),i.disposeIntermediateTensorInfo(F),i.disposeIntermediateTensorInfo(O),i.disposeIntermediateTensorInfo(L),i.disposeIntermediateTensorInfo(z),i.disposeIntermediateTensorInfo(B),i.disposeIntermediateTensorInfo(V),i.disposeIntermediateTensorInfo(U),i.disposeIntermediateTensorInfo(W),i.disposeIntermediateTensorInfo(G),i.disposeIntermediateTensorInfo(q),i.disposeIntermediateTensorInfo(H),i.disposeIntermediateTensorInfo(K),i.disposeIntermediateTensorInfo(X),i.disposeIntermediateTensorInfo(Y),{real:Z,imag:Q}}(s,o,r,t,n),i=[e.shape[0],e.shape[1]];if(t){let e=n.makeTensorInfo(i,"float32",a.real),t=n.makeTensorInfo(i,"float32",a.imag),s=n.makeTensorInfo([],"float32",cs.createScalarValue(r,"float32")),o=bI({inputs:{x:s},backend:n}),l=wE.kernelFunc({inputs:{a:e,b:s},backend:n}),c=wE.kernelFunc({inputs:{a:t,b:o},backend:n}),u=n.data.get(l.dataId).values,h=n.data.get(c.dataId).values;return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(c),{real:u,imag:h}}return a}{let e=function(e,t,n){let a=new Float32Array(2*t);for(let r=0;r<t;r++){let i=0,s=0;for(let a=0;a<t;a++){let o=oB.exponent(r*a,t,n),l=oB.getComplexWithIndex(e,a);i+=l.real*o.real-l.imag*o.imag,s+=l.real*o.imag+l.imag*o.real}n&&(i/=t,s/=t),oB.assignToTypedArray(a,i,s,r)}return a}(oB.mergeRealAndImagArrays(s,o),r,t);return oB.splitRealAndImagArrays(e)}}(s,t,n),p=oB.mergeRealAndImagArrays(c,u);for(let t=0;t<i;t++){let n=oB.getComplexWithIndex(p,t);h[e*i+t]=n.real,d[e*i+t]=n.imag}n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(s)}let p=n.makeTensorInfo(c,"float32",h),f=n.makeTensorInfo(c,"float32",d),m=bC({inputs:{real:p,imag:f},backend:n});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),m}var cs=cs;function wA(e){var t,n;let{backend:a,attrs:r}=e,{shape:i,value:s,dtype:o}=r,l=o||cs.inferDtype(s),c=cs.getArrayFromDType(l,cs.sizeFromShape(i));return t=c,n=s,t.fill(n),a.makeTensorInfo(i,l,c)}var cs=cs,oB=oB,cs=cs,oB=oB,cs=cs,cs=cs;let wR=bB(tE,e=>+!!Number.isFinite(e),"bool"),wD=bB(t_,e=>+(Math.abs(e)===1/0),"bool"),wM=bB(tA,e=>+!!Number.isNaN(e),"bool"),wF=bB(tO,e=>Math.log1p(e)),wO=bR(tP,bS((e,t)=>e&&t),null,"bool"),wP=bB(tj,e=>+!e,"bool"),wj=bR(tL,bS((e,t)=>e||t),null,"bool");var cs=cs,cs=cs,oB=oB,cs=cs;function wL(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{reductionIndices:i,keepDims:s}=a,o=r.shape,l=o.length,c=cs.parseAxisParam(i,o),u=c,h=oB.getAxesPermutation(u,l),d=n.data.get(r.dataId).values;if(null!=h){let e=Array(l);for(let t=0;t<e.length;t++)e[t]=o[h[t]];d=vf(d,o,r.dtype,h,e),u=oB.getInnerMostAxes(u.length,l),o=e}bv(r,"max"),oB.assertAxesAreInnerMostDims("max",u,l);let[p,f]=oB.computeOutAndReduceShapes(o,u),m=vr(d,cs.sizeFromShape(f),p,r.dtype),g=n.write(m,p,r.dtype),x=p;return s&&(x=oB.expandShapeToKeepDim(p,c)),{dataId:g,shape:x,dtype:r.dtype}}var oB=oB,cs=cs,oB=oB,cs=cs,oB=oB,oB=oB,oB=oB,cs=cs,oB=oB,cs=cs,oB=oB,cs=cs,cs=cs;let wz=bR("Mod",bS((e,t)=>{let n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t}));var cs=cs,oB=oB,cs=cs;function wB(e){let{inputs:t,backend:n,attrs:a}=e,{logits:r}=t,{dim:i}=a,s=r.shape.length,o=i;if(-1===o&&(o=s-1),o!==s-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(s," and dim was ").concat(o));let l=cs.parseAxisParam([o],r.shape),c=wL({inputs:{x:r},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),u=oB.expandShapeToKeepDim(c.shape,l),h=v7({inputs:{x:c},backend:n,attrs:{shape:u}}),d=vY({inputs:{a:r,b:h},backend:n}),p=bX({inputs:{x:d},backend:n}),f=wy({inputs:{x:p},backend:n,attrs:{axis:l,keepDims:!1}}),m=v7({inputs:{x:f},backend:n,attrs:{shape:u}}),g=wI({inputs:{a:p,b:m},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}var bb=bb;let wV=bb.nonMaxSuppressionV3Impl;var bb=bb;let wU=bb.nonMaxSuppressionV4Impl;var bb=bb;let wW=bb.nonMaxSuppressionV5Impl;var cs=cs;function wG(e){let{inputs:t,backend:n}=e,{x:a}=t;if("string"===a.dtype)throw Error("zerosLike is not supported for string tensors");if("complex64"!==a.dtype)return wA({backend:n,attrs:{shape:a.shape,value:0,dtype:a.dtype}});{let e=bE({inputs:{input:a},backend:n}),t=wG({inputs:{x:e},backend:n}),r=wd({inputs:{input:a},backend:n}),i=wG({inputs:{x:r},backend:n}),s=bC({inputs:{real:t,imag:i},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),s}}var cs=cs;function wH(e){let{inputs:t,backend:n,attrs:a}=e,{axis:r}=a;if(1===t.length)return wT({inputs:{input:t[0]},backend:n,attrs:{dim:r}});let i=t[0].shape,s=t[0].dtype;t.forEach(e=>{cs.assertShapesMatch(i,e.shape,"All tensors passed to stack must have matching shapes"),cs.assert(s===e.dtype,()=>"All tensors passed to stack must have matching dtypes")});let o=[],l=wp({inputs:t.map(e=>{let t=wT({inputs:{input:e},backend:n,attrs:{dim:r}});return o.push(t),t}),backend:n,attrs:{axis:r}});return o.forEach(e=>n.disposeIntermediateTensorInfo(e)),l}var cs=cs;let wq={kernelName:t4,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{paddings:i,constantValue:s}=a;bv(r,"pad");let o=i.map((e,t)=>e[0]+r.shape[t]+e[1]),l=i.map(e=>e[0]),c=n.data.get(r.dataId).values,u=cs.sizeFromShape(r.shape),h=r.shape.length,d=cs.computeStrides(r.shape),p=cs.sizeFromShape(o),f=o.length,m=cs.computeStrides(o),g=cs.getTypedArrayFromDType(r.dtype,p);0!==s&&g.fill(s);for(let e=0;e<u;e++){let t=cs.indexToLoc(e,h,d).map((e,t)=>e+l[t]);g[cs.locToIndex(t,f,m)]=c[e]}return{dataId:n.write(g,o,r.dtype),shape:o,dtype:r.dtype}}},wK=bR("Pow",bS((e,t)=>Math.pow(e,t))),wX=bB(nn,e=>1/e);var cs=cs,cs=cs,cs=cs,cs=cs,cs=cs,oB=oB,cs=cs;let wY=bB(nh,e=>{let t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2==0?t:t+1});var oB=oB,cs=cs,cs=cs,oB=oB;let wZ=oB.SELU_SCALEALPHA,wQ=oB.SELU_SCALE,wJ=bB(nx,e=>e>=0?wQ*e:wZ*(Math.exp(e)-1)),w$=bB(nv,e=>e<0?-1:+(e>0)),w0=bB("Sin",e=>Math.sin(e)),w1=bB(nb,e=>Math.sinh(e)),w2=Math.log(11920928955078125e-23)+2,w3=bB(nN,e=>{let t=Math.exp(e);return e<w2?t:e>-w2?e:Math.log(1+t)});var oB=oB,cs=cs,oB=oB,cs=cs,oB=oB,cs=cs;let w4=bB(nX,(e,t)=>isNaN(e)?NaN:e>0?1:t.alpha);var vR=sR,cs=cs;let w5=bB("Tan",e=>Math.tan(e)),w6=bB(nz,e=>Math.tanh(e));var oB=oB,cs=cs;function w8(e,t,n){switch(n){case"reflect":var a,r,i,s,o=e,l=t;let c=o;if(c<0)if(l<=1)c=0;else{let e=2*l;c<e&&(c=e*Math.trunc(-c/e)+c),c=c<-l?c+e:-c-1}else if(c>l-1)if(l<=1)c=0;else{let e=2*l;(c-=e*Math.trunc(c/e))>=l&&(c=e-c-1)}return cs.clamp(0,c,l-1);case"wrap":let u;return a=e,r=t,(u=a)<0?r<=1?u=0:u+=r*(Math.trunc(-u/(r-1))+1):u>r-1&&(r<=1?u=0:u-=r*Math.trunc(u/(r-1))),cs.clamp(0,u,r-1);case"nearest":return i=e,s=t,cs.clamp(0,i,s-1);default:return e}}function w9(e,t,n,a,r,i,s,o,l,c,u){return 0<=o&&o<t&&0<=l&&l<n?e[s*a+o*r+l*i+c]:u}var cs=cs;for(let e of[{kernelName:nQ,backendName:"cpu",kernelFunc:function(e){let t,n,a,{inputs:r,backend:i,attrs:s}=e,{a:o,b:l,bias:c,preluActivationWeights:u}=r,{transposeA:h,transposeB:d,activation:p,leakyreluAlpha:f}=s,m=[];for(let e of(t=we({inputs:{a:o,b:l},attrs:{transposeA:h,transposeB:d},backend:i}),c&&(n=bF({inputs:{a:t,b:c},backend:i}),m.push(t),t=n),p&&(a=v8(i,t,p,u,f),m.push(t),t=a),m))i.disposeIntermediateTensorInfo(e);return t}},{kernelName:"Abs",backendName:"cpu",kernelFunc:e=>{let{x:t}=e.inputs,n=e.backend;bv(t,"abs");let a=new Float32Array(cs.sizeFromShape(t.shape));return a=bk(n.data.get(t.dataId).values),n.makeOutput(a,t.shape,t.dtype)}},{kernelName:e_,backendName:"cpu",kernelFunc:wt},{kernelName:eA,backendName:"cpu",kernelFunc:wn},{kernelName:"Add",backendName:"cpu",kernelFunc:bF},{kernelName:eR,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e;bv(t,"addN");let a=t.map(e=>n.data.get(e.dataId).values),r=rD(t[0].shape,t[0].dtype),i=r.values;for(let e=0;e<t.length;e++){let t=a[e];for(let e=0;e<i.length;e++)i[e]+=t[e]}return n.makeTensorInfo(r.shape,r.dtype,r.values)}},{kernelName:"All",backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:i,keepDims:s}=a;bv(r,"all");let o=cs.parseAxisParam(i,r.shape),l=o,c=oB.getAxesPermutation(l,r.shape.length),u=r;null!=c&&(u=vm({inputs:{x:r},backend:n,attrs:{perm:c}}),l=oB.getInnerMostAxes(l.length,r.shape.length)),oB.assertAxesAreInnerMostDims("all",l,u.shape.length);let[h,d]=oB.computeOutAndReduceShapes(u.shape,l),p=cs.sizeFromShape(d),f=cs.makeZerosTypedArray(cs.sizeFromShape(h),u.dtype),m=n.data.get(u.dataId).values;for(let e=0;e<f.length;++e){let t=e*p,n=m[t];for(let e=0;e<p;++e){let a=m[t+e];n=n&&a}f[e]=n}null!=c&&n.disposeIntermediateTensorInfo(u);let g=n.makeTensorInfo(h,u.dtype,f);if(s){let e=v7({inputs:{x:g},backend:n,attrs:{shape:oB.expandShapeToKeepDim(h,o)}});return n.disposeIntermediateTensorInfo(g),e}return g}},{kernelName:"Any",backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:i,keepDims:s}=a;bv(r,"any");let o=cs.parseAxisParam(i,r.shape),l=o,c=oB.getAxesPermutation(l,r.shape.length),u=r;null!=c&&(u=vm({inputs:{x:r},backend:n,attrs:{perm:c}}),l=oB.getInnerMostAxes(l.length,r.shape.length)),oB.assertAxesAreInnerMostDims("any",l,u.shape.length);let[h,d]=oB.computeOutAndReduceShapes(u.shape,l),p=cs.sizeFromShape(d),f=cs.makeZerosTypedArray(cs.sizeFromShape(h),u.dtype),m=n.data.get(u.dataId).values;for(let e=0;e<f.length;++e){let t=e*p,n=m[t];for(let e=0;e<p;++e){let a=m[t+e];n=n||a}f[e]=n}null!=c&&n.disposeIntermediateTensorInfo(u);let g=n.makeTensorInfo(h,u.dtype,f);if(s){let e=v7({inputs:{x:g},backend:n,attrs:{shape:oB.expandShapeToKeepDim(h,o)}});return n.disposeIntermediateTensorInfo(g),e}return g}},{kernelName:eD,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:i}=a;bv(r,"argMax");let s=cs.parseAxisParam(i,r.shape),o=oB.getAxesPermutation(s,r.shape.length),l=r,c=[];null!=o&&(c.push(l=vm({inputs:{x:r},backend:n,attrs:{perm:o}})),s=oB.getInnerMostAxes(s.length,l.shape.length)),s=[s[0]],oB.assertAxesAreInnerMostDims("argMax",s,l.shape.length);let[u,h]=oB.computeOutAndReduceShapes(l.shape,s),d=cs.sizeFromShape(u),p=cs.makeZerosTypedArray(d,"int32"),f=cs.sizeFromShape(h),m=n.data.get(l.dataId).values;for(let e=0;e<p.length;++e){let t=e*f,n=m[t],a=0;for(let e=0;e<f;++e){let r=m[t+e];r>n&&(n=r,a=e)}p[e]=a}return c.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.makeTensorInfo(u,"int32",p)}},{kernelName:eM,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:i}=a;bv(r,"argMin");let s=cs.parseAxisParam(i,r.shape),o=oB.getAxesPermutation(s,r.shape.length),l=r,c=[];null!=o&&(c.push(l=vm({inputs:{x:r},backend:n,attrs:{perm:o}})),s=oB.getInnerMostAxes(s.length,l.shape.length)),s=[s[0]],oB.assertAxesAreInnerMostDims("argMin",s,l.shape.length);let[u,h]=oB.computeOutAndReduceShapes(l.shape,s),d=cs.sizeFromShape(u),p=cs.makeZerosTypedArray(d,"int32"),f=cs.sizeFromShape(h),m=n.data.get(l.dataId).values;for(let e=0;e<p.length;++e){let t=e*f,n=m[t],a=0;for(let e=0;e<f;++e){let r=m[t+e];r<n&&(n=r,a=e)}p[e]=a}return c.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.makeTensorInfo(u,"int32",p)}},{kernelName:eF,backendName:"cpu",kernelFunc:wa},{kernelName:eO,backendName:"cpu",kernelFunc:wr},{kernelName:eP,backendName:"cpu",kernelFunc:wi},{kernelName:eL,backendName:"cpu",kernelFunc:ws},{kernelName:ej,backendName:"cpu",kernelFunc:wo},{kernelName:ez,backendName:"cpu",kernelFunc:function(e){let t,{inputs:n,backend:a,attrs:r}=e,{x:i}=n;bv(i,"avgPool");let{filterSize:s,strides:o,pad:l,dimRoundingMode:c}=r;cs.assert(oB.eitherStridesOrDilationsAreOne(o,1),()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'"));let u=oB.computePool2DInfo(i.shape,s,o,1,l,c);if(1===u.filterWidth&&1===u.filterHeight&&cs.arraysEqual(u.inShape,u.outShape))t=bI({inputs:{x:i},backend:a});else{let e=a.data.get(i.dataId).values,n=cs.computeStrides(i.shape),r=wl(e,i.shape,i.dtype,n,u,"avg");t=a.makeTensorInfo(u.outShape,i.dtype,r.values)}return t}},{kernelName:eV,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:l,dataFormat:c}=a;bv(r,"avgPool3d");let u=oB.computePool3DInfo(r.shape,i,s,1,o,l,c),h=wu(n.data.get(r.dataId).values,r.shape,r.dtype,cs.computeStrides(r.shape),u,"avg");return n.makeTensorInfo(h.shape,"float32",h.values)}},{kernelName:eU,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,input:i}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:c}=a;bv([r,i],"avgPool3DGrad");let u=oB.computePool3DInfo(i.shape,s,o,1,l,c),h=u.strideDepth,d=u.strideHeight,p=u.strideWidth,f=u.filterDepth,m=u.filterHeight,g=u.filterWidth,x=u.dilationDepth,y=u.dilationHeight,b=u.dilationWidth,v=u.effectiveFilterDepth,w=u.effectiveFilterHeight,N=u.effectiveFilterWidth,k=v-1-u.padInfo.front,S=N-1-u.padInfo.left,C=w-1-u.padInfo.top,T=rD(i.shape,"float32"),I=1/(f*m*g),E=n.bufferSync(r);for(let e=0;e<u.batchSize;++e)for(let t=0;t<u.inChannels;++t)for(let n=0;n<u.inDepth;++n)for(let a=0;a<u.inHeight;++a)for(let r=0;r<u.inWidth;++r){let i=n-k,s=a-C,o=r-S,l=0;for(let n=0;n<v;n+=x){let a=(i+n)/h;if(!(a<0)&&!(a>=u.outDepth)&&Math.floor(a)===a)for(let n=0;n<w;n+=y){let r=(s+n)/d;if(!(r<0)&&!(r>=u.outHeight)&&Math.floor(r)===r)for(let n=0;n<N;n+=b){let i=(o+n)/p;i<0||i>=u.outWidth||Math.floor(i)!==i||(l+=E.get(e,a,r,i,t))}}}T.set(l*I,e,n,a,r,t)}return n.makeTensorInfo(T.shape,T.dtype,T.values)}},{kernelName:eB,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,input:i}=t;bv([r,i],"avgPoolGrad");let{filterSize:s,strides:o,pad:l}=a,c=oB.computePool2DInfo(i.shape,s,o,1,l),u=c.strideHeight,h=c.strideWidth,d=c.filterHeight,p=c.filterWidth,f=c.dilationHeight,m=c.dilationWidth,g=c.effectiveFilterHeight,x=c.effectiveFilterWidth,y=x-1-c.padInfo.left,b=g-1-c.padInfo.top,v=rD(i.shape,"float32"),w=1/(d*p),N=n.data.get(r.dataId).values,k=rD(r.shape,"float32",N);for(let e=0;e<c.batchSize;++e)for(let t=0;t<c.inChannels;++t)for(let n=0;n<c.inHeight;++n)for(let a=0;a<c.inWidth;++a){let r=n-b,i=a-y,s=0;for(let n=0;n<g;n+=f){let a=(r+n)/u;if(!(a<0)&&!(a>=c.outHeight)&&Math.floor(a)===a)for(let n=0;n<x;n+=m){let r=(i+n)/h;r<0||r>=c.outWidth||Math.floor(r)!==r||(s+=k.get(e,a,r,t))}}v.set(s*w,e,n,a,t)}return n.makeTensorInfo(v.shape,v.dtype,v.values)}},{kernelName:eW,backendName:"cpu",kernelFunc:we},{kernelName:tv,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,scale:i,offset:s,mean:o,variance:l}=t;cs.assert(o.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),cs.assert(null==s||o.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),cs.assert(null==i||o.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),bv([r,o,l,i,s],"batchNorm");let{varianceEpsilon:c}=a;null==c&&(c=.001);let u=n.data.get(r.dataId).values,h=n.data.get(o.dataId).values,d=n.data.get(l.dataId).values,p=i?n.data.get(i.dataId).values:new Float32Array([1]),f=s?n.data.get(s.dataId).values:new Float32Array([0]),m=new Float32Array(u.length),g=f.length,x=p.length,y=d.length,b=h.length,v=0,w=0,N=0,k=0;for(let e=0;e<u.length;++e)m[e]=f[v++]+(u[e]-h[w++])*p[N++]/Math.sqrt(d[k++]+c),v>=g&&(v=0),w>=b&&(w=0),N>=x&&(N=0),k>=y&&(k=0);return n.makeTensorInfo(r.shape,r.dtype,m)}},{kernelName:eG,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{blockShape:i,crops:s}=a;bv([r],"batchToSpaceND");let o=i.reduce((e,t)=>e*t),l=oB.getReshaped(r.shape,i,o),c=oB.getPermuted(l.length,i.length),u=oB.getReshapedPermuted(r.shape,i,o),h=oB.getSliceBeginCoords(s,i.length),d=oB.getSliceSize(u,s,i.length),p=v7({inputs:{x:r},backend:n,attrs:{shape:l}}),f=vm({inputs:{x:p},backend:n,attrs:{perm:c}}),m=v7({inputs:{x:f},backend:n,attrs:{shape:u}}),g=vM({inputs:{x:m},backend:n,attrs:{begin:h,size:d}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}},{kernelName:eH,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,weights:i}=t,{size:s}=a,o=bO(n.data.get(r.dataId).values,n.data.get(i.dataId).values,i.dtype,i.shape,s);return n.makeTensorInfo([s],i.dtype,o)}},{kernelName:eq,backendName:"cpu",kernelFunc:bL},{kernelName:eK,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{s0:a,s1:r}=t,i=n.data.get(a.dataId).values,s=n.data.get(r.dataId).values,o=oB.assertAndGetBroadcastShape(Array.from(i),Array.from(s));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}},{kernelName:eX,backendName:"cpu",kernelFunc:bA},{kernelName:eY,backendName:"cpu",kernelFunc:bW},{kernelName:eZ,backendName:"cpu",kernelFunc:wh},{kernelName:eQ,backendName:"cpu",kernelFunc:bC},{kernelName:eJ,backendName:"cpu",kernelFunc:e=>{let{x:t}=e.inputs,n=e.backend,a=new Float32Array(cs.sizeFromShape(t.shape)),r=n.data.get(t.dataId),i=r.complexTensorInfos.real,s=r.complexTensorInfos.imag,o=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values;for(let e=0;e<o.length;e++){let t=o[e],n=l[e];a[e]=Math.hypot(t,n)}return n.makeOutput(a,t.shape,"float32")}},{kernelName:e$,backendName:"cpu",kernelFunc:wp},{kernelName:e0,backendName:"cpu",kernelFunc:wf},{kernelName:e1,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,dy:i}=t,{strides:s,pad:o,dataFormat:l,dimRoundingMode:c,filterShape:u}=a;bv([r,i],"conv2dBackpropFilter");let h=oB.convertConv2DDataFormat(l),d=oB.computeConv2DInfo(r.shape,u,s,1,o,c,!1,h),{strideHeight:p,strideWidth:f,filterHeight:m,filterWidth:g}=d,x="channelsLast"===d.dataFormat,y=new ad(d.filterShape,"float32"),b=d.padInfo.left,v=d.padInfo.top,w=n.data.get(r.dataId).values,N=n.data.get(i.dataId).values,k=new ad(r.shape,r.dtype,w),S=new ad(i.shape,i.dtype,N);for(let e=0;e<m;++e){let t=Math.max(0,Math.ceil((v-e)/p)),n=Math.min(d.outHeight,(d.inHeight+v-e)/p);for(let a=0;a<g;++a){let r=Math.max(0,Math.ceil((b-a)/f)),i=Math.min(d.outWidth,(d.inWidth+b-a)/f);for(let s=0;s<d.inChannels;++s)for(let o=0;o<d.outChannels;++o){let l=0;for(let c=0;c<d.batchSize;++c)for(let u=t;u<n;++u){let t=e+u*p-v;for(let e=r;e<i;++e){let n=a+e*f-b;x?l+=k.get(c,t,n,s)*S.get(c,u,e,o):l+=k.get(c,s,t,n)*S.get(c,o,u,e)}}y.set(l,e,a,s,o)}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}},{kernelName:e2,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,filter:i}=t,{inputShape:s,strides:o,pad:l,dataFormat:c,dimRoundingMode:u}=a;bv([r,i],"conv2dBackpropInput");let h=cs.computeStrides(i.shape),d=cs.computeStrides(r.shape),p=oB.convertConv2DDataFormat(c),f=oB.computeConv2DInfo(s,i.shape,o,1,l,u,!1,p),m=new ad(f.inShape,"float32"),g=m.values,x=n.data.get(r.dataId).values,y=n.data.get(i.dataId).values,[b,v,w]=h,{batchSize:N,filterHeight:k,filterWidth:S,inChannels:C,inHeight:T,inWidth:I,outChannels:E,outHeight:_,outWidth:A,strideHeight:R,strideWidth:D}=f;p=f.dataFormat;let M=k-1-f.padInfo.top,F=S-1-f.padInfo.left,O="channelsLast"===p,P=m.strides[0],j=O?m.strides[1]:m.strides[2],L=O?m.strides[2]:1,z=O?1:m.strides[1],B=d[0],V=O?d[1]:d[2],U=O?d[2]:1,W=O?1:d[1];for(let e=0;e<N;++e)for(let t=0;t<C;++t)for(let n=0;n<T;++n){let a=n-M,r=Math.max(0,Math.ceil(a/R)),i=Math.min(_,(k+a)/R);for(let s=0;s<I;++s){let o=s-F,l=Math.max(0,Math.ceil(o/D)),c=Math.min(A,(S+o)/D),u=0;for(let n=r;n<i;++n){let r=n*R-a;for(let a=l;a<c;++a){let i=a*D-o,s=B*e+V*n+U*a,l=b*(k-1-r)+v*(S-1-i)+w*t;for(let e=0;e<E;++e)u+=x[s+W*e]*y[l+e]}}g[P*e+j*n+L*s+z*t]=u}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}},{kernelName:e3,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:i}=t,{strides:s,pad:o,dilations:l}=a;bv([r,i],"conv3d");let c=oB.computeConv3DInfo(r.shape,i.shape,s,l,o),{filterDepth:u,filterHeight:h,filterWidth:d,dilationDepth:p,dilationHeight:f,dilationWidth:m,padInfo:g}=c,x=g.front,y=g.left,b=g.top,v=new ad(c.outShape,r.dtype),w=n.data.get(r.dataId).values,N=n.data.get(i.dataId).values,k=v.values,S=cs.computeStrides(r.shape),C=cs.computeStrides(i.shape);for(let e=0;e<c.batchSize;++e){let t=e*S[0],n=e*v.strides[0];for(let e=0;e<c.outDepth;++e){let a=n+e*v.strides[1],r=e*c.strideDepth-x;for(let e=0;e<u;++e){let n=r+e*p;if(n<0||n>=c.inDepth)continue;let i=e*C[0],s=t+n*S[1];for(let e=0;e<c.outHeight;++e){let t=a+e*v.strides[2],n=e*c.strideHeight-b;for(let e=0;e<h;++e){let a=n+e*f;if(a<0||a>=c.inHeight)continue;let r=i+e*C[1],o=s+a*S[2];for(let e=0;e<c.outWidth;++e){let n=t+e*c.outChannels,a=e*c.strideWidth-y;for(let e=0;e<d;++e){let t=a+e*m;if(t<0||t>=c.inWidth)continue;let i=r+e*C[2],s=o+t*c.inChannels,l=i;for(let e=0;e<c.inChannels;++e){let t=w[s+e];for(let e=0;e<c.outChannels;++e)k[n+e]+=t*N[l+e];l+=c.outChannels}}}}}}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}},{kernelName:e4,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,dy:i}=t,{strides:s,pad:o,filterShape:l}=a;bv([r,i],"conv3dBackpropFilterV2");let c=cs.computeStrides(r.shape),u=cs.computeStrides(i.shape),h=oB.computeConv3DInfo(r.shape,l,s,1,o),d=h.strideDepth,p=h.strideHeight,f=h.strideWidth,m=h.filterDepth,g=h.filterHeight,x=h.filterWidth,y=new ad(h.filterShape,"float32"),b=y.values,[v,w,N,k]=y.strides,S=n.data.get(i.dataId).values,[C,T,I,E]=u,_=n.data.get(r.dataId).values,[A,R,D,M]=c,F=h.padInfo.front,O=h.padInfo.left,P=h.padInfo.top;for(let e=0;e<m;++e){let t=Math.max(0,Math.ceil((F-e)/d)),n=Math.min(h.outDepth,(h.inDepth+F-e)/d),a=e*v;for(let r=0;r<g;++r){let i=Math.max(0,Math.ceil((P-r)/p)),s=Math.min(h.outHeight,(h.inHeight+P-r)/p),o=r*w+a;for(let a=0;a<x;++a){let l=Math.max(0,Math.ceil((O-a)/f)),c=Math.min(h.outWidth,(h.inWidth+O-a)/f),u=a*N+o;for(let o=0;o<h.inChannels;++o){let m=o*k+u;for(let u=0;u<h.outChannels;++u){let g=0;for(let m=0;m<h.batchSize;++m){let h=m*A,x=m*C;for(let m=t;m<n;++m){let t=(e+m*d-F)*R+h,n=m*T+x;for(let e=i;e<s;++e){let i=(r+e*p-P)*D+t,s=e*I+n;for(let e=l;e<c;++e){let t=(a+e*f-O)*M+i,n=e*E+s;g+=_[t+o]*S[n+u]}}}}b[m+u]=g}}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}},{kernelName:e5,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,filter:i}=t,{pad:s,strides:o,inputShape:l}=a;bv([r],"conv3dBackpropInputV2");let c=cs.computeStrides(r.shape),u=cs.computeStrides(i.shape),h=oB.computeConv3DInfo(l,i.shape,o,1,s),d=new ad(h.inShape,"float32"),p=d.values,[f,m,g,x]=d.strides,y=n.data.get(r.dataId).values,[b,v,w,N]=c,k=n.data.get(i.dataId).values,[S,C,T,I]=u,{batchSize:E,filterDepth:_,filterHeight:A,filterWidth:R,inChannels:D,inDepth:M,inHeight:F,inWidth:O,outChannels:P,outDepth:j,outHeight:L,outWidth:z,strideDepth:B,strideHeight:V,strideWidth:U}=h,W=_-1-h.padInfo.front,G=A-1-h.padInfo.top,H=R-1-h.padInfo.left;for(let e=0;e<E;++e)for(let t=0;t<D;++t)for(let n=0;n<M;++n){let a=n-W,r=Math.max(0,Math.ceil(a/B)),i=Math.min(j,(_+a)/B);for(let s=0;s<F;++s){let o=s-G,l=Math.max(0,Math.ceil(o/V)),c=Math.min(L,(A+o)/V);for(let u=0;u<O;++u){let h=u-H,d=Math.max(0,Math.ceil(h/U)),E=Math.min(z,(R+h)/U),D=0;for(let n=r;n<i;++n){let r=n*B-a;for(let a=l;a<c;++a){let i=a*V-o;for(let s=d;s<E;++s){let o=s*U-h,l=b*e+v*n+w*a+N*s,c=S*(_-1-r)+C*(A-1-i)+T*(R-1-o)+I*t;for(let e=0;e<P;++e)D+=y[l+e]*k[c+e]}}}p[f*e+m*n+g*s+x*u+t]=D}}}return n.makeTensorInfo(d.shape,d.dtype,d.values)}},{kernelName:"Cos",backendName:"cpu",kernelFunc:wm},{kernelName:e6,backendName:"cpu",kernelFunc:wg},{kernelName:e7,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{image:r,boxes:i,boxInd:s}=t,{cropSize:o,method:l,extrapolationValue:c}=a,[u,h,d,p]=r.shape,f=i.shape[0],[m,g]=o,x=rD([f,m,g,p],"float32"),y=n.data.get(i.dataId).values,b=n.data.get(s.dataId).values,v=n.data.get(r.dataId).values,w=cs.computeStrides(r.shape),N=cs.computeStrides(x.shape);for(let e=0;e<f;e++){let t=4*e,n=y[t],a=y[t+1],r=y[t+2],i=y[t+3],s=b[e];if(s>=u)continue;let o=m>1?(r-n)*(h-1)/(m-1):0,f=g>1?(i-a)*(d-1)/(g-1):0;for(let t=0;t<m;t++){let u=m>1?n*(h-1)+t*o:.5*(n+r)*(h-1);if(u<0||u>h-1){for(let n=0;n<g;n++)for(let a=0;a<p;a++){let r=a+n*N[2]+t*N[1]+e*N[0];x.values[r]=c}continue}if("bilinear"===l){let n=Math.floor(u),r=Math.ceil(u),o=u-n;for(let l=0;l<g;l++){let u=g>1?a*(d-1)+l*f:.5*(a+i)*(d-1);if(u<0||u>d-1){for(let n=0;n<p;n++){let a=n+l*N[2]+t*N[1]+e*N[0];x.values[a]=c}continue}let h=Math.floor(u),m=Math.ceil(u),y=u-h;for(let a=0;a<p;a++){let i=a+h*w[2]+n*w[1]+s*w[0],c=v[i],u=v[i=a+m*w[2]+n*w[1]+s*w[0]],d=v[i=a+h*w[2]+r*w[1]+s*w[0]],p=v[i=a+m*w[2]+r*w[1]+s*w[0]],f=c+(u-c)*y,g=d+(p-d)*y;i=a+l*N[2]+t*N[1]+e*N[0],x.values[i]=f+(g-f)*o}}}else for(let n=0;n<g;++n){let r=g>1?a*(d-1)+n*f:.5*(a+i)*(d-1);if(r<0||r>d-1){for(let a=0;a<p;a++){let r=a+n*N[2]+t*N[1]+e*N[0];x.values[r]=c}continue}let o=Math.round(r),l=Math.round(u);for(let a=0;a<p;a++){let r=a+o*w[2]+l*w[1]+s*w[0],i=a+n*N[2]+t*N[1]+e*N[0];x.values[i]=v[r]}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}},{kernelName:e8,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:i,exclusive:s,reverse:o}=a;bv(r,"cumprod");let l=oB.getAxesPermutation([i],r.shape.length),c=r;null!=l&&(c=vm({inputs:{x:r},backend:n,attrs:{perm:l}}));let u=oB.getInnerMostAxes(1,r.shape.length)[0];if(u!==c.shape.length-1)throw Error("backend.cumprod in CPU expects an inner-most "+"axis=".concat(c.shape.length-1," but got axis=").concat(u));let h=ab(c.dtype,"int32"),d=cs.makeOnesTypedArray(cs.sizeFromShape(c.shape),h),p=n.data.get(c.dataId).values,f=c.shape[c.shape.length-1],m=o?(e,t)=>e+f-t-1:(e,t)=>e+t;for(let e=0;e<p.length;e+=f)for(let t=0;t<f;t++){let n=m(e,t);if(0===t)d[n]=s?1:p[n];else{let a=m(e,t-1);d[n]=s?p[a]*d[a]:p[n]*d[a]}}let g=n.makeTensorInfo(c.shape,h,d);if(null!=l){let e=vm({inputs:{x:g},backend:n,attrs:{perm:oB.getUndoAxesPermutation(l)}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(c),e}return g}},{kernelName:e9,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:i,exclusive:s,reverse:o}=a;bv(r,"cumsum");let l=oB.getAxesPermutation([i],r.shape.length),c=r;null!=l&&(c=vm({inputs:{x:r},backend:n,attrs:{perm:l}}));let u=oB.getInnerMostAxes(1,r.shape.length)[0];if(u!==c.shape.length-1)throw Error("backend.cumsum in CPU expects an inner-most "+"axis=".concat(c.shape.length-1," but got axis=").concat(u));let h=ab(c.dtype,"int32"),d=cs.makeZerosTypedArray(cs.sizeFromShape(c.shape),h),p=n.data.get(c.dataId).values,f=c.shape[c.shape.length-1],m=o?(e,t)=>e+f-t-1:(e,t)=>e+t;for(let e=0;e<p.length;e+=f)for(let t=0;t<f;t++){let n=m(e,t);if(0===t)d[n]=s?0:p[n];else{let a=m(e,t-1);d[n]=s?p[a]+d[a]:p[n]+d[a]}}let g=n.makeTensorInfo(c.shape,h,d);if(null!=l){let e=vm({inputs:{x:g},backend:n,attrs:{perm:oB.getUndoAxesPermutation(l)}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(c),e}return g}},{kernelName:te,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,weights:i}=t,{size:s,binaryOutput:o}=a;if(1===r.shape.length){let e=bO(n.data.get(r.dataId).values,n.data.get(i.dataId).values,i.dtype,i.shape,s);return n.makeTensorInfo([s],i.dtype,e)}if(2===r.shape.length){let e=bP(n.bufferSync(r),n.bufferSync(i),s,o);return n.makeTensorInfo(e.shape,i.dtype,e.values)}throw Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(r.shape.length,"."))}},{kernelName:tt,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{blockSize:i,dataFormat:s}=a;cs.assert("NHWC"===s,()=>"Only NHWC dataFormat supported on CPU for depthToSpace. Got ".concat(s));let o=r.shape[0],l=r.shape[1],c=r.shape[2],u=r.shape[3],h=l*i,d=c*i,p=u/(i*i),f=n.data.get(r.dataId).values,m=new Float32Array(o*h*d*p),g=0;for(let e=0;e<o;++e)for(let t=0;t<h;++t){let n=Math.floor(t/i),a=t%i;for(let t=0;t<d;++t){let r=Math.floor(t/i),s=t%i,o=(a*i+s)*p;for(let t=0;t<p;++t){let a=t+o+u*(r+c*(n+l*e));m[g++]=f[a]}}}return n.makeTensorInfo([o,h,d,p],r.dtype,m)}},{kernelName:tn,backendName:"cpu",kernelFunc:wx},{kernelName:ta,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,dy:i}=t,{strides:s,dilations:o,pad:l,dimRoundingMode:c,filterShape:u}=a;bv([r,i],"depthwiseConv2dNativeBackpropFilter");let h=oB.computeConv2DInfo(r.shape,u,s,o,l,c,!0),{strideHeight:d,strideWidth:p,filterHeight:f,filterWidth:m}=h,g=new ad(h.filterShape,"float32"),x=h.padInfo.left,y=h.padInfo.top,b=h.outChannels/h.inChannels,v=n.data.get(r.dataId).values,w=new ad(r.shape,r.dtype,v),N=n.data.get(i.dataId).values,k=new ad(i.shape,i.dtype,N);for(let e=0;e<f;++e){let t=Math.max(0,Math.ceil((y-e)/d)),n=Math.min(h.outHeight,(h.inHeight+y-e)/d);for(let a=0;a<m;++a){let r=Math.max(0,Math.ceil((x-a)/p)),i=Math.min(h.outWidth,(h.inWidth+x-a)/p);for(let s=0;s<h.outChannels;++s){let o=Math.trunc(s/b),l=s%b,c=0;for(let l=0;l<h.batchSize;++l)for(let u=t;u<n;++u){let t=e+u*d-y;for(let e=r;e<i;++e){let n=a+e*p-x;c+=w.get(l,t,n,o)*k.get(l,u,e,s)}}g.set(c,e,a,o,l)}}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}},{kernelName:tr,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,filter:i}=t,{strides:s,dilations:o,pad:l,dimRoundingMode:c,inputShape:u}=a;bv([r,i],"depthwiseConv2DNativeBackpropInput");let h=cs.computeStrides(r.shape),d=cs.computeStrides(i.shape),p=oB.computeConv2DInfo(u,i.shape,s,o,l,c,!0),f=new ad(p.inShape,"float32"),m=f.values,[g,x,y]=f.strides,b=n.data.get(r.dataId).values,[v,w,N]=h,k=n.data.get(i.dataId).values,[S,C,T]=d,{batchSize:I,filterHeight:E,filterWidth:_,inChannels:A,inHeight:R,inWidth:D,outChannels:M,outHeight:F,outWidth:O,strideHeight:P,strideWidth:j}=p,L=E-1-p.padInfo.top,z=_-1-p.padInfo.left,B=M/A;for(let e=0;e<I;++e)for(let t=0;t<A;++t)for(let n=0;n<R;++n){let a=n-L,r=Math.max(0,Math.ceil(a/P)),i=Math.min(F,(E+a)/P);for(let s=0;s<D;++s){let o=s-z,l=Math.max(0,Math.ceil(o/j)),c=Math.min(O,(_+o)/j),u=0;for(let n=r;n<i;++n){let r=n*P-a;for(let a=l;a<c;++a){let i=a*j-o,s=v*e+w*n+N*a,l=S*(E-1-r)+C*(_-1-i)+T*t;for(let e=0;e<B;++e)u+=b[s+(t*B+e)]*k[l+e]}}m[g*e+x*n+y*s+t]=u}}return n.makeTensorInfo(f.shape,f.dtype,f.values)}},{kernelName:ti,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{x:a}=t,r=cs.sizeFromShape(a.shape),i=n.data.get(a.dataId).values,s=rD([r,r],a.dtype),o=s.values;for(let e=0;e<i.length;e++)o[e*r+e]=i[e];let l=[...a.shape,...a.shape];return n.makeTensorInfo(l,s.dtype,s.values)}},{kernelName:ts,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:i}=t,{strides:s,pad:o,dilations:l}=a,c=n.data.get(r.dataId).values,u=r.shape.length,h=n.data.get(i.dataId).values,d=i.shape.length,{batchSize:p,inHeight:f,inWidth:m,inChannels:g,outHeight:x,outWidth:y,padInfo:b,strideHeight:v,strideWidth:w,filterHeight:N,filterWidth:k,dilationHeight:S,dilationWidth:C,outShape:T}=oB.computeDilation2DInfo(r.shape,i.shape,s,o,"NHWC",l),I=cs.sizeFromShape(T),E=T.length,_=cs.getArrayFromDType(r.dtype,I);for(let e=0;e<p;++e)for(let t=0;t<x;++t){let n=t*v-b.top;for(let a=0;a<y;++a){let s=a*w-b.left;for(let o=0;o<g;++o){let l=Number.MIN_SAFE_INTEGER;for(let t=0;t<N;++t){let a=n+t*S;if(a>=0&&a<f)for(let n=0;n<k;++n){let p=s+n*C;if(p>=0&&p<m){let s=cs.locToIndex([e,a,p,o],u,cs.computeStrides(r.shape)),f=cs.locToIndex([t,n,o],d,cs.computeStrides(i.shape)),m=c[s]+h[f];m>l&&(l=m)}}}_[cs.locToIndex([e,t,a,o],E,cs.computeStrides(T))]=l}}}return{dataId:n.write(cs.toTypedArray(_,r.dtype),T,r.dtype),shape:T,dtype:r.dtype}}},{kernelName:tl,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:i,dy:s}=t,{strides:o,pad:l,dilations:c}=a,u=cs.toNestedArray(r.shape,n.data.get(r.dataId).values),h=cs.toNestedArray(i.shape,n.data.get(i.dataId).values),{batchSize:d,inHeight:p,inWidth:f,inChannels:m,outHeight:g,outWidth:x,padInfo:y,strideHeight:b,strideWidth:v,filterHeight:w,filterWidth:N,dilationHeight:k,dilationWidth:S,outShape:C}=oB.computeDilation2DInfo(r.shape,i.shape,o,l,"NHWC",c);cs.assert(s.rank===C.length,()=>"Error in ".concat(tl,", dy ")+"must have the same rank as output ".concat(C.length,", but got ")+"".concat(s.rank));let T=cs.toNestedArray(C,n.data.get(s.dataId).values),I=cs.makeZerosNestedTypedArray(i.shape,i.dtype);for(let e=0;e<d;++e)for(let t=0;t<g;++t){let n=t*b-y.top;for(let a=0;a<x;++a){let r=a*v-y.left;for(let i=0;i<m;++i){let s=Number.MIN_SAFE_INTEGER,o=0,l=0;for(let t=0;t<w;++t){let a=n+t*k;if(a>=0&&a<p)for(let n=0;n<N;++n){let c=r+n*S;if(c>=0&&c<f){let r=u[e][a][c][i]+h[t][n][i];r>s&&(s=r,o=t,l=n)}}}I[o][l][i]+=T[e][t][a][i]}}}return{dataId:n.write(cs.toTypedArray(I,r.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}},{kernelName:to,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:i,dy:s}=t,{strides:o,pad:l,dilations:c}=a,u=cs.toNestedArray(r.shape,n.data.get(r.dataId).values),h=cs.toNestedArray(i.shape,n.data.get(i.dataId).values),{batchSize:d,inHeight:p,inWidth:f,inChannels:m,outHeight:g,outWidth:x,padInfo:y,strideHeight:b,strideWidth:v,filterHeight:w,filterWidth:N,dilationHeight:k,dilationWidth:S,outShape:C}=oB.computeDilation2DInfo(r.shape,i.shape,o,l,"NHWC",c);cs.assert(s.rank===C.length,()=>"Error in ".concat(to,", dy ")+"must have the same rank as output ".concat(C.length,", but got ")+"".concat(s.rank));let T=cs.toNestedArray(C,n.data.get(s.dataId).values),I=cs.makeZerosNestedTypedArray(r.shape,r.dtype);for(let e=0;e<d;++e)for(let t=0;t<g;++t){let n=t*b-y.top;for(let a=0;a<x;++a){let r=a*v-y.left;for(let i=0;i<m;++i){let s=Number.MIN_SAFE_INTEGER,o=n<0?0:n,l=r<0?0:r;for(let t=0;t<w;++t){let a=n+t*k;if(a>=0&&a<p)for(let n=0;n<N;++n){let c=r+n*S;if(c>=0&&c<f){let r=u[e][a][c][i]+h[t][n][i];r>s&&(s=r,o=a,l=c)}}}I[e][o][l][i]+=T[e][t][a][i]}}}return{dataId:n.write(cs.toTypedArray(I,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:tc,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{image:r}=t,{canvas:i,options:s}=a,{contextOptions:o,imageOptions:l}=s||{},c=(null==l?void 0:l.alpha)||1,u=(null==o?void 0:o.contextType)||"2d";if("2d"!==u)throw Error("Context type ".concat(o.contextType," is not supported by the CPU backend."));let h=i.getContext(u,(null==o?void 0:o.contextAttributes)||{});if(null==h)throw Error("Could not get the context with ".concat(u," type."));let[d,p]=r.shape.slice(0,2),f=2===r.shape.length?1:r.shape[2],m=n.data.get(r.dataId).values,g="float32"===r.dtype?255:1,x=new Uint8ClampedArray(p*d*4);for(let e=0;e<d*p;++e){let t=[0,0,0,255*c];for(let n=0;n<f;n++){let a=m[e*f+n];if("float32"===r.dtype){if(a<0||a>1)throw Error("Tensor values for a float32 Tensor must be in the "+"range [0 - 1] but encountered ".concat(a,"."))}else if("int32"===r.dtype&&(a<0||a>255))throw Error("Tensor values for a int32 Tensor must be in the "+"range [0 - 255] but encountered ".concat(a,"."));1===f?(t[0]=a*g,t[1]=a*g,t[2]=a*g):t[n]=a*g}let n=4*e;x[n+0]=Math.round(t[0]),x[n+1]=Math.round(t[1]),x[n+2]=Math.round(t[2]),x[n+3]=Math.round(t[3])}i.width=p,i.height=d;let y=new ImageData(x,p,d);return h.putImageData(y,0,0),r}},{kernelName:th,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{equation:r}=a,{allDims:i,summedDims:s,idDims:o}=oB.decodeEinsumEquation(r,t.length);oB.checkEinsumDimSizes(i.length,o,t);let{path:l,steps:c}=oB.getEinsumComputePath(s,o),u=c.length,h=null,d=i.length,p=[];for(let e=0;e<u;++e){for(let a of c[e]){let e,{permutationIndices:r,expandDims:i}=oB.getEinsumPermutation(d,o[a]);oB.isIdentityPermutation(r)?e=t[a]:(e=vm({inputs:{x:t[a]},backend:n,attrs:{perm:r}}),p.push(e));let s=e.shape.slice();for(let e=0;e<i.length;++e)s.splice(i[e],0,1);cs.arraysEqual(e.shape,s)||(e=v7({inputs:{x:e},backend:n,attrs:{shape:s}}),p.push(e)),null===h?h=e:(h=vu({inputs:{a:e,b:h},backend:n}),p.push(h))}e<u-1&&(l[e]>=0&&(h=wy({inputs:{x:h},backend:n,attrs:{axis:l[e]-(i.length-d),keepDims:!1}}),p.push(h)),d--)}for(let e of p)e!==h&&n.disposeIntermediateTensorInfo(e);return h}},{kernelName:"Elu",backendName:"cpu",kernelFunc:v1},{kernelName:td,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{dy:a,y:r}=t;bv([a,r],"eluGrad");let i=new Float32Array(cs.sizeFromShape(r.shape)),s=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values;for(let e=0;e<s.length;++e){let t=s[e];t>=0?i[e]=o[e]:i[e]=o[e]*(t+1)}return n.makeTensorInfo(r.shape,"float32",i)}},{kernelName:tp,backendName:"cpu",kernelFunc:bq},{kernelName:"Erf",backendName:"cpu",kernelFunc:wC},{kernelName:"Exp",backendName:"cpu",kernelFunc:bX},{kernelName:tf,backendName:"cpu",kernelFunc:wT},{kernelName:tm,backendName:"cpu",kernelFunc:bZ},{kernelName:"FFT",backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{input:a}=t,r=cs.sizeFromShape(a.shape),i=a.shape[a.shape.length-1],s=v7({inputs:{x:a},backend:n,attrs:{shape:[r/i,i]}}),o=w_(s,!1,n),l=v7({inputs:{x:o},backend:n,attrs:{shape:a.shape}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),l}},{kernelName:tg,backendName:"cpu",kernelFunc:wA},{kernelName:tx,backendName:"cpu",kernelFunc:e=>{let{inputs:t,attrs:n,backend:a}=e,{image:r}=t,i=cs.getTypedArrayFromDType(r.dtype,cs.sizeFromShape(r.shape)),[s,o,l,c]=r.shape,u=a.data.get(r.dataId).values;for(let e=0;e<s;e++){let t=e*l*o*c;for(let e=0;e<o;e++){let n=l*c*e;for(let e=0;e<l;e++){let a=e*c;for(let r=0;r<c;r++){let s=Math.round(l-e-1),o=t+n+a+r,h=u[o];s>=0&&s<l&&(h=u[t+n+s*c+r]),i[o]=h}}}}return{dataId:a.write(i,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:ty,backendName:"cpu",kernelFunc:bJ},{kernelName:tb,backendName:"cpu",kernelFunc:b0},{kernelName:nJ,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:i,bias:s,preluActivationWeights:o}=t,{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d,activation:p,leakyreluAlpha:f}=a,m=wf({inputs:{x:r,filter:i},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d}});if(s){let e=m;if("NCHW"===u&&1===s.shape.length&&1!==s.shape[0]){let e=v7({inputs:{x:s},backend:n,attrs:{shape:[s.shape[0],1,1]}});m=bF({inputs:{a:m,b:e},backend:n}),n.disposeIntermediateTensorInfo(e)}else m=bF({inputs:{a:m,b:s},backend:n});n.disposeIntermediateTensorInfo(e)}if(p){let e=m;if("NCHW"===u&&"prelu"===p&&1===o.shape.length&&1!==o.shape[0]){let e=v7({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});m=v8(n,m,p,e,f),n.disposeIntermediateTensorInfo(e)}else m=v8(n,m,p,o,f);n.disposeIntermediateTensorInfo(e)}return m}},{kernelName:n$,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:i,bias:s,preluActivationWeights:o}=t,{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d,activation:p,leakyreluAlpha:f}=a,m=wx({inputs:{x:r,filter:i},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d}});if(s){let e=m;m=bF({inputs:{a:m,b:s},backend:n}),n.disposeIntermediateTensorInfo(e)}if(p){let e=m;m=v8(n,m,p,o,f),n.disposeIntermediateTensorInfo(e)}return m}},{kernelName:tN,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{params:a,indices:r}=t,i=cs.sizeFromShape(a.shape),s=r.shape,o=s[s.length-1],[l,c,u,h]=oB.prepareAndValidate(a,r);if(0===c)return n.makeTensorInfo(l,a.dtype,[]);let d=b1(n.data.get(r.dataId).values,n.bufferSync(a),a.dtype,c,o,u,h,a.shape,i);return n.makeTensorInfo(l,a.dtype,d.values)}},{kernelName:tw,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,indices:i}=t,{axis:s,batchDims:o}=a;bv([r,i],"gatherV2");let l=cs.parseAxisParam(s,r.shape)[0],c=n.data.get(i.dataId).values,u=r.shape[l];for(let e=0;e<c.length;++e){let t=c[e];cs.assert(t<=u-1&&t>=0,()=>"GatherV2: the index value ".concat(t," is not in [0, ").concat(u-1,"]"))}let h=o;null==o&&(h=0);let d=cs.sizeFromShape(i.shape),p=oB.segment_util.collectGatherOpShapeInfo(r,i,l,h),f=v7({inputs:{x:r},backend:n,attrs:{shape:[p.batchSize,p.outerSize,p.dimSize,p.sliceSize]}}),m=v7({inputs:{x:i},backend:n,attrs:{shape:[p.batchSize,d/p.batchSize]}}),g=[p.batchSize,p.outerSize,d/p.batchSize,p.sliceSize],x=n.bufferSync(m),y=b2(n.bufferSync(f),x,g);return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.makeTensorInfo(p.outputShape,y.dtype,y.values)}},{kernelName:tk,backendName:"cpu",kernelFunc:b4},{kernelName:tS,backendName:"cpu",kernelFunc:b6},{kernelName:tC,backendName:"cpu",kernelFunc:bI},{kernelName:tT,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{input:a}=t,r=cs.sizeFromShape(a.shape),i=a.shape[a.shape.length-1],s=v7({inputs:{x:a},backend:n,attrs:{shape:[r/i,i]}}),o=w_(s,!0,n),l=v7({inputs:{x:o},backend:n,attrs:{shape:a.shape}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),l}},{kernelName:tI,backendName:"cpu",kernelFunc:wd},{kernelName:tE,backendName:"cpu",kernelFunc:wR},{kernelName:t_,backendName:"cpu",kernelFunc:wD},{kernelName:tA,backendName:"cpu",kernelFunc:wM},{kernelName:tR,backendName:"cpu",kernelFunc:v2},{kernelName:tD,backendName:"cpu",kernelFunc:b9},{kernelName:tM,backendName:"cpu",kernelFunc:ve},{kernelName:tF,backendName:"cpu",kernelFunc:function(e){let{backend:t,attrs:n}=e,{start:a,stop:r,num:i}=n,s=vt(a,r,i);return t.makeTensorInfo([s.length],"float32",s)}},{kernelName:"Log",backendName:"cpu",kernelFunc:va},{kernelName:tO,backendName:"cpu",kernelFunc:wF},{kernelName:tP,backendName:"cpu",kernelFunc:wO},{kernelName:tj,backendName:"cpu",kernelFunc:wP},{kernelName:tL,backendName:"cpu",kernelFunc:wj},{kernelName:"LRN",backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{depthRadius:i,bias:s,alpha:o,beta:l}=a;bv(r,"LRN");let c=r.shape[3],u=c-1,h=n.data.get(r.dataId).values,d=cs.sizeFromShape(r.shape),p=new Float32Array(d);for(let e=0;e<d;e++){let t=function(e){let t=e%c,n=e-t+Math.max(0,t-i),a=e-t+Math.min(t+i,u),r=0;for(;n<=a;n++){let e=h[n];r+=e*e}return r}(e),n=h[e]*Math.pow(s+o*t,-l);p[e]=n}return n.makeTensorInfo(r.shape,r.dtype,p)}},{kernelName:tz,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,y:i,dy:s}=t,{depthRadius:o,bias:l,alpha:c,beta:u}=a;bv(s,"LRNGrad");let h=cs.sizeFromShape(s.shape),d=s.shape[3],p=n.data.get(s.dataId).values,f=n.data.get(r.dataId).values,m=n.data.get(i.dataId).values,g=new Float32Array(h);for(let e=0;e<h;e++){let t=e%d,n=e-t+Math.max(0,t-o),a=e-t+Math.min(d,t+o+1),r=0;for(let e=n;e<a;e++)r+=Math.pow(f[e],2);r=c*r+l;for(let t=n;t<a;t++){let n=-2*c*u*f[t]*m[e]/r;e===t&&(n+=Math.pow(r,-u)),n*=p[e],g[t]+=n}}return n.makeTensorInfo(s.shape,r.dtype,g)}},{kernelName:"Max",backendName:"cpu",kernelFunc:wL},{kernelName:tB,backendName:"cpu",kernelFunc:vs},{kernelName:tV,backendName:"cpu",kernelFunc:function(e){let t,{inputs:n,backend:a,attrs:r}=e,{x:i}=n;bv(i,"maxPool");let{filterSize:s,strides:o,pad:l,dimRoundingMode:c}=r;cs.assert(oB.eitherStridesOrDilationsAreOne(o,1),()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'"));let u=oB.computePool2DInfo(i.shape,s,o,1,l,c);if(1===u.filterWidth&&1===u.filterHeight&&cs.arraysEqual(u.inShape,u.outShape))t=bI({inputs:{x:i},backend:a});else{let e=a.data.get(i.dataId).values,n=cs.computeStrides(i.shape),r=wl(e,i.shape,i.dtype,n,u,"max");t=a.makeTensorInfo(u.outShape,i.dtype,r.values)}return t}},{kernelName:tW,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:l,dataFormat:c}=a;bv(r,"maxPool3d");let u=oB.computePool3DInfo(r.shape,i,s,1,o,l,c),h=wu(n.data.get(r.dataId).values,r.shape,r.dtype,cs.computeStrides(r.shape),u,"max");return n.makeTensorInfo(h.shape,"float32",h.values)}},{kernelName:tG,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,input:i}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:c}=a;bv([r,i],"maxPool3DGrad");let u=oB.computePool3DInfo(i.shape,s,o,1,l,c),h=function(e,t){let n=rD(t.outShape,"int32"),a=t.strideDepth,r=t.strideHeight,i=t.strideWidth,s=t.dilationDepth,o=t.dilationHeight,l=t.dilationWidth,c=t.effectiveFilterDepth,u=t.effectiveFilterHeight,h=t.effectiveFilterWidth,d=t.padInfo.front,p=t.padInfo.top,f=t.padInfo.left;for(let m=0;m<t.batchSize;++m)for(let g=0;g<t.inChannels;++g)for(let x=0;x<t.outDepth;++x){let y=x*a-d,b=y;for(;b<0;)b+=s;let v=Math.min(t.inDepth,c+y);for(let a=0;a<t.outHeight;++a){let c=a*r-p,d=c;for(;d<0;)d+=o;let w=Math.min(t.inHeight,u+c);for(let r=0;r<t.outWidth;++r){let p=r*i-f,N=p;for(;N<0;)N+=l;let k=Math.min(t.inWidth,h+p),S=-1/0,C=-1;for(let t=b;t<v;t+=s){let n=t-y;for(let a=d;a<w;a+=o){let r=a-c;for(let i=N;i<k;i+=l){let s=i-p,o=e.get(m,t,a,i,g);o>=S&&(S=o,C=n*u*h+r*u+s)}}}n.set(C,m,x,a,r,g)}}}return n}(n.bufferSync(i),u),d=u.strideDepth,p=u.strideHeight,f=u.strideWidth,m=u.dilationDepth,g=u.dilationHeight,x=u.dilationWidth,y=u.effectiveFilterDepth,b=u.effectiveFilterHeight,v=u.effectiveFilterWidth,w=y-1-u.padInfo.front,N=v-1-u.padInfo.left,k=b-1-u.padInfo.top,S=rD(i.shape,"float32"),C=n.bufferSync(r);for(let e=0;e<u.batchSize;++e)for(let t=0;t<u.inChannels;++t)for(let n=0;n<u.inDepth;++n)for(let a=0;a<u.inHeight;++a)for(let r=0;r<u.inWidth;++r){let i=n-w,s=a-k,o=r-N,l=0;for(let n=0;n<y;n+=m){let a=(i+n)/d;if(!(a<0)&&!(a>=u.outDepth)&&Math.floor(a)===a)for(let r=0;r<b;r+=g){let i=(s+r)/p;if(!(i<0)&&!(i>=u.outHeight)&&Math.floor(i)===i)for(let s=0;s<v;s+=x){let c=(o+s)/f;if(c<0||c>=u.outWidth||Math.floor(c)!==c)continue;let d=+(y*b*v-1-h.get(e,a,i,c,t)===n*b*v+r*v+s);0!==d&&(l+=C.get(e,a,i,c,t)*d)}}}S.set(l,e,n,a,r,t)}return n.makeTensorInfo(S.shape,S.dtype,S.values)}},{kernelName:tU,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,input:i,output:s}=t;bv([i,s],"maxPoolGrad");let{filterSize:o,strides:l,pad:c,dimRoundingMode:u}=a,h=oB.computePool2DInfo(i.shape,o,l,1,c,u),d=n.data.get(i.dataId).values,p=rD(h.outShape,i.dtype,wc(d,i.shape,i.dtype,h).values),f=h.strideHeight,m=h.strideWidth,g=h.dilationHeight,x=h.dilationWidth,y=h.effectiveFilterHeight,b=h.effectiveFilterWidth,v=b-1-h.padInfo.left,w=y-1-h.padInfo.top,N=rD(i.shape,"float32"),k=n.data.get(r.dataId).values,S=rD(r.shape,"float32",k);for(let e=0;e<h.batchSize;++e)for(let t=0;t<h.inChannels;++t)for(let n=0;n<h.inHeight;++n)for(let a=0;a<h.inWidth;++a){let r=n-w,i=a-v,s=0;for(let n=0;n<y;n+=g){let a=(r+n)/f;if(!(a<0)&&!(a>=h.outHeight)&&Math.floor(a)===a)for(let r=0;r<b;r+=x){let o=(i+r)/m;if(o<0||o>=h.outWidth||Math.floor(o)!==o)continue;let l=+(y*b-1-p.get(e,a,o,t)===n*b+r);0!==l&&(s+=S.get(e,a,o,t)*l)}}N.set(s,e,n,a,t)}return n.makeTensorInfo(N.shape,N.dtype,N.values)}},{kernelName:tH,backendName:"cpu",kernelFunc:e=>{let{inputs:t,attrs:n,backend:a}=e,{x:r}=t,{filterSize:i,strides:s,pad:o,includeBatchInIndex:l}=n;bv(r,"MaxPoolWithArgmax");let c=a.data.get(r.dataId).values,u=oB.computePool2DInfo(r.shape,i,s,[1,1],o),[h,d]=function(e,t,n,a,r){let i=cs.computeStrides(t),s=wl(e,t,n,i,r,"max"),o=wc(e,t,n,r,!0,a);return[s.values,o.values]}(c,r.shape,r.dtype,l,u),p=a.write(h,u.outShape,r.dtype),f=a.write(d,u.outShape,r.dtype);return[{dataId:p,shape:u.outShape,dtype:r.dtype},{dataId:f,shape:u.outShape,dtype:"int32"}]}},{kernelName:tq,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:i,keepDims:s}=a,o=cs.parseAxisParam(i,r.shape),l=oB.computeOutAndReduceShapes(r.shape,o)[1],c=cs.sizeFromShape(l),u=[],h=n.makeTensorInfo([],"float32",new Float32Array([c]));u.push(h);let d=bA({inputs:{x:r},backend:n,attrs:{dtype:"float32"}});u.push(d);let p=wI({inputs:{a:d,b:h},backend:n});u.push(p);let f=wy({inputs:{x:p},backend:n,attrs:{axis:i,keepDims:s}});return u.forEach(e=>n.disposeIntermediateTensorInfo(e)),f}},{kernelName:"Min",backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:i,keepDims:s}=a;bv(r,"min");let o=cs.parseAxisParam(i,r.shape),l=o,c=oB.getAxesPermutation(l,r.shape.length),u=r;null!=c&&(u=vm({inputs:{x:r},backend:n,attrs:{perm:c}}),l=oB.getInnerMostAxes(l.length,r.shape.length)),oB.assertAxesAreInnerMostDims("min",l,u.shape.length);let[h,d]=oB.computeOutAndReduceShapes(u.shape,l),p=cs.sizeFromShape(d),f=cs.makeZerosTypedArray(cs.sizeFromShape(h),u.dtype),m=n.data.get(u.dataId).values;for(let e=0;e<f.length;++e){let t=e*p,n=m[t];for(let e=0;e<p;++e){let a=m[t+e];(Number.isNaN(a)||a<n)&&(n=a)}f[e]=n}null!=c&&n.disposeIntermediateTensorInfo(u);let g=n.makeTensorInfo(h,u.dtype,f);if(s){let e=v7({inputs:{x:g},backend:n,attrs:{shape:oB.expandShapeToKeepDim(h,o)}});return n.disposeIntermediateTensorInfo(g),e}return g}},{kernelName:tK,backendName:"cpu",kernelFunc:vl},{kernelName:tX,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{paddings:i,mode:s}=a;bv(r,"mirrorPad");let o=i.map((e,t)=>e[0]+r.shape[t]+e[1]),l=i.map(e=>e[0]),c=i.map((e,t)=>e[0]+r.shape[t]),u=+("reflect"!==s),h=n.data.get(r.dataId).values,d=r.shape.length,p=cs.computeStrides(r.shape),f=cs.sizeFromShape(o),m=o.length,g=cs.computeStrides(o),x=cs.getTypedArrayFromDType(r.dtype,f);for(let e=0;e<f;e++){let t=cs.indexToLoc(e,m,g);for(let e=0;e<m;e++)t[e]<l[e]?t[e]=2*l[e]-t[e]-u:t[e]>=c[e]&&(t[e]=(c[e]-1)*2-t[e]+u);t=t.map((e,t)=>e-l[t]);let n=cs.locToIndex(t,d,p);x[e]=h[n]}return{dataId:n.write(x,o,r.dtype),shape:o,dtype:r.dtype}}},{kernelName:"Mod",backendName:"cpu",kernelFunc:wz},{kernelName:tY,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{logits:r}=t,{numSamples:i,seed:s,normalized:o}=a;bv(r,"multinomial");let l=o?r:wB({inputs:{logits:r},backend:n,attrs:{dim:-1}}),c=l.shape[0],u=l.shape[1],h=n.data.get(l.dataId).values,d=[c,i],p=cs.makeZerosTypedArray(cs.sizeFromShape(d),"int32");for(let e=0;e<c;++e){let t=e*u,n=new Float32Array(u-1);n[0]=h[t];for(let e=1;e<n.length;++e)n[e]=n[e-1]+h[t+e];let a=uX.alea(s.toString()),r=e*i;for(let e=0;e<i;++e){let t=a();p[r+e]=n.length;for(let a=0;a<n.length;a++)if(t<n[a]){p[r+e]=a;break}}}return o||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(d,"int32",p)}},{kernelName:tZ,backendName:"cpu",kernelFunc:vu},{kernelName:"Neg",backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{x:a}=t;bv(a,"neg");let[r,i]=vh(n.data.get(a.dataId).values,a.shape,a.dtype);return n.makeTensorInfo(i,a.dtype,r)}},{kernelName:tJ,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{boxes:r,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l}=a;bv(r,"NonMaxSuppression");let{selectedIndices:c}=wV(n.data.get(r.dataId).values,n.data.get(i.dataId).values,s,o,l);return n.makeTensorInfo([c.length],"int32",new Int32Array(c))}},{kernelName:t$,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{boxes:r,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:c}=a;bv(r,"NonMaxSuppressionPadded");let{selectedIndices:u,validOutputs:h}=wU(n.data.get(r.dataId).values,n.data.get(i.dataId).values,s,o,l,c);return[n.makeTensorInfo([u.length],"int32",new Int32Array(u)),n.makeTensorInfo([],"int32",new Int32Array([h]))]}},{kernelName:t0,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{boxes:r,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l,softNmsSigma:c}=a;bv(r,"NonMaxSuppressionWithScore");let u=n.data.get(r.dataId).values,{selectedIndices:h,selectedScores:d}=wW(u,n.data.get(i.dataId).values,s,o,l,c);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([d.length],"float32",new Float32Array(d))]}},{kernelName:tQ,backendName:"cpu",kernelFunc:vp},{kernelName:t2,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{indices:r}=t,{dtype:i,depth:s,onValue:o,offValue:l}=a;bv(r,"oneHot");let c=cs.sizeFromShape(r.shape),u=new Float32Array(c*s);u.fill(l);let h=n.data.get(r.dataId).values;for(let e=0;e<c;++e)h[e]>=0&&h[e]<s&&(u[e*s+h[e]]=o);return n.makeTensorInfo([...r.shape,s],i,u)}},{kernelName:t1,backendName:"cpu",kernelFunc:function e(t){let{inputs:n,backend:a}=t,{x:r}=n;if("string"===r.dtype)throw Error("onesLike is not supported for string tensors");if("complex64"!==r.dtype)return wA({backend:a,attrs:{shape:r.shape,value:1,dtype:r.dtype}});{let t=bE({inputs:{input:r},backend:a}),n=e({inputs:{x:t},backend:a}),i=wd({inputs:{input:r},backend:a}),s=wG({inputs:{x:i},backend:a}),o=bC({inputs:{real:n,imag:s},backend:a});return a.disposeIntermediateTensorInfo(t),a.disposeIntermediateTensorInfo(n),a.disposeIntermediateTensorInfo(i),a.disposeIntermediateTensorInfo(s),o}}},{kernelName:t3,backendName:"cpu",kernelFunc:wH},wq,{kernelName:"Pow",backendName:"cpu",kernelFunc:wK},{kernelName:t5,backendName:"cpu",kernelFunc:v4},{kernelName:t6,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:i,keepDims:s}=a;bv(r,"prod");let o=r.shape.length,l=cs.parseAxisParam(i,r.shape),c=oB.getAxesPermutation(l,o),u=l,h=r,d=[];null!=c&&(d.push(h=vm({inputs:{x:r},backend:n,attrs:{perm:c}})),u=oB.getInnerMostAxes(u.length,o));let p=n.data.get(h.dataId).values,{outVals:f,outShape:m,outDtype:g}=vg(h.shape,h.dtype,p,u),x=m;return s&&(x=oB.expandShapeToKeepDim(m,l)),d.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.makeTensorInfo(x,g,f)}},{kernelName:t8,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{paramsNestedSplits:r,paramsDenseValues:i,indices:s}=t,{outputRaggedRank:o}=a,l=r.map(e=>n.data.get(e.dataId).values),c=r.map(e=>e.shape),u=n.data.get(i.dataId).values,h=n.data.get(s.dataId).values,[d,p,f]=vy(l,c,u,i.shape,i.dtype,h,s.shape,o),m=d.map(e=>n.makeTensorInfo([e.length],"int32",e)),g=n.makeTensorInfo(f,i.dtype,p);return m.concat([g])}},{kernelName:t9,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{starts:a,limits:r,deltas:i}=t,s=n.data.get(a.dataId).values,o=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,[c,u]=vb(s,a.shape,a.dtype,o,r.shape,l,i.shape);return[n.makeTensorInfo([c.length],"int32",c),n.makeTensorInfo([u.length],a.dtype,u)]}},{kernelName:t7,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{shape:r,values:i,defaultValue:s,rowPartitionTensors:o}=t,{rowPartitionTypes:l}=a,c=n.data.get(r.dataId).values,u=n.data.get(i.dataId).values,h=n.data.get(s.dataId).values,d=o.map(e=>n.data.get(e.dataId).values),p=o.map(e=>e.shape),[f,m]=vS(c,r.shape,u,i.shape,i.dtype,h,s.shape,d,p,l);return n.makeTensorInfo(f,i.dtype,m)}},{kernelName:ne,backendName:"cpu",kernelFunc:function(e){let{backend:t,attrs:n}=e,{start:a,stop:r,dtype:i,step:s}=n,o=vC(a,r,s,i);return t.makeTensorInfo([o.length],i,o)}},{kernelName:nt,backendName:"cpu",kernelFunc:bE},wE,{kernelName:nn,backendName:"cpu",kernelFunc:wX},{kernelName:na,backendName:"cpu",kernelFunc:v5},{kernelName:nc,backendName:"cpu",kernelFunc:v6},{kernelName:nr,backendName:"cpu",kernelFunc:v7},{kernelName:no,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{images:r}=t,{alignCorners:i,halfPixelCenters:s,size:o}=a;bv(r,"resizeBilinear");let l=cs.computeStrides(r.shape),[c,u]=o,[h,d,p,f]=r.shape,m=n.data.get(r.dataId).values,g=new Float32Array(cs.sizeFromShape([h,c,u,f])),x=[i&&c>1?d-1:d,i&&u>1?p-1:p],y=[i&&c>1?c-1:c,i&&u>1?u-1:u],b=0,v=x[0]/y[0],w=x[1]/y[1];for(let e=0;e<h;e++)for(let t=0;t<c;t++){let n,a=Math.max(0,Math.floor(n=s?v*(t+.5)-.5:v*t)),r=n-a,i=Math.min(d-1,Math.ceil(n)),o=e*l[0]+a*l[1],c=e*l[0]+i*l[1];for(let e=0;e<u;e++){let t,n=Math.max(0,Math.floor(t=s?w*(e+.5)-.5:w*e)),a=t-n,i=Math.min(p-1,Math.ceil(t)),u=o+n*l[2],h=c+n*l[2],d=o+i*l[2],x=c+i*l[2];for(let e=0;e<f;e++){let t=m[u+e],n=m[h+e],i=m[d+e],s=m[x+e],o=t+(i-t)*a,l=o+(n+(s-n)*a-o)*r;g[b++]=l}}}return n.makeTensorInfo([h,c,u,f],"float32",g)}},{kernelName:nl,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{images:r,dy:i}=t,{alignCorners:s}=a;bv([i,r],"resizeBilinearGrad");let o=cs.computeStrides(r.shape),[l,c,u,h]=r.shape,[,d,p]=i.shape,f=new Float32Array(l*c*u*h),m=[s&&d>1?c-1:c,s&&p>1?u-1:u],g=[s&&d>1?d-1:d,s&&p>1?p-1:p],x=m[0]/g[0],y=m[1]/g[1],b=n.data.get(i.dataId).values,v=0;for(let e=0;e<l;e++){let t=e*o[0];for(let e=0;e<d;e++){let n=e*x,a=Math.floor(n),r=Math.min(Math.ceil(n),c-1),i=t+a*o[1],s=t+r*o[1],l=n-a,d=1-l;for(let e=0;e<p;e++){let t=e*y,n=Math.floor(t),a=Math.min(Math.ceil(t),u-1),r=t-n,c=1-r,p=i+n*o[2],m=i+a*o[2],g=s+n*o[2],x=s+a*o[2],w=d*c,N=d*r,k=l*c,S=l*r;for(let e=0;e<h;e++){let t=b[v++];f[p+e]+=t*w,f[m+e]+=t*N,f[g+e]+=t*k,f[x+e]+=t*S}}}}return n.makeTensorInfo([l,u,c,h],"float32",f)}},{kernelName:ni,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{images:r}=t,{alignCorners:i,halfPixelCenters:s,size:o}=a;bv(r,"resizeNearestNeighbor");let l=cs.computeStrides(r.shape),[c,u]=o,[h,d,p,f]=r.shape,m=n.data.get(r.dataId).values,g=new Float32Array(h*c*u*f),x=[i&&c>1?d-1:d,i&&u>1?p-1:p],y=[i&&c>1?c-1:c,i&&u>1?u-1:u],b=x[0]/y[0],v=x[1]/y[1],w=0;for(let e=0;e<h;e++){let t=e*l[0];for(let e=0;e<c;e++){let n=s?b*(e+.5):b*e,a=Math.min(d-1,i?Math.round(n):Math.floor(n));s&&(a=Math.max(0,a));let r=t+a*l[1];for(let e=0;e<u;e++){let t=s?v*(e+.5):v*e,n=Math.min(p-1,i?Math.round(t):Math.floor(t));s&&(n=Math.max(0,n));let a=r+n*l[2];for(let e=0;e<f;e++){let t=m[a+e];g[w++]=t}}}}return n.makeTensorInfo([h,c,u,f],r.dtype,g)}},{kernelName:ns,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{images:r,dy:i}=t,{alignCorners:s}=a;bv([i,r],"resizeNearestNeighborGrad");let o=cs.computeStrides(r.shape),l=cs.computeStrides(i.shape),[c,u,h,d]=r.shape,[,p,f]=i.shape,m=new Float32Array(c*u*h*d),g=n.data.get(i.dataId).values,x=[s&&p>1?u-1:u,s&&f>1?h-1:h],y=[s&&p>1?p-1:p,s&&f>1?f-1:f],b=x[0]/y[0],v=x[1]/y[1],w=1/b,N=1/v,k=2*Math.ceil(w)+2,S=2*Math.ceil(N)+2;for(let e=0;e<c;e++){let t=e*o[0];for(let e=0;e<u;e++){let n=t+e*o[1],a=Math.floor(Math.floor(e*w)-k/2);for(let r=0;r<h;r++){let i=n+r*o[2],c=Math.floor(Math.floor(r*N)-S/2);for(let n=0;n<d;n++){let o=0;for(let i=0;i<k;i++){let d=i+a;if(d<0||d>=p)continue;let m=t+d*l[1],x=d*b;if(e===Math.min(u-1,s?Math.round(x):Math.floor(x)))for(let e=0;e<S;e++){let t=e+c;if(t<0||t>=f)continue;let a=m+t*l[2],i=t*v;r===Math.min(h-1,s?Math.round(i):Math.floor(i))&&(o+=g[a+n])}}m[i+n]=o}}}}return n.makeTensorInfo(r.shape,r.dtype,m)}},{kernelName:nu,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{dims:i}=a;bv(r,"reverse");let s=r.shape.length,o=cs.parseAxisParam(i,r.shape);if(0===s)return bI({inputs:{x:r},backend:n});let l=new ad(r.shape,r.dtype),c=n.bufferSync(r);for(let e=0;e<l.size;e++){let t=l.indexToLoc(e),n=t.slice();o.forEach(e=>n[e]=r.shape[e]-1-n[e]),l.set(c.get(...n),...t)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}},{kernelName:nZ,backendName:"cpu",kernelFunc:e=>{let{inputs:t,attrs:n,backend:a}=e,{image:r}=t,{radians:i,fillValue:s,center:o}=n,l=cs.getTypedArrayFromDType(r.dtype,cs.sizeFromShape(r.shape)),[c,u,h,d]=r.shape,[p,f]=oB.getImageCenter(o,u,h),m=Math.sin(i),g=Math.cos(i),x=a.data.get(r.dataId).values;for(let e=0;e<c;e++){let t=e*h*u*d;for(let e=0;e<u;e++){let n=h*d*e;for(let a=0;a<h;a++){let r=a*d;for(let i=0;i<d;i++){let o=[c,e,a,i],y=o[2],b=o[1],v=(y-p)*g-(b-f)*m,w=(y-p)*m+(b-f)*g;v=Math.round(v+p),w=Math.round(w+f);let N=s;"number"!=typeof s&&(N=3===i?255:s[i]),v>=0&&v<h&&w>=0&&w<u&&(N=x[t+h*d*w+v*d+i]),l[t+n+r+i]=N}}}}return{dataId:a.write(l,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:nh,backendName:"cpu",kernelFunc:wY},{kernelName:nd,backendName:"cpu",kernelFunc:vI},{kernelName:np,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{indices:r,updates:i}=t,{shape:s}=a,{sliceRank:o,numUpdates:l,sliceSize:c,strides:u,outputSize:h}=oB.calculateShapes(i,r,s),d=vE(n.bufferSync(r),n.bufferSync(i),s,h,c,l,o,u,0,!0);return n.makeTensorInfo(s,d.dtype,d.values)}},{kernelName:nm,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{sortedSequence:r,values:i}=t,{side:s}=a,o=function(e,t,n,a,r,i){let s=cs.getArrayFromDType("int32",n*r);for(let o=0;o<n;++o){let n=e.slice(o*a,(o+1)*a),l=o*r;for(let e=0;e<r;++e)s[l+e]="left"===i?function(e,t){let n=0,a=e.length,r=0;for(;n<a;)e[r=Math.floor((n+a)/2)]<t?n=r+1:a=r;return a}(n,t[e+l]):function(e,t){let n=0,a=e.length,r=0;for(;n<a;)e[r=Math.floor((n+a)/2)]<=t?n=r+1:a=r;return a}(n,t[e+l])}return s}(n.data.get(r.dataId).values,n.data.get(i.dataId).values,r.shape[0],r.shape[1],i.shape[1],s);return n.makeTensorInfo(i.shape,"int32",o)}},{kernelName:ng,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{condition:a,t:r,e:i}=t;bv([a,r,i],"select");let s=a.shape.length,o=n.data.get(a.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,u=ab(r.dtype,i.dtype),h=cs.makeZerosTypedArray(cs.sizeFromShape(r.shape),u),d=0,p=0===s||s>1||1===r.shape.length?1:cs.sizeFromShape(r.shape.slice(1));for(let e=0;e<o.length;e++)for(let t=0;t<p;t++)1===o[e]?h[d++]=l[e]:h[d++]=c[e];return n.makeTensorInfo(r.shape,u,h)}},{kernelName:nx,backendName:"cpu",kernelFunc:wJ},{kernelName:nw,backendName:"cpu",kernelFunc:vA},{kernelName:nv,backendName:"cpu",kernelFunc:w$},{kernelName:"Sin",backendName:"cpu",kernelFunc:w0},{kernelName:nb,backendName:"cpu",kernelFunc:w1},{kernelName:ny,backendName:"cpu",kernelFunc:vM},{kernelName:nT,backendName:"cpu",kernelFunc:wB},{kernelName:nN,backendName:"cpu",kernelFunc:w3},{kernelName:nS,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{blockShape:i,paddings:s}=a;bv([r],"spaceToBatchND");let o=cs.sizeFromShape(i),l=[[0,0]];l.push(...s);for(let e=1+i.length;e<r.shape.length;++e)l.push([0,0]);let c=wq.kernelFunc({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),u=oB.getReshaped(c.shape,i,o,!1),h=oB.getPermuted(u.length,i.length,!1),d=oB.getReshapedPermuted(c.shape,i,o,!1),p=v7({inputs:{x:c},backend:n,attrs:{shape:u}}),f=vm({inputs:{x:p},backend:n,attrs:{perm:h}}),m=v7({inputs:{x:f},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),m}},{kernelName:nI,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{indices:a,values:r,denseShape:i,defaultValue:s}=t;if(1!==i.shape.length)throw Error("Dense shape must be a vector, saw:\n        ".concat(i.shape));if(2!==a.shape.length)throw Error("Indices must be a matrix, saw:\n        ".concat(a.shape));if(1!==r.shape.length)throw Error("Values must be a vector, saw:\n        ".concat(r.shape));if(0!==s.shape.length)throw Error("Default value must be a scalar, saw:\n        ".concat(s.shape));let o=n.data.get(a.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,u=n.data.get(s.dataId).values[0],[h,d,p,f,m]=vF(o,a.shape,a.dtype,l,r.dtype,c,u);return[n.makeTensorInfo(d,a.dtype,h),n.makeTensorInfo([d[0]],r.dtype,p),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map(e=>Number(e)))),n.makeTensorInfo([m.length],a.dtype,new Int32Array(m))]}},{kernelName:nE,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{inputIndices:a,inputShape:r,newShape:i}=t;if(2!==a.shape.length)throw Error("Input indices should be a matrix but received shape\n        ".concat(a.shape));if(1!==r.shape.length)throw Error("Input shape should be a vector but received shape\n        ".concat(r.shape));if(1!==i.shape.length)throw Error("Target shape should be a vector but received shape ".concat(i.shape));let s=Array.from(n.data.get(r.dataId).values),o=n.data.get(a.dataId).values,l=Array.from(n.data.get(i.dataId).values),[c,u,h]=vO(o,a.shape,a.dtype,s,l);return[n.makeTensorInfo(u,a.dtype,c),n.makeTensorInfo([h.length],i.dtype,new Int32Array(h))]}},{kernelName:n_,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{data:a,indices:r,segmentIds:i}=t;if(a.shape.length<1)throw Error("Data should be at least 1 dimensional but received scalar");if(1!==r.shape.length)throw Error("Indices should be a vector but received shape\n          ".concat(r.shape));if(1!==i.shape.length)throw Error("Segment ids should be a vector but received shape\n          ".concat(i.shape));if(r.shape[0]!==i.shape[0])throw Error("segmentIds and indices should have same size.");let s=n.data.get(a.dataId).values,o=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,[c,u]=vP(s,a.shape,a.dtype,o,l,!0);return n.makeTensorInfo(u,a.dtype,c)}},{kernelName:nA,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{data:a,indices:r,segmentIds:i}=t;if(a.shape.length<1)throw Error("Data should be at least 1 dimensional but received scalar");if(1!==r.shape.length)throw Error("Indices should be a vector but received shape\n         ".concat(r.shape));if(1!==i.shape.length)throw Error("Segment ids should be a vector but received shape\n         ".concat(i.shape));if(r.shape[0]!==i.shape[0])throw Error("segmentIds and indices should have same size.");let s=n.data.get(a.dataId).values,o=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,[c,u]=vP(s,a.shape,a.dtype,o,l);return n.makeTensorInfo(u,a.dtype,c)}},{kernelName:nR,backendName:"cpu",kernelFunc:function(e){let t,{inputs:n,backend:a,attrs:r}=e,{sparseIndices:i,sparseValues:s,defaultValue:o}=n,{outputShape:l}=r,{sliceRank:c,numUpdates:u,sliceSize:h,strides:d,outputSize:p}=oB.calculateShapes(s,i,l),f=a.bufferSync(i);switch(s.dtype){case"bool":t=vE(f,a.bufferSync(s),l,p,h,u,c,d,!!a.data.get(o.dataId).values[0],!1);break;case"float32":case"int32":t=vE(f,a.bufferSync(s),l,p,h,u,c,d,a.data.get(o.dataId).values[0],!1);break;case"string":t=vE(f,a.bufferSync(s),l,p,h,u,c,d,cs.decodeString(a.data.get(o.dataId).values[0]),!1);break;default:throw Error("Unsupported type ".concat(s.dtype))}return a.makeTensorInfo(l,t.dtype,t.values)}},{kernelName:nC,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{numOrSizeSplits:i,axis:s}=a,o=cs.parseAxisParam(s,r.shape)[0],l=oB.prepareSplitSize(r,i,o),c=Array(r.shape.length).fill(0),u=r.shape.slice();return l.map(e=>{let t=[...u];t[o]=e;let a=vM({inputs:{x:r},backend:n,attrs:{begin:c,size:t}});return c[o]+=e,a})}},{kernelName:nk,backendName:"cpu",kernelFunc:vL},{kernelName:nM,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n}=e,{x:a}=t;bv(a,"square");let r=n.data.get(a.dataId).values,i=new Float32Array(r.length);for(let e=0;e<r.length;++e){let t=r[e];i[e]=t*t}return{dataId:n.write(i,a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},{kernelName:nD,backendName:"cpu",kernelFunc:vB},{kernelName:nF,backendName:"cpu",kernelFunc:vU},{kernelName:nX,backendName:"cpu",kernelFunc:w4},{kernelName:nO,backendName:"cpu",kernelFunc:function(e){let t,{inputs:n,backend:a,attrs:r}=e,{x:i}=n,{begin:s,end:o,strides:l,beginMask:c,endMask:u,ellipsisMask:h,newAxisMask:d,shrinkAxisMask:p}=r;bv(i,"stridedSlice");let{finalShapeSparse:f,finalShape:m,isIdentity:g,sliceDim0:x,isSimpleSlice:y,begin:b,end:v,strides:w}=vR.sliceInfo(i.shape,s,o,l,c,u,h,d,p);if(g)t=v7({inputs:{x:i},backend:a,attrs:{shape:m}});else if(x||y){cs.assert(i.shape.length>=1,()=>"Input must have rank at least 1, got: ".concat(i.shape.length));let e=vR.computeOutShape(b,v,w),n=vM({inputs:{x:i},backend:a,attrs:{begin:b,size:e}});t=v7({inputs:{x:n},backend:a,attrs:{shape:m}}),a.disposeIntermediateTensorInfo(n)}else{let e=vW(f,a.bufferSync(i),w,b);t=a.makeTensorInfo(m,e.dtype,e.values)}return t}},{kernelName:nP,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{separator:r,nGramWidths:i,leftPad:s,rightPad:o,padWidth:l,preserveShortSequences:c}=a,{data:u,dataSplits:h}=t,[d,p]=vH(n.data.get(u.dataId).values,n.data.get(h.dataId).values,r,i,s,o,l,c);return[n.makeTensorInfo([d.length],"string",d),n.makeTensorInfo(h.shape,"int32",p)]}},{kernelName:nj,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{skipEmpty:r}=a,{input:i,delimiter:s}=t;if("string"!==i.dtype)throw Error("Input must be of datatype string");if(1!==i.shape.length)throw Error("Input must be a vector, got shape: ".concat(i.shape));if(0!==s.shape.length)throw Error("Delimiter must be a scalar, got shape: ".concat(s.shape));let[o,l,c]=vq(n.data.get(i.dataId).values,n.data.get(s.dataId).values[0],r),u=l.length;return[n.makeTensorInfo([u,2],"int32",o),n.makeTensorInfo([u],"string",l),n.makeTensorInfo([2],"int32",new Int32Array(c))]}},{kernelName:nL,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{numBuckets:r}=a,{input:i}=t;if("string"!==i.dtype)throw Error("Input must be of datatype string");if(r<=0)throw Error("Number of buckets must be at least 1");let s=vK(n.data.get(i.dataId).values,r);return n.makeTensorInfo(i.shape,"int32",s)}},{kernelName:"Sub",backendName:"cpu",kernelFunc:vY},{kernelName:"Sum",backendName:"cpu",kernelFunc:wy},{kernelName:"Tan",backendName:"cpu",kernelFunc:w5},{kernelName:nz,backendName:"cpu",kernelFunc:w6},{kernelName:nf,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{tensor:a,indices:r,updates:i}=t,{sliceRank:s,numUpdates:o,sliceSize:l,strides:c,outputSize:u}=oB.calculateShapes(i,r,a.shape),h=n.bufferSync(r),d=n.bufferSync(i),p=n.bufferSync(a),f=vE(h,d,a.shape,u,l,o,s,c,p,!1);return n.makeTensorInfo(a.shape,f.dtype,f.values)}},{kernelName:nB,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{reps:i}=a;bv(r,"tile");let s=vZ(n.bufferSync(r),i);return n.makeTensorInfo(s.shape,s.dtype,s.values)}},{kernelName:nV,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{k:i,sorted:s}=a;bv(r,"topk");let[o,l]=vJ(n.data.get(r.dataId).values,r.shape,r.dtype,i,s);return[n.makeTensorInfo(o.shape,o.dtype,o.values),n.makeTensorInfo(l.shape,l.dtype,l.values)]}},{kernelName:nU,backendName:"cpu",kernelFunc:function(e){let{inputs:t,attrs:n,backend:a}=e,{image:r,transforms:i}=t,{interpolation:s,fillMode:o,fillValue:l,outputShape:c}=n,[u,h,d,p]=r.shape,[f,m]=null!=c?c:[h,d],g=[u,f,m,p],x=cs.computeStrides(r.shape),y=x[0],b=x[1],v=x[2],w=cs.computeStrides(g),N=w[0],k=w[1],S=w[2],C=cs.getTypedArrayFromDType(r.dtype,cs.sizeFromShape(g));C.fill(l);let T=a.data.get(r.dataId).values,I=a.data.get(i.dataId).values;for(let e=0;e<u;++e){let t=1===i.shape[0]?I:I.subarray(8*e,8*e+8);for(let n=0;n<f;++n)for(let a=0;a<m;++a)for(let r=0;r<p;++r){let i,c=t[6]*a+t[7]*n+1;if(0===c)continue;let u=(t[0]*a+t[1]*n+t[2])/c,p=(t[3]*a+t[4]*n+t[5])/c,f=w8(u,d,o),m=w8(p,h,o);switch(s){case"nearest":i=w9(T,h,d,y,b,v,e,Math.round(m),Math.round(f),r,l);break;case"bilinear":i=function(e,t,n,a,r,i,s,o,l,c,u){let h=Math.floor(o),d=Math.floor(l),p=h+1,f=d+1,m=(f-l)*w9(e,t,n,a,r,i,s,h,d,c,u)+(l-d)*w9(e,t,n,a,r,i,s,h,f,c,u),g=(f-l)*w9(e,t,n,a,r,i,s,p,d,c,u)+(l-d)*w9(e,t,n,a,r,i,s,p,f,c,u);return(p-o)*m+(o-h)*g}(T,h,d,y,b,v,e,m,f,r,l);break;default:throw Error("Error in Transform: Expect 'nearest' or "+"'bilinear', but got ".concat(s))}C[e*N+n*k+a*S+r]=i}return a.makeTensorInfo(g,r.dtype,C)}return{dataId:a.write(C,g,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:nW,backendName:"cpu",kernelFunc:vm},{kernelName:nG,backendName:"cpu",kernelFunc:function(e){let{inputs:t,attrs:n,backend:a}=e,{axis:r}=n,{x:i}=t;bv(i,"unique");let{outputValues:s,outputShape:o,indices:l}=v$(a.data.get(i.dataId).values,r,i.shape,i.dtype);return[a.makeTensorInfo(o,i.dtype,s),a.makeTensorInfo([l.length],"int32",l)]}},{kernelName:nH,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{value:r}=t,{axis:i}=a;i<0&&(i+=r.shape.length);let s=r.shape.length,o=r.shape[i],l=Array(s-1),c=0;for(let e=0;e<s;e++)e!==i&&(l[c++]=r.shape[e]);let u=Array(s).fill(0),h=r.shape.slice();h[i]=1;let d=Array(o);for(let e=0;e<d.length;e++){u[i]=e;let t=vM({inputs:{x:r},backend:n,attrs:{begin:u,size:h}});d[e]=v7({inputs:{x:t},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(t)}return d}},{kernelName:nq,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,segmentIds:i}=t,{numSegments:s}=a;bv(r,"unsortedSegmentSum");let o=r.shape.length,l=i.shape.length,c=[],u=[],h=o-l,d=i;for(let e=0;e<h;++e){let t=wT({inputs:{input:d},backend:n,attrs:{dim:e+1}});d=t,u.push(t)}for(let e=0;e<s;++e){let t=cs.createScalarValue(e,"int32"),a=n.makeTensorInfo([],"int32",t),i=bq({inputs:{a:a,b:d},backend:n}),s=bA({inputs:{x:i},backend:n,attrs:{dtype:"float32"}}),o=vu({inputs:{a:s,b:r},backend:n}),l=wy({inputs:{x:o},backend:n,attrs:{axis:0,keepDims:!1}});c.push(l),u.push(a),u.push(i),u.push(s),u.push(o),u.push(l)}let p=wH({inputs:c,backend:n,attrs:{axis:0}});return u.forEach(e=>n.disposeIntermediateTensorInfo(e)),p}},{kernelName:nK,backendName:"cpu",kernelFunc:wG}])n6(e);e.s(["webgl",()=>Sq],59007);var w7=e.i(62893),w7=w7,w7=w7;e.s(["assertNotComplex",()=>N$,"bindCanvasToFramebuffer",()=>NA,"bindColorTextureToFramebuffer",()=>NR,"bindTextureToProgramUniformSampler",()=>N_,"bindTextureUnit",()=>NC,"bindVertexBufferToProgramAttribute",()=>NS,"callAndCheck",()=>No,"canBeRepresented",()=>Nl,"createFragmentShader",()=>Nd,"createFramebuffer",()=>Nk,"createProgram",()=>Nm,"createStaticIndexBuffer",()=>Nb,"createStaticVertexBuffer",()=>Ny,"createTexture",()=>Nw,"createVertexShader",()=>Nh,"getBatchDim",()=>Nj,"getExtensionOrThrow",()=>Nu,"getFramebufferErrorMessage",()=>NF,"getMaxTexturesInShader",()=>NH,"getNumChannels",()=>Nv,"getProgramUniformLocation",()=>NE,"getProgramUniformLocationOrThrow",()=>NI,"getRowsCols",()=>NL,"getShapeAs3D",()=>Nz,"getTextureShapeFromLogicalShape",()=>NB,"getWebGLDisjointQueryTimerVersion",()=>Nq,"getWebGLErrorMessage",()=>Nc,"getWebGLMaxTextureSize",()=>NU,"hasExtension",()=>NK,"isCapableOfRenderingToFloatTexture",()=>NY,"isDownloadFloatTextureEnabled",()=>NZ,"isReshapeFree",()=>NV,"isWebGLFenceEnabled",()=>NJ,"isWebGLVersionEnabled",()=>NX,"linkProgram",()=>Ng,"logShaderSourceAndInfoLog",()=>Nf,"resetMaxTextureSize",()=>NW,"resetMaxTexturesInShader",()=>NG,"unbindColorTextureFromFramebuffer",()=>ND,"unbindTextureUnit",()=>NT,"validateFramebuffer",()=>NM,"validateProgram",()=>Nx,"validateTextureSize",()=>NN],19392);var cs=cs;let Ne={},Nt={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Nn(e,t){Ne[e]=t}function Na(e,t){if(!(e in Ne)||null!=t){let n=function(e,t){if(1!==e&&2!==e)throw Error("Cannot get WebGL rendering context, WebGL is disabled.");let n=null==t?function(e){if(!eT.getBool("IS_SAFARI")&&"undefined"!=typeof OffscreenCanvas&&2===e)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw Error("Cannot create a canvas in this context")}(e):t;return(n.addEventListener("webglcontextlost",t=>{t.preventDefault(),delete Ne[e]},!1),eT.getBool("SOFTWARE_WEBGL_ENABLED")&&(Nt.failIfMajorPerformanceCaveat=!1),1===e)?n.getContext("webgl",Nt)||n.getContext("experimental-webgl",Nt):n.getContext("webgl2",Nt)}(e,t);if(null===n)return console.log("Could not get context for WebGL version",e),null;Ne[e]=n}let n=Ne[e];return null==n||n.isContextLost()?(delete Ne[e],Na(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),Ne[e])}var cs=cs;function Nr(e){let t=Math.ceil(cs.sizeFromShape(e)/4);return cs.sizeToSquarishShape(t)}function Ni(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function Ns(e,t){let n,a,r,i,s,o,l,c,u,h;return 2===eT.getNumber("WEBGL_VERSION")?(n=e.R32F,a=e.R16F,r=e.RGBA16F,i=e.RGBA32F,s=e.RED,l=4,c=1,u=e.HALF_FLOAT,h=e.FLOAT,o=e.RGBA8):(n=e.RGBA,a=e.RGBA,r=e.RGBA,i=e.RGBA,s=e.RGBA,l=4,c=4,u=null!=t?t.HALF_FLOAT_OES:null,h=e.FLOAT,o=e.RGBA),{internalFormatFloat:n,internalFormatHalfFloat:a,internalFormatPackedHalfFloat:r,internalFormatPackedFloat:i,textureFormatFloat:s,downloadTextureFormat:o,downloadUnpackNumChannels:l,defaultNumChannels:c,textureTypeHalfFloat:u,textureTypeFloat:h}}function No(e,t){let n=t();return eT.getBool("DEBUG")&&function(e){let t=e.getError();if(t!==e.NO_ERROR)throw Error("WebGL Error: "+Nc(e,t))}(e),n}function Nl(e){return!!(eT.getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||596e-10<Math.abs(e)&&65504>Math.abs(e))}function Nc(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code ".concat(t)}}function Nu(e,t){return NO(e,()=>e.getExtension(t),'Extension "'+t+'" not supported on this browser.')}function Nh(e,t){let n=NO(e,()=>e.createShader(e.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(No(e,()=>e.shaderSource(n,t)),No(e,()=>e.compileShader(n)),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(n)),Error("Failed to compile vertex shader.");return n}function Nd(e,t){let n=NO(e,()=>e.createShader(e.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(No(e,()=>e.shaderSource(n,t)),No(e,()=>e.compileShader(n)),eT.get("ENGINE_COMPILE_ONLY"))return n;if(!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw Nf(t,e.getShaderInfoLog(n)),Error("Failed to compile fragment shader.");return n}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(v||(v={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(w||(w={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(N||(N={}));let Np=/ERROR: [0-9]+:([0-9]+):/g;function Nf(e,t){let n=Np.exec(t);if(null==n){console.log("Couldn't parse line number in error: ".concat(t)),console.log(e);return}let a=+n[1],r=e.split("\n"),i=r.length.toString().length+2,s=r.map((e,t)=>cs.rightPad((t+1).toString(),i)+e),o=0;for(let e=0;e<s.length;e++)o=Math.max(s[e].length,o);let l=s.slice(0,a-1),c=s.slice(a-1,a),u=s.slice(a);console.log(l.join("\n")),console.log(t.split("\n")[0]),console.log("%c ".concat(cs.rightPad(c[0],o)),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join("\n"))}function Nm(e){return NO(e,()=>e.createProgram(),"Unable to create WebGLProgram.")}function Ng(e,t){if(No(e,()=>e.linkProgram(t)),!eT.get("ENGINE_COMPILE_ONLY")&&!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),Error("Failed to link vertex and fragment shaders.")}function Nx(e,t){if(No(e,()=>e.validateProgram(t)),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),Error("Shader program validation failed.")}function Ny(e,t){let n=NO(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return No(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),No(e,()=>e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)),n}function Nb(e,t){let n=NO(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return No(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)),No(e,()=>e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)),n}function Nv(){return 2===eT.getNumber("WEBGL_VERSION")?1:4}function Nw(e){return NO(e,()=>e.createTexture(),"Unable to create WebGLTexture.")}function NN(e,t){let n=eT.getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0)throw Error("Requested texture size "+"[".concat(e,"x").concat(t,"]")+" is invalid.");if(e>n||t>n)throw Error("Requested texture size "+"[".concat(e,"x").concat(t,"]")+" greater than WebGL maximum on this browser / GPU "+"[".concat(n,"x").concat(n,"]")+".")}function Nk(e){return NO(e,()=>e.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function NS(e,t,n,a,r,i,s){let o=e.getAttribLocation(t,n);return -1!==o&&(No(e,()=>e.bindBuffer(e.ARRAY_BUFFER,a)),No(e,()=>e.vertexAttribPointer(o,r,e.FLOAT,!1,i,s)),No(e,()=>e.enableVertexAttribArray(o)),!0)}function NC(e,t,n){NP(e,n),No(e,()=>e.activeTexture(e.TEXTURE0+n)),No(e,()=>e.bindTexture(e.TEXTURE_2D,t))}function NT(e,t){NP(e,t),No(e,()=>e.activeTexture(e.TEXTURE0+t)),No(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function NI(e,t,n){return NO(e,()=>e.getUniformLocation(t,n),'uniform "'+n+'" not present in program.')}function NE(e,t,n){return e.getUniformLocation(t,n)}function N_(e,t,n,a){No(e,()=>NC(e,t,a)),No(e,()=>e.uniform1i(n,a))}function NA(e){No(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),No(e,()=>e.viewport(0,0,e.canvas.width,e.canvas.height)),No(e,()=>e.scissor(0,0,e.canvas.width,e.canvas.height))}function NR(e,t,n){No(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,n)),No(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0))}function ND(e,t){No(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,t)),No(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0))}function NM(e){let t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw Error("Error binding framebuffer: "+NF(e,t))}function NF(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error ".concat(t)}}function NO(e,t,n){let a=No(e,()=>t());if(null==a)throw Error(n);return a}function NP(e,t){let n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,a=t+e.TEXTURE0;if(a<e.TEXTURE0||a>n)throw Error("textureUnit must be in ".concat("[gl.TEXTURE0, gl.TEXTURE".concat(n,"]"),"."))}function Nj(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return cs.sizeFromShape(e.slice(0,e.length-t))}function NL(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function Nz(e){let t=[1,1,1];return 0!==e.length&&(1!==e.length||1!==e[0])&&(t=[Nj(e),...NL(e)]),t}function NB(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=eT.getNumber("WEBGL_MAX_TEXTURE_SIZE"),a=eT.getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");a===1/0&&eT.getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(a=n/2),t&&(n*=2,a*=2,1===(e=e.map((t,n)=>n>=e.length-2?cs.nearestLargerEven(e[n]):e[n])).length&&(e=[2,e[0]])),2!==e.length&&(e=cs.squeezeShape(e).newShape);let r=cs.sizeFromShape(e),i=null;e.length<=1&&r<=n?i=[1,r]:2===e.length&&e[0]<=n&&e[1]<=n?i=e:3===e.length&&e[0]*e[1]<=n&&e[2]<=n?i=[e[0]*e[1],e[2]]:3===e.length&&e[0]<=n&&e[1]*e[2]<=n?i=[e[0],e[1]*e[2]]:4===e.length&&e[0]*e[1]*e[2]<=n&&e[3]<=n?i=[e[0]*e[1]*e[2],e[3]]:4===e.length&&e[0]<=n&&e[1]*e[2]*e[3]<=n&&(i=[e[0],e[1]*e[2]*e[3]]);let s=null!=i&&Math.max(...i)>a&&Math.min(...i)<=(t?2:1)&&Math.min(...i)>0;if(null==i||s)if(t){let t=Nj(e),n=2,a=2;e.length&&([n,a]=NL(e)),r=n/2*t*(a/2),i=cs.sizeToSquarishShape(r).map(e=>2*e)}else i=cs.sizeToSquarishShape(r);return i}function NV(e,t){if(e=e.slice(-2),t=t.slice(-2),cs.arraysEqual(e,t)||!e.length||!t.length||0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){let n=e[e.length-1],a=t[t.length-1];if(n===a||n%2==0&&a%2==0&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&e[0]%2==0&&t[0]%2==0}function NU(e){if(null==s){let t=Na(e);s=t.getParameter(t.MAX_TEXTURE_SIZE)}return s}function NW(){s=null}function NG(){o=null}function NH(e){if(null==o){let t=Na(e);o=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,o)}function Nq(e){if(0===e)return 0;let t=Na(e);return NK(t,"EXT_disjoint_timer_query_webgl2")&&2===e?2:+!!NK(t,"EXT_disjoint_timer_query")}function NK(e,t){return null!=e.getExtension(t)}function NX(e){try{let t=Na(e);if(null!=t)return!0}catch(e){console.log("Error when getting WebGL context: ",e)}return!1}function NY(e){if(0===e)return!1;let t=Na(e);if(1===e){if(!NK(t,"OES_texture_float"))return!1}else if(!NK(t,"EXT_color_buffer_float"))return!1;return NQ(t)}function NZ(e){if(0===e)return!1;let t=Na(e);if(1===e){if(!NK(t,"OES_texture_float")||!NK(t,"WEBGL_color_buffer_float"))return!1}else{if(NK(t,"EXT_color_buffer_float"))return NQ(t);let e="EXT_color_buffer_half_float";if(NK(t,e)){let r=t.getExtension(e);var n=t,a=r;let i=Ns(n,a),s=n.createTexture();n.bindTexture(n.TEXTURE_2D,s),n.texImage2D(n.TEXTURE_2D,0,i.internalFormatHalfFloat,1,1,0,i.textureFormatFloat,i.textureTypeHalfFloat,null);let o=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,o),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,s,0);let l=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(s),n.deleteFramebuffer(o),l}return!1}return NQ(t)}function NQ(e){let t=Ns(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);let a=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,a),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);let r=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(a),r}function NJ(e){return 2===e&&null!=Na(e).fenceSync}function N$(e,t){Array.isArray(e)||(e=[e]),e.forEach(e=>{null!=e&&cs.assert("complex64"!==e.dtype,()=>"".concat(t," does not support complex64 tensors ")+"in the WebGL backend.")})}let N0=eT;N0.registerFlag("HAS_WEBGL",()=>N0.getNumber("WEBGL_VERSION")>0),N0.registerFlag("WEBGL_VERSION",()=>NX(2)?2:+!!NX(1)),N0.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1),N0.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>2===N0.get("WEBGL_VERSION")),N0.registerFlag("WEBGL_CPU_FORWARD",()=>!0),N0.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1),N0.registerFlag("WEBGL_PACK",()=>N0.getBool("HAS_WEBGL")),N0.registerFlag("WEBGL_PACK_NORMALIZATION",()=>N0.getBool("WEBGL_PACK")),N0.registerFlag("WEBGL_PACK_CLIP",()=>N0.getBool("WEBGL_PACK")),N0.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>N0.getBool("WEBGL_PACK")),N0.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>N0.getBool("WEBGL_PACK")),N0.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>N0.getBool("WEBGL_PACK")),N0.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>N0.getBool("WEBGL_PACK")),N0.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>N0.getBool("WEBGL_PACK")),N0.registerFlag("WEBGL_PACK_REDUCE",()=>N0.getBool("WEBGL_PACK")),N0.registerFlag("WEBGL_LAZILY_UNPACK",()=>N0.getBool("WEBGL_PACK")),N0.registerFlag("WEBGL_CONV_IM2COL",()=>N0.getBool("WEBGL_PACK")),N0.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>N0.getBool("WEBGL_PACK")),N0.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>NU(N0.getNumber("WEBGL_VERSION"))),N0.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>NH(N0.getNumber("WEBGL_VERSION"))),N0.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{let e=N0.getNumber("WEBGL_VERSION");return 0===e?0:Nq(e)}),N0.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>N0.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!w7.isMobile()),N0.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>NY(N0.getNumber("WEBGL_VERSION"))),N0.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>!N0.getBool("WEBGL_FORCE_F16_TEXTURES")&&N0.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")),N0.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>NZ(N0.getNumber("WEBGL_VERSION"))),N0.registerFlag("WEBGL_FENCE_API_ENABLED",()=>NJ(N0.getNumber("WEBGL_VERSION"))),N0.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>4*!!N0.getBool("WEBGL_RENDER_FLOAT32_ENABLED")),N0.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,e=>{if("number"!=typeof e)throw Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but "+"got ".concat(e,"."));if(e<0&&-1!==e)throw Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never "+"delete) or at least 0, but got ".concat(e,"."))}),N0.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>w7.isMobile()?1:-1,e=>{if("number"!=typeof e)throw Error("WEBGL_FLUSH_THRESHOLD must be a number but got "+"".concat(e,"."));if(e<0&&-1!==e)throw Error("WEBGL_FLUSH_THRESHOLD must be -1 (indicating never "+"manual flush) or at least 0, but got ".concat(e,"."))}),N0.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128),N0.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1),N0.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5),N0.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128),N0.registerFlag("WEBGL_EXP_CONV",()=>!1),N0.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>N0.getBool("IS_TEST")),N0.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0),N0.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1),N0.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1),N0.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);var oB=oB,bb=bb,cs=cs;function N1(){let e,t,n,a,r,i,s,o,l,c;return 2===eT.getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",a="in",r="texture",i="outputColor",s="out vec4 outputColor;",o=eT.getBool("WEBGL2_ISNAN_CUSTOM")?"\n      bool isnan_custom(float val) {\n        uint floatToUint = floatBitsToUint(val);\n        return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ":"",l="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",a="varying",r="texture2D",i="gl_FragColor",s="",o="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",l="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:a,texture2D:r,output:i,defineOutput:s,defineSpecialNaN:o,defineSpecialInf:l,defineRound:c}}var oB=oB,cs=cs,oB=oB,cs=cs,cs=cs;function N2(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",a=cs.computeStrides(t);return a.map((t,r)=>{let i="int ".concat(e[r]," = ").concat(n," / ").concat(t),s=r===a.length-1?"int ".concat(e[r+1]," = ").concat(n," - ").concat(e[r]," * ").concat(t):"index -= ".concat(e[r]," * ").concat(t);return"".concat(i,"; ").concat(s,";")}).join("")}function N3(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",a=cs.computeStrides(t);return a.map((t,r)=>{let i="int ".concat(e[r]," = ").concat(n," / outShapeStrides[").concat(r,"]"),s=r===a.length-1?"int ".concat(e[r+1]," = ").concat(n," - ").concat(e[r]," * outShapeStrides[").concat(r,"]"):"index -= ".concat(e[r]," * outShapeStrides[").concat(r,"]");return"".concat(i,"; ").concat(s,";")}).join("")}function N4(e){let t=cs.computeStrides(e).map(e=>e.toString());return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(t[0]," + coords.y * ").concat(t[1]," + coords.z;\n  }\n")}function N5(){return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n"}let N6="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",{getBroadcastDims:N8}=oB;function N9(){return"\n    int getOutputCoords() {\n      return 0;\n    }\n  "}function N7(e){return"offset".concat(e)}function ke(e){let t=e.name,n=cs.sizeFromShape(e.shapeInfo.logicalShape);return n<2?"return ".concat(t,";"):"\n    for (int i = 0; i < ".concat(n,"; i++) {\n      if (i == index) {\n        return ").concat(t,"[i];\n      }\n    }\n  ")}function kt(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";else if(6===e)return"ivec6";else throw Error("GPU for rank ".concat(e," is not yet supported"))}function kn(e,t,n){let{newShape:a,keptDims:r}=cs.squeezeShape(t),i=t.length,s=e&&3===i&&1===t[0],o=s?t.slice(1):a,l=!e&&i>1&&!cs.arraysEqual(t,n)&&a.length<i||s,c=l?o:t;return{useSqueezeShape:l,uniformShape:c,keptDims:r}}function ka(e,t){let n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function kr(e,t){return t.map(t=>e[t]).join(", ")}function ki(e,t,n){let a,r,i,s=[],o=[],l=null,c=null;for(let a of(c=e.getUniformLocation(n,"NAN",!1),1===eT.getNumber("WEBGL_VERSION")&&(l=e.getUniformLocation(n,"INFINITY",!1)),t.variableNames)){let r={name:a,uniform:e.getUniformLocation(n,a,!1),offset:e.getUniformLocation(n,"offset".concat(a),!1)};t.enableShapeUniforms&&(r.shape=e.getUniformLocation(n,"".concat(a,"Shape"),!1),r.texShape=e.getUniformLocation(n,"".concat(a,"TexShape"),!1)),s.push(r)}if(t.enableShapeUniforms&&(a=e.getUniformLocation(n,"outShape",!1),i=e.getUniformLocation(n,"outShapeStrides",!1),r=e.getUniformLocation(n,"outTexShape",!1)),t.customUniforms)for(let a of t.customUniforms)o.push(e.getUniformLocation(n,a.name,!1));return{variablesLocations:s,customUniformLocations:o,infLoc:l,nanLoc:c,outShapeLocation:a,outShapeStridesLocation:i,outTexShapeLocation:r}}function ks(e,t){if(e.length!==t.length)throw Error("Binary was compiled with ".concat(e.length," inputs, but ")+"was executed with ".concat(t.length," inputs"));e.forEach((e,n)=>{let a=e.logicalShape,r=t[n],i=r.shape;if(!cs.arraysEqual(a,i))throw Error("Binary was compiled with different shapes than "+"the current args. Shapes ".concat(a," and ").concat(i," must match"));if(e.isUniform&&r.isUniform)return;let s=e.texShape,o=r.isUniform?null:r.texData.texShape;if(!cs.arraysEqual(s,o))throw Error("Binary was compiled with different texture shapes than the"+" current args. Shape ".concat(s," and ").concat(o," must match"))})}function ko(e){return eT.getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}class kl{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=v.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];let t=N1();this.outputShape=e,this.enableShapeUniforms=ko(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?N3(["r","c","d"],e):N2(["r","c","d"],e),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(t.output," = result;\n      }\n    ")}}class kc{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=v.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];let t=N1();this.outputShape=e,this.enableShapeUniforms=ko(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?N3(["r","c","d"],e):N2(["r","c","d"],e),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(t.output," = result;\n      }\n    ")}}class ku{constructor(e){this.variableNames=["A"],this.outTexUsage=w.DOWNLOAD;let t=N1();this.outputShape=e,this.userCode="\n      ".concat(N6,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(t.output," = encode_float(x);\n      }\n    ")}}class kh{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=w.DOWNLOAD;let t=N1();this.outputShape=e,this.userCode="\n      ".concat(N6,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(t.output," = encode_float(x);\n      }\n    ")}}let kd={R:0,G:1,B:2,A:3};class kp{constructor(e,t=!1,n="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];let a=N1();this.outputShape=e,this.enableShapeUniforms=ko(this.outputShape.length);let r="result";t&&(r="floor(result * 255. + 0.5)");let i="";for(let e=0;e<n.length;e++){let t=n[e];i+="\n          if(offset == ".concat(e,") {\n            result = values[").concat(kd[t],"];\n          }")}this.userCode="\n      ".concat(this.enableShapeUniforms?N5():N4(e),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int flatIndex = getFlatIndex(coords);\n        float result = 0.;\n        int offset = imod(flatIndex, ").concat(n.length,");\n\n        flatIndex = idiv(flatIndex, ").concat(n.length,", 1.);\n\n        int r = flatIndex / texShape[1];\n        if (r < texShape[0]) {\n          int c = imod(flatIndex, texShape[1]);\n          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n          vec4 values = ").concat(a.texture2D,"(A, uv);\n          ").concat(i,"\n        }\n        ").concat(a.output," = vec4(").concat(r,", 0., 0., 0.);\n      }\n    ")}}class kf{constructor(e,t=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];let n=N1();this.outputShape=e,this.enableShapeUniforms=ko(this.outputShape.length);let a="",r="result";t&&(r="floor(result * 255. + 0.5)");for(let t=0;t<=1;t++)for(let r=0;r<=1;r++){let i=2*t+r;a+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(r," < ").concat(this.enableShapeUniforms?"outShape[2]":"".concat(e[2]),") {\n          localCoords[2] += ").concat(r,";\n          if (localCoords[1] + ").concat(t," < ").concat(this.enableShapeUniforms?"outShape[1]":"".concat(e[1]),") {\n            localCoords[1] += ").concat(t,";\n\n            flatIndex = getFlatIndex(localCoords);\n            offset = imod(flatIndex, 4);\n\n            flatIndex = idiv(flatIndex, 4, 1.);\n\n            int r = flatIndex / texShape[1];\n            int c = imod(flatIndex, texShape[1]);\n            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n            values = ").concat(n.texture2D,"(A, uv);\n\n            if (offset == 0) {\n              result[").concat(i,"] = values[0];\n            } else if (offset == 1) {\n              result[").concat(i,"] = values[1];\n            } else if (offset == 2) {\n              result[").concat(i,"] = values[2];\n            } else {\n              result[").concat(i,"] = values[3];\n            }\n          }\n        }\n        ")}this.userCode="\n        ".concat(this.enableShapeUniforms?N5():N4(e),"\n\n        void main() {\n          ivec3 coords = getOutputCoords();\n\n          vec4 result = vec4(0.);\n          int flatIndex, r, c, offset;\n          ivec3 localCoords;\n          vec2 uv;\n          vec4 values;\n\n          ").concat(a,"\n\n          ").concat(n.output," = ").concat(r,";\n        }\n    ")}}var cs=cs;function km(e){let t=N1();return Nh(e,"".concat(t.version,"\n    precision highp float;\n    ").concat(t.attribute," vec3 clipSpacePos;\n    ").concat(t.attribute," vec2 uv;\n    ").concat(t.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }"))}function kg(e){return Ny(e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function kx(e){return Nb(e,new Uint16Array([0,1,2,2,1,3]))}function ky(e,t,n,a,r,i){NN(t,n);let s=Nw(e),o=e.TEXTURE_2D;return No(e,()=>e.bindTexture(o,s)),No(e,()=>e.texParameteri(o,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)),No(e,()=>e.texParameteri(o,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),No(e,()=>e.texParameteri(o,e.TEXTURE_MIN_FILTER,e.NEAREST)),No(e,()=>e.texParameteri(o,e.TEXTURE_MAG_FILTER,e.NEAREST)),1===eT.getNumber("WEBGL_VERSION")?No(e,()=>e.texImage2D(o,0,a,t,n,0,r,i,null)):No(e,()=>e.texStorage2D(o,1,a,t,n)),No(e,()=>e.bindTexture(e.TEXTURE_2D,null)),{texture:s,texShape:[n,t]}}function kb(e){return e.internalFormatFloat}function kv(e,t,n,a){let[r,i]=[n,t];return ky(e,r,i,kb(a),a.textureFormatFloat,e.FLOAT)}function kw(e){return e.internalFormatHalfFloat}function kN(e,t,n,a){let[r,i]=[n,t];return ky(e,r,i,kw(a),a.textureFormatFloat,a.textureTypeHalfFloat)}function kk(e){return e.downloadTextureFormat}function kS(e,t,n,a){let[r,i]=[n,t];return ky(e,r,i,kk(a),e.RGBA,e.UNSIGNED_BYTE)}function kC(e){return e.internalFormatPackedFloat}function kT(e,t,n,a){let[r,i]=Ni(t,n);return ky(e,r,i,kC(a),e.RGBA,e.FLOAT)}function kI(e){return e.internalFormatPackedHalfFloat}function kE(e,t,n,a){let[r,i]=Ni(t,n);return ky(e,r,i,kI(a),e.RGBA,a.textureTypeHalfFloat)}function k_(e,t,n){return No(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),NS(e,t,"clipSpacePos",n,3,20,0)&&NS(e,t,"uv",n,2,20,12)}function kA(e,t,n,a,r,i){let s,o,l;No(e,()=>e.bindTexture(e.TEXTURE_2D,t)),r instanceof Uint8Array?(s=new Uint8Array(n*a*4),o=e.UNSIGNED_BYTE,l=e.RGBA):(s=new Float32Array(n*a*4),o=e.FLOAT,l=i.internalFormatPackedFloat),s.set(r),2===eT.getNumber("WEBGL_VERSION")?No(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,a,e.RGBA,o,s)):No(e,()=>e.texImage2D(e.TEXTURE_2D,0,l,n,a,0,e.RGBA,o,s)),No(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function kR(e,t,n){No(e,()=>e.bindTexture(e.TEXTURE_2D,t)),n.data instanceof Uint8Array?2===eT.getNumber("WEBGL_VERSION")?No(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,e.RGBA,e.UNSIGNED_BYTE,n.data)):No(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)):2===eT.getNumber("WEBGL_VERSION")?No(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,n)):No(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)),No(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function kD(e,t,n,a){let r=e.createBuffer();No(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,r));let i=16*t*n;return No(e,()=>e.bufferData(e.PIXEL_PACK_BUFFER,i,e.STREAM_READ)),No(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)),No(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,null)),r}function kM(e,t,n){let a=new Float32Array(n);return e.bindBuffer(e.PIXEL_PACK_BUFFER,t),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,a),e.bindBuffer(e.PIXEL_PACK_BUFFER,null),a}function kF(e,t,n,a){let[r,i]=[n,t],s=new Uint8Array(t*n*4);return No(e,()=>e.readPixels(0,0,r,i,a.downloadTextureFormat,e.UNSIGNED_BYTE,s)),new Float32Array(s.buffer)}function kO(e,t,n,a,r,i,s,o){let l=new Float32Array(function(e,t){let[n,a]=Ni(e,t);return n*a*4}(i,s));return e.bindBuffer(e.PIXEL_PACK_BUFFER,t),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,l),e.bindBuffer(e.PIXEL_PACK_BUFFER,null),l}function kP(e,t,n){let a=new Float32Array(t*n*4);return No(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,a)),a}e.s(["bindVertexProgramAttributeStreams",()=>k_,"createBufferFromOutputTexture",()=>kD,"createFloat16MatrixTexture",()=>kN,"createFloat16PackedMatrixTexture",()=>kE,"createFloat32MatrixTexture",()=>kv,"createIndexBuffer",()=>kx,"createPackedMatrixTexture",()=>kT,"createUnsignedBytesMatrixTexture",()=>kS,"createVertexBuffer",()=>kg,"createVertexShader",()=>km,"downloadByteEncodedFloatMatrixFromOutputTexture",()=>kF,"downloadFloat32MatrixFromBuffer",()=>kM,"downloadMatrixFromPackedOutputTexture",()=>kP,"downloadPackedMatrixFromBuffer",()=>kO,"getInternalFormatForFloat16MatrixTexture",()=>kw,"getInternalFormatForFloat16PackedMatrixTexture",()=>kI,"getInternalFormatForFloat32MatrixTexture",()=>kb,"getInternalFormatForPackedMatrixTexture",()=>kC,"getInternalFormatForUnsignedBytesMatrixTexture",()=>kk,"uploadDenseMatrixToTexture",()=>kA,"uploadPixelDataToTexture",()=>kR],70798);class kj{get debug(){return eT.getBool("DEBUG")}dispose(){if(this.disposed)return;null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");let e=this.gl;No(e,()=>e.finish()),No(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),No(e,()=>e.deleteFramebuffer(this.framebuffer)),No(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),No(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),No(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),kv(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),kN(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),kS(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),kR(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,n,a){this.throwIfDisposed(),kA(this.gl,e,t,n,a,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),kE(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),kT(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(ND(this.gl,this.framebuffer),this.outputTexture=null),No(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,n){return this.downloadMatrixDriver(e,()=>kF(this.gl,t,n,this.textureConfig))}downloadPackedMatrixFromBuffer(e,t,n,a,r,i){return kO(this.gl,e,t,n,a,r,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return kM(this.gl,e,t)}createBufferFromTexture(e,t,n){this.bindTextureToFrameBuffer(e);let a=kD(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),a}createAndWaitForFence(){let e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,n;if(eT.getBool("WEBGL_FENCE_API_ENABLED")){let a=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=()=>{let t=e.clientWaitSync(a,0,0);return t===e.ALREADY_SIGNALED||t===e.CONDITION_SATISFIED},t=a}else eT.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(t,eT.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:t,isFencePassed:n}}downloadMatrixFromPackedTexture(e,t,n){return this.downloadMatrixDriver(e,()=>kP(this.gl,t,n))}createProgram(e){this.throwIfDisposed();let t=this.gl;null==this.vertexShader&&(this.vertexShader=km(t));let n=Nm(t);No(t,()=>t.attachShader(n,this.vertexShader)),No(t,()=>t.attachShader(n,e)),Ng(t,n);let a=Object.assign(n,{vao:this.createVertexArray()});return this.debug&&Nx(t,a),a}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);let t=this.gl;No(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),k_(t,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&(No(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&Nx(this.gl,this.program),No(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,t){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return(this.throwIfDisposed(),n)?NI(this.gl,e,t):NE(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),No(this.gl,()=>this.gl.getAttribLocation(e,t))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),N_(this.gl,e,t,n)}setOutputMatrixTexture(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}setOutputPackedMatrixTexture(e,t,n){this.throwIfDisposed();let[a,r]=Ni(t,n);this.setOutputMatrixTextureDriver(e,a,r)}setOutputMatrixWriteRegion(e,t,n,a){this.setOutputMatrixWriteRegionDriver(n,e,a,t)}setOutputPackedMatrixWriteRegion(e,t,n,a){throw Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){null!=this.program&&Nx(this.gl,this.program),NM(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();let e=this.gl;this.debug&&(console.assert(this.getVertexArray()===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()),No(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),No(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=Nu(this.gl,2===eT.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(2===eT.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){let e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}let e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(2===eT.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){let e=this.gl,t=this.getQueryTimerExtensionWebGL2();e.endQuery(t.TIME_ELAPSED_EXT);return}let e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await cs.repeatedTry(()=>this.disposed||this.isQueryAvailable(e,eT.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,eT.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(0===t)return null;if(2===t){let t=this.gl;return t.getQueryParameter(e,t.QUERY_RESULT)/1e6}{let t=this.getQueryTimerExtensionWebGL1();return t.getQueryObjectEXT(e,t.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(0===t)return!0;if(2===t){let t=this.gl,n=this.getQueryTimerExtensionWebGL2(),a=t.getQueryParameter(e,t.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),a&&!this.disjoint}{let t=this.getQueryTimerExtensionWebGL1(),n=t.getQueryObjectEXT(e,t.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(t.GPU_DISJOINT_EXT)),n&&!this.disjoint}}pollFence(e){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})}pollItems(){let e=function(e){let t=0;for(;t<e.length&&e[t]();++t);return t-1}(this.itemsToPoll.map(e=>e.isDoneFn));for(let t=0;t<=e;++t){let{resolveFn:e}=this.itemsToPoll[t];e()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){let n;this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1||("setTimeoutCustom"in eT.platform&&(n=eT.platform.setTimeoutCustom.bind(eT.platform)),cs.repeatedTry(()=>(this.pollItems(),0===this.itemsToPoll.length),()=>0,null,n))}bindTextureToFrameBuffer(e){this.throwIfDisposed(),NR(this.gl,e,this.framebuffer),this.debug&&NM(this.gl)}unbindTextureToFrameBuffer(){null!=this.outputTexture?(NR(this.gl,this.outputTexture,this.framebuffer),this.debug&&NM(this.gl)):ND(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);let n=t();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(e,t,n){this.throwIfDisposed();let a=this.gl;NR(a,e,this.framebuffer),this.debug&&NM(a),this.outputTexture=e,No(a,()=>a.viewport(0,0,t,n)),No(a,()=>a.scissor(0,0,t,n))}setOutputMatrixWriteRegionDriver(e,t,n,a){this.throwIfDisposed(),No(this.gl,()=>this.gl.scissor(e,t,n,a))}throwIfDisposed(){if(this.disposed)throw Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(null==this.program)throw Error("No GPU program is currently set.")}constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];let t=eT.getNumber("WEBGL_VERSION");if(null!=e){var n;this.gl=e,n=e,Ne[t]=n}else this.gl=Na(t);if(e=this.gl,2===eT.getNumber("WEBGL_VERSION")){let t=e;this.createVertexArray=()=>No(t,()=>t.createVertexArray()),this.bindVertexArray=e=>No(t,()=>t.bindVertexArray(e)),this.deleteVertexArray=e=>No(t,()=>t.deleteVertexArray(e)),this.getVertexArray=()=>No(t,()=>t.getParameter(t.VERTEX_ARRAY_BINDING))}else if(null!=e){let t=e.getExtension("OES_vertex_array_object");if(null==t)throw Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>No(e,()=>t.createVertexArrayOES()),this.bindVertexArray=n=>No(e,()=>t.bindVertexArrayOES(n)),this.deleteVertexArray=n=>No(e,()=>t.deleteVertexArrayOES(n)),this.getVertexArray=()=>No(e,()=>e.getParameter(t.VERTEX_ARRAY_BINDING_OES))}let a="WEBGL_color_buffer_float",r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),1===eT.getNumber("WEBGL_VERSION")){let e="OES_texture_half_float";if(this.textureFloatExtension=Nu(this.gl,"OES_texture_float"),NK(this.gl,e))this.textureHalfFloatExtension=Nu(this.gl,e);else if(eT.get("WEBGL_FORCE_F16_TEXTURES"))throw Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(a),NK(this.gl,r))this.colorBufferHalfFloatExtension=Nu(this.gl,r);else if(eT.get("WEBGL_FORCE_F16_TEXTURES"))throw Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(a="EXT_color_buffer_float",NK(this.gl,a))this.colorBufferFloatExtension=this.gl.getExtension(a);else if(NK(this.gl,r))this.colorBufferHalfFloatExtension=this.gl.getExtension(r);else throw Error("GL context does not support color renderable floats");this.vertexBuffer=kg(this.gl),this.indexBuffer=kx(this.gl),this.framebuffer=Nk(this.gl),this.textureConfig=Ns(this.gl,this.textureHalfFloatExtension)}}let{addImpl:kL,bincountImpl:kz,bincountReduceImpl:kB,bitwiseAndImpl:kV,castImpl:kU,ceilImpl:kW,concatImpl:kG,equalImpl:kH,expImpl:kq,expm1Impl:kK,floorImpl:kX,gatherNdImpl:kY,gatherV2Impl:kZ,greaterImpl:kQ,greaterEqualImpl:kJ,lessImpl:k$,lessEqualImpl:k0,linSpaceImpl:k1,logImpl:k2,maxImpl:k3,maximumImpl:k4,minimumImpl:k5,multiplyImpl:k6,negImpl:k8,notEqualImpl:k9,prodImpl:k7,raggedGatherImpl:Se,raggedRangeImpl:St,raggedTensorToTensorImpl:Sn,rangeImpl:Sa,rsqrtImpl:Sr,scatterImpl:Si,sigmoidImpl:Ss,simpleAbsImpl:So,sliceImpl:Sl,sparseFillEmptyRowsImpl:Sc,sparseReshapeImpl:Su,sparseSegmentReductionImpl:Sh,sqrtImpl:Sd,staticRegexReplaceImpl:Sp,stridedSliceImpl:Sf,stringNGramsImpl:Sm,stringSplitImpl:Sg,stringToHashBucketFastImpl:Sx,subImpl:Sy,tileImpl:Sb,topKImpl:Sv,transposeImpl:Sw,uniqueImpl:SN}=v0;function Sk(e,t){return["x","y","z","w","u","v"].slice(0,t).map(t=>"".concat(e,".").concat(t))}function SS(e,t){return 1===t?[e]:Sk(e,t)}class SC{getSourceCoordsArr(e){let t=[];for(let n=0;n<=1;n++)for(let a=0;a<=1;a++){let r="".concat(0===n?"r":"rp1",", ").concat(0===a?"c":"cp1");for(let t=2;t<this.rank;t++)r="".concat(e[e.length-1-t],",")+r;t.push(r)}return t}getOutOfBoundsCondition(e){if(1===this.rank)return"rc > ".concat(this.enableShapeUniforms?"outShape":this.outputShape[0]);let t="";for(let n=this.rank-2;n<this.rank;n++)t+="".concat(e[n]," >= ").concat(this.enableShapeUniforms?"outShape[".concat(n,"]"):this.outputShape[n]),n<this.rank-1&&(t+="||");return t}getSetup(e){if(1===this.rank)return"";let t=e.slice(-2),n=this.enableShapeUniforms?"outShape[".concat(this.rank," - 1]"):this.outputShape[this.rank-1],a=this.enableShapeUniforms?"outShape[".concat(this.rank," - 2]"):this.outputShape[this.rank-2];return"\n      int r = ".concat(t[0],";\n      int c = ").concat(t[1],";\n      int rp1 = r + 1;\n      int cp1 = c + 1;\n\n      bool cEdge = cp1 >= ").concat(n,";\n      bool rEdge = rp1 >= ").concat(a,";\n    ")}getOutput(e){let t=this.getSourceCoordsArr(e);if(1===this.rank){let e=this.enableShapeUniforms?"outShape":this.outputShape[0];return"getA(rc), (rc + 1 >= ".concat(e," ? 0. : getA(rc + 1)), 0, 0")}return"getA(".concat(t[0],"),\n            cEdge ? 0. : getA(").concat(t[1],"),\n            rEdge ? 0. : getA(").concat(t[2],"),\n            rEdge || cEdge ? 0. : getA(").concat(t[3],")")}constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=ko(this.outputShape.length),0===this.rank)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{let e=SS("rc",this.rank),t=kt(this.rank),n=this.getOutOfBoundsCondition(e),a=this.getSetup(e),r=this.getOutput(e);this.userCode="\n        void main() {\n          ".concat(t," rc = getOutputCoords();\n\n          if(").concat(n,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(a,"\n\n            setOutput(vec4(").concat(r,"));\n          }\n        }\n      ")}}}class ST{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=ko(this.outputShape.length);let n="";for(let e=0;e<4;e++){let t="thisRC = rc;";e%2==1&&(t+="thisRC.z += 1;"),e>1&&(t+="thisRC.y += 1;"),n+="\n        ".concat(t,"\n        ").concat(e>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(e,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(e>0?"}":"","\n      ")}this.userCode="\n      ".concat(function(e,t){let n=t?function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",a=function(e,t){let n=e.length,a=e.map(e=>"".concat(t,"[").concat(e,"]")),r=Array(n-1);r[n-2]=a[n-1];for(let e=n-3;e>=0;--e)r[e]="(".concat(r[e+1]," * ").concat(a[e+1],")");return r}(e.map((e,t)=>t),t);return a.map((t,r)=>{let i="int ".concat(e[r]," = ").concat(n," / ").concat(a[r]),s=r===a.length-1?"int ".concat(e[r+1]," = ").concat(n," - ").concat(e[r]," * ").concat(a[r]):"index -= ".concat(e[r]," * ").concat(a[r]);return"".concat(i,"; ").concat(s,";")}).join("")}(["r","c","d"],"inputShape"):N2(["r","c","d"],e);return"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(n,"\n      return ivec3(r, c, d);\n    }\n  ")}(t,this.enableShapeUniforms),"\n      ").concat(this.enableShapeUniforms?N5():N4(e),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(this.enableShapeUniforms?"outShape[1]":e[1],";\n        int cols = ").concat(this.enableShapeUniforms?"outShape[2]":e[2],";\n\n        ").concat(n,"\n\n        setOutput(result);\n      }\n    ")}}class SI{acquireTexture(e,t,n){let a,r=S_(t,n),i=SA(e,r,n);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);let s=SE(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=s,this.log();let e=this.freeTextures[i].pop();return this.usedTextures[i].push(e),e}return r===N.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===N.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===N.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===N.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===N.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(a),this.numUsedTextures++,this._numBytesAllocated+=s,this.log(),a}releaseTexture(e,t,n,a){if(null==this.freeTextures)return;let r=S_(n,a),i=SA(t,r,a);i in this.freeTextures||(this.freeTextures[i]=[]);let s=SE(t,r,this.gpgpu.gl,this.gpgpu.textureConfig,a),o=eT.getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==o&&this._numBytesAllocated>o?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=s):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=s),this.numUsedTextures--;let l=this.usedTextures[i],c=l&&l.indexOf(e);if(null==c||c<0)throw Error("Cannot release a texture that was never provided by this texture manager");l[c]=l[l.length-1],l.pop(),this.log()}log(){if(!this.logEnabled)return;let e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(e,")"));let t=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: ".concat(this._numBytesAllocated)),console.log("Bytes unused: ".concat(this._numBytesFree," (").concat(Math.round(100*t),"%)"))}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(null!=this.freeTextures){for(let e in this.freeTextures)this.freeTextures[e].forEach(e=>{this.gpgpu.deleteMatrixTexture(e.texture)});for(let e in this.usedTextures)this.usedTextures[e].forEach(e=>{this.gpgpu.deleteMatrixTexture(e.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}}function SE(e,t,n,a,r){let i,s=function(e,t){switch(e){case N.PACKED_2X2_FLOAT32:return kC(t);case N.PACKED_2X2_FLOAT16:return kI(t);case N.UNPACKED_FLOAT32:return kb(t);case N.UNPACKED_FLOAT16:return kw(t);case N.PACKED_4X1_UNSIGNED_BYTE:return kk(t);default:throw Error("Unknown physical texture type ".concat(e))}}(t,a);if(r){let[t,n]=Ni(e[0],e[1]);i=t*n}else{var o;let[t,n]=(o=e[0],[e[1],o]);i=t*n}return i*function(e,t){if(t===e.R32F)return 4;if(t===e.R16F)return 2;if(t===e.RGBA32F)return 16;if(t===e.RGBA)return 16;if(t===e.RGBA16F)return 8;else if(t===e.RGBA8)return 4;throw Error("Unknown internal format ".concat(t))}(n,s)}function S_(e,t){if(e===w.UPLOAD)return N.PACKED_2X2_FLOAT32;if(e===w.RENDER||null==e)return eT.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?N.PACKED_2X2_FLOAT32:N.UNPACKED_FLOAT32:t?N.PACKED_2X2_FLOAT16:N.UNPACKED_FLOAT16;if(e===w.DOWNLOAD||e===w.PIXELS)return N.PACKED_4X1_UNSIGNED_BYTE;throw Error("Unknown logical texture type ".concat(e))}function SA(e,t,n){return"".concat(e[0],"_").concat(e[1],"_").concat(t,"_").concat(n)}class SR{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=ko(this.outputShape.length),this.userCode="\n      float unaryOperation(float x) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")}}let SD="if (isnan(x)) return x;",SM="return abs(x);",SF=SD+"\n  return (x < 0.0) ? 0.0 : x;\n",SO=SD+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",SP="return x;";class Sj{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=ko(this.outputShape.length),this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(t,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")}}class SL{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=ko(this.outputShape.length);let t=e.length,n=SS("rc",t),a=kt(t),r=function(e,t){if(1===e)return"rc";let n="";for(let a=0;a<e;a++)n+=t[a],a<e-1&&(n+=",");return n}(t,n),i=n.slice(-2),s=t<=1?"rc":"vec2(".concat(i.join(","),")");this.userCode="\n      void main() {\n        ".concat(a," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(r,");\n\n        setOutput(getChannel(packedInput, ").concat(s,"));\n      }\n    ")}}let Sz=bb.whereImpl,SB={},SV=eT.getNumber("CPU_HANDOFF_SIZE_THRESHOLD");class SU extends E{nextDataId(){return SU.nextDataId++}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,t,n,a,r,i){let s=this.makeTensorInfo(t,n),o=this.texData.get(s.dataId);o.isPacked=!1,o.texture={texture:e,texShape:[a,r]},o.texShape=[a,r];let l=new kp(Nz(t),!1,i),c=this.runWebGLProgram(l,[s],n,[[a,r]]);return c.shape=t,o.texture=null,this.disposeIntermediateTensorInfo(s),c.dataId}write(e,t,n){if((eT.getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||eT.getBool("DEBUG"))&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");let a={id:this.nextDataId()};return this.texData.set(a,{shape:t,dtype:n,values:e,usage:w.UPLOAD,refCount:1}),a}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){let t=this.texData.get(e);t.refCount++}decRef(e){if(this.texData.has(e)){let t=this.texData.get(e);t.refCount--}}move(e,t,n,a,r){if(eT.getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===a)throw Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:a,values:t,usage:w.UPLOAD,refCount:r})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){let t,n,{values:a,dtype:r,complexTensorInfos:i,slice:s,shape:o,isPacked:l}=this.texData.get(e);if(null!=s){let t;t=l?new Sj(o,SP):new SR(o,SP);let n=this.runWebGLProgram(t,[{dataId:e,shape:o,dtype:r}],r),a=this.readSync(n.dataId);return this.disposeIntermediateTensorInfo(n),a}if(null!=a)return this.convertAndCacheOnCPU(e);if("string"===r)return a;let c=null!=this.activeTimers;if(c&&(t=cs.now()),"complex64"===r){let e=this.readSync(i.real.dataId),t=this.readSync(i.imag.dataId);n=oB.mergeRealAndImagArrays(e,t)}else n=this.getValuesFromTexture(e);return c&&(this.downloadWaitMs+=cs.now()-t),this.convertAndCacheOnCPU(e,n)}async read(e){let t,n;if(this.pendingRead.has(e)){let t=this.pendingRead.get(e);return new Promise(e=>t.push(e))}let{values:a,shape:r,slice:i,dtype:s,complexTensorInfos:o,isPacked:l}=this.texData.get(e);if(null!=i){let t;t=l?new Sj(r,SP):new SR(r,SP);let n=this.runWebGLProgram(t,[{dataId:e,shape:r,dtype:s}],s),a=this.read(n.dataId);return this.disposeIntermediateTensorInfo(n),a}if(null!=a)return this.convertAndCacheOnCPU(e);if(eT.getBool("DEBUG")&&!eT.getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===eT.getNumber("WEBGL_VERSION"))throw Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c=null;if("complex64"!==s&&eT.get("WEBGL_BUFFER_SUPPORTED")){t=this.decode(e);let n=this.texData.get(t.dataId);c=this.gpgpu.createBufferFromTexture(n.texture.texture,...Nr(r))}if(this.pendingRead.set(e,[]),"complex64"!==s&&await this.gpgpu.createAndWaitForFence(),"complex64"===s){let e=await Promise.all([this.read(o.real.dataId),this.read(o.imag.dataId)]),t=e[0],a=e[1];n=oB.mergeRealAndImagArrays(t,a)}else if(null==c)n=this.getValuesFromTexture(e);else{let e=cs.sizeFromShape(r);n=this.gpgpu.downloadFloat32MatrixFromBuffer(c,e)}if(null!=t&&this.disposeIntermediateTensorInfo(t),null!=c){let e=this.gpgpu.gl;No(e,()=>e.deleteBuffer(c))}let u=this.convertAndCacheOnCPU(e,n),h=this.pendingRead.get(e);return this.pendingRead.delete(e),h.forEach(e=>e(u)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&aR.removeDataId(e,this),this.pendingDeletes--),u}readToGPU(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{values:n,shape:a,slice:r,dtype:i,isPacked:s,texture:o}=this.texData.get(e);if("complex64"===i)throw Error("Does not support reading texture for complex64 dtype.");if(null!=r){let n;n=s?new Sj(a,SP):new SR(a,SP);let r=this.runWebGLProgram(n,[{dataId:e,shape:a,dtype:i}],i),o=this.readToGPU(r,t);return this.disposeIntermediateTensorInfo(r),o}if(null==o)if(null!=n)throw Error("Data is not on GPU but on CPU.");else throw Error("There is no data on GPU or CPU.");let l=this.decode(e,t.customTexShape);return Object.assign({tensorRef:aR.makeTensorFromTensorInfo(l)},this.texData.get(l.dataId).texture)}bufferSync(e){let t=this.readSync(e.dataId);if("string"===e.dtype)try{let n=t.map(e=>cs.decodeString(e));return rD(e.shape,e.dtype,n)}catch(e){throw Error("Failed to decode encoded string bytes into utf-8")}return rD(e.shape,e.dtype,t)}checkNumericalProblems(e){if(null!=e)for(let t=0;t<e.length;t++){let n=e[t];if(!Nl(n)){if(eT.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value ".concat(n," cannot be represented with your ")+"current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value ".concat(n," cannot be represented on this device."))}}}getValuesFromTexture(e){let{shape:t,dtype:n,isPacked:a}=this.texData.get(e),r=cs.sizeFromShape(t);if(eT.getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){let n=this.decode(e),a=this.texData.get(n.dataId),i=this.gpgpu.downloadMatrixFromPackedTexture(a.texture.texture,...Nr(t)).subarray(0,r);return this.disposeIntermediateTensorInfo(n),i}let i=eT.getBool("WEBGL_PACK")&&!0===a,s=i?Nz(t):t,o=i?new kh(s):new ku(s),l=this.runWebGLProgram(o,[{shape:s,dtype:n,dataId:e}],"float32"),c=this.texData.get(l.dataId),u=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture.texture,c.texShape[0],c.texShape[1]).subarray(0,r);return this.disposeIntermediateTensorInfo(l),u}timerAvailable(){return eT.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){let t=this.activeTimers,n=[],a=!1;null==this.programTimersStack?(this.programTimersStack=n,a=!0):this.activeTimers.push(n),this.activeTimers=n,e();let r=cs.flatten(this.activeTimers.map(e=>e.query)).filter(e=>null!=e),i=cs.flatten(this.activeTimers.map(e=>e.name)).filter(e=>null!=e);this.activeTimers=t,a&&(this.programTimersStack=null);let s={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(eT.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){let e=await Promise.all(r);s.kernelMs=cs.sum(e),s.getExtraProfileInfo=()=>e.map((e,t)=>({name:i[t],ms:e})).map(e=>"".concat(e.name,": ").concat(e.ms)).join(", ")}else s.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,s})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return eT.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:cs.now(),endMs:null}}endTimer(e){return eT.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.endQuery():e.endMs=cs.now(),e}async getQueryTime(e){return eT.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.waitForQueryAndGetTime(e):e.endMs-e.startMs}disposeData(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);let{complexTensorInfos:n}=this.texData.get(e);return null!=n&&(this.disposeData(n.real.dataId,t),this.disposeData(n.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){let{texture:t,dtype:n,texShape:a,usage:r,isPacked:i,slice:s}=this.texData.get(e),o=s&&s.origDataId||e,l=this.dataRefCount.get(o);l>1?this.dataRefCount.set(o,l-1):(this.dataRefCount.delete(o),null!=t&&(this.numBytesInGPU-=this.computeBytes(a,n),this.textureManager.releaseTexture(t,a,r,i)));let c=this.texData.get(e);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:SV;return eT.getBool("WEBGL_CPU_FORWARD")&&e.every(e=>null==this.texData.get(e.dataId).texture&&cs.sizeFromShape(e.shape)<t)}getGPGPUContext(){return this.gpgpu}where(e){oB.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");let t=e.dataSync();return Sz(e.shape,t)}packedUnaryOp(e,t,n){let a=new Sj(e.shape,t),r=this.compileAndRun(a,[e],n);return aR.makeTensorFromTensorInfo(r)}abs(e){if(this.shouldExecuteOnCPU([e])&&"complex64"!==e.dtype){let t=So(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,t)}if(eT.getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,SM,e.dtype);let t=new SR(e.shape,SM),n=this.compileAndRun(t,[e]);return aR.makeTensorFromTensorInfo(n)}makeTensorInfo(e,t,n){let a;if("string"===t&&null!=n&&n.length>0&&cs.isString(n[0])){let r=n.map(e=>cs.encodeString(e));a=this.write(r,e,t)}else a=this.write(n,e,t);return this.texData.get(a).usage=null,{dataId:a,shape:e,dtype:t}}makeOutput(e,t,n){return aR.makeTensorFromTensorInfo(this.makeTensorInfo(e,t,n),this)}unpackTensor(e){let t=new SL(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){let t=new SC(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}packedReshape(e,t){let n=[Nj(e.shape),...NL(e.shape)],a={dtype:e.dtype,shape:n,dataId:e.dataId},r=new ST([Nj(t),...NL(t)],n),i=this.runWebGLProgram(r,[a],e.dtype,[n],!0);return{dataId:i.dataId,shape:t,dtype:i.dtype}}decode(e,t){let n,{isPacked:a,shape:r,dtype:i}=this.texData.get(e);if(null!=t){let e=cs.sizeFromShape(r),n=t[0]*t[1]*4;cs.assert(e<=n,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}let s=Nz(r);n=a?new kc(s):new kl(s);let o=[null!=t?t:Nr(s)],l=this.runWebGLProgram(n,[{shape:s,dtype:i,dataId:e}],i,o,!0,t);return{dtype:i,shape:r,dataId:l.dataId}}runWebGLProgram(e,t,n,a){let r,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5?arguments[5]:void 0,o=this.makeTensorInfo(e.outputShape,n),l=this.texData.get(o.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===v.DENSE&&(l.texShape=(null!=s?s:Nr(e.outputShape)).map(e=>2*e)),null!=e.outTexUsage&&(l.usage=e.outTexUsage),0===cs.sizeFromShape(o.shape))return l.values=cs.getTypedArrayFromDType(o.dtype,0),o;let c=[],u=t.map(t=>{if("complex64"===t.dtype)throw Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let n=this.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&cs.sizeFromShape(t.shape)<=eT.getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}if(this.uploadToGPU(t.dataId),!!n.isPacked!=!!e.packedInputs)t=n.isPacked?this.unpackTensor(t):this.packTensor(t),c.push(t),n=this.texData.get(t.dataId);else if(n.isPacked&&!NV(n.shape,t.shape)){let e=t,a=t.shape;t.shape=n.shape,t=this.packedReshape(t,a),c.push(t),n=this.texData.get(t.dataId),e.shape=a}return{shape:t.shape,texData:n,isUniform:!1}});this.uploadToGPU(o.dataId);let h={shape:o.shape,texData:l,isUniform:!1},d=function(e,t,n){let a="";t.concat(n).forEach(t=>{let r=null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!t.isUniform){let i=t.texData.texShape,{useSqueezeShape:s,uniformShape:o,keptDims:l}=kn(e.packedInputs,t.shape,i),c="",u="",h="";if(1===o.length&&e.packedInputs){let e=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];c="".concat(e[0]>1,"_").concat(e[1]>1)}else if(2!==o.length||e.packedInputs){if(o.length>2&&!e.packedInputs){let e=cs.computeStrides(o);h="".concat(e[0]===i[1],"_").concat(e[e.length-1]===i[1])}}else u="".concat(o[0]>1,"_").concat(o[1]>1);let d=t.shape.length,p=2===o.length&&cs.arraysEqual(t.shape,i),f=1===cs.sizeFromShape(t.shape),m=oB.getBroadcastDims(t.shape,n.shape),g=!e.packedInputs&&d===n.shape.length&&cs.arraysEqual(i,n.texData.texShape),x=e.packedInputs||o.length>2?"":"".concat(i[0]>1,"_").concat(i[1]>1);a+="".concat(d,"_").concat(g,"_").concat(s?l:"","_").concat(o.length,"_").concat(f,"_").concat(m,"_").concat(p,"_").concat(c,"_").concat(u,"_").concat(h,"_").concat(x,"_").concat(r)}else{let e=t.isUniform?"uniform":t.texData.texShape;a+="".concat(t.shape,"_").concat(e,"_").concat(r)}});let r=e.userCode,i=e.constructor.name;return i+("_"+a+"_"+r+"".concat(eT.getNumber("WEBGL_VERSION")))}(e,u,h),p=this.getAndSaveBinary(d,()=>(function(e,t,n,a){let r=n.map((e,n)=>{let a={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(a.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:a}}),i=r.map(e=>e.shapeInfo),s={logicalShape:a.shape,texShape:a.texData.texShape,isUniform:!1,isPacked:a.texData.isPacked,flatOffset:null},o=function(e,t,n){var a,r,i,s;let o,l,c=[];if(e.forEach(e=>{let t=cs.sizeFromShape(e.shapeInfo.logicalShape);if(e.shapeInfo.isUniform?c.push("uniform float ".concat(e.name).concat(t>1?"[".concat(t,"]"):"",";")):(c.push("uniform sampler2D ".concat(e.name,";")),c.push("uniform int offset".concat(e.name,";"))),n.enableShapeUniforms){let{uniformShape:t}=kn(n.packedInputs,e.shapeInfo.logicalShape,e.shapeInfo.texShape);switch(t.length){case 1:c.push("uniform int ".concat(e.name,"Shape;"));break;case 2:c.push("uniform ivec2 ".concat(e.name,"Shape;"));break;case 3:c.push("uniform ivec3 ".concat(e.name,"Shape;"));break;case 4:c.push("uniform ivec4 ".concat(e.name,"Shape;"))}c.push("uniform ivec2 ".concat(e.name,"TexShape;"))}}),n.enableShapeUniforms){switch(t.logicalShape.length){case 1:c.push("uniform int outShape;");break;case 2:c.push("uniform ivec2 outShape;"),c.push("uniform int outShapeStrides;");break;case 3:c.push("uniform ivec3 outShape;"),c.push("uniform ivec2 outShapeStrides;");break;case 4:c.push("uniform ivec4 outShape;"),c.push("uniform ivec3 outShapeStrides;")}c.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(e=>{c.push("uniform ".concat(e.type," ").concat(e.name).concat(e.arrayIndex?"[".concat(e.arrayIndex,"]"):"",";"))});let u=c.join("\n"),h=e.map(e=>(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3?arguments[3]:void 0,r="";n?r+=function e(t,n){switch(t.shapeInfo.logicalShape.length){case 0:var a=t;let r=a.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=N1();return"\n    vec4 ".concat(i,"() {\n      return ").concat(s.texture2D,"(").concat(r,", halfCR);\n    }\n  ");case 1:return function(e,t){let n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1),r=e.shapeInfo.texShape,i=N1();if(t)return"\n    vec4 ".concat(a,"(int index) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      vec2 uv = packedUVfrom1D(\n        packedTexShape[0], packedTexShape[1], index);\n      return ").concat(i.texture2D,"(").concat(n,", uv);\n    }\n  ");let s=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];return"\n    vec4 ".concat(a,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(s[0],", ").concat(s[1],", index);\n      return ").concat(i.texture2D,"(").concat(n,", uv);\n    }\n  ")}(t,n);case 2:return function(e,t){let n=e.shapeInfo.logicalShape,a=e.name,r="get"+a.charAt(0).toUpperCase()+a.slice(1),i=e.shapeInfo.texShape,s=i[0],o=i[1],l=N1();if(null!=i&&cs.arraysEqual(n,i))return t?"\n      vec4 ".concat(r,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(a,"TexShape[1], ").concat(a,"TexShape[0]);\n\n        return ").concat(l.texture2D,"(").concat(a,", uv);\n      }\n    "):"\n      vec4 ".concat(r,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(o,".0, ").concat(s,".0);\n\n        return ").concat(l.texture2D,"(").concat(a,", uv);\n      }\n    ");if(t)return"\n    vec4 ".concat(r,"(int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(a,"TexShape[0]) / 2.0), ceil(float(").concat(a,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(a,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);\n      return ").concat(l.texture2D,"(").concat(a,", uv);\n    }\n  ");let c=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],u=Math.ceil(n[1]/2);return"\n    vec4 ".concat(r,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(u,", ").concat(c[0],", ").concat(c[1],", row, col);\n      return ").concat(l.texture2D,"(").concat(a,", uv);\n    }\n  ")}(t,n);case 3:return function(t,n){let a=t.shapeInfo.logicalShape,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=t.shapeInfo.texShape,o=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];if(1===a[0]){let r=ka(t,a.slice(1));return"\n        ".concat(e(r,n),"\n        vec4 ").concat(i,"(int b, int row, int col) {\n          return ").concat(i,"(").concat(kr(["b","row","col"],[1,2]),");\n        }\n      ")}let l=N1();if(n)return"\n    vec4 ".concat(i,"(int b, int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(r,"TexShape[0]) / 2.0), ceil(float(").concat(r,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(r,"Shape[2]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(r,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom3D(\n        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);\n      return ").concat(l.texture2D,"(").concat(r,", uv);\n    }\n  ");let c=o[0],u=o[1],h=Math.ceil(a[2]/2),d=h*Math.ceil(a[1]/2);return"\n    vec4 ".concat(i,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(c,", ").concat(u,", ").concat(d,", ").concat(h,", b, row, col);\n      return ").concat(l.texture2D,"(").concat(r,", uv);\n    }\n  ")}(t,n);default:return function(e,t){let n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1),r=N1();if(t)return"\n    vec4 ".concat(a,"(int b2, int b, int row, int col) {\n      int valuesPerRow = int(ceil(float(").concat(n,"Shape[3]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(n,"Shape[2]) / 2.0));\n      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);\n      texelsInBatch *= ").concat(n,"Shape[1];\n      index = b2 * texelsInBatch + index;\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      int texR = index / packedTexShape[1];\n      int texC = index - texR * packedTexShape[1];\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ").concat(r.texture2D,"(").concat(n,", uv);\n    }\n  ");let i=e.shapeInfo.logicalShape,s=i.length,o=e.shapeInfo.texShape,l=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],c=l[0],u=l[1],h=Math.ceil(i[s-1]/2),d=h*Math.ceil(i[s-2]/2),p="int b, int row, int col",f="b * ".concat(d," + (row / 2) * ").concat(h," + (col / 2)");for(let e=2;e<s-1;e++)p="int b".concat(e,", ")+p,d*=i[s-e-1],f="b".concat(e," * ").concat(d," + ")+f;return"\n    vec4 ".concat(a,"(").concat(p,") {\n      int index = ").concat(f,";\n      int texR = index / ").concat(u,";\n      int texC = index - texR * ").concat(u,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(u,", ").concat(c,");\n      return ").concat(r.texture2D,"(").concat(n,", uv);\n    }\n  ")}(t,n)}}(e,a):r+=function e(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=t.shapeInfo.logicalShape;switch(a.length){case 0:return function(e,t){let n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"float ".concat(a,"() {return ").concat(n,";}");let[r,i]=e.shapeInfo.texShape;if(1===r&&1===i)return"\n      float ".concat(a,"() {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");let s=N7(n);if(t)return"\n    float ".concat(a,"() {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");let[o,l]=e.shapeInfo.texShape;return"\n    float ".concat(a,"() {\n      vec2 uv = uvFromFlat(").concat(o,", ").concat(l,", ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(t,n);case 1:return function(e,t){let n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int index) {\n        ").concat(ke(e),"\n      }\n    ");let r=e.shapeInfo.texShape,i=r[0],s=r[1];if(1===s&&1===i)return"\n      float ".concat(a,"(int index) {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");let o=N7(n);return 1===s?t?"\n      float ".concat(a,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(o,") + 0.5) / float(").concat(n,"TexShape[0]));\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(a,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(o,") + 0.5) / ").concat(i,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):1===i?t?"\n      float ".concat(a,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(o,") + 0.5) / float(").concat(n,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(a,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(o,") + 0.5) / ").concat(s,".0, 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):t?"\n    float ".concat(a,"(int index) {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], index + ").concat(o,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  "):"\n    float ".concat(a,"(int index) {\n      vec2 uv = uvFromFlat(").concat(i,", ").concat(s,", index + ").concat(o,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(t,n);case 2:return function(t,n){let a=t.shapeInfo.logicalShape,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=t.shapeInfo.texShape;if(null!=s&&cs.arraysEqual(a,s)){if(n)return"\n      float ".concat(i,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");let e=s[0],t=s[1];return"\n    float ".concat(i,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(t,".0, ").concat(e,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}let{newShape:o,keptDims:l}=cs.squeezeShape(a);if(o.length<a.length){let a=ka(t,o);return"\n      ".concat(e(a,n),"\n      float ").concat(i,"(int row, int col) {\n        return ").concat(i,"(").concat(kr(["row","col"],l),");\n      }\n    ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(i,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(a[1],", 1)));\n        ").concat(ke(t),"\n      }\n    ");let c=s[0],u=s[1],h=N7(r);return 1===u?n?"\n      float ".concat(i,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(h,"), vec3(").concat(r,"Shape[1], 1, 1));\n        vec2 uv = vec2(0.5, (index + 0.5) / float(").concat(r,"TexShape[0]));\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(i,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(h,"), vec3(").concat(a[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(c,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  "):1===c?n?"\n      float ".concat(i,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(h,"), vec3(").concat(r,"Shape[1], 1, 1));\n        vec2 uv = vec2((index + 0.5) / float(").concat(r,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(i,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(h,"), vec3(").concat(a[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(u,".0, 0.5);\n      return sampleTexture(").concat(r,", uv);\n    }\n  "):n?"\n      float ".concat(i,"(int row, int col) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(r,"Shape[1] + col + ").concat(h,";\n        vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n  float ".concat(i,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(a[1]," + col + ").concat(h,";\n    vec2 uv = uvFromFlat(").concat(c,", ").concat(u,", index);\n    return sampleTexture(").concat(r,", uv);\n  }\n")}(t,n);case 3:return function(t,n){let a=t.shapeInfo.logicalShape,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=a[1]*a[2],o=a[2],{newShape:l,keptDims:c}=cs.squeezeShape(a);if(l.length<a.length){let a=ka(t,l);return"\n        ".concat(e(a,n),"\n        float ").concat(i,"(int row, int col, int depth) {\n          return ").concat(i,"(").concat(kr(["row","col","depth"],c),");\n        }\n      ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(i,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(s,", ").concat(o,", 1)));\n        ").concat(ke(t),"\n      }\n    ");let u=t.shapeInfo.texShape,h=u[0],d=u[1],p=t.shapeInfo.flatOffset;if(d===s&&null==p)return n?"\n      float ".concat(i,"(int row, int col, int depth) {\n        int stride1 = ").concat(r,"Shape[2];\n        float texR = float(row);\n        float texC = dot(vec2(col, depth), vec2(stride1, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n        float ".concat(i,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(o,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(d,".0, ").concat(h,".0);\n          return sampleTexture(").concat(r,", uv);\n        }\n      ");if(d===o&&null==p)return n?"\n      float ".concat(i,"(int row, int col, int depth) {\n        float texR = dot(vec2(row, col), vec2(").concat(r,"Shape[1], 1));\n        float texC = float(depth);\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(i,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(a[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(d,".0, ").concat(h,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");let f=N7(r);return n?"\n    float ".concat(i,"(int row, int col, int depth) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int stride0 = ").concat(r,"Shape[1] * ").concat(r,"Shape[2];\n      int stride1 = ").concat(r,"Shape[2];\n      int index = row * stride0 + col * stride1 + depth + ").concat(f,";\n      vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index);\n      return sampleTexture(").concat(r,", uv);\n    }\n    "):"\n      float ".concat(i,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(s," + col * ").concat(o," + depth + ").concat(f,";\n        vec2 uv = uvFromFlat(").concat(h,", ").concat(d,", index);\n        return sampleTexture(").concat(r,", uv);\n      }\n  ")}(t,n);case 4:return function(t,n){let a=t.shapeInfo.logicalShape,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=a[3],o=a[2]*s,l=a[1]*o,{newShape:c,keptDims:u}=cs.squeezeShape(a);if(c.length<a.length){let a=ka(t,c);return"\n      ".concat(e(a,n),"\n      float ").concat(i,"(int row, int col, int depth, int depth2) {\n        return ").concat(i,"(").concat(kr(["row","col","depth","depth2"],u),");\n      }\n    ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(i,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(l,", ").concat(o,", ").concat(s,", 1)));\n        ").concat(ke(t),"\n      }\n    ");let h=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,p=d[0],f=d[1],m="int stride2 = ".concat(r,"Shape[3];"),g="int stride1 = ".concat(r,"Shape[2] * stride2;"),x="int stride0 = ".concat(r,"Shape[1] * stride1;");if(f===l&&null==h)return n?"\n      float ".concat(i,"(int row, int col, int depth, int depth2) {\n        ").concat(m,"\n        ").concat(g,"\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(stride1, stride2, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n      float ".concat(i,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(o,", ").concat(s,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(f,".0, ").concat(p,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");if(f===s&&null==h)return n?"\n      float ".concat(i,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(r,"Shape[1] * ").concat(r,"Shape[2], ").concat(r,"Shape[2], 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n      float ".concat(i,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(a[1]*a[2],", ").concat(a[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(f,".0, ").concat(p,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");let y=N7(r);return n?"\n    float ".concat(i,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      ").concat(m,"\n      ").concat(g,"\n      ").concat(x,"\n      int index = row * stride0 + col * stride1 +\n          depth * stride2 + depth2;\n      vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index + ").concat(y,");\n      return sampleTexture(").concat(r,", uv);\n    }\n  "):"\n    float ".concat(i,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(l," + col * ").concat(o," +\n          depth * ").concat(s," + depth2;\n      vec2 uv = uvFromFlat(").concat(p,", ").concat(f,", index + ").concat(y,");\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}(t,n);case 5:return function(t){let n=t.shapeInfo.logicalShape,a=t.name,r="get"+a.charAt(0).toUpperCase()+a.slice(1),i=n[4],s=n[3]*i,o=n[2]*s,l=n[1]*o,{newShape:c,keptDims:u}=cs.squeezeShape(n);if(c.length<n.length){let n=ka(t,c);return"\n      ".concat(e(n),"\n      float ").concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(r,"(").concat(kr(["row","col","depth","depth2","depth3"],u),");\n      }\n    ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(l,", ").concat(o,", ").concat(s,", ").concat(i,")) +\n          depth3;\n        ").concat(ke(t),"\n      }\n    ");let h=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,p=d[0],f=d[1];if(f===l&&null==h)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(o,", ").concat(s,", ").concat(i,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(f,".0, ").concat(p,".0);\n        return sampleTexture(").concat(a,", uv);\n      }\n    ");if(f===i&&null==h)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(n[1]*n[2]*n[3],",\n               ").concat(n[2]*n[3],", ").concat(n[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(f,".0, ").concat(p,".0);\n        return sampleTexture(").concat(a,", uv);\n      }\n    ");let m=N7(a);return"\n    float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(l," + col * ").concat(o," + depth * ").concat(s," +\n          depth2 * ").concat(i," + depth3 + ").concat(m,";\n      vec2 uv = uvFromFlat(").concat(p,", ").concat(f,", index);\n      return sampleTexture(").concat(a,", uv);\n    }\n  ")}(t);case 6:return function(t){let n=t.shapeInfo.logicalShape,a=t.name,r="get"+a.charAt(0).toUpperCase()+a.slice(1),{newShape:i,keptDims:s}=cs.squeezeShape(n);if(i.length<n.length){let n=ka(t,i);return"\n      ".concat(e(n),"\n      float ").concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(r,"(").concat(kr(["row","col","depth","depth2","depth3","depth4"],s),");\n      }\n    ")}let o=n[5],l=n[4]*o,c=n[3]*l,u=n[2]*c,h=n[1]*u;if(t.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(h,", ").concat(u,", ").concat(c,", ").concat(l,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(o,", 1)));\n        ").concat(ke(t),"\n      }\n    ");let d=t.shapeInfo.flatOffset,p=t.shapeInfo.texShape,f=p[0],m=p[1];if(m===h&&null==d)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(u,", ").concat(c,", ").concat(l,", ").concat(o,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(m,".0, ").concat(f,".0);\n        return sampleTexture(").concat(a,", uv);\n      }\n    ");if(m===o&&null==d)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(n[1]*n[2]*n[3]*n[4],",\n               ").concat(n[2]*n[3]*n[4],",\n               ").concat(n[3]*n[4],",\n               ").concat(n[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(m,".0, ").concat(f,".0);\n        return sampleTexture(").concat(a,", uv);\n      }\n    ");let g=N7(a);return"\n    float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(h," + col * ").concat(u," + depth * ").concat(c," +\n          depth2 * ").concat(l," + depth3 * ").concat(o," + depth4 + ").concat(g,";\n      vec2 uv = uvFromFlat(").concat(f,", ").concat(m,", index);\n      return sampleTexture(").concat(a,", uv);\n    }\n  ")}(t);default:throw Error("".concat(a.length,"-D input sampling")+" is not yet supported")}}(e,a);let i=e.shapeInfo.logicalShape,s=t.logicalShape;return i.length<=s.length&&(n?r+=function(e,t){let n,a=e.name,r=a.charAt(0).toUpperCase()+a.slice(1),i="get"+r+"AtOutCoords",s=e.shapeInfo.logicalShape.length,o=t.logicalShape.length,l=N8(e.shapeInfo.logicalShape,t.logicalShape),c=kt(o),u=o-s,h=["x","y","z","w","u","v"];n=0===s?"":o<2&&l.length>=1?"coords = 0;":l.map(e=>"coords.".concat(h[e+u]," = 0;")).join("\n");let d="";d=o<2&&s>0?"coords":e.shapeInfo.logicalShape.map((e,t)=>"coords.".concat(h[t+u])).join(", ");let p="return outputValue;",f=1===cs.sizeFromShape(e.shapeInfo.logicalShape),m=1===cs.sizeFromShape(t.logicalShape);if(1!==s||f||m){if(f&&!m)p=1===o?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(l.length){let e=s-2,t=s-1;l.indexOf(e)>-1&&l.indexOf(t)>-1?p="return vec4(outputValue.x);":l.indexOf(e)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":l.indexOf(t)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}}else p="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 ".concat(i,"() {\n      ").concat(c," coords = getOutputCoords();\n      ").concat(n,"\n      vec4 outputValue = get").concat(r,"(").concat(d,");\n      ").concat(p,"\n    }\n  ")}(e,t):r+=function(e,t){let n,a=e.name,r=a.charAt(0).toUpperCase()+a.slice(1),i="get"+r+"AtOutCoords",s=t.texShape,o=e.shapeInfo.texShape,l=e.shapeInfo.logicalShape.length,c=t.logicalShape.length;if(!e.shapeInfo.isUniform&&l===c&&null==e.shapeInfo.flatOffset&&cs.arraysEqual(o,s))return"\n      float ".concat(i,"() {\n        return sampleTexture(").concat(a,", resultUV);\n      }\n    ");let u=kt(c),h=N8(e.shapeInfo.logicalShape,t.logicalShape),d=c-l,p=["x","y","z","w","u","v"];n=0===l?"":c<2&&h.length>=1?"coords = 0;":h.map(e=>"coords.".concat(p[e+d]," = 0;")).join("\n");let f="";return f=c<2&&l>0?"coords":e.shapeInfo.logicalShape.map((e,t)=>"coords.".concat(p[t+d])).join(", "),"\n    float ".concat(i,"() {\n      ").concat(u," coords = getOutputCoords();\n      ").concat(n,"\n      return get").concat(r,"(").concat(f,");\n    }\n  ")}(e,t)),r})(e,t,n.packedInputs,n.enableShapeUniforms)).join("\n"),d=t.texShape,p=N1(),f=(a=p,"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(a.texture2D,"(textureSampler, uv).r;\n    }\n  ")),m=(r=p,"".concat(r.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(r.varyingFs," vec2 resultUV;\n    ").concat(r.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(r.defineSpecialNaN,"\n    ").concat(r.defineSpecialInf,"\n    ").concat(r.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat("\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n","\n    ").concat("\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n","\n    ").concat("\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n","\n  "));return t.isPacked?(o=function(e,t,n){switch(e.length){case 0:return N9();case 1:var a=t,r=n;let i=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return 1===i[0]?r?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(i[1],".0);\n      }\n    "):1===i[1]?r?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(i[0],".0);\n      }\n    "):r?"\n    int getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);\n    }\n  ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(i[0],", ").concat(i[1],"));\n      return 2 * (resTexRC.x * ").concat(i[1]," + resTexRC.y);\n    }\n  ");case 2:var s=e,o=t,l=n;let c=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(cs.arraysEqual(s,o))return l?"\n      ivec2 getOutputCoords() {\n        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(c[0],", ").concat(c[1],"));\n      }\n    ");let u=Math.ceil(s[1]/2);return l?"\n    ivec2 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec2(r, c);\n    }\n  ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(c[0],", ").concat(c[1],"));\n\n      int index = resTexRC.x * ").concat(c[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(u,");\n      int c = imod(index, ").concat(u,") * 2;\n\n      return ivec2(r, c);\n    }\n  ");case 3:var h=e,d=t,p=n;if(p)return"\n    ivec3 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";let f=[Math.ceil(d[0]/2),Math.ceil(d[1]/2)],m=Math.ceil(h[2]/2),g=m*Math.ceil(h[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(f[0],", ").concat(f[1],"));\n      int index = resTexRC.x * ").concat(f[1]," + resTexRC.y;\n\n      int b = index / ").concat(g,";\n      index -= b * ").concat(g,";\n\n      int r = 2 * (index / ").concat(m,");\n      int c = imod(index, ").concat(m,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ");default:return function(e,t,n){if(n)return"\n    ivec4 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatchN = texelsInBatch * outShape[1];\n\n      int b2 = index / texelsInBatchN;\n      index -= b2 * texelsInBatchN;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  ";let a=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[e.length-1]/2),i=r*Math.ceil(e[e.length-2]/2),s=i,o="",l="b, r, c";for(let t=2;t<e.length-1;t++)s*=e[e.length-t-1],o="\n      int b".concat(t," = index / ").concat(s,";\n      index -= b").concat(t," * ").concat(s,";\n    ")+o,l="b".concat(t,", ")+l;return"\n    ivec".concat(e.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(a[0],", ").concat(a[1],"));\n      int index = resTexRC.x * ").concat(a[1]," + resTexRC.y;\n\n      ").concat(o,"\n\n      int b = index / ").concat(i,";\n      index -= b * ").concat(i,";\n\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec").concat(e.length,"(").concat(l,");\n    }\n  ")}(e,t,n)}}(t.logicalShape,d,n.enableShapeUniforms),i=p,l="\n    void setOutput(vec4 val) {\n      ".concat(i.output," = val;\n    }\n  ")):(o=function(e,t,n){switch(e.length){case 0:return N9();case 1:return a=t,r=n,1===a[0]?r?"\n      int getOutputCoords() {\n        return int(resultUV.x * float(outTexShape[1]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(a[1],".0);\n      }\n    "):1===a[1]?r?"\n      int getOutputCoords() {\n        return int(resultUV.y * float(outTexShape[0]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(a[0],".0);\n      }\n    "):r?"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      return resTexRC.x * outTexShape[1] + resTexRC.y;\n    }\n  ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(a[0],", ").concat(a[1],"));\n      return resTexRC.x * ").concat(a[1]," + resTexRC.y;\n    }\n  ");case 2:return i=e,s=t,o=n,cs.arraysEqual(i,s)?o?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(s[0],", ").concat(s[1],"));\n      }\n    "):1===i[1]?o?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(s[0],", ").concat(s[1],"));\n        int index = resTexRC.x * ").concat(s[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    "):1===i[0]?o?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(s[0],", ").concat(s[1],"));\n        int index = resTexRC.x * ").concat(s[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    "):o?"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      int r = index / outShape[1];\n      int c = index - r * outShape[1];\n      return ivec2(r, c);\n    }\n  ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(s[0],", ").concat(s[1],"));\n      int index = resTexRC.x * ").concat(s[1]," + resTexRC.y;\n      int r = index / ").concat(i[1],";\n      int c = index - r * ").concat(i[1],";\n      return ivec2(r, c);\n    }\n  ");case 3:var a,r,i,s,o,l=e,c=t,u=n;if(u){let e=N3(["r","c","d"],l);return"\n  ivec3 getOutputCoords() {\n    ivec2 resTexRC = ivec2(resultUV.yx *\n                           vec2(outTexShape[0], outTexShape[1]));\n    int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n    ".concat(e,"\n    return ivec3(r, c, d);\n  }\n")}let h=N2(["r","c","d"],l);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(c[0],", ").concat(c[1],"));\n      int index = resTexRC.x * ").concat(c[1]," + resTexRC.y;\n      ").concat(h,"\n      return ivec3(r, c, d);\n    }\n  ");case 4:var d=e,p=t,f=n;if(f){let e=N3(["r","c","d","d2"],d);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      ".concat(e,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}let m=N2(["r","c","d","d2"],d);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(p[0],", ").concat(p[1],"));\n      int index = resTexRC.x * ").concat(p[1]," + resTexRC.y;\n      ").concat(m,"\n      return ivec4(r, c, d, d2);\n    }\n  ");case 5:var g=e,x=t;let y=N2(["r","c","d","d2","d3"],g);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(x[0],",\n                             ").concat(x[1],"));\n\n      int index = resTexRC.x * ").concat(x[1]," + resTexRC.y;\n\n      ").concat(y,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ");case 6:var b=e,v=t;let w=N2(["r","c","d","d2","d3","d4"],b);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(v[0],", ").concat(v[1],"));\n      int index = resTexRC.x * ").concat(v[1]," + resTexRC.y;\n\n      ").concat(w,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ");default:throw Error("".concat(e.length,"-D output sampling is not yet supported"))}}(t.logicalShape,d,n.enableShapeUniforms),s=p,l="\n    void setOutput(float val) {\n      ".concat(s.output," = vec4(val, 0, 0, 0);\n    }\n  ")),n.packedInputs&&(m+="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n"),[m,f,l,u,o,h,n.userCode].join("\n")}(r,s,t),l=Nd(e.gl,o),c=e.createProgram(l);return eT.get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:l,source:o,webGLProgram:c,inShapeInfos:i,outShapeInfo:s,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(e.buildVao(c),Object.assign({program:t,fragmentShader:l,source:o,webGLProgram:c,inShapeInfos:i,outShapeInfo:s},ki(e,t,c)))})(this.gpgpu,e,u,h)),f=null!=this.activeTimers;f&&(r=this.startTimer()),eT.get("ENGINE_COMPILE_ONLY")||function(e,t,n,a,r){t.program.enableShapeUniforms||(ks(t.inShapeInfos,n),ks([t.outShapeInfo],[a]));let i=a.texData.texture,s=a.texData.texShape;a.texData.isPacked?e.setOutputPackedMatrixTexture(i.texture,s[0],s[1]):e.setOutputMatrixTexture(i.texture,s[0],s[1]),e.setProgram(t.webGLProgram),e.bindVertexArray(t.webGLProgram.vao),1===eT.getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN);for(let a=0;a<n.length;++a){let r=n[a],{uniform:i,offset:s,shape:o,texShape:l}=t.variablesLocations[a];if(o){let{uniformShape:n}=kn(t.program.packedInputs,r.shape,r.texData.texShape);switch(n.length){case 1:e.gl.uniform1iv(o,new Int32Array(n));break;case 2:e.gl.uniform2iv(o,new Int32Array(n));break;case 3:e.gl.uniform3iv(o,new Int32Array(n));break;case 4:e.gl.uniform4iv(o,new Int32Array(n))}}if(l&&e.gl.uniform2i(l,r.texData.texShape[0],r.texData.texShape[1]),null!=i){if(r.isUniform){if(2>cs.sizeFromShape(r.shape))e.gl.uniform1f(i,r.uniformValues[0]);else{let t=r.uniformValues;t instanceof Float32Array||(t=new Float32Array(t)),e.gl.uniform1fv(i,t)}continue}null!=r.texData.slice&&null!=s&&e.gl.uniform1i(s,r.texData.slice.flatOffset),e.setInputMatrixTexture(r.texData.texture.texture,i,a)}}let o=t.outShapeLocation;if(o)switch(a.shape.length){case 1:e.gl.uniform1iv(o,new Int32Array(a.shape));break;case 2:e.gl.uniform2iv(o,new Int32Array(a.shape));break;case 3:e.gl.uniform3iv(o,new Int32Array(a.shape));break;case 4:e.gl.uniform4iv(o,new Int32Array(a.shape))}if(t.outShapeStridesLocation){let n=cs.computeStrides(a.shape);switch(a.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(n));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(n));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(n))}}if(t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,a.texData.texShape[0],a.texData.texShape[1]),t.program.customUniforms&&r)for(let n=0;n<t.program.customUniforms.length;++n){let a=t.program.customUniforms[n],i=t.customUniformLocations[n],s=r[n];if("float"===a.type)e.gl.uniform1fv(i,s);else if("vec2"===a.type)e.gl.uniform2fv(i,s);else if("vec3"===a.type)e.gl.uniform3fv(i,s);else if("vec4"===a.type)e.gl.uniform4fv(i,s);else if("int"===a.type)e.gl.uniform1iv(i,s);else if("ivec2"===a.type)e.gl.uniform2iv(i,s);else if("ivec3"===a.type)e.gl.uniform3iv(i,s);else if("ivec4"===a.type)e.gl.uniform4iv(i,s);else throw Error("uniform type ".concat(a.type," is not supported yet."))}e.executeProgram()}(this.gpgpu,p,u,h,a),c.forEach(e=>this.disposeIntermediateTensorInfo(e)),f&&(r=this.endTimer(r),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(r)}));let m=eT.getNumber("WEBGL_FLUSH_THRESHOLD");if(m>0){let e=cs.now();e-this.lastGlFlushTime>m&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=e)}if(!eT.getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&!1===i){let e=this.unpackTensor(o);return this.disposeIntermediateTensorInfo(o),e}return o}compileAndRun(e,t,n,a){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return n=n||t[0].dtype,this.runWebGLProgram(e,t,n,a,r)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(eT.getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(e=>{this.gpgpu.deleteProgram(this.binaryCache[e].webGLProgram),delete this.binaryCache[e]}),this.textureManager.dispose(),null!=this.canvas&&"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return null==this.floatPrecisionValue&&(this.floatPrecisionValue=aQ(()=>{if(!eT.get("WEBGL_RENDER_FLOAT32_ENABLED")){let e=eT.getBool("DEBUG");eT.set("DEBUG",!1);let t=this.abs(rG(1e-8)).dataSync()[0];if(eT.set("DEBUG",e),t>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}uploadToGPU(e){let t,n=this.texData.get(e),{shape:a,dtype:r,values:i,texture:s,usage:o,isPacked:l}=n;if(null!=s)return;let c=null!=this.activeTimers;c&&(t=cs.now());let u=n.texShape;if(null==u&&(n.texShape=u=NB(a,l)),null!=i){let e,s=Nz(a),o=u[1],h=u[0],d=i instanceof Uint8Array||i instanceof Uint8ClampedArray;(l||!d)&&([o,h]=Ni(u[0],u[1])),e=l?new kf(s,d):new kp(s,d);let p=d?[h,o]:u,f=this.makeTensorInfo(p,r),m=this.texData.get(f.dataId);d?m.usage=w.PIXELS:m.usage=w.UPLOAD,m.texShape=p,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(f.dataId),o,h,i);let g=[[h,o]],x=this.runWebGLProgram(e,[f],r,g,!0),y=this.texData.get(x.dataId);n.texShape=y.texShape,n.isPacked=y.isPacked,n.usage=y.usage,eT.get("ENGINE_COMPILE_ONLY")?this.disposeData(x.dataId):(n.texture=y.texture,n.values=null,this.texData.delete(x.dataId)),this.disposeIntermediateTensorInfo(f),c&&(this.uploadWaitMs+=cs.now()-t)}else n.texture=this.acquireTexture(u,o,r,l)}convertAndCacheOnCPU(e,t){let n=this.texData.get(e),{dtype:a}=n;return null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){let n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length);for(let t=0;t<n.length;++t)n[t]=Math.round(e[t]);return n}throw Error("Unknown dtype ".concat(t))}(t,a)),n.values}acquireTexture(e,t,n,a){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){let e=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(e," MB, ")+"most likely due to a memory leak")}return this.textureManager.acquireTexture(e,t,a)}computeBytes(e,t){return e[0]*e[1]*cs.bytesPerElement(t)}checkCompileCompletion(){for(let[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){let e=[];if(this.gpgpu.parallelCompilationExtension){for(let[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}for(let[,t]of Object.entries(this.binaryCache)){let n=new Promise(e=>{try{this.checkCompletion_(t),e(!0)}catch(e){throw e}});e.push(n)}return Promise.all(e)}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await dA(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(!1===this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)){if(console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),!1===this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS))throw Nf(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),Error("Failed to compile fragment shader.");throw Error("Failed to link vertex and fragment shaders.")}return!0}getUniformLocations(){for(let e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);let{variablesLocations:t,customUniformLocations:n,infLoc:a,nanLoc:r,outShapeLocation:i,outShapeStridesLocation:s,outTexShapeLocation:o}=ki(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=t,e.customUniformLocations=n,e.infLoc=a,e.nanLoc=r,e.outShapeLocation=i,e.outShapeStridesLocation=s,e.outTexShapeLocation=o}}createTensorFromGPUData(e,t,n){e.channels=e.channels||"RGBA";let{texture:a,height:r,width:i,channels:s}=e,o=aR.backend;if(!o.gpgpu.gl.isTexture(a))throw Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");let l=o.writeTexture(a,t,n,r,i,s);return aR.makeTensorFromDataId(l,t,n,o)}constructor(e){let t;if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!eT.getBool("HAS_WEBGL"))throw Error("WebGL is not supported on this device");null!=e?(t=e instanceof kj?e:new kj(Na(eT.getNumber("WEBGL_VERSION"),e)),this.binaryCache={},this.gpgpuCreatedLocally=!1):(t=new kj(Na(eT.getNumber("WEBGL_VERSION"))),this.binaryCache=function(e){return e in SB||(SB[e]={}),SB[e]}(eT.getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0),this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new SI(this.gpgpu),this.numMBBeforeWarning=null==eT.global.screen?1024:eT.global.screen.height*eT.global.screen.width*window.devicePixelRatio*600/1024/1024,this.texData=new I(this,aR)}}SU.nextDataId=0,e.s(["forceHalfFloat",()=>SH],59951);var SW=e.i(70798),SG=e.i(19392);function SH(){eT.set("WEBGL_FORCE_F16_TEXTURES",!0)}w7.isBrowser()&&a0("webgl",()=>new SU,2);let Sq={forceHalfFloat:SH};var v9=sB,cs=cs,oB=oB,oB=oB;let SK="\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n";class SX{constructor(e,t,n){this.variableNames=["A","B"],this.outputShape=oB.assertAndGetBroadcastShape(t,n),this.enableShapeUniforms=ko(this.outputShape.length),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(e,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")}}var oB=oB,cs=cs;let SY="\n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n";class SZ{constructor(e,t,n,a=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=oB.assertAndGetBroadcastShape(t,n);let r=this.outputShape.length;this.enableShapeUniforms=ko(r);let i="";if(a)if(0===r||1===cs.sizeFromShape(this.outputShape))i="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else{let e=kt(r);if(i="\n          ".concat(e," coords = getOutputCoords();\n        "),1===r)this.enableShapeUniforms?i+="\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ":i+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{let e=SS("coords",r);this.enableShapeUniforms?i+="\n            bool nextRowOutOfBounds =\n              (".concat(e[r-2]," + 1) >= outShape[").concat(r," - 2];\n            bool nextColOutOfBounds =\n              (").concat(e[r-1]," + 1) >= outShape[").concat(r," - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "):i+="\n            bool nextRowOutOfBounds =\n              (".concat(e[r-2]," + 1) >= ").concat(this.outputShape[r-2],";\n            bool nextColOutOfBounds =\n              (").concat(e[r-1]," + 1) >= ").concat(this.outputShape[r-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(e,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(i,"\n\n        setOutput(result);\n      }\n    ")}}function SQ(e){let{inputs:t,backend:n}=e,{x:a}=t;return n.incRef(a.dataId),{dataId:a.dataId,shape:a.shape,dtype:a.dtype}}function SJ(e){let{inputs:t,backend:n}=e,{real:a,imag:r}=t,i=n.makeTensorInfo(a.shape,"complex64"),s=n.texData.get(i.dataId);return s.complexTensorInfos={real:SQ({inputs:{x:a},backend:n}),imag:SQ({inputs:{x:r},backend:n})},i}var cs=cs;let S$="return (a < 0.) ? b * a : a;",S0="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",S1="return (a < 0.) ? b * a : a;",S2="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",S3="if (isnan(x)) return x;";function S4(e){let{opSnippet:t,packedOpSnippet:n,cpuKernelImpl:a,dtype:r}=e;return e=>{let i,{inputs:s,backend:o}=e,{x:l}=s,c=r||l.dtype;if(o.shouldExecuteOnCPU([l])&&null!=a){let e=a(o.texData.get(l.dataId).values,c);return o.makeTensorInfo(l.shape,c,e)}return i=eT.getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=n?new Sj(l.shape,n):new SR(l.shape,t),o.runWebGLProgram(i,[l],c)}}function S5(e){let{opSnippet:t,packedOpSnippet:n,checkOutOfBounds:a=!1,supportsComplex:r=!1,cpuKernelImpl:i,dtype:s}=e;return e=>{let o,{inputs:l,backend:c}=e,{a:u,b:h}=l;if(r&&"complex64"===u.dtype){let e=c.texData.get(u.dataId),n=c.texData.get(h.dataId),[a,r]=[[e.complexTensorInfos.real,n.complexTensorInfos.real],[e.complexTensorInfos.imag,n.complexTensorInfos.imag]].map(e=>{let[n,a]=e,r={dataId:n.dataId,dtype:n.dtype,shape:u.shape},i={dataId:a.dataId,dtype:a.dtype,shape:h.shape},s=new SX(t,u.shape,h.shape);return c.runWebGLProgram(s,[r,i],ab(n.dtype,a.dtype))}),i=SJ({inputs:{real:a,imag:r},backend:c});return c.disposeIntermediateTensorInfo(a),c.disposeIntermediateTensorInfo(r),i}let d=s||ab(u.dtype,h.dtype);if(("string"===u.dtype||"string"===h.dtype||c.shouldExecuteOnCPU([u,h]))&&null!=i){let e=c.texData.get(u.dataId).values,t=c.texData.get(h.dataId).values,n="string"===u.dtype?oB.fromUint8ToStringArray(e):e,a="string"===u.dtype?oB.fromUint8ToStringArray(t):t,[r,s]=i(u.shape,h.shape,n,a,d),o=c.makeTensorInfo(s,d);return c.texData.get(o.dataId).values=r,o}return o=eT.getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=n?new SZ(n,u.shape,h.shape,a):new SX(t,u.shape,h.shape),c.runWebGLProgram(o,[u,h],d)}}function S6(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("linear"===e)return"return x;";if("relu"===e)return t?"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n":SF;if("elu"===e)return t?"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n":"return (x >= 0.0) ? x : (exp(x) - 1.0);";if("relu6"===e)return t?"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n":SO;if("prelu"===e)return t?S2:S1;else if("leakyrelu"===e)return t?S0:S$;else if("sigmoid"===e)return"return 1.0 / (1.0 + exp(-1.0 * x));";throw Error("Activation ".concat(e," has not been implemented for the WebGL backend."))}class S8{constructor(e,t,n,a=!1,r=!1,i=!1,s=null,o=!1,l=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.enableShapeUniforms=ko(this.outputShape.length);let c=Math.ceil((a?e[1]:e[2])/2),u=a?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],h=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],d="",p="";s&&(d=o?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(s,"\n        }"):l?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(s,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(s,"\n        }"),p="result = activation(result);"),i&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),l&&this.variableNames.push("leakyreluAlpha");let f="rc.x",m="rc.x";e[0]<t[0]?f="imod(rc.x, ".concat(e[0],")"):t[0]<e[0]&&(m="imod(rc.x, ".concat(t[0],")")),this.userCode="\n      ".concat(d,"\n      // Don't use uniform for sharedDimensionPacked for performance.\n      const float sharedDimension = ").concat(c,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        int batchA = ").concat(f,";\n        int batchB = ").concat(m,";\n        for (int i = 0; i < ").concat(c,"; i++) {\n          vec4 a = getMatrixA(batchA, ").concat(a?"i * 2, rc.y":"rc.y, i * 2",");\n          vec4 b = getMatrixB(batchB, ").concat(r?"rc.z, i * 2":"i * 2, rc.z",");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(u[0]," * ").concat(h[0],");\n          result += (").concat(u[1]," * ").concat(h[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(i?"result += getBiasAtOutCoords();":"","\n\n        ").concat(p,"\n\n        setOutput(result);\n      }\n    ")}}var oB=oB,oB=oB;let S9={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class S7{constructor(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=oB.assertAndGetBroadcastShape(t,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(e,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")}}let Ce="return a * b;";function Ct(e){let t,{inputs:n,backend:a}=e,{a:r,b:i}=n,s=oB.upcastType(r.dtype,i.dtype);if("complex64"===r.dtype){let e=a.texData.get(r.dataId),t=a.texData.get(i.dataId),n=new S7(S9.REAL,r.shape,i.shape),s=new S7(S9.IMAG,r.shape,i.shape),o=[{dataId:e.complexTensorInfos.real.dataId,dtype:e.complexTensorInfos.real.dtype,shape:r.shape},{dataId:e.complexTensorInfos.imag.dataId,dtype:e.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:t.complexTensorInfos.real.dataId,dtype:t.complexTensorInfos.real.dtype,shape:i.shape},{dataId:t.complexTensorInfos.imag.dataId,dtype:t.complexTensorInfos.imag.dtype,shape:i.shape}],l=a.runWebGLProgram(n,o,"float32"),c=a.runWebGLProgram(s,o,"float32"),u=SJ({inputs:{real:l,imag:c},backend:a});return a.disposeIntermediateTensorInfo(l),a.disposeIntermediateTensorInfo(c),u}if(a.shouldExecuteOnCPU([r,i])){let e=a.texData.get(r.dataId),t=a.texData.get(i.dataId),[n,o]=k6(r.shape,i.shape,e.values,t.values,s),l=a.makeTensorInfo(o,s);return a.texData.get(l.dataId).values=n,l}return t=eT.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new SZ(Ce,r.shape,i.shape):new SX(Ce,r.shape,i.shape),a.runWebGLProgram(t,[r,i],s)}var cs=cs;function Cn(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{shape:i}=a,s=cs.sizeFromShape(r.shape),o=cs.inferFromImplicitShape(i,s),l=cs.sizeFromShape(o);cs.assert(s===l,()=>"The new shape (".concat(o,") has ").concat(l," elements and the old ")+"shape (".concat(r.shape,") has ").concat(s," elements. The new shape and old ")+"shape must have the same number of elements.");let c=n.texData.get(r.dataId);return!c.isPacked||NV(r.shape,o)||null!==c.texture&&NV(c.shape,o)?(n.incRef(r.dataId),{dataId:r.dataId,shape:o,dtype:r.dtype}):function(e,t,n){let a=[Nj(e.shape),...NL(e.shape)],r={dtype:e.dtype,shape:a,dataId:e.dataId},i=new ST([Nj(t),...NL(t)],a),s=n.runWebGLProgram(i,[r],e.dtype,[a],!0);return{dataId:s.dataId,shape:t,dtype:s.dtype}}(r,o,n)}var oB=oB,cs=cs,oB=oB,cs=cs;class Ca{constructor(e,t){this.variableNames=["x"];let{windowSize:n,batchSize:a,inSize:r,outSize:i}=e;this.outputShape=[a,i];let s=4*Math.floor(n/4),o=n%4,l="sumValue += dot(values, ones);";if(null!=t){let e=1/t;l="sumValue += dot(values * ".concat(cs.isInt(e)?e.toPrecision(2):e,", ones);")}let c="";r%n>0&&(c="\n        if (inIdx < 0 || inIdx >= ".concat(r,") {\n          return 0.0;\n        }\n      ")),this.userCode="\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ".concat(c,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(s,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(l,"\n        }\n\n        int inIdx = inOffset + ").concat(s,";\n        if (").concat(1===o,") {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ").concat(l,"\n        } else if (").concat(2===o,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ").concat(l,"\n        } else if (").concat(3===o,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ").concat(l,"\n        }\n        setOutput(sumValue);\n      }\n    ")}}class Cr{constructor(e,t){this.variableNames=["x"];let{windowSize:n,batchSize:a,inSize:r,outSize:i}=e;this.outputShape=[a,i];let s="0.0",o="";"prod"===t?s="1.0":"min"===t?(s="1.0 / 1e-20",o="min"):"max"===t&&(s="-1.0 / 1e-20",o="max");let l="".concat(t,"(").concat(t,"(").concat(t,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===t?l="sumValue":"prod"===t?l="prodValue":"all"===t?l="allValue":"any"===t&&(l="anyValue");let c=4*Math.floor(n/4),u=n%4,h="\n      if (".concat("sum"===t,") {\n        sumValue += dot(values, ones);\n      } else if (").concat("prod"===t,") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(o,"(values, minMaxValue);\n        if (").concat("min"===t," || ").concat("max"===t,") {\n          minMaxValue = ").concat(o,"(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    "),d="vec4";"all"===t?(s="1.0",h="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",d="bvec4"):"any"===t&&(s="0.0",h="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",d="bvec4");let p="";r%n>0&&(p="\n        if (inIdx < 0 || inIdx >= ".concat(r,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(s,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(p,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        vec4 minMaxValue = vec4(").concat(s,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(c,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(h,"\n        }\n\n        int inIdx = inOffset + ").concat(c,";\n        if (").concat(1===u,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(h,"\n        } else if (").concat(2===u,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(h,"\n        } else if (").concat(3===u,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(h,"\n        }\n        setOutput(").concat(l,");\n      }\n    ")}}function Ci(e,t,n,a){let r=function(e){let t=[];for(;0===t.length||1!==t[t.length-1].outSize;){let n=t.length?t[t.length-1].outSize:e[1],a=oB.computeOptimalWindowSize(n);t.push({inSize:n,windowSize:a,outSize:Math.ceil(n/a)})}return t}(e.shape),i=e;for(let s=0;s<r.length;s++){let o,l,{inSize:c,windowSize:u,outSize:h}=r[s];o="mean"===n?0===s?new Ca({windowSize:u,inSize:c,batchSize:e.shape[0],outSize:h},c):new Ca({windowSize:u,inSize:c,batchSize:e.shape[0],outSize:h}):new Cr({windowSize:u,inSize:c,batchSize:e.shape[0],outSize:h},n),l=i,i=a.runWebGLProgram(o,[i],t),l.dataId!==e.dataId&&a.disposeIntermediateTensorInfo(l)}return i}class Cs{constructor(e,t){this.variableNames=["A"];let n=Array(e.length);for(let a=0;a<n.length;a++)n[a]=e[t[a]];this.outputShape=n,this.rank=n.length;let a=kt(this.rank),r=function(e){let t=e.length;if(t>6)throw Error("Transpose for rank ".concat(t," is not yet supported"));let n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],a=Array(t);for(let t=0;t<e.length;t++)a[e[t]]=n[t];return a.join()}(t);this.userCode="\n    void main() {\n      ".concat(a," resRC = getOutputCoords();\n      setOutput(getA(").concat(r,"));\n    }\n    ")}}class Co{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;let n=Array(e.length);for(let a=0;a<n.length;a++)n[a]=e[t[a]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));let a=kt(this.rank),r=Sk("rc",this.rank),i=Array(this.rank);for(let e=0;e<t.length;e++)i[t[e]]=r[e];let s="vec2(".concat(i.slice(-2).join(),")"),o="++".concat(r[this.rank-1]," < ").concat(n[this.rank-1]),l="getChannel(getA(".concat(i.join(),"), ").concat(s,")");this.userCode="\n    void main() {\n      ".concat(a," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(l,";\n      if(").concat(o,") {\n        result[1] = ").concat(l,";\n      }\n      --").concat(r[this.rank-1],";\n      if(++").concat(r[this.rank-2]," < ").concat(n[this.rank-2],") {\n        result[2] = ").concat(l,";\n        if(").concat(o,") {\n          result[3] = ").concat(l,";\n        }\n      }\n      setOutput(result);\n    }\n    ")}}function Cl(e,t,n){let a=eT.getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Co(e.shape,t):new Cs(e.shape,t);return n.runWebGLProgram(a,[e],e.dtype)}function Cc(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:i,keepDims:s}=a;return function(e,t,n,a){let r=e.shape.length,i=cs.parseAxisParam(t,e.shape),s=i,o=oB.getAxesPermutation(s,r),l=null!=o,c=e;l&&(c=Cl(e,o,a),s=oB.getInnerMostAxes(s.length,r)),oB.assertAxesAreInnerMostDims("sum",s,r);let[u,h]=oB.computeOutAndReduceShapes(c.shape,s),d=u;n&&(d=oB.expandShapeToKeepDim(u,i));let p=cs.sizeFromShape(h),f=Cn({inputs:{x:c},attrs:{shape:[cs.sizeFromShape(e.shape)/p,p]},backend:a}),m=Ci(f,av(e.dtype),"sum",a),g=Cn({inputs:{x:m},attrs:{shape:d},backend:a});return a.disposeIntermediateTensorInfo(f),a.disposeIntermediateTensorInfo(m),l&&a.disposeIntermediateTensorInfo(c),g}(r,i,s,n)}function Cu(e){let t,{inputs:n,backend:a,attrs:r}=e,{x:i}=n,{perm:s}=r,o=Array(i.shape.length);for(let e=0;e<o.length;e++)o[e]=i.shape[s[e]];if(a.shouldExecuteOnCPU([i])){let e=Sw(a.texData.get(i.dataId).values,i.shape,i.dtype,s,o);t=a.makeTensorInfo(o,i.dtype),a.texData.get(t.dataId).values=e}else t=Cl(i,s,a);return t}function Ch(e){let t,{a:n,b:a,transposeA:r,transposeB:i,backend:s,bias:o=null,preluActivationWeights:l=null,leakyreluAlpha:c=0,activation:u=null}=e,h=n.shape.length,d=a.shape.length,p=r?n.shape[h-2]:n.shape[h-1],f=i?a.shape[d-1]:a.shape[d-2],m=r?n.shape[h-1]:n.shape[h-2],g=i?a.shape[d-2]:a.shape[d-1],x=n.shape.slice(0,-2),y=a.shape.slice(0,-2),b=cs.sizeFromShape(x),v=cs.sizeFromShape(y),w=v9.assertAndGetBroadcastShape(n.shape.slice(0,-2),a.shape.slice(0,-2)).concat([m,g]);cs.assert(p===f,()=>"Error in matMul: inner shapes (".concat(p,") and (")+"".concat(f,") of Tensors with shapes ").concat(n.shape," and ")+"".concat(a.shape," and transposeA=").concat(r)+" and transposeB=".concat(i," must match."));let N=r?[b,p,m]:[b,m,p],k=i?[v,g,f]:[v,f,g],S=Cn({inputs:{x:n},backend:s,attrs:{shape:N}}),C=Cn({inputs:{x:a},backend:s,attrs:{shape:k}}),T=[S,C],I=Math.max(b,v),E=r?S.shape[1]:S.shape[2],_=null!=o,A=null!=l,R="leakyrelu"===u,D=null!=u?S6(u,!0):null,M=_||A||R||null!=D;if((1===m||1===g)&&E>1e3&&!1===M){let e=S,n=C;r&&(e=Cu({inputs:{x:S},backend:s,attrs:{perm:[0,2,1]}}),T.push(e)),i&&(n=Cu({inputs:{x:C},backend:s,attrs:{perm:[0,2,1]}}),T.push(n));let a=1!==g,o=1===g,l=e;a&&(l=Cn({inputs:{x:e},backend:s,attrs:{shape:[I,E,1]}}),T.push(l));let c=n;o&&(c=Cn({inputs:{x:n},backend:s,attrs:{shape:[I,1,E]}}),T.push(c));let u=Ct({inputs:{a:l,b:c},backend:s});t=Cc({inputs:{x:u},backend:s,attrs:{axis:1===g?2:1,keepDims:!0}}),T.push(u)}else{let e=ab(n.dtype,a.dtype),u=new S8(N,k,[I,m,g],r,i,_,D,A,R),h=[S,C];if(null!=o&&h.push(o),A&&h.push(l),R){let e=s.makeTensorInfo([],"float32",cs.createScalarValue(c,"float32"));h.push(e),T.push(e)}t=s.runWebGLProgram(u,h,e)}let F=Cn({inputs:{x:t},backend:s,attrs:{shape:w}});for(let e of(T.push(t),T))s.disposeIntermediateTensorInfo(e);return F}let Cd="return abs(x);",Cp=S4({opSnippet:SD+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),Cf=S4({opSnippet:SD+"\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),Cm="return a + b;",Cg=S5({opSnippet:Cm,packedOpSnippet:Cm,supportsComplex:!0,cpuKernelImpl:kL});class Cx{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((e,t)=>"T".concat(t));let n=[];this.variableNames.forEach(e=>{n.push("float v".concat(e," = get").concat(e,"AtOutCoords();"))});let a=this.variableNames.map(e=>"v".concat(e)).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        float result = ").concat(a,";\n        setOutput(result);\n      }\n    ")}}class Cy{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((e,t)=>"T".concat(t));let n=[];this.variableNames.forEach(e=>{n.push("vec4 v".concat(e," = get").concat(e,"AtOutCoords();"))});let a=this.variableNames.map(e=>"v".concat(e)).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        vec4 result = ").concat(a,";\n        setOutput(result);\n      }\n    ")}}var oB=oB,cs=cs,oB=oB,cs=cs,oB=oB,cs=cs,oB=oB,cs=cs;class Cb{constructor(e,t,n){this.variableNames=["A"];let{windowSize:a,batchSize:r,outSize:i}=e;n||this.variableNames.push("bestIndicesA"),this.outputShape=[r,i],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(a,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          int inIdx = ").concat(n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));",";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat("max"===t?">":"<"," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")}}var cs=cs;class Cv{constructor(e,t,n,a){let r,i;this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,cs.assert(e.length>2,()=>"Packed arg".concat(n.charAt(0).toUpperCase()+n.slice(1)," supports only inputs with rank above 2."));let s=Math.ceil(e[e.length-1]/t);this.outputShape=e.slice(0,-1),s>1&&this.outputShape.push(s),a||this.variableNames.push("bestIndicesA");let o=this.outputShape,l=o.length,c=kt(l),u=SS("coords",l);if(1===s){let e=kt(i=l+1);r="\n        ".concat(e," sourceLocR = ").concat(e,"(").concat(u.join(),", 0);\n        ++").concat(u[l-1],";\n        ").concat(e," sourceLocG = ").concat(e,"(").concat(u.join(),", 0);\n        ++").concat(u[l-2],";\n        ").concat(e," sourceLocA = ").concat(e,"(").concat(u.join(),", 0);\n        --").concat(u[l-1],";\n        ").concat(e," sourceLocB = ").concat(e,"(").concat(u.join(),", 0);\n        --").concat(u[l-2],";")}else i=l,r="\n        ".concat(c," sourceLocR = coords;\n        ++").concat(u[l-1],";\n        ").concat(c," sourceLocG = coords;\n        ++").concat(u[l-2],";\n        ").concat(c," sourceLocA = coords;\n        --").concat(u[l-1],";\n        ").concat(c," sourceLocB = coords;\n        --").concat(u[l-2],";");let h=["x","y","z","w","u","v"].slice(0,i),d="."+h[i-1],p=h.map(e=>"int "+e),f=SS("sourceLocR",i-1).concat("inIdx.r"),m=SS("sourceLocG",i-1).concat("inIdx.g"),g=SS("sourceLocB",i-1).concat("inIdx.b"),x=SS("sourceLocA",i-1).concat("inIdx.a"),y="max"===n?"greaterThan":"lessThan",b=a?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(f.join(),"),\n                             getBestIndicesAChannel(").concat(m.join(),"),\n                             getBestIndicesAChannel(").concat(g.join(),"),\n                             getBestIndicesAChannel(").concat(x.join(),")));"),v="vec4(\n            getAChannel(".concat(f.join(),"),\n            hasNextCol ? getAChannel(").concat(m.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(g.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(x.join(),") : 0.)"),w=a?"":"\n      float getBestIndicesAChannel(".concat(p.join(),") {\n        return getChannel(getBestIndicesA(").concat(h.join(),"),\n                                          vec2(").concat(h.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(p.join(),") {\n        return getChannel(getA(").concat(h.join(),"),\n                               vec2(").concat(h.slice(-2).join(),"));\n      }\n      ").concat(w,"\n      void main() {\n        ").concat(c," coords = getOutputCoords();\n        bool hasNextCol = ").concat(u[l-1]," < ").concat(o[l-1]-1,";\n        bool hasNextRow = ").concat(u[l-2]," < ").concat(o[l-2]-1,";\n        ").concat(r,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(d,", sourceLocG").concat(d,",\n          sourceLocB").concat(d,", sourceLocA").concat(d,") * ").concat(t,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(v,";\n\n        for (int i = 0; i < ").concat(t,"; i++) {\n          inIdx = srcIdx;\n          ").concat(b,"\n          vec4 candidate = ").concat(v,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(y,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")}}function Cw(e,t,n,a){let r=[n];if(oB.assertAxesAreInnerMostDims("arg"+a.charAt(0).toUpperCase()+a.slice(1),r,t.shape.length),!eT.getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){let n=[],i=e.texData.get(t.dataId),s=null!==i&&i.isPacked,o=t;s&&n.push(o=e.unpackTensor(t));let[l,c]=oB.computeOutAndReduceShapes(o.shape,r),u=Cn({inputs:{x:o},backend:e,attrs:{shape:[-1,cs.sizeFromShape(c)]}});n.push(u);let h=function e(t,n,a){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=n.shape[0],s=n.shape[1];null!=r&&(i=r.shape[0],s=r.shape[1]);let o=oB.computeOptimalWindowSize(s),l=new Cb({windowSize:o,inSize:s,batchSize:i,outSize:Math.ceil(s/o)},a,null==r),c=[n];null!=r&&c.push(r);let u=t.runWebGLProgram(l,c,"int32");if(1===u.shape[1])return u;let h=e(t,n,a,u);return t.disposeIntermediateTensorInfo(u),h}(e,u,a);n.push(h);let d=Cn({inputs:{x:h},backend:e,attrs:{shape:l}});return n.forEach(t=>e.disposeIntermediateTensorInfo(t)),d}return function e(t,n,a){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=null!=r?r.shape:n.shape,s=i[i.length-1],o=new Cv(i,oB.computeOptimalWindowSize(s),a,null==r),l=null==r?[n]:[n,r],c=t.runWebGLProgram(o,l,"int32");if(c.shape.length===n.shape.length){let r=e(t,n,a,c);return t.disposeIntermediateTensorInfo(c),r}return c}(e,t,a)}var oB=oB,cs=cs;let CN=S4({opSnippet:SD+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),Ck=S4({opSnippet:SD+"return log(x + sqrt(x * x + 1.0));"}),CS=S4({opSnippet:SD+"\n  return atan(x);\n"}),CC=S5({opSnippet:SK+"\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+SY+"\n  return result;\n"}),CT=S4({opSnippet:SD+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"});var oB=oB,cs=cs;class CI{constructor(e,t,n,a=!1,r=!1){if(this.variableNames=["x"],"avg"===t&&n)throw Error("Cannot compute positions for average pool.");let i=e.filterWidth,s=e.strideHeight,o=e.strideWidth,l=e.dilationHeight,c=e.dilationWidth,u=e.effectiveFilterHeight,h=e.effectiveFilterWidth,d=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;let f="avg"===t,m="((batch  * ".concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + d"),g="(xR * ".concat(e.inWidth," + xC) * ").concat(e.inChannels," + d"),x="0.0";if(f||(x="-1.0 / 1e-20"),n){this.userCode="\n        const ivec2 strides = ivec2(".concat(s,", ").concat(o,");\n        const ivec2 pads = ivec2(").concat(d,", ").concat(p,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(u,";\n              wR += ").concat(l,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(h,";\n                wC += ").concat(c,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ").concat(">="," currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(a?r?m:g:"wR * ".concat(h," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ");return}let y="".concat(t,"(").concat(t,"(").concat(t,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(y="avgValue / max(count, 1.0)");let b=4*Math.floor(i/4),v=i%4,w="\n      if (".concat(f,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(s,", ").concat(o,");\n      const ivec2 pads = ivec2(").concat(d,", ").concat(p,");\n      const float initializationValue = ").concat(x,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(e.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(x,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(u,";\n            wR += ").concat(l,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(e.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(b,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(c,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(c,", d),\n              getValue(batch, xR, xC + 2 * ").concat(c,", d),\n              getValue(batch, xR, xC + 3 * ").concat(c,", d)\n            );\n\n            ").concat(w,"\n          }\n\n          int xC = xCCorner + ").concat(b,";\n          if (").concat(1===v,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(w,"\n          } else if (").concat(2===v,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(c,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(w,"\n          } else if (").concat(3===v,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(c,", d),\n              getValue(batch, xR, xC + 2 * ").concat(c,", d),\n              initializationValue\n            );\n\n            ").concat(w,"\n          }\n        }\n        setOutput(").concat(y,");\n      }\n    ")}}class CE{constructor(e,t,n,a=!1,r=!1){if(this.variableNames=["x"],"avg"===t&&n)throw Error("Cannot compute positions for average pool.");let i=e.filterWidth,s=e.strideDepth,o=e.strideHeight,l=e.strideWidth,c=e.dilationDepth,u=e.dilationHeight,h=e.dilationWidth,d=e.effectiveFilterDepth,p=e.effectiveFilterHeight,f=e.effectiveFilterWidth,m=e.padInfo.front,g=e.padInfo.top,x=e.padInfo.left;this.outputShape=e.outShape;let y="avg"===t,b="0.0";if(y||(b="-1.0 / 1e-20"),n){this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(s,", ").concat(o,", ").concat(l,");\n        const ivec3 pads = ivec3(").concat(m,", ").concat(g,", ").concat(x,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(d,";\n              wD += ").concat(c,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(e.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(p,";\n                wR += ").concat(u,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(e.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(f,";\n                  wC += ").concat(h,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ").concat(">="," currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(a?r?"(((batch * ".concat(e.inDepth," + xD) * ").concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + ch"):"((xD * ".concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + ch"):"wD * ".concat(p," * ").concat(f," +\n                      wR * ").concat(f," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ");return}let v="".concat(t,"(").concat(t,"(").concat(t,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(v="avgValue / max(count, 1.0)");let w=4*Math.floor(i/4),N=i%4,k="\n      if (".concat(y,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(s,", ").concat(o,", ").concat(l,");\n      const ivec3 pads = ivec3(").concat(m,", ").concat(g,", ").concat(x,");\n      const float initializationValue = ").concat(b,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(e.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(b,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(d,";\n            wD += ").concat(c,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(e.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(p,";\n            wR += ").concat(u,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(w,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(h,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(h,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(h,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(h,", ch)\n              );\n\n              ").concat(k,"\n            }\n\n            int xC = xCCorner + ").concat(w,";\n            if (").concat(1===N,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(k,"\n            } else if (").concat(2===N,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(h,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(k,"\n            } else if (").concat(3===N,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(h,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(h,", ch),\n                initializationValue\n              );\n\n              ").concat(k,"\n            }\n          }\n        }\n        setOutput(").concat(v,");\n      }\n    ")}}var oB=oB,oB=oB;class C_{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,a=e.strideHeight,r=e.strideWidth,i=e.dilationHeight,s=e.dilationWidth,o=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=o-1-e.padInfo.top,u=l-1-e.padInfo.left;this.userCode="\n      const ivec2 pads = ivec2(".concat(c,", ").concat(u,");\n      const float avgMultiplier = float(").concat(1/(t*n),");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(o,";\n            wR += ").concat(i,") {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(l,";\n            wC+= ").concat(s,") {\n            float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class CA{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;let t=e.filterDepth,n=e.filterHeight,a=e.filterWidth,r=e.strideDepth,i=e.strideHeight,s=e.strideWidth,o=e.dilationDepth,l=e.dilationHeight,c=e.dilationWidth,u=e.effectiveFilterDepth,h=e.effectiveFilterHeight,d=e.effectiveFilterWidth,p=u-1-e.padInfo.front,f=h-1-e.padInfo.top,m=d-1-e.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3(".concat(p,", ").concat(f,", ").concat(m,");\n      const float avgMultiplier = float(").concat(1/(t*n*a),");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(u,";\n            wD += ").concat(o,") {\n          float dyD = float(dyDCorner + wD) / ").concat(r,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(e.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(h,";\n              wR += ").concat(l,") {\n            float dyR = float(dyRCorner + wR) / ").concat(i,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(d,";\n                wC += ").concat(c,") {\n              float dyC = float(dyCCorner + wC) / ").concat(s,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}var oB=oB,cs=cs,oB=oB;class CR{constructor(e,t,n,a,r,i){this.outputShape=[],this.variableNames=["x","mean","variance"],oB.assertAndGetBroadcastShape(e,t),oB.assertAndGetBroadcastShape(e,n);let s="0.0";null!=a&&(oB.assertAndGetBroadcastShape(e,a),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");let o="1.0";null!=r&&(oB.assertAndGetBroadcastShape(e,r),this.variableNames.push("scale"),o="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(s,";\n        float scale = ").concat(o,";\n        float inv = scale * inversesqrt(variance + float(").concat(i,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")}}var oB=oB;class CD{constructor(e,t,n,a,r,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],oB.assertAndGetBroadcastShape(e,t),oB.assertAndGetBroadcastShape(e,n);let s="vec4(0.0)";null!=a&&(oB.assertAndGetBroadcastShape(e,a),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");let o="vec4(1.0)";null!=r&&(oB.assertAndGetBroadcastShape(e,r),this.variableNames.push("scale"),o="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        vec4 offset = ".concat(s,";\n        vec4 scale = ").concat(o,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(i,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")}}var oB=oB,cs=cs,vR=sR,cs=cs;class CM{constructor(e){let t;this.variableNames=["source"],this.outputShape=e,this.rank=e.length;let n=kt(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];let a=function(e){if(1===e)return"sourceLoc";if(e<=6)return CF.slice(0,e).map(e=>"sourceLoc."+e).join(",");throw Error("Slicing for rank ".concat(e," is not yet supported"))}(this.rank),r=e.map((e,t)=>"sourceLoc.".concat(CF[t]," = start[").concat(t,"] + coords.").concat(CF[t],";"));t="\n        ".concat(n," sourceLoc;\n        ").concat(n," coords = getOutputCoords();\n        ").concat(r.join("\n"),"\n      "),this.userCode="\n      void main() {\n        ".concat(t,"\n        setOutput(getSource(").concat(a,"));\n      }\n    ")}}let CF=["x","y","z","w","u","v"];class CO{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];let t=kt(this.rank),n=SS("coords",this.rank),a=SS("sourceLoc",this.rank),r=1===this.rank?"sourceLoc":"vec2(".concat(a.slice(-2).join(),")"),i="getChannel(getSource(".concat(a.join(),"), ").concat(r,")"),s="\n      result.x = ".concat(i,";\n      if (++").concat(n[this.rank-1]," < ").concat(e[this.rank-1],") {\n        ++").concat(a[this.rank-1],";\n        result.y = ").concat(i,";\n        --").concat(a[this.rank-1],";\n      }\n    "),o=1===this.rank?"":"\n      --".concat(n[this.rank-1],";\n      if (++").concat(n[this.rank-2]," < ").concat(e[this.rank-2],") {\n        ++").concat(a[this.rank-2],";\n        result.z = ").concat(i,";\n        if (++").concat(n[this.rank-1]," < ").concat(e[this.rank-1],") {\n          ++").concat(a[this.rank-1],";\n          result.w = ").concat(i,";\n        }\n      }\n    "),l=this.rank<=4?"sourceLoc = coords +\n            ".concat(t,"(").concat(e.map((e,t)=>"start[".concat(t,"]")).join(),");"):e.map((e,t)=>"".concat(a[t]," = ").concat(n[t]," + start[").concat(t,"];")).join("\n");this.userCode="\n      void main() {\n        ".concat(t," coords = getOutputCoords();\n        ").concat(t," sourceLoc;\n        ").concat(l,"\n        vec4 result = vec4(0.);\n        ").concat(s,"\n        ").concat(o,"\n        setOutput(result);\n      }\n    ")}}function CP(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{begin:i,size:s}=a,[o,l]=vR.parseSliceParams(r,i,s);if(vR.assertParamsValid(r,o,l),0===cs.sizeFromShape(l))return n.makeTensorInfo(l,r.dtype,[]);if(n.shouldExecuteOnCPU([r])||"string"===r.dtype){let e=Sl(n.texData.get(r.dataId).values,o,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,e)}let{isPacked:c}=n.texData.get(r.dataId),u=vR.isSliceContinous(r.shape,o,l);if(c||!u){let e=eT.getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new CO(l):new CM(l),t=[o];return n.runWebGLProgram(e,[r],r.dtype,t)}return n.uploadToGPU(r.dataId),function(e,t,n,a){let r=a.texData.get(e.dataId),i=a.makeTensorInfo(n,e.dtype),s=a.texData.get(i.dataId);Object.assign(s,r),s.refCount=1,s.shape=n,s.dtype=e.dtype;let o=vR.computeFlatOffset(t,cs.computeStrides(e.shape));r.slice&&(o+=r.slice.flatOffset),s.slice={flatOffset:o,origDataId:r.slice&&r.slice.origDataId||e.dataId};let l=a.dataRefCount.get(s.slice.origDataId)||1;return a.dataRefCount.set(s.slice.origDataId,l+1),i}(r,o,l,n)}var oB=oB,cs=cs;let Cj=S5({opSnippet:"return float(a != b);",cpuKernelImpl:k9,dtype:"bool"});function CL(e){let{inputs:t,backend:n}=e,{input:a}=t;return SQ({inputs:{x:n.texData.get(a.dataId).complexTensorInfos.real},backend:n})}let Cz="return ceil(x);",CB=S4({opSnippet:Cz,packedOpSnippet:Cz,cpuKernelImpl:kW});class CV{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}}class CU{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}}class CW{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}}function CG(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}var oB=oB,cs=cs,oB=oB,cs=cs,oB=oB;class CH{constructor(e){this.outputShape=[],this.outputShape=oB.computeOutShape(e,1),this.variableNames=e.map((e,t)=>"T".concat(t));let t=Array(e.length-1);t[0]=e[0][1];for(let n=1;n<t.length;n++)t[n]=t[n-1]+e[n][1];let n=["if (yC < ".concat(t[0],") setOutput(getT0(yR, yC));")];for(let e=1;e<t.length;e++){let a=t[e-1];n.push("else if (yC < ".concat(t[e],") ")+"setOutput(getT".concat(e,"(yR, yC-").concat(a,"));"))}let a=t.length,r=t[t.length-1];n.push("else setOutput(getT".concat(a,"(yR, yC-").concat(r,"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(n.join("\n        "),"\n      }\n    ")}}var oB=oB;class Cq{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=oB.computeOutShape(e,t);let n=this.outputShape,a=n.length,r=kt(a),i=SS("coords",a),s=["x","y","z","w","u","v"].slice(0,a);this.variableNames=e.map((e,t)=>"T".concat(t));let o=Array(e.length-1);o[0]=e[0][t];for(let n=1;n<o.length;n++)o[n]=o[n-1]+e[n][t];let l=s[t],c=s.slice(-2),u=s.join(),h="if (".concat(l," < ").concat(o[0],") {\n        return getChannel(\n            getT0(").concat(u,"), vec2(").concat(c.join(),"));\n        }");for(let e=1;e<o.length;e++){let t=o[e-1];h+="\n        if (".concat(l," < ").concat(o[e],"  && ").concat(l," >= ").concat(o[e-1],") {\n          return getChannel(\n            getT").concat(e,"(").concat(CK(s,l,t),"),\n            vec2(").concat(CK(c,l,t),"));\n        }")}let d=o.length,p=o[o.length-1];h+="\n        return getChannel(\n          getT".concat(d,"(").concat(CK(s,l,p),"),\n          vec2(").concat(CK(c,l,p),"));"),this.userCode="\n      float getValue(".concat(s.map(e=>"int "+e),") {\n        ").concat(h,"\n      }\n\n      void main() {\n        ").concat(r," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(i,"), 0., 0., 0.);\n\n        ").concat(i[a-1]," = ").concat(i[a-1]," + 1;\n        if (").concat(i[a-1]," < ").concat(n[a-1],") {\n          result.g = getValue(").concat(i,");\n        }\n\n        ").concat(i[a-2]," = ").concat(i[a-2]," + 1;\n        if (").concat(i[a-2]," < ").concat(n[a-2],") {\n          result.a = getValue(").concat(i,");\n        }\n\n        ").concat(i[a-1]," = ").concat(i[a-1]," - 1;\n        if (").concat(i[a-2]," < ").concat(n[a-2]," &&\n            ").concat(i[a-1]," < ").concat(n[a-1],") {\n          result.b = getValue(").concat(i,");\n        }\n        setOutput(result);\n      }\n    ")}}function CK(e,t,n){let a=e.indexOf(t);return e.map((e,t)=>t===a?"".concat(e," - ").concat(n):e).join()}function CX(e){let{inputs:t,backend:n}=e,{input:a}=t;return SQ({inputs:{x:n.texData.get(a.dataId).complexTensorInfos.imag},backend:n})}function CY(e){let{inputs:t,backend:n,attrs:a}=e,{axis:r}=a,i=cs.parseAxisParam(r,t[0].shape)[0],s=t.map(e=>e.shape);oB.assertParamsConsistent(s,i);let o=oB.computeOutShape(t.map(e=>e.shape),i);if(0===cs.sizeFromShape(o))return n.makeTensorInfo(o,t[0].dtype,[]);let l=t.filter(e=>cs.sizeFromShape(e.shape)>0);return 1===l.length?SQ({inputs:{x:l[0]},backend:n}):function e(t,n,a){let r=t[0].dtype;if("complex64"===r){let r=t.map(e=>CL({inputs:{input:e},backend:a})),i=t.map(e=>CX({inputs:{input:e},backend:a})),s=e(r,n,a),o=e(i,n,a),l=SJ({inputs:{real:s,imag:o},backend:a});return r.forEach(e=>a.disposeIntermediateTensorInfo(e)),i.forEach(e=>a.disposeIntermediateTensorInfo(e)),a.disposeIntermediateTensorInfo(s),a.disposeIntermediateTensorInfo(o),l}let i=a.shouldExecuteOnCPU(t);if("string"===r&&(i=!0),i){let e=t.map(e=>{let t=cs.sizeFromShape(e.shape.slice(n));return Cn({inputs:{x:e},backend:a,attrs:{shape:[-1,t]}})}),i=e.map(e=>({vals:a.readSync(e.dataId),shape:e.shape})),s=kG(i,oB.computeOutShape(e.map(e=>e.shape),1),r,1===e[0].shape[0]),o=oB.computeOutShape(t.map(e=>e.shape),n),l=a.makeTensorInfo(o,r,s);return e.forEach(e=>a.disposeIntermediateTensorInfo(e)),l}let s=t.filter(e=>cs.sizeFromShape(e.shape)>0),o=eT.getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&s[0].shape.length>1;if(1===s.length){let e=o?new SR(t[0].shape,SP):new Sj(t[0].shape,SP);return a.runWebGLProgram(e,t,r)}let l=eT.getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(s.length>l){let t=[];for(let r=0;r<s.length;r+=l){let i=s.slice(r,r+l);t.push(e(i,n,a))}let r=e(t,n,a);for(let e of t)a.disposeIntermediateTensorInfo(e);return r}if(o){let e=new Cq(s.map(e=>e.shape),n);return a.runWebGLProgram(e,s,r)}let{tensors2D:c,outShape:u}=function(e,t,n){let a=oB.computeOutShape(e.map(e=>e.shape),t);return{tensors2D:e.map(e=>Cn({inputs:{x:e},attrs:{shape:[-1,cs.sizeFromShape(e.shape.slice(t))]},backend:n})),outShape:a}}(s,n,a),h=new CH(c.map(e=>e.shape)),d=a.runWebGLProgram(h,c,r);c.forEach(e=>a.disposeIntermediateTensorInfo(e));let p=Cn({inputs:{x:d},attrs:{shape:u},backend:a});return a.disposeIntermediateTensorInfo(d),p}(l,i,n)}var oB=oB;class CZ{constructor(e,t=!1,n=null,a=!1,r=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;let i=e.padInfo.top,s=e.padInfo.left,o=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,u=e.dilationWidth,h=e.filterHeight,d=e.filterWidth,p=4*Math.floor(e.inChannels/4),f=e.inChannels%4,m="channelsLast"===e.dataFormat,g=m?1:2,x=m?2:3,y=m?3:1,b="",v="";n&&(b=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):r?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),v="result = activation(result);"),t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(b,"\n\n      const ivec2 strides = ivec2(").concat(o,", ").concat(l,");\n      const ivec2 pads = ivec2(").concat(i,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(y,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(g,"], coords[").concat(x,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(h,"; wR++) {\n          int xR = xRCorner + wR * ").concat(c,";\n\n          if (xR < 0 || xR >= ").concat(e.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(d,"; wC++) {\n            int xC = xCCorner + wC * ").concat(u,";\n\n            if (xC < 0 || xC >= ").concat(e.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(p,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(m,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(1===f,") {\n\n              if (").concat(m,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(p,") *\n                    getW(wR, wC, ").concat(p,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(p,", xR, xC) *\n                    getW(wR, wC, ").concat(p,", d2);\n              }\n\n            } else if (").concat(2===f,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(p,", d2),\n                getW(wR, wC, ").concat(p," + 1, d2)\n              );\n\n              if (").concat(m,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(p,"),\n                  getX(batch, xR, xC, ").concat(p," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(p,", xR, xC),\n                  getX(batch, ").concat(p," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(3===f,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(p,", d2),\n                getW(wR, wC, ").concat(p," + 1, d2),\n                getW(wR, wC, ").concat(p," + 2, d2)\n              );\n\n              if (").concat(m,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(p,"),\n                  getX(batch, xR, xC, ").concat(p," + 1),\n                  getX(batch, xR, xC, ").concat(p," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(p,", xR, xC),\n                  getX(batch, ").concat(p," + 1, xR, xC),\n                  getX(batch, ").concat(p," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(t?"result += getBiasAtOutCoords();":"","\n        ").concat(v,"\n        setOutput(result);\n      }\n    ")}}class CQ{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;let t=e.padInfo.front,n=e.padInfo.top,a=e.padInfo.left,r=e.strideDepth,i=e.strideHeight,s=e.strideWidth,o=e.dilationDepth,l=e.dilationHeight,c=e.dilationWidth,u=e.filterDepth,h=e.filterHeight,d=e.filterWidth,p=4*Math.floor(e.inChannels/4),f=e.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(r,", ").concat(i,", ").concat(s,");\n      const ivec3 pads = ivec3(").concat(t,", ").concat(n,", ").concat(a,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(u,"; wF++) {\n          int xF = xFCorner + wF * ").concat(o,";\n\n          if (xF < 0 || xF >= ").concat(e.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(h,"; wR++) {\n            int xR = xRCorner + wR * ").concat(l,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(d,"; wC++) {\n              int xC = xCCorner + wC * ").concat(c,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(p,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(1===f,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(p,") *\n                  getW(wF, wR, wC, ").concat(p,", d2);\n              } else if (").concat(2===f,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(p,"),\n                  getX(batch, xF, xR, xC, ").concat(p," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(p,", d2),\n                  getW(wF, wR, wC, ").concat(p," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(3===f,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(p,"),\n                  getX(batch, xF, xR, xC, ").concat(p," + 1),\n                  getX(batch, xF, xR, xC, ").concat(p," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(p,", d2),\n                  getW(wF, wR, wC, ").concat(p," + 1, d2),\n                  getW(wF, wR, wC, ").concat(p," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}var cs=cs;class CJ{constructor(e,t=!1,n=null,a=!1,r=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=ko(this.outputShape.length);let i=e.padInfo.left,s=e.strideWidth,o=e.dilationWidth,l=e.filterHeight,c=e.filterWidth,u="\n       int xR; int xC; int xCOffset;\n       vec4 wTexel; vec4 previous; vec4 final;";for(let e=0;e<c;e++)u+="\n           vec4 xTexelC".concat(2*e,";\n           int xTexelC").concat(2*e,"Ready;\n           vec4 xTexelC").concat(2*e+1,";\n           int xTexelC").concat(2*e+1,"Ready;\n           vec4 xC").concat(e,";");u+="\n     for (int r = 0; r < ".concat(l,"; r++) {\n      for (int d1 = 0; d1 < ").concat(e.inChannels,"; d1 += 2) {\n       ");for(let e=0;e<c;e++)u+="\n           xTexelC".concat(2*e," = vec4(0.0);\n           xTexelC").concat(2*e,"Ready = 0;\n           xTexelC").concat(2*e+1," = vec4(0.0);\n           xTexelC").concat(2*e+1,"Ready = 0;\n           xC").concat(e," = vec4(0.0);");u+="\n         xR = xRCorner + r * dilations[0];\n         if (xR >=0 && xR < inDims[0]) {\n       ";for(let t=0;t<(c+1)/2;t++){let n=2*t;if(u+="\n           xC = xCCorner + ".concat(n*o,";\n           "),1===s){if(n<c&&(i%2==1?(u+="\n                 xCOffset = xC + 1;\n                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(n,"Ready == 0) {\n                   xTexelC").concat(n," = getX(batch, xR, xCOffset, d1);\n\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(n,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(n,"Ready = 1;\n                 }\n               "),1===o&&n>0?u+="\n                 xC".concat(n," = vec4(xTexelC").concat(n-2,".zw, xTexelC").concat(n,".xy);\n                 "):u+="\n                   xCOffset = xC + 1 - 2;\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       previous.zw = vec2(0.0);\n                     }\n\n                     xC".concat(n," = vec4(previous.zw, xTexelC").concat(n,".xy);\n                   } else {\n                     xC").concat(n," = vec4(0.0, 0.0, xTexelC").concat(n,".xy);\n                   }\n                   ")):u+="\n                 if (xC >= 0 && xC < inDims[1] && xTexelC".concat(n,"Ready == 0) {\n                   xTexelC").concat(n," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(n,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(n,"Ready = 1;\n                 }\n\n                 xC").concat(n," = xTexelC").concat(n,";\n                 "),n+1<c)){let e=i%2==0?cs.nearestLargerEven(o):o;o%2==0&&i%2==1||o%2!=0&&i%2!=1?(u+="\n                   xCOffset = xC + imod(pads[1], 2) + ".concat(e,";\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(n+1,"Ready == 0) {\n                     xTexelC").concat(n+1," = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       xTexelC").concat(n+1,".zw = vec2(0.0);\n                     }\n                     xTexelC").concat(n+1,"Ready = 1;\n                   }\n                   "),o>1?u+="\n                     xCOffset -= 2;\n                     if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                      previous = getX(batch, xR, xCOffset, d1);\n                      xC".concat(n+1," = vec4(previous.zw, xTexelC").concat(n+1,".xy);\n                     } else {\n                      xC").concat(n+1," = vec4(0.0, 0.0, xTexelC").concat(n+1,".xy);\n                     }\n                     "):u+="\n                     xC".concat(n+1," = vec4(xTexelC").concat(n,".zw, xTexelC").concat(n+1,".xy);\n                     ")):1===e?u+="\n                     xC".concat(n+1," = xTexelC").concat(n,";\n                     "):u+="\n                     xCOffset = xC + ".concat(e,";\n\n                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(n+1,"Ready == 0) {\n                       xTexelC").concat(n+1," = getX(batch, xR, xCOffset, d1);\n                       if (xCOffset + 1 >= inDims[1]) {\n                         xTexelC").concat(n+1,".zw = vec2(0.0);\n                       }\n                       xTexelC").concat(n+1,"Ready = 1;\n                     }\n\n                     xC").concat(n+1," = xTexelC").concat(n+1,";\n                     ")}}else n<c&&(i%2==1?(u+="\n                 xCOffset = xC + 1 - strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(n,"Ready == 0) {\n                   xTexelC").concat(n," = getX(batch, xR, xCOffset, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(n,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(n,"Ready = 1;\n                 }\n\n                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(n+1,"Ready == 0) {\n                   xTexelC").concat(n+1," = getX(batch, xR, xC + 1, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xC + 2 >= inDims[1]) {\n                     xTexelC").concat(n+1,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(n+1,"Ready = 1;\n                 }\n\n                 xC").concat(n," = vec4(xTexelC").concat(n,".zw, xTexelC").concat(n+1,".zw);\n               "),n+1<c&&(u+="\n                   final = vec4(0.0);\n                   xCOffset = xC + 1 + strides[1];\n                   if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                     final = getX(batch, xR, xCOffset, d1);\n                   }\n                   xC".concat(n+1," = vec4(xTexelC").concat(n+1,".xy, final.xy);\n                 "))):(u+="\n                 if(xC >= 0 && xC < inDims[1] && xTexelC".concat(n,"Ready == 0) {\n                   xTexelC").concat(n," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(n,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(n,"Ready = 1;\n                 }\n\n                 xCOffset = xC + strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(n+1,"Ready == 0) {\n                   xTexelC").concat(n+1," = getX(batch, xR, xCOffset, d1);\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(n+1,".zw = vec2(0.);\n                   }\n                   xTexelC").concat(n+1,"Ready = 1;\n                 }\n\n                 xC").concat(n," = vec4(\n                   xTexelC").concat(n,".xy, xTexelC").concat(n+1,".xy);\n               "),n+1<c&&(u+="\n                   xC".concat(n+1," = vec4(xTexelC").concat(n,".zw, xTexelC").concat(n+1,".zw);\n                 "))));n<c&&(u+="\n             wTexel = getW(r, ".concat(n,", d1, d2);\n             dotProd += xC").concat(n,".xxzz * vec4(wTexel.xy, wTexel.xy);\n             if(d1 + 1 < ").concat(e.inChannels,") {\n               dotProd += xC").concat(n,".yyww * vec4(wTexel.zw, wTexel.zw);\n             }\n           "),n+1<c&&(u+="\n               wTexel = getW(r, ".concat(n+1,", d1, d2);\n               dotProd += xC").concat(n+1,".xxzz * vec4(wTexel.xy, wTexel.xy);\n               if(d1 + 1 < ").concat(e.inChannels,") {\n                 dotProd += xC").concat(n+1,".yyww * vec4(wTexel.zw, wTexel.zw);\n               }\n             ")))}u+="\n     }\n   ",u+="\n     }\n   ",u+="\n     }\n   ";let h="",d="";n&&(h=a?"vec4 activation(vec4 a) {\n           vec4 b = getPreluActivationWeightsAtOutCoords();\n           ".concat(n,"\n         }"):r?"vec4 activation(vec4 a) {\n           vec4 b = getLeakyreluAlphaAtOutCoords();\n           ".concat(n,"\n         }"):"vec4 activation(vec4 x) {\n           ".concat(n,"\n         }"),d="result = activation(result);"),t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n       ".concat(h,"\n\n       void main() {\n         ivec4 coords = getOutputCoords();\n         int batch = coords.x;\n         ivec2 xRCCorner = coords.yz * strides - pads;\n         int d2 = coords.w;\n         int xRCorner = xRCCorner.x;\n         int xCCorner = xRCCorner.y;\n\n         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n         vec4 dotProd = vec4(0.000000000000001);\n\n         ").concat(u,"\n\n         vec4 result = dotProd - vec4(0.000000000000001);\n         ").concat(t?"result += getBiasAtOutCoords();":"","\n         ").concat(d,"\n         setOutput(result);\n       }\n     ")}}var cs=cs;class C${constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=ko(this.outputShape.length);let{dataFormat:n}=t,a=N1(),r="channelsLast"===n,i=r?1:2,s=r?2:3,o=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":"if(blockIndex < ".concat(e[2]," && pos < ").concat(e[1],") {"),l="";for(let e=0;e<=1;e++)for(let t=0;t<=1;t++)l+="\n          blockIndex = rc.z + ".concat(t,";\n          pos = rc.y + ").concat(e,";\n\n          ").concat(o,"\n            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];\n            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);\n\n            if(d0 < inputShape[").concat(i,"] && d0 >= 0) {\n              // Use custom imod instead mod. On Intel GPU, mod may generate\n              // unexpected value.\n              // https://github.com/tensorflow/tfjs/issues/5447\n              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];\n              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /\n                  inChannels);\n\n              if(d1 < inputShape[").concat(s,"] && d1 >= 0) {\n\n                ch = imod(pos, inChannels);\n\n                if (").concat(r,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(2*e+t,"] = getChannel(\n                    getA(rc.x, d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(2*e+t,"] = getChannel(\n                    getA(rc.x, ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(l,"\n\n        ").concat(a.output," = result;\n      }\n    ")}}function C0(e,t){let n=e.length;return n>=3?t?[...e.slice(0,-3),e[n-3]*e[n-2],e[n-1]]:[...e.slice(0,-3),e[n-3],e[n-2]*e[n-1]]:!t&&1===n&&e[0]>1?[e[0],1]:null}function C1(e){let t,{x:n,filter:a,convInfo:r,backend:i,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:l=0,activation:c=null}=e,u=n.shape,h=i.texData.get(n.dataId),d=r.inChannels,p=u[0]*u[1]*u[2],f=r.outChannels,m="channelsLast"===r.dataFormat,g=[];if(null!=o){let e=C0(o.shape,m);null!=e&&(o=Cn({inputs:{x:o},backend:i,attrs:{shape:e}}),g.push(o))}if(null!=s){let e=C0(s.shape,m);null!=e&&(s=Cn({inputs:{x:s},backend:i,attrs:{shape:e}}),g.push(s))}if(!((1===p||1===f)&&d>1e3)&&h.isPacked&&m&&null!=h.texture&&u[2]%2!=0&&cs.arraysEqual(h.shape.slice(-3),u.slice(-3))){let e=u[0]*u[1]*(u[2]+1),d={dataId:n.dataId,shape:[1,e,r.inChannels],dtype:n.dtype},p=h.shape;h.shape=h.shape.slice(),h.shape[h.shape.length-2]++,cs.assert(NV(h.shape,d.shape),()=>"packed reshape ".concat(h.shape," to ").concat(d.shape," isn't free"));let f=Cn({inputs:{x:a},backend:i,attrs:{shape:[1,r.inChannels,r.outChannels]}});g.push(f);let m=Ch({a:d,b:f,backend:i,transposeA:!1,transposeB:!1,bias:s,activation:c,preluActivationWeights:o,leakyreluAlpha:l}),x=i.texData.get(m.dataId);cs.assert(x.isPacked,()=>"batchMatMul result is expected to be packed"),h.shape=p,x.shape=r.outShape,(t=SQ({inputs:{x:m},backend:i})).shape=r.outShape,g.push(m)}else{let e=r.outHeight*r.outWidth,u=Cn({inputs:{x:n},backend:i,attrs:{shape:m?[r.batchSize,e,r.inChannels]:[r.batchSize,r.inChannels,e]}}),h=Cn({inputs:{x:a},backend:i,attrs:{shape:[1,r.inChannels,r.outChannels]}}),d=Ch({a:m?u:h,b:m?h:u,transposeA:!m,transposeB:!1,backend:i,bias:s,activation:c,preluActivationWeights:o,leakyreluAlpha:l});t=Cn({inputs:{x:d},backend:i,attrs:{shape:r.outShape}}),g.push(u),g.push(h),g.push(d)}for(let e of g)i.disposeIntermediateTensorInfo(e);return t}function C2(e){let{x:t,filter:n,convInfo:a,backend:r,bias:i=null,preluActivationWeights:s=null,leakyreluAlpha:o=0,activation:l=null}=e,{filterWidth:c,filterHeight:u,inChannels:h,outWidth:d,outHeight:p,dataFormat:f}=a,m="channelsLast"===f,g=c*u*h,x=p*d,y=[a.batchSize,g,x],b=[];if(null!=s){let e=C0(s.shape,m);null!=e&&(s=Cn({inputs:{x:s},backend:r,attrs:{shape:e}}),b.push(s))}if(null!=i){let e=C0(i.shape,m);null!=e&&(i=Cn({inputs:{x:i},backend:r,attrs:{shape:e}}),b.push(i))}let v=Cn({inputs:{x:n},backend:r,attrs:{shape:[1,g,cs.sizeFromShape(n.shape)/g]}});b.push(v);let w=new C$(y,a),N=[t.shape,[a.padInfo.top,a.padInfo.left],[a.strideHeight,a.strideWidth],[a.dilationHeight,a.dilationWidth],[a.inChannels],[a.filterWidth*a.inChannels],[a.outWidth]],k=r.runWebGLProgram(w,[t],"float32",N),S=Cn({inputs:{x:k},backend:r,attrs:{shape:y}});b.push(k),b.push(S);let C=null!=i,T=null!=s,I="leakyrelu"===l,E=l?S6(l,!0):null,_=new S8(m?S.shape:v.shape,m?v.shape:S.shape,m?[a.batchSize,x,a.outChannels]:[a.batchSize,a.outChannels,x],!0,!1,C,E,T,I),A=m?[S,v]:[v,S];if(i&&A.push(i),T&&A.push(s),I){let e=r.makeTensorInfo([],"float32",cs.createScalarValue(o,"float32"));A.push(e),b.push(e)}let R=r.runWebGLProgram(_,A,"float32"),D=Cn({inputs:{x:R},backend:r,attrs:{shape:a.outShape}});for(let e of(b.push(R),b))r.disposeIntermediateTensorInfo(e);return D}var oB=oB;class C3{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideHeight,n=e.strideWidth,a=e.padInfo.top,r=e.padInfo.left,i="channelsLast"===e.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(e.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(t," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(r,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              ").concat(i?"float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);":"float dyValue = getDy(b, d2, yR, yC);\n              float xValue = getX(b, d1, xR, xC);\n              dotProd += (xValue * dyValue);","\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class C4{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,a=e.strideHeight,r=e.strideWidth,i="channelsLast"===e.dataFormat,s=t-1-e.padInfo.top,o=n-1-e.padInfo.left;this.userCode="\n      const ivec2 pads = ivec2(".concat(s,", ").concat(o,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(i?3:1,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(i?1:2,"], coords[").concat(i?2:3,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(t,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(t," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2++) {\n\n              if (").concat(i,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class C5{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideDepth,n=e.strideHeight,a=e.strideWidth,r=e.padInfo.front,i=e.padInfo.top,s=e.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(e.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(e.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(t," - ").concat(r,";\n\n            if (xF < 0 || xF >= ").concat(e.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(n," - ").concat(i,";\n\n              if (xR < 0 || xR >= ").concat(e.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(a," - ").concat(s,";\n\n                if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class C6{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterDepth,n=e.filterHeight,a=e.filterWidth,r=e.strideDepth,i=e.strideHeight,s=e.strideWidth,o=t-1-e.padInfo.front,l=n-1-e.padInfo.top,c=a-1-e.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3(".concat(o,", ").concat(l,", ").concat(c,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(t,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(r,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(e.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(t," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(n,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(i,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(n," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(a,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(s,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(a," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}var oB=oB;class C8{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=ko(this.outputShape.length);let t=e.filterHeight,n=e.filterWidth,a=t-1-e.padInfo.top,r=n-1-e.padInfo.left;this.userCode="\n      const ivec2 pads = ivec2(".concat(a,", ").concat(r,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        vec4 result = vec4(0.);\n        for (int wR = 0; wR < ").concat(t,"; wR++) {\n          float dyR = float(dyRCorner + wR) / strides[0];\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n          int wRPerm = ").concat(t," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            float dyC = float(dyCCorner + wC) / strides[1];\n            bool idyCVal = (dyC >= 0.0) && (dyC < ").concat(e.outWidth,".0)\n              && (fract(dyC) == 0.0);\n            int idyC = int(dyC);\n\n            float dyC2 = float(dyCCorner + wC + 1) / strides[1];\n            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ").concat(e.outWidth,".0)\n              && (fract(dyC2) == 0.0);\n            int idyC2 = int(dyC2);\n\n            if (idyCVal && idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?\n                  dySample : getDy(batch, idyR, idyC2, d2);\n\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n\n                dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample2.xy : dySample2.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal) {\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC2, d2);\n                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            }\n          }\n        }\n        setOutput(result);\n      }\n    ")}}var oB=oB,oB=oB,oB=oB;let C9=S4({opSnippet:S3+"\n  return cos(x);\n",packedOpSnippet:"\n  vec4 result = cos(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(SY,"\n  return result;\n")}),C7=S4({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"});class Te{constructor(e,t,n,a,r){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];let[i,s,o,l]=e,[c]=t,[u,h]=n;this.outputShape=[c,u,h,l];let[d,p]=["".concat(s-1,".0"),"".concat(o-1,".0")],[f,m,g]=u>1?["".concat((s-1)/(u-1)),"(y2-y1) * height_ratio","y1*".concat(d," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(d)],[x,y,b]=h>1?["".concat((o-1)/(h-1)),"(x2-x1) * width_ratio","x1*".concat(p," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(p)];this.userCode="\n      const float height_ratio = float(".concat(f,");\n      const float width_ratio = float(").concat(x,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(i,") {\n          return;\n        }\n\n        float height_scale = ").concat(m,";\n        float width_scale = ").concat(y,";\n\n        float in_y = ").concat(g,";\n        if( in_y < 0.0 || in_y > ").concat(d," ) {\n          setOutput(float(").concat(r,"));\n          return;\n        }\n        float in_x = ").concat(b,";\n        if( in_x < 0.0 || in_x > ").concat(p," ) {\n          setOutput(float(").concat(r,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(+("bilinear"===a)," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")}}!function(e){e.Prod="*",e.Sum="+"}(k||(k={}));class Tt{constructor(e,t,n,a){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];let r=this.outputShape.length,i=this.op===k.Prod?"1.0":"0.0",s=n?i:"getX(".concat(Tn(r,"coords",this.op),")"),o=this.outputShape[this.outputShape.length-1],l="",c="";n?(l=a?"end != ".concat(o-1):"end != 0",c=a?"end + 1":"end - 1"):(l=a?"end + pow2 < ".concat(o):"end >= pow2",c=a?"end + pow2":"end - pow2"),this.userCode="\n      void main() {\n        ".concat(kt(r)," coords = getOutputCoords();\n        int end = ").concat(Ta(r,"coords",this.op),";\n        float val = ").concat(s,";\n        int pow2 = int(pow(2.0, index));\n        if (").concat(l,") {\n          int idx = ").concat(c,";\n          ").concat(Ta(r,"coords",this.op)," = idx;\n          val ").concat(this.op,"= getX(").concat(Tn(r,"coords",this.op),");\n        }\n        setOutput(val);\n      }\n    ")}}function Tn(e,t,n){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".x, ").concat(t,".y");if(3===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z");if(4===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z, ").concat(t,".w");throw Error("Cumulative ".concat(n," for rank ").concat(e," is not yet supported"))}function Ta(e,t,n){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".y");if(3===e)return"".concat(t,".z");if(4===e)return"".concat(t,".w");throw Error("Cumulative ".concat(n," for rank ").concat(e," is not yet supported"))}var oB=oB;function Tr(e,t,n,a,r,i){let s=t.shape.length,o=oB.getAxesPermutation([a],s),l=t;null!=o&&(l=Cu({inputs:{x:t},backend:n,attrs:{perm:o}}));let c=oB.getInnerMostAxes(1,s)[0];if(c!==s-1)throw Error("WebGL cumprod shader expects an inner-most axis=".concat(t.shape.length-1," ")+"but got axis=".concat(a));let u=l.shape[c],h=SQ({inputs:{x:l},backend:n});for(let t=0;t<=Math.ceil(Math.log2(u))-1;t++){let a=new Tt(e,l.shape,!1,i),r=[[t]],s=h;h=n.runWebGLProgram(a,[h],h.dtype,r),n.disposeIntermediateTensorInfo(s)}if(r){let t=new Tt(e,l.shape,r,i),a=h;h=n.runWebGLProgram(t,[h],h.dtype),n.disposeIntermediateTensorInfo(a)}if(null!=o){let e=Cu({inputs:{x:h},backend:n,attrs:{perm:oB.getUndoAxesPermutation(o)}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(l),e}return h}class Ti{getHeightCoordString(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}getWidthCoordString(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}getDepthCoordString(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}getOutputDepthSize(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}constructor(e,t,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(t,";\n      int offset_h = imod(h, ").concat(t,");\n      int in_w = w / ").concat(t,";\n      int offset_w = imod(w, ").concat(t,");\n      int offset_d = (offset_h * ").concat(t," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}}var oB=oB,cs=cs;class Ts{constructor(e,t=!1,n=null,a=!1,r=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=ko(this.outputShape.length);let i=e.filterHeight,s=e.filterWidth,o=e.outChannels/e.inChannels,l="",c="";n&&(l=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):r?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),c="result = activation(result);"),t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(l,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(o,";\n        int q = d2 - d1 * ").concat(o,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(i,"; wR++) {\n          int xR = xRCorner + wR * dilations[0];\n\n          if (xR < 0 || xR >= inDims[0]) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(s,"; wC++) {\n            int xC = xCCorner + wC * dilations[1];\n\n            if (xC < 0 || xC >= inDims[1]) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(t?"result += getBiasAtOutCoords();":"","\n        ").concat(c,"\n        setOutput(result);\n      }\n    ")}}var cs=cs;class To{constructor(e,t=!1,n=null,a=!1,r=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=ko(this.outputShape.length);let i=e.outChannels/e.inChannels,s=e.padInfo.left,o=e.strideWidth,l=e.dilationWidth,c=e.filterHeight,u=e.filterWidth,h="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;";for(let e=0;e<u;e++)h+="\n          vec4 xTexelC".concat(2*e,";\n          int xTexelC").concat(2*e,"Ready;\n          vec4 xTexelC").concat(2*e+1,";\n          int xTexelC").concat(2*e+1,"Ready;\n          vec4 xC").concat(e,";");h+="\n    for (int r = 0; r < ".concat(c,"; r++) {\n      ");for(let e=0;e<u;e++)h+="\n          xTexelC".concat(2*e," = vec4(0.0);\n          xTexelC").concat(2*e,"Ready = 0;\n          xTexelC").concat(2*e+1," = vec4(0.0);\n          xTexelC").concat(2*e+1,"Ready = 0;\n          xC").concat(e," = vec4(0.0);");h+="\n        xR = xRCorner + r * dilations[0];\n        if (xR >=0 && xR < inDims[0]) {\n      ";for(let e=0;e<(u+1)/2;e++){let t=2*e;if(h+="\n          xC = xCCorner + ".concat(t*l,";\n          "),1===o){if(t<u&&(s%2==1?(h+="\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                  xTexelC").concat(t," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(t,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(t,"Ready = 1;\n                }\n              "),1===l&&t>0?h+="\n                xC".concat(t," = vec4(xTexelC").concat(t-2,".zw, xTexelC").concat(t,".xy);\n                "):h+="\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC".concat(t," = vec4(previous.zw, xTexelC").concat(t,".xy);\n                  } else {\n                    xC").concat(t," = vec4(0.0, 0.0, xTexelC").concat(t,".xy);\n                  }\n                  ")):h+="\n                if (xC >= 0 && xC < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                  xTexelC").concat(t," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(t,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(t,"Ready = 1;\n                }\n\n                xC").concat(t," = xTexelC").concat(t,";\n                "),t+1<u)){let e=s%2==0?cs.nearestLargerEven(l):l;l%2==0&&s%2==1||l%2!=0&&s%2!=1?(h+="\n                  xCOffset = xC + imod(pads[1], 2) + ".concat(e,";\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                    xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      xTexelC").concat(t+1,".zw = vec2(0.0);\n                    }\n                    xTexelC").concat(t+1,"Ready = 1;\n                  }\n                  "),l>1?h+="\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n                     xC".concat(t+1," = vec4(previous.zw, xTexelC").concat(t+1,".xy);\n                    } else {\n                     xC").concat(t+1," = vec4(0.0, 0.0, xTexelC").concat(t+1,".xy);\n                    }\n                    "):h+="\n                    xC".concat(t+1," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".xy);\n                    ")):1===e?h+="\n                    xC".concat(t+1," = xTexelC").concat(t,";\n                    "):h+="\n                    xCOffset = xC + ".concat(e,";\n\n                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                      xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= inDims[1]) {\n                        xTexelC").concat(t+1,".zw = vec2(0.0);\n                      }\n                      xTexelC").concat(t+1,"Ready = 1;\n                    }\n\n                    xC").concat(t+1," = xTexelC").concat(t+1,";\n                    ")}}else t<u&&(s%2==1?(h+="\n                xCOffset = xC + 1 - strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                  xTexelC").concat(t," = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(t,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(t,"Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                  xTexelC").concat(t+1," = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= inDims[1]) {\n                    xTexelC").concat(t+1,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(t+1,"Ready = 1;\n                }\n\n                xC").concat(t," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".zw);\n              "),t+1<u&&(h+="\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + strides[1];\n                  if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC".concat(t+1," = vec4(xTexelC").concat(t+1,".xy, final.xy);\n                "))):(h+="\n                if(xC >= 0 && xC < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                  xTexelC").concat(t," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(t,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(t,"Ready = 1;\n                }\n\n                xCOffset = xC + strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                  xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(t+1,".zw = vec2(0.);\n                  }\n                  xTexelC").concat(t+1,"Ready = 1;\n                }\n\n                xC").concat(t," = vec4(\n                  xTexelC").concat(t,".xy, xTexelC").concat(t+1,".xy);\n              "),t+1<u&&(h+="\n                  xC".concat(t+1," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".zw);\n                "))));t<u&&(h+="\n            wTexel = getW(r, ".concat(t,", d1, q);\n            dotProd += xC").concat(t," * vec4(wTexel.xz, wTexel.xz);\n          "),t+1<u&&(h+="\n              wTexel = getW(r, ".concat(t+1,", d1, q);\n              dotProd += xC").concat(t+1," * vec4(wTexel.xz, wTexel.xz);\n            ")))}h+="\n    }\n  ",h+="\n      }\n    ";let d="",p="";n&&(d=a?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):r?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(n,"\n        }"),p="result = activation(result);"),t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(d,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(i,";\n        int q = d2 - d1 * ").concat(i,";\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ").concat(h,"\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ").concat(t?"result += getBiasAtOutCoords();":"","\n        ").concat(p,"\n        setOutput(result);\n      }\n    ")}}var oB=oB;class Tl{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideHeight,n=e.strideWidth,a=e.padInfo.top,r=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(i," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(e.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(t," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(r,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class Tc{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,a=e.strideHeight,r=e.strideWidth,i=t-1-e.padInfo.top,s=n-1-e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(i,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(t,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(t," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(o,"; dm++) {\n              int d2 = d1 * ").concat(o," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}var oB=oB,cs=cs;class Tu{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}}var oB=oB;class Th{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;let{inHeight:t,inWidth:n,padInfo:a,strideHeight:r,strideWidth:i,filterHeight:s,filterWidth:o,dilationHeight:l,dilationWidth:c}=e,{top:u,left:h}=a;this.userCode="\n      const ivec2 strides = ivec2(".concat(r,", ").concat(i,");\n      const ivec2 pads = ivec2(").concat(u,", ").concat(h,");\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ").concat(s,"; h++) {\n          int hIn = hBeg + h * ").concat(l,";\n\n          if (hIn >= 0 && hIn < ").concat(t,") {\n            for (int w = 0; w < ").concat(o,"; w++) {\n              int wIn = wBeg + w * ").concat(c,";\n\n              if (wIn >= 0 && wIn < ").concat(n,") {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    ")}}var oB=oB,cs=cs;let Td=S4({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),Tp=S5({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool",cpuKernelImpl:kH});var oB=oB;let Tf=S4({opSnippet:'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(oB.ERF_P,";\n  float a1 = ").concat(oB.ERF_A1,";\n  float a2 = ").concat(oB.ERF_A2,";\n  float a3 = ").concat(oB.ERF_A3,";\n  float a4 = ").concat(oB.ERF_A4,";\n  float a5 = ").concat(oB.ERF_A5,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n")}),Tm=S4({opSnippet:S3+"\n  return exp(x);\n",packedOpSnippet:"\n  vec4 result = exp(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:kq,dtype:"float32"});var cs=cs;function Tg(e){let{inputs:t,attrs:n,backend:a}=e,{dim:r}=n,{input:i}=t,s=i.shape.length,o=i.shape.slice(),l=r;return r<0&&(cs.assert(-(s+1)<=r,()=>"Axis must be in the interval [".concat(-(s+1),", ").concat(s,"]")),l=s+r+1),o.splice(l,0,1),Cn({inputs:{x:i},backend:a,attrs:{shape:o}})}let Tx="return exp(x) - 1.0;",Ty=S4({opSnippet:Tx,packedOpSnippet:Tx,cpuKernelImpl:kK});var cs=cs;class Tb{constructor(e,t,n){let a;this.variableNames=["real","imag"];let r=t[1];this.outputShape=t;let i=n?"2.0 * ".concat(Math.PI):"-2.0 * ".concat(Math.PI),s=n?"".concat(r,".0"):"1.0";if("real"===e)a="return real * expR - imag * expI;";else if("imag"===e)a="return real * expI + imag * expR;";else throw Error('FFT component must be either "real" or "imag", got '.concat(e,"."));this.userCode="\n      const float exponentMultiplier = ".concat(i,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(a,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(r,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(r,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(s,";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")}}function Tv(e,t,n){let a=n.texData.get(e.dataId),r=cs.sizeFromShape(e.shape),i=e.shape[e.shape.length-1],s=Cn({inputs:{x:e},backend:n,attrs:{shape:[r/i,i]}}),o=s.shape,l=new Tb("real",o,t),c=new Tb("imag",o,t),u=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:o},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:o}],h=n.runWebGLProgram(l,u,"float32"),d=n.runWebGLProgram(c,u,"float32"),p=SJ({inputs:{real:h,imag:d},backend:n});n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d);let f=Cn({inputs:{x:p},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(p),f}var cs=cs;class Tw{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode="\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}}function TN(e){let{backend:t,attrs:n}=e,{shape:a,value:r}=n,{dtype:i}=n;if("string"===(i=i||cs.inferDtype(r))){let e=cs.getArrayFromDType(i,cs.sizeFromShape(a));return e.fill(r),t.makeTensorInfo(a,i,e)}{let e=new Tw(a,r),n=[[r]];return t.runWebGLProgram(e,[],i,n)}}class Tk{constructor(e){this.variableNames=["Image"],this.outputShape=[];let t=e[2];this.outputShape=e,this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ".concat(t," - x - 1;\n          float outputValue;\n          if(coordX >= 0 && coordX < ").concat(t,") {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}}let TS="return floor(x);",TC=S4({opSnippet:TS,packedOpSnippet:TS,cpuKernelImpl:kX}),TT=S5({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"});class TI{constructor(e){this.variableNames=["A"];let t=N1(),[n,a]=e;this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(a,".0, ").concat(n,".0);\n\n        vec4 values = ").concat(t.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")}}class TE{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;let t=N1(),[n,a]=e;this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(a,".0, ").concat(n,".0);\n            vec4 values = ").concat(t.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(t.output," = result;\n      }\n    ")}}let T_=eT.getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");var oB=oB,cs=cs,oB=oB,cs=cs,oB=oB,cs=cs;class TA{constructor(e,t,n,a){this.sliceDim=e,this.strides=t,this.paramsShape=a,this.variableNames=["x","indices"],this.outputShape=n;let r=kt(n.length),i="\n    int index;";for(let e=0;e<this.sliceDim;e++)i+="\n          index = round(getIndices(coords[0], ".concat(e,"));\n          out_of_bounds = out_of_bounds || index < 0;\n          out_of_bounds = out_of_bounds || index >= ").concat(this.paramsShape[e],";\n          flattenIndex += index * ").concat(this.strides[e],";");this.userCode="\n         void main() {\n          ".concat(r," coords = getOutputCoords();\n          int flattenIndex = 0;\n          bool out_of_bounds = false;\n\n          ").concat(i,"\n\n          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));\n        }\n      ")}}var oB=oB,cs=cs;class TR{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;let n=kt(this.rank),a=function(e,t){let n=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[];for(let t=0;t<e.length;t++)2===t?a.push("index"):a.push("".concat(n[t]));return a.join()}(e,0);this.userCode="\n      void main() {\n        ".concat(n," resRC = getOutputCoords();\n        int index = int(getIndices(resRC.x, resRC.z));\n        float inBounds = (index >= 0) && (index < ").concat(e[2],") ? 1.0 : 0.0;\n        setOutput(inBounds * getA(").concat(a,"));\n      }\n    ")}}function TD(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,indices:i}=t,{axis:s,batchDims:o}=a,l=cs.parseAxisParam(s,r.shape)[0];if(eT.get("DEBUG")){let e=n.readSync(i.dataId),t=r.shape[l];for(let n=0;n<e.length;++n){let a=e[n];cs.assert(a<=t-1&&a>=0,()=>"GatherV2: the index value ".concat(a," is not in [0, ").concat(t-1,"]"))}}let c=oB.segment_util.collectGatherOpShapeInfo(r,i,l,o),u=cs.sizeFromShape(i.shape),h=[],d=Cn({inputs:{x:r},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),p=Cn({inputs:{x:i},backend:n,attrs:{shape:[c.batchSize,u/c.batchSize]}});h.push(d),h.push(p);let f=[c.batchSize,c.outerSize,u/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([r,i])||"string"===r.dtype){let e=n.bufferSync(p),t=kZ(n.bufferSync(d),e,f);return h.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.makeTensorInfo(c.outputShape,t.dtype,t.values)}let m=new TR(d.shape,f),g=n.runWebGLProgram(m,[d,p],d.dtype);h.push(g);let x=Cn({inputs:{x:g},backend:n,attrs:{shape:c.outputShape}});return h.forEach(e=>n.disposeIntermediateTensorInfo(e)),x}let TM=S5({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:kQ,dtype:"bool"}),TF=S5({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool",cpuKernelImpl:kJ}),TO=S4({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),TP=S4({opSnippet:"return float(isinf(x));",dtype:"bool"}),Tj=S4({opSnippet:"return float(isnan(x));",dtype:"bool"}),TL=S5({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:k$,dtype:"bool"}),Tz=S5({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",cpuKernelImpl:k0,dtype:"bool"}),TB=S4({opSnippet:S3+"\n  return x < 0.0 ? 0./0. : log(x);\n",packedOpSnippet:"\n  vec4 result = log(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);\n  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);\n  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);\n  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);\n  return result;\n",cpuKernelImpl:k2}),TV=S4({opSnippet:S3+"\n  return log(1.0 + x);\n"}),TU=S5({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),TW=S4({opSnippet:"return float(!(x >= 1.0));"}),TG=S5({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"});class TH{constructor(e,t,n,a,r){let i;this.variableNames=["x"],this.outputShape=[];let s=e[3]-1;this.outputShape=e;let o="float(".concat(n,") + float(").concat(a,") * sum");i=.5===r?"inversesqrt(".concat(o,")"):1===r?"1.0/(".concat(o,")"):"exp(log(".concat(o,") * float(-").concat(r,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(t,"; j <= ").concat(t,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(s,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(i,";\n        setOutput(val);\n      }\n    ")}}class Tq{constructor(e,t,n,a,r){let i;this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;let s=e[3]-1;this.outputShape=e;let o="float(".concat(n,") + float(").concat(a,") * sum");i=.5===r?"inversesqrt(".concat(o,")"):1===r?"1.0/(".concat(o,")"):"exp(log(".concat(o,") * float(-").concat(r,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(t,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(t,"; j <= ").concat(t,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(s,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(i,";\n        setOutput(result);\n      }\n    ")}}class TK{constructor(e,t,n,a,r){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=a,this.beta=r,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(t,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(t," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(a,") * norm + float(").concat(n,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(a,")\n                * float(").concat(r,")\n                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(r,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")}}var oB=oB,cs=cs,cs=cs;function TX(e){let t,{inputs:n,backend:a,attrs:r}=e,{x:i}=n,{reductionIndices:s,keepDims:o}=r,l=i.shape.length,c=cs.parseAxisParam(s,i.shape),u=c,h=oB.getAxesPermutation(u,l),d=null!=h,p=a.shouldExecuteOnCPU([i]),f=i;if(d){if(p){let e=a.texData.get(f.dataId).values,t=Array(l);for(let e=0;e<t.length;e++)t[e]=i.shape[h[e]];let n=Sw(e,i.shape,i.dtype,h,t);f=a.makeTensorInfo(t,i.dtype),a.texData.get(f.dataId).values=n}else f=Cl(i,h,a);u=oB.getInnerMostAxes(u.length,l)}oB.assertAxesAreInnerMostDims("max",u,l);let[m,g]=oB.computeOutAndReduceShapes(f.shape,u),x=m;if(o&&(x=oB.expandShapeToKeepDim(m,c)),p){let e=k3(a.texData.get(f.dataId).values,cs.sizeFromShape(g),x,i.dtype);t=a.makeTensorInfo(x,i.dtype),a.texData.get(t.dataId).values=e}else t=function(e,t,n,a){let r=cs.sizeFromShape(t),i=cs.sizeFromShape(e.shape),s=Cn({inputs:{x:e},attrs:{shape:[i/r,r]},backend:a}),o=Ci(s,e.dtype,"max",a),l=Cn({inputs:{x:o},attrs:{shape:n},backend:a});return a.disposeIntermediateTensorInfo(s),a.disposeIntermediateTensorInfo(o),l}(f,g,x,a);return d&&a.disposeIntermediateTensorInfo(f),t}let TY=S5({opSnippet:SK+"\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+SY+"\n  return result;\n",cpuKernelImpl:k4});var oB=oB,cs=cs,oB=oB,oB=oB;class TZ{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;let t=e.strideHeight,n=e.strideWidth,a=e.dilationHeight,r=e.effectiveFilterHeight,i=e.effectiveFilterWidth,s=r-1-e.padInfo.top,o=i-1-e.padInfo.left,l=r*i-1;this.userCode="\n      const ivec2 pads = ivec2(".concat(s,", ").concat(o,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(r,";\n          wR += ").concat(a,") {\n          float dyR = float(dyRCorner + wR) / ").concat(t,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(i,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(n,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(l," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(i," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class TQ{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;let t=e.strideDepth,n=e.strideHeight,a=e.strideWidth,r=e.dilationDepth,i=e.dilationHeight,s=e.dilationWidth,o=e.effectiveFilterDepth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,u=o-1-e.padInfo.front,h=l-1-e.padInfo.top,d=c-1-e.padInfo.left,p=o*l*c-1;this.userCode="\n      const ivec3 pads = ivec3(".concat(u,", ").concat(h,", ").concat(d,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(o,";\n           wD += ").concat(r,") {\n          float dyD = float(dyDCorner + wD) / ").concat(t,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(e.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(l,";\n              wR += ").concat(i,") {\n            float dyR = float(dyRCorner + wR) / ").concat(n,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(c,";\n                wC += ").concat(s,") {\n              float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(p," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(l," * ").concat(c," +\n                  wR * ").concat(c," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}var oB=oB,oB=oB,cs=cs,oB=oB,cs=cs,cs=cs,oB=oB,cs=cs;let TJ=S5({opSnippet:SK+"\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+SY+"\n  return result;\n",cpuKernelImpl:k5});class T${constructor(e,t,n){this.variableNames=["x"],this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);let a=e.length,r=kt(a),i=t.map(e=>e[0]).join(","),s=t.map((t,n)=>t[0]+e[n]).join(","),o=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a),l=+("reflect"!==n);if(1===a){this.userCode="\n        int start = ".concat(i,";\n        int end = ").concat(s,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ").concat(l,";\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ").concat(l,";\n          }\n          setOutput(getX(outC - start));\n        }\n      ");return}this.userCode="\n      ".concat(r," start = ").concat(r,"(").concat(i,");\n      ").concat(r," end = ").concat(r,"(").concat(s,");\n\n      void main() {\n        ").concat(r," outC = getOutputCoords();\n        for (int i = 0; i < ").concat(a,"; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ").concat(l,";\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ").concat(l,";\n          }\n        }\n        ").concat(r," coords = outC - start;\n        setOutput(getX(").concat(o,"));\n      }\n    ")}}class T0{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);let a=e.length,r=kt(a),i=t.map(e=>e[0]).join(","),s=t.map((t,n)=>t[0]+e[n]).join(","),o=SS("rc",a),l=SS("source",a),c="".concat(o[a-1]," < ").concat(this.outputShape[a-1]),u=1===a?"source":"vec2(".concat(l.slice(-2).join(),")"),h=+("reflect"!==n),d="";if(1===a){let e="\n        ".concat(r," source = rc;\n        if (source < start) {\n          source = start * 2 - source - ").concat(h,";\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ").concat(h,";\n        }\n        source -= start;\n      ");d="\n        ".concat(r," rc = outputLoc;\n        ").concat(e,"\n        result[0] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n        ").concat(o[a-1]," += 1;\n        if(").concat(c,") {\n          ").concat(e,"\n          result[1] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n        }\n      ")}else{let e="\n        ".concat(r," source = rc;\n        ").concat(r," lt = ").concat(r,"(lessThan(source, start));\n        ").concat(r," gte = ").concat(r,"(greaterThanEqual(source, end));\n        ").concat(r," orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ").concat(h,") +\n                gte * ((end - 1) * 2 - source + ").concat(h,");\n        source -= start;\n      ");d="\n        ".concat(r," rc = outputLoc;\n        ").concat(e,"\n        result[0] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n        ").concat(o[a-1]," += 1;\n        if(").concat(c,") {\n          ").concat(e,"\n          result[1] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n        }\n        rc = outputLoc;\n        ").concat(o[a-2]," += 1;\n        if(").concat(o[a-2]," < ").concat(this.outputShape[a-2],") {\n          ").concat(e,"\n          result[2] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n          ").concat(o[a-1]," += 1;\n          if(").concat(c,") {\n            ").concat(e,"\n            result[3] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n          }\n        }\n      ")}this.userCode="\n      const ".concat(r," start = ").concat(r,"(").concat(i,");\n      const ").concat(r," end = ").concat(r,"(").concat(s,");\n\n      void main() {\n        ").concat(r," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(d,"\n        setOutput(result);\n      }\n    ")}}let T1=S5({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  bvec4 isNaN = equal(b, vec4(0.0));\n  "+SY+"\n  return result;\n"});class T2{constructor(e,t,n){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(t-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(t-1,"));\n      }\n    ")}}var oB=oB,cs=cs;let T3=S5({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),T4="return a - b;",T5=S5({opSnippet:T4,packedOpSnippet:T4,supportsComplex:!0,cpuKernelImpl:Sy});function T6(e){let{inputs:t,backend:n,attrs:a}=e,{logits:r}=t,{dim:i}=a,s=cs.parseAxisParam([i],r.shape),o=TX({inputs:{x:r},backend:n,attrs:{reductionIndices:s,keepDims:!1}}),l=oB.expandShapeToKeepDim(o.shape,s),c=Cn({inputs:{x:o},backend:n,attrs:{shape:l}}),u=T5({inputs:{a:r,b:c},backend:n}),h=Tm({inputs:{x:u},backend:n}),d=Cc({inputs:{x:h},backend:n,attrs:{axis:s,keepDims:!1}}),p=Cn({inputs:{x:d},backend:n,attrs:{shape:l}}),f=T3({inputs:{a:h,b:p},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),f}let T8=SD+"\n  return -x;\n";var oB=oB,bb=bb;let T9=bb.nonMaxSuppressionV3Impl;var oB=oB,bb=bb;let T7=bb.nonMaxSuppressionV4Impl;var oB=oB,bb=bb;let Ie=bb.nonMaxSuppressionV5Impl;var cs=cs;class It{constructor(e,t,n,a){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(a,"), float(").concat(n,"),\n                      float(index == coords.y)));\n      }\n    ")}}function In(e){let{inputs:t,backend:n}=e,{x:a}=t;if("complex64"!==a.dtype)return TN({attrs:{shape:a.shape,dtype:a.dtype,value:"string"===a.dtype?"":0},backend:n});{let e=CL({inputs:{input:a},backend:n}),t=In({inputs:{x:e},backend:n}),r=CX({inputs:{input:a},backend:n}),i=In({inputs:{x:r},backend:n}),s=SJ({inputs:{real:t,imag:i},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),s}}var cs=cs,cs=cs;class Ia{constructor(e,t,n){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);let a=e.length,r=kt(a),i=t.map(e=>e[0]).join(","),s=t.map((t,n)=>t[0]+e[n]).join(","),o=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a);if(1===a){this.userCode="\n        int start = ".concat(i,";\n        int end = ").concat(s,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ");return}this.userCode="\n      ".concat(r," start = ").concat(r,"(").concat(i,");\n      ").concat(r," end = ").concat(r,"(").concat(s,");\n\n      void main() {\n        ").concat(r," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ").concat(r," coords = outC - start;\n          setOutput(getX(").concat(o,"));\n        }\n      }\n    ")}}class Ir{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);let a=e.length,r=kt(a),i=t.map(e=>e[0]).join(","),s=t.map((t,n)=>t[0]+e[n]).join(","),o=SS("rc",a),l=SS("source",a),c="".concat(o[a-1]," < ").concat(this.outputShape[a-1]),u=1===a?"source":"vec2(".concat(l.slice(-2).join(),")"),h=["".concat(r," rc = outputLoc;"),"".concat(o[a-1]," += 1;\n       if(").concat(c,") {\n      "),1===a?"":"}\n       rc = outputLoc;\n       ".concat(o[a-2]," += 1;\n       if(").concat(o[a-2]," < ").concat(this.outputShape[a-2],") {"),1===a?"":"  ".concat(o[a-1]," += 1;\n         if(").concat(c,") {")],d=1===a?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",p="";for(let e=0,t=1===a?2:4;e<t;e++)p+="\n        ".concat(h[e],"\n        if (").concat(d,") {\n          result[").concat(e,"] = float(value);\n        } else {\n          ").concat(r," source = rc - start;\n          result[").concat(e,"] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n        }\n      ");p+=1===a?"} ":"}}",this.userCode="\n      const ".concat(r," start = ").concat(r,"(").concat(i,");\n      const ").concat(r," end = ").concat(r,"(").concat(s,");\n\n      void main() {\n        ").concat(r," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(p,"\n        setOutput(result);\n      }\n    ")}}let Ii=e=>{let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{paddings:i,constantValue:s}=a;if(0===cs.sizeFromShape(r.shape))return TN({backend:n,attrs:{shape:i.map((e,t)=>e[0]+r.shape[t]+e[1]),value:s,dtype:r.dtype}});let o=eT.getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Ir(r.shape,i,s):new Ia(r.shape,i,s),l=[[s]];return n.runWebGLProgram(o,[r],r.dtype,l)},Is=S5({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  bvec4 isNaN1 = lessThan(a, vec4(0.0));\n  bvec4 isNaN2 = lessThan(floor(b), b);\n  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);\n  "+SY+"\n  return result;\n"});var oB=oB,cs=cs;let Io=e=>{let{backend:t,attrs:n}=e,{start:a,stop:r,step:i,dtype:s}=n,o=Sa(a,r,i,s);return t.makeTensorInfo([o.length],s,o)},Il=S4({opSnippet:"return 1.0 / x;"}),Ic=S4({opSnippet:SD+"\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),Iu=S4({opSnippet:SD+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"});class Ih{constructor(e,t,n,a,r){this.variableNames=["A"],this.outputShape=[];let[i,s,o,l]=e;this.outputShape=[i,t,n,l];let c=[a&&t>1?s-1:s,a&&n>1?o-1:o],u=[a&&t>1?t-1:t,a&&n>1?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(c[0]/u[0],",\n          ").concat(c[1]/u[1],");\n      const vec2 inputShapeRC = vec2(").concat(s,".0, ").concat(o,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(r?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",";\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")}}class Id{constructor(e,t,n,a,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[i,s,o,l]=e;this.outputShape=[i,t,n,l];let c=[a&&t>1?s-1:s,a&&n>1?o-1:o],u=[a&&t>1?t-1:t,a&&n>1?n-1:n];this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(c[0]/u[0],",\n          ").concat(c[1]/u[1],",\n          ").concat(c[1]/u[1],");\n      const vec3 inputShapeRC = vec3(").concat(s,".0, ").concat(o,".0,\n                                     ").concat(o,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(r?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",";\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(l-1,";\n        bool hasNextRow = coords.z < ").concat(n-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")}}class Ip{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;let[,a,r]=t,[,i,s]=e,o=[n&&i>1?a-1:a,n&&s>1?r-1:r],l=[n&&i>1?i-1:i,n&&s>1?s-1:s],c=o[0]/l[0],u=o[1]/l[1],h=1/c,d=1/u,p=2*Math.ceil(h)+2,f=2*Math.ceil(d)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(c,");\n        const float widthScale = float(").concat(u,");\n\n        const float invHeightScale = float(").concat(h,");\n        const float invWidthScale = float(").concat(d,");\n\n        const int winHeight = int(").concat(p,");\n        const int winWidth = int(").concat(f,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(i,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(s,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(a-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(r-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}}class If{constructor(e,t,n,a,r){this.variableNames=["A"],this.outputShape=[];let[i,s,o,l]=e;this.outputShape=[i,t,n,l];let c=[a&&t>1?s-1:s,a&&n>1?o-1:o],u=[a&&t>1?t-1:t,a&&n>1?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(c[0]/u[0],",\n          ").concat(c[1]/u[1],");\n      const vec2 inputShapeRC = vec2(").concat(s,".0, ").concat(o,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(r?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(a?"0.5":"0.0",")));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")}}class Im{constructor(e,t,n,a,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[i,s,o,l]=e;this.outputShape=[i,t,n,l];let c=[a&&t>1?s-1:s,a&&n>1?o-1:o],u=[a&&t>1?t-1:t,a&&n>1?n-1:n];this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(c[0]/u[0],",\n          ").concat(c[1]/u[1],",\n          ").concat(c[1]/u[1],");\n      const vec3 inputShapeRC = vec3(").concat(s,".0, ").concat(o,".0,\n                                     ").concat(o,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(r?"max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":"vec3(yRC) * effectiveInputOverOutputRatioRC",";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(a?"0.5":"0.0",")));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(l-1,";\n        bool hasNextRow = coords.z < ").concat(n-1,";\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    ")}}class Ig{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;let[,a,r]=t,[,i,s]=e,o=[n&&i>1?a-1:a,n&&s>1?r-1:r],l=[n&&i>1?i-1:i,n&&s>1?s-1:s],c=o[0]/l[0],u=o[1]/l[1],h=1/c,d=1/u,p=2*Math.ceil(h)+2,f=2*Math.ceil(d)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(c,");\n        const float widthScale = float(").concat(u,");\n\n        const float invHeightScale = float(").concat(h,");\n        const float invWidthScale = float(").concat(d,");\n\n        const int winHeight = int(").concat(p,");\n        const int winWidth = int(").concat(f,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(i,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(s,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(o[0],") *\n                (float(dyR) / float(").concat(l[0],"));\n\n            float sourceFracCol =\n                float(").concat(o[1],") *\n                  (float(dyC) / float(").concat(l[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(a,") - 1),\n                ").concat(n," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(r,") - 1),\n                ").concat(n," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}}var cs=cs;class Ix{constructor(e,t){this.variableNames=["x"];let n=e.length;if(n>4)throw Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));if(this.outputShape=e,1===n){this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(e[0]," - coord - 1));\n        }\n      ");return}let a=e.map((n,a)=>(n=>-1!==t.indexOf(n)&&1!==e[n]?"".concat(e[n]," - coords[").concat(n,"] - 1"):"coords[".concat(n,"]"))(a)).join(","),r=kt(n);this.userCode="\n      void main() {\n        ".concat(r," coords = getOutputCoords();\n        setOutput(getX(").concat(a,"));\n      }\n    ")}}class Iy{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;let n=e.length;if(n>4)throw Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));this.outputShape=e;let a=SS("rc",n),r="".concat(a[n-1]," + 1 < ").concat(this.outputShape[n-1]),i="".concat(a[n-2]," + 1 < ").concat(this.outputShape[n-2]),s=kt(n);function o(n){let a=e.map((a,r)=>{var i,s;return i=r,s=n,-1!==t.indexOf(i)&&1!==e[i]?"".concat(e[i]," - ").concat(s[i]," - 1"):"".concat(s[i])}),r=a.join(","),i=a.slice(-2).join(",");return"getChannel(getX(".concat(r,"), vec2(").concat(i,"))")}1===n?this.userCode="\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(e[0]," - rc - 1),\n            ").concat(e[0]," - rc - 1);\n          if(").concat(r,"){\n              result.g = getChannel(getX(").concat(e[0]," - (rc  + 1) - 1),\n                ").concat(e[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):this.userCode="\n        void main() {\n          ".concat(s," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat(o(a.slice()),";\n          if(").concat(r,"){\n            result.g = ").concat(function(e){return e[n-1]="("+e[n-1]+" + 1)",o(e)}(a.slice()),";\n          }\n          if(").concat(i,") {\n            result.b = ").concat(function(e){return e[n-2]="("+e[n-2]+" + 1)",o(e)}(a.slice()),";\n            if(").concat(r,") {\n              result.a = ").concat(function(e){return e[n-1]="("+e[n-1]+" + 1)",e[n-2]="("+e[n-2]+" + 1)",o(e)}(a.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ")}}var oB=oB;class Ib{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];let n=e[1],a=e[2];this.outputShape=e;let r="";r="number"==typeof t?"float outputValue = ".concat(t.toFixed(2),";"):"\n        vec3 fill = vec3(".concat(t.join(","),");\n        float outputValue = fill[coords[3]];"),this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ".concat(r,"\n          if(coordX >= 0 && coordX < ").concat(a," && coordY >= 0 && coordY < ").concat(n,") {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}}let Iv=S4({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),Iw=S4({opSnippet:"return inversesqrt(x);",cpuKernelImpl:Sr});var oB=oB;class IN{constructor(e,t,n,a,r,i,s=!0,o=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;let l=kt(r.length),c=kt(i.length),u="";1===n?u="i":2===n&&(u="i, j");let h="getIndices(".concat(u,")"),d="";1===a?d="i":2===a&&(d="i, coords[1]");let p="getUpdates(".concat(d,")"),f="";o&&(f="coords[0], coords[1]");let m="getDefaultValue(".concat(f,")");this.userCode="\n        ".concat(l," strides = ").concat(l,"(").concat(r,");\n\n        void main() {\n          ").concat(c," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(e,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(t,"; j++) {\n              int index = round(").concat(h,");\n              flattenedIndex += index * ").concat(t>1?"strides[j]":"strides",";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ").concat(p,";\n              found = true;\n            }\n          }\n          setOutput(mix(").concat(m,", sum, float(found)));\n        }\n      ")}}class Ik{constructor(e,t,n,a,r,i,s=!0,o=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i;let l=kt(r.length),c=kt(i.length),u="";1===n?u="i":2===n&&(u="i, j");let h="getIndices(".concat(u,")"),d="";1===a?d="i":2===a&&(d="i, coords[1]");let p="getUpdates(".concat(d,")"),f="";o&&(f="coords[0], coords[1]");let m="getDefaultValue(".concat(f,")"),g=t>1?"strides[j]":"strides",x=t>1?"strides[j + 1]":"strides";this.userCode="\n        ".concat(l," strides = ").concat(l,"(").concat(r,");\n\n        void main() {\n          ").concat(c," coords = getOutputCoords();\n          vec4 sum = vec4(0.);\n          vec4 found = vec4(0.);\n          for (int i = 0; i < ").concat(e,"; i+=2) {\n            ivec2 flattenedIndex = ivec2(0);\n            for (int j = 0; j < ").concat(t,"; j+=2) {\n              ivec4 index = round(").concat(h,");\n              flattenedIndex += index.xz * ").concat(g,";\n              if (j + 1 < ").concat(t,") {\n                flattenedIndex += index.yw * ").concat(x,";\n              }\n            }\n            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||\n                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {\n              vec4 updVals = ").concat(p,";\n              if (flattenedIndex[0] == coords[0]) {\n                sum.xy += updVals.xy;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[0] == coords[0] + 1) {\n                sum.zw += updVals.xy;\n                found.zw = vec2(1.);\n              }\n              if (flattenedIndex[1] == coords[0]) {\n                sum.xy += updVals.zw;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[1] == coords[0] + 1) {\n                sum.zw += updVals.zw;\n                found.zw = vec2(1.);\n              }\n            }\n          }\n          setOutput(mix(").concat(m,", sum, found));\n        }\n      ")}}class IS{constructor(e,t,n,a){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,n];let r="for (int i = 0; i < ".concat(Math.ceil(Math.log2(t+1)),"; ++i) { if (left >= right) break;"),i=2===eT.getNumber("WEBGL_VERSION")?"while (left < right) {":r;this.userCode="\n       int findBound(int batch, float value) {\n         int left = 0;\n         int right = numInputs;\n         int mid;\n         ".concat(i,"\n           mid = (left + right) / 2;\n           if (getSortedSequence(batch, mid) ").concat("left"===a?"<":"<="," value) {\n             left = mid + 1;\n           } else {\n             right = mid;\n           }\n         }\n         return right;\n       }\n\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int valueIndex = coords[1];\n\n         float value = getValues(batch, valueIndex);\n\n         setOutput(float(findBound(batch, value)));\n       }\n     ")}}class IC{constructor(e,t,n){let a,r;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank ".concat(n," is not yet supported"));if(1===n)r="resRC",a="resRC";else{let n=["resRC.x","resRC.y","resRC.z","resRC.w"],i=[],s=[];for(let a=0;a<t.length;a++)s.push("".concat(n[a])),a<e&&i.push("".concat(n[a]));a=i.join(),r=s.join()}let i=kt(n);this.userCode="\n      void main() {\n        ".concat(i," resRC = getOutputCoords();\n        float cVal = getC(").concat(a,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(r,"));\n        } else {\n          setOutput(getB(").concat(r,"));\n        }\n      }\n    ")}}var oB=oB;let IT=S4({opSnippet:"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat(oB.SELU_SCALEALPHA,";\n  float scale = ").concat(oB.SELU_SCALE,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n")}),II=S4({opSnippet:S3+"\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",packedOpSnippet:"\n  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:Ss}),IE=S4({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),I_=S4({opSnippet:S3+"\n  return sin(x);\n",packedOpSnippet:"\n  vec4 result = sin(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(SY,"\n  return result;\n")}),IA=S4({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),IR=S4({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"});var oB=oB,cs=cs,oB=oB,cs=cs,oB=oB,cs=cs;let ID="return sqrt(x);",IM=S4({opSnippet:ID,packedOpSnippet:ID,cpuKernelImpl:Sd}),IF=S4({opSnippet:"return x * x;"}),IO="return (a - b) * (a - b);",IP=S5({opSnippet:IO,packedOpSnippet:IO});var oB=oB,vR=sR,cs=cs;class Ij{constructor(e,t,n){this.variableNames=["x"],this.outputShape=n;let a=n.length,r=kt(n.length),i=kt(n.length),s="";if(1===a)s="coords * strides + begin";else{let e=0;s=n.map((t,a)=>(e++,1===n.length?"coords * strides[".concat(a,"] + begin[").concat(a,"]"):"coords[".concat(e-1,"] * strides[").concat(a,"] + begin[").concat(a,"]"))).join(",")}this.userCode="\n      ".concat(r," begin = ").concat(r,"(").concat(e,");\n      ").concat(r," strides = ").concat(r,"(").concat(t,");\n\n      void main() {\n        ").concat(i," coords = getOutputCoords();\n        setOutput(getX(").concat(s,"));\n      }\n    ")}}let IL=S4({opSnippet:"return tan(x);"}),Iz=S4({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"});var oB=oB,cs=cs;class IB{constructor(e,t){this.variableNames=["A"];let n=Array(e.length);for(let a=0;a<n.length;a++)n[a]=e[a]*t[a];this.outputShape=n,this.rank=n.length;let a=kt(this.rank),r=function(e){let t=e.length;if(t>5)throw Error("Tile for rank ".concat(t," is not yet supported"));if(1===t)return"imod(resRC, ".concat(e[0],")");let n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],a=[];for(let t=0;t<e.length;t++)a.push("imod(".concat(n[t],", ").concat(e[t],")"));return a.join()}(e);this.userCode="\n      void main() {\n        ".concat(a," resRC = getOutputCoords();\n        setOutput(getA(").concat(r,"));\n      }\n    ")}}function IV(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{reps:i}=a;if("string"===r.dtype||r.shape.length>5){let e=n.readSync(r.dataId),t="string"===r.dtype?e.map(e=>cs.decodeString(e)):e,a=Sb(rD(r.shape,r.dtype,t),i);return n.makeTensorInfo(a.shape,a.dtype,a.values)}let s=new IB(r.shape,i);return n.runWebGLProgram(s,[r],r.dtype)}var cs=cs;class IU{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode="\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // We compare elements pair-wise within a group of size 2 * inc.\n         // The comparing rule for each group alternates between ascending\n         // and descending. Within each group, we compare each pair at\n         // positions i and i+inc. To decide whether an element at position i\n         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n         // inc, it is in the first half of the group, we denote it as x0,\n         // otherwise we denote it as x1.\n         // For example, as shown in the Bitonic top K paper referenced above,\n         // Figure5(a) shows that element[1] is in the\n         // second half of the group when group size is 2, but it is in the\n         // first half of the group when group size is 4.\n\n         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;\n         int i = isFirstInPair ? elemIdx : elemIdx - inc;\n\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));\n         float x0 = i0 < n ? getX(batch, i0) : negativeInf;\n         float x1 = i1 < n ? getX(batch, i1) : negativeInf;\n\n         // Denotes which direction indices are in (ascending or descending).\n         bool reverse = imod(elemIdx, 2 * dir) >= dir;\n         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n         if (reverse == isGreater) { // Elements in opposite order of direction\n           int iTemp = i0;\n           i0 = i1;\n           i1 = iTemp;\n         }\n         if (isFirstInPair) {\n            setOutput(float(i0));\n         } else {\n            setOutput(float(i1));\n         }\n       }\n     "}}class IW{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode="\n    void main() {\n         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // The output size is half of the previous size.\n         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),\n         // we only need to output the indices at positions |, the indices at\n         // positions _ can be thrown away, see Figure5(b) After Phase 2\n         // (Merge phase) in the Bitonic Top K paper referenced above.\n         // For example, the paper shows we only need to output the orange bars.\n         // The output sequence should look like this | | | | | | | |.\n         // Because the sequence is halved, to map the output index back\n         // to the previous sequence to find the corresponding value,\n         // we need to double the index. When we double the index,\n         // we basically interpolate a position, so 2i looks like\n         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position\n         // of each 2k positions by - elemIdx % k. E.g. for output at\n         // index 4,5,6,7, we want to get the corresponding element at\n         // original index 8,9,10,11, for output at index 8,9,10,11,\n         // we want to get the corresponding element at original index\n         // 16,17,18,19, so on and so forth.\n\n         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));\n\n         float x0 = getX(batch, i0);\n         float x1 = i1 < n ? getX(batch, i1) : x0;\n\n         setOutput(x0 >= x1 ? float(i0) : float(i1));\n       }\n     "}}function IG(e,t){null!==t&&e.disposeIntermediateTensorInfo(t)}function IH(e){let t=1;for(;t<e;)t*=2;return t}class Iq{constructor(e,t,n,a,r,i){let s;switch(this.variableNames=["Image","Transforms"],this.outputShape=i,a){case"constant":default:s=1;break;case"reflect":s=2;break;case"wrap":s=3;break;case"nearest":s=4}this.userCode="\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(".concat(s," == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ").concat(e," && 0 <= coordX && coordX < ").concat(t,") {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(").concat(r,");\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(").concat(r,");\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(").concat(t,"));\n                float mapY = mapCoord(inY, float(").concat(e,"));\n\n                if (").concat("nearest"===n?1:2," == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        ")}}var oB=oB,cs=cs;class IK{constructor(e,t){this.variableNames=["x","segmentIds"];let n=e.windowSize,a=e.batchSize,r=e.inSize,i=e.numSegments,s=i*Math.ceil(r/n);this.outputShape=[a,s];let o=4*Math.floor(n/4),l=n%4,c="\n        sumValue += dot(values, segFilter);\n    ",u="";r%n>0&&(u="\n        if (inIdx < 0 || inIdx >= ".concat(r,") {\n          return initializationValue;\n        }\n      "));let h="";r%n>0&&(h="\n        if (inIdx < 0 || inIdx >= ".concat(r,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat("0.0",";\n\n      float getValue(int batch, int inIdx) {\n        ").concat(u,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(h,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(i,")) * float(").concat(n,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(i,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(o,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(c,"\n        }\n\n        int inIdx = inOffset + ").concat(o,";\n        if (").concat(1===l,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(c,"\n        } else if (").concat(2===l,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(c,"\n        } else if (").concat(3===l,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(c,"\n        }\n        setOutput(").concat("sumValue",");\n      }\n    ")}}for(let e of[{kernelName:nQ,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{a:r,b:i,bias:s,preluActivationWeights:o}=t,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:h}=a;return Ch({a:r,b:i,transposeA:l,transposeB:c,backend:n,bias:s,preluActivationWeights:o,leakyreluAlpha:h,activation:u})}},{kernelName:"Abs",backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:a}=e,{x:r}=n;if(a.shouldExecuteOnCPU([r])&&"complex64"!==r.dtype){let e=So(a.texData.get(r.dataId).values);return a.makeTensorInfo(r.shape,r.dtype,e)}return t=eT.getBool("WEBGL_PACK_UNARY_OPERATIONS")?new Sj(r.shape,Cd):new SR(r.shape,Cd),a.runWebGLProgram(t,[r],r.dtype)}},{kernelName:e_,backendName:"webgl",kernelFunc:Cp},{kernelName:eA,backendName:"webgl",kernelFunc:Cf},{kernelName:"Add",backendName:"webgl",kernelFunc:Cg},{kernelName:eR,backendName:"webgl",kernelFunc:function e(t){let{inputs:n,backend:a}=t;if(1===n.length)return SQ({inputs:{x:n[0]},backend:a});if(n.length>eT.getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){let t=Math.floor(n.length/2),r=e({inputs:n.slice(0,t),backend:a}),i=e({inputs:n.slice(t),backend:a});return e({inputs:[r,i],backend:a})}let r=n.map(e=>e.dtype).reduce((e,t)=>ab(e,t)),i=n.map(e=>e.shape),s=eT.getBool("WEBGL_PACK")?new Cy(n[0].shape,i):new Cx(n[0].shape,i);return a.runWebGLProgram(s,n,r)}},{kernelName:"All",backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:a,attrs:r}=e,{x:i}=n,{axis:s,keepDims:o}=r,l=i.shape.length,c=cs.parseAxisParam(s,i.shape),u=c,h=oB.getAxesPermutation(u,l),d=i;null!=h&&(d=Cu({inputs:{x:i},backend:a,attrs:{perm:h}}),u=oB.getInnerMostAxes(u.length,l)),oB.assertAxesAreInnerMostDims("all",u,l);let[p,f]=oB.computeOutAndReduceShapes(d.shape,u),m=Cn({inputs:{x:d},backend:a,attrs:{shape:[-1,cs.sizeFromShape(f)]}}),g=Ci(m,m.dtype,"all",a);return t=o?Cn({inputs:{x:g},backend:a,attrs:{shape:oB.expandShapeToKeepDim(p,c)}}):Cn({inputs:{x:g},backend:a,attrs:{shape:p}}),a.disposeIntermediateTensorInfo(m),a.disposeIntermediateTensorInfo(g),null!=h&&a.disposeIntermediateTensorInfo(d),t}},{kernelName:"Any",backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:a,attrs:r}=e,{x:i}=n,{axis:s,keepDims:o}=r,l=i.shape.length,c=cs.parseAxisParam(s,i.shape),u=c,h=oB.getAxesPermutation(u,l),d=i;null!=h&&(d=Cu({inputs:{x:i},backend:a,attrs:{perm:h}}),u=oB.getInnerMostAxes(u.length,l)),oB.assertAxesAreInnerMostDims("any",u,l);let[p,f]=oB.computeOutAndReduceShapes(d.shape,u),m=Cn({inputs:{x:d},backend:a,attrs:{shape:[-1,cs.sizeFromShape(f)]}}),g=Ci(m,m.dtype,"any",a);return t=o?Cn({inputs:{x:g},backend:a,attrs:{shape:oB.expandShapeToKeepDim(p,c)}}):Cn({inputs:{x:g},backend:a,attrs:{shape:p}}),a.disposeIntermediateTensorInfo(m),a.disposeIntermediateTensorInfo(g),null!=h&&a.disposeIntermediateTensorInfo(d),t}},{kernelName:eD,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:i}=a,s=cs.parseAxisParam(i,r.shape),o=oB.getAxesPermutation(s,r.shape.length),l=r,c=[];null!=o&&(c.push(l=Cu({inputs:{x:r},backend:n,attrs:{perm:o}})),s=oB.getInnerMostAxes(s.length,l.shape.length)),oB.assertAxesAreInnerMostDims("argMax",[s[0]],l.shape.length);let u=Cw(n,l,s[0],"max");return c.forEach(e=>n.disposeIntermediateTensorInfo(e)),u}},{kernelName:eM,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:i}=a,s=cs.parseAxisParam(i,r.shape),o=oB.getAxesPermutation(s,r.shape.length),l=r,c=[];null!=o&&(c.push(l=Cu({inputs:{x:r},backend:n,attrs:{perm:o}})),s=oB.getInnerMostAxes(s.length,l.shape.length)),oB.assertAxesAreInnerMostDims("argMin",[s[0]],l.shape.length);let u=Cw(n,l,s[0],"min");return c.forEach(e=>n.disposeIntermediateTensorInfo(e)),u}},{kernelName:eF,backendName:"webgl",kernelFunc:CN},{kernelName:eO,backendName:"webgl",kernelFunc:Ck},{kernelName:eP,backendName:"webgl",kernelFunc:CS},{kernelName:eL,backendName:"webgl",kernelFunc:CC},{kernelName:ej,backendName:"webgl",kernelFunc:CT},{kernelName:ez,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t;N$(r,"avgPool");let{filterSize:i,strides:s,pad:o,dimRoundingMode:l}=a;cs.assert(oB.eitherStridesOrDilationsAreOne(s,1),()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(s," and dilations '").concat(1,"'"));let c=oB.computePool2DInfo(r.shape,i,s,1,o,l);if(1===c.filterWidth&&1===c.filterHeight&&cs.arraysEqual(c.inShape,c.outShape))return SQ({inputs:{x:r},backend:n});let u=new CI(c,"avg",!1);return n.runWebGLProgram(u,[r],"float32")}},{kernelName:eV,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:l,dataFormat:c}=a,u=new CE(oB.computePool3DInfo(r.shape,i,s,[1,1,1],o,l,c),"avg",!1);return n.runWebGLProgram(u,[r],"float32")}},{kernelName:eU,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,input:i}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:c}=a,u=new CA(oB.computePool3DInfo(i.shape,s,o,[1,1,1],l,c));return n.runWebGLProgram(u,[r],i.dtype)}},{kernelName:eB,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,input:i}=t;N$([r,i],"avgPoolGrad");let{filterSize:s,strides:o,pad:l}=a,c=new C_(oB.computePool2DInfo(i.shape,s,o,1,l));return n.runWebGLProgram(c,[r],i.dtype)}},{kernelName:eW,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{a:r,b:i}=t,{transposeA:s,transposeB:o}=a;return Ch({a:r,b:i,transposeA:s,transposeB:o,backend:n})}},{kernelName:tv,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{x:r,mean:i,variance:s,offset:o,scale:l}=t;cs.assert(i.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),cs.assert(null==o||i.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),cs.assert(null==l||i.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:c}=a;null==c&&(c=.001);let u=[r,i,s],h=null;null!=o&&(h=o.shape,u.push(o));let d=null;null!=l&&(d=l.shape,u.push(l));let p=eT.getBool("WEBGL_PACK_NORMALIZATION")?new CD(r.shape,i.shape,s.shape,h,d,c):new CR(r.shape,i.shape,s.shape,h,d,c);return n.runWebGLProgram(p,u,u[0].dtype)}},{kernelName:eG,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{blockShape:i,crops:s}=a;cs.assert(r.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");let o=i.reduce((e,t)=>e*t),l=oB.getReshaped(r.shape,i,o),c=oB.getPermuted(l.length,i.length),u=oB.getReshapedPermuted(r.shape,i,o),h=oB.getSliceBeginCoords(s,i.length),d=oB.getSliceSize(u,s,i.length),p=[],f=Cn({inputs:{x:r},backend:n,attrs:{shape:l}}),m=Cu({inputs:{x:f},backend:n,attrs:{perm:c}}),g=Cn({inputs:{x:m},backend:n,attrs:{shape:u}}),x=CP({inputs:{x:g},backend:n,attrs:{begin:h,size:d}});return p.push(f),p.push(m),p.push(g),p.forEach(e=>n.disposeIntermediateTensorInfo(e)),x}},{kernelName:eH,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,weights:i}=t,{size:s}=a,o=kz(n.readSync(r.dataId),n.readSync(i.dataId),i.dtype,i.shape,s);return n.makeTensorInfo([s],i.dtype,o)}},{kernelName:eq,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:a}=e,{a:r,b:i}=n,s=eT.getBool("WEBGL_PACK_BINARY_OPERATIONS"),o=eT.getNumber("WEBGL_VERSION");if(a.shouldExecuteOnCPU([r,i])||1===o){let e=a.texData.get(r.dataId).values,t=a.texData.get(i.dataId).values,[n,s]=kV(r.shape,i.shape,e,t,r.dtype),o=a.makeTensorInfo(s,r.dtype);return a.texData.get(o.dataId).values=n,o}return t=s?new SZ("\n  int r = int(a.r) & int(b.r);\n  int g = int(a.g) & int(b.g);\n  int rb = int(a.b) & int(b.b);\n  int ra = int(a.a) & int(b.a);\n  return vec4(r, g, rb, ra);\n",r.shape,i.shape,!1):new SX("\n  return float(int(a.r) & int(b.r));\n",r.shape,i.shape),a.runWebGLProgram(t,[r,i],r.dtype)}},{kernelName:eK,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{s0:a,s1:r}=t,i=n.readSync(a.dataId),s=n.readSync(r.dataId),o=oB.assertAndGetBroadcastShape(Array.from(i),Array.from(s));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}},{kernelName:eX,backendName:"webgl",kernelFunc:function e(t){let{inputs:n,backend:a,attrs:r}=t,{x:i}=n,{dtype:s}=r;if("complex64"===s){if("complex64"===i.dtype)return SQ({inputs:{x:i},backend:a});let t=sl(i.shape),n=e({inputs:{x:i},backend:a,attrs:{dtype:"float32"}}),r=SJ({inputs:{real:n,imag:t},backend:a});return t.dispose(),a.disposeIntermediateTensorInfo(n),r}if("complex64"===i.dtype){let t=CL({inputs:{input:i},backend:a}),n=e({inputs:{x:t},backend:a,attrs:{dtype:s}});return a.disposeIntermediateTensorInfo(t),n}if(!cs.hasEncodingLoss(i.dtype,s)){let e=SQ({inputs:{x:i},backend:a});return{dataId:e.dataId,shape:e.shape,dtype:s}}if(a.shouldExecuteOnCPU([i])){let[e,t,n]=kU(a.texData.get(i.dataId).values,i.shape,i.dtype,s);return a.makeTensorInfo(e,t,n)}if("int32"===s){let e=new SR(i.shape,"return float(int(x));"),t=a.runWebGLProgram(e,[i],"int32");return{dataId:t.dataId,shape:t.shape,dtype:t.dtype}}if("bool"===s){let e=a.makeTensorInfo([],"bool",cs.getTypedArrayFromDType("bool",1)),t=Cj({inputs:{a:i,b:e},backend:a});return a.disposeIntermediateTensorInfo(e),t}throw Error("Error in Cast: failed to cast ".concat(i.dtype," to ").concat(s))}},{kernelName:eY,backendName:"webgl",kernelFunc:CB},{kernelName:eZ,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:a,attrs:r}=e,{x:i}=n,{clipValueMin:s,clipValueMax:o}=r;return t=eT.getBool("WEBGL_PACK_CLIP")?new CU(i.shape):new CV(i.shape),a.runWebGLProgram(t,[i],i.dtype,[[s],[o]])}},{kernelName:eQ,backendName:"webgl",kernelFunc:SJ},{kernelName:eJ,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{x:a}=t,r=n.texData.get(a.dataId),i=new CW(a.shape),s=[CG(a,r.complexTensorInfos.real),CG(a,r.complexTensorInfos.imag)];return n.runWebGLProgram(i,s,s[0].dtype)}},{kernelName:e$,backendName:"webgl",kernelFunc:CY},{kernelName:e0,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:a,attrs:r}=e,{x:i,filter:s}=n,{strides:o,pad:l,dataFormat:c,dilations:u,dimRoundingMode:h}=r,d=oB.convertConv2DDataFormat(c),p=oB.computeConv2DInfo(i.shape,s.shape,o,u,l,h,!1,d);if(1===p.filterHeight&&1===p.filterWidth&&1===p.dilationHeight&&1===p.dilationWidth&&1===p.strideHeight&&1===p.strideWidth&&("SAME"===p.padInfo.type||"VALID"===p.padInfo.type))t=C1({x:i,filter:s,convInfo:p,backend:a});else if(p.strideWidth<=2&&"channelsLast"===d&&eT.getBool("WEBGL_EXP_CONV")){let e=new CJ(p),n=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];t=a.runWebGLProgram(e,[i,s],"float32",n)}else if(eT.getBool("WEBGL_CONV_IM2COL"))t=C2({x:i,filter:s,convInfo:p,backend:a});else{let e=new CZ(p);t=a.runWebGLProgram(e,[i,s],"float32")}let f=Cn({inputs:{x:t},backend:a,attrs:{shape:p.outShape}});return a.disposeIntermediateTensorInfo(t),f}},{kernelName:e1,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,dy:i}=t,{strides:s,pad:o,dataFormat:l,dimRoundingMode:c,filterShape:u}=a,h=oB.convertConv2DDataFormat(l),d=new C3(oB.computeConv2DInfo(r.shape,u,s,1,o,c,!1,h));return n.runWebGLProgram(d,[r,i],"float32")}},{kernelName:e2,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,filter:i}=t,{inputShape:s,strides:o,pad:l,dataFormat:c,dimRoundingMode:u}=a,h=oB.convertConv2DDataFormat(c),d=oB.computeConv2DInfo(s,i.shape,o,1,l,u,!1,h);if(eT.getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&"channelsLast"===h){let e=[[d.strideHeight,d.strideWidth]],t=new C8(d);return n.runWebGLProgram(t,[r,i],"float32",e)}{let e=new C4(d);return n.runWebGLProgram(e,[r,i],"float32")}}},{kernelName:e3,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,filter:i}=t,{strides:s,pad:o,dilations:l}=a,c=new CQ(oB.computeConv3DInfo(r.shape,i.shape,s,l,o));return n.runWebGLProgram(c,[r,i],"float32")}},{kernelName:e4,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,dy:i}=t,{strides:s,pad:o,filterShape:l}=a,c=new C5(oB.computeConv3DInfo(r.shape,l,s,1,o));return n.runWebGLProgram(c,[r,i],"float32")}},{kernelName:e5,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,filter:i}=t,{pad:s,strides:o,inputShape:l}=a,c=new C6(oB.computeConv3DInfo(l,i.shape,o,1,s));return n.runWebGLProgram(c,[r,i],"float32")}},{kernelName:"Cos",backendName:"webgl",kernelFunc:C9},{kernelName:e6,backendName:"webgl",kernelFunc:C7},{kernelName:e7,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{image:r,boxes:i,boxInd:s}=t,{cropSize:o,method:l,extrapolationValue:c}=a,u=new Te(r.shape,i.shape,o,l,c);return n.runWebGLProgram(u,[r,i,s],"float32")}},{kernelName:e8,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:i,exclusive:s,reverse:o}=a;return Tr(k.Prod,r,n,i,s,o)}},{kernelName:e9,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{axis:i,exclusive:s,reverse:o}=a;return Tr(k.Sum,r,n,i,s,o)}},{kernelName:te,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,weights:i}=t,{size:s,binaryOutput:o}=a;if(1===r.shape.length){let e=kz(n.readSync(r.dataId),n.readSync(i.dataId),i.dtype,i.shape,s);return n.makeTensorInfo([s],i.dtype,e)}if(2===r.shape.length){let e=kB(n.bufferSync(r),n.bufferSync(i),s,o);return n.makeTensorInfo(e.shape,i.dtype,e.values)}throw Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(r.shape.length,"."))}},{kernelName:tt,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{blockSize:i,dataFormat:s}=a,o=r.shape[0],l="NHWC"===s?r.shape[1]:r.shape[2],c="NHWC"===s?r.shape[2]:r.shape[3],u="NHWC"===s?r.shape[3]:r.shape[1],h=l*i,d=c*i,p=u/(i*i),f=new Ti("NHWC"===s?[o,h,d,p]:[o,p,h,d],i,s);return n.runWebGLProgram(f,[r],r.dtype)}},{kernelName:tn,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:a,attrs:r}=e,{x:i,filter:s}=n,{strides:o,pad:l,dilations:c,dimRoundingMode:u}=r,h=c;null==h&&(h=[1,1]),cs.assert(oB.eitherStridesOrDilationsAreOne(o,h),()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(o," and dilations '").concat(h,"'"));let d=oB.computeConv2DInfo(i.shape,s.shape,o,h,l,u,!0);t=eT.getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels==1?new To(d):new Ts(d);let p=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return a.runWebGLProgram(t,[i,s],"float32",p)}},{kernelName:ta,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,dy:i}=t,{strides:s,dilations:o,pad:l,dimRoundingMode:c,filterShape:u}=a,h=new Tl(oB.computeConv2DInfo(r.shape,u,s,o,l,c,!0));return n.runWebGLProgram(h,[r,i],"float32")}},{kernelName:tr,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,filter:i}=t,{strides:s,dilations:o,pad:l,dimRoundingMode:c,inputShape:u}=a,h=new Tc(oB.computeConv2DInfo(u,i.shape,s,o,l,c,!0));return n.runWebGLProgram(h,[r,i],"float32")}},{kernelName:ti,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{x:a}=t,r=[...a.shape,...a.shape],i=cs.sizeFromShape(a.shape),s=Cn({inputs:{x:a},backend:n,attrs:{shape:[i]}}),o=new Tu(i),l=n.runWebGLProgram(o,[s],s.dtype),c=Cn({inputs:{x:l},backend:n,attrs:{shape:r}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(l),c}},{kernelName:ts,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:a,attrs:r}=e,{x:i,filter:s}=n,{strides:o,pad:l,dilations:c}=r,u=oB.computeDilation2DInfo(i.shape,s.shape,o,l,"NHWC",c),h=new Th(u),d=Cn({inputs:{x:t=a.runWebGLProgram(h,[i,s],"float32")},backend:a,attrs:{shape:u.outShape}});return a.disposeIntermediateTensorInfo(t),d}},{kernelName:th,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{equation:r}=a,{allDims:i,summedDims:s,idDims:o}=oB.decodeEinsumEquation(r,t.length);oB.checkEinsumDimSizes(i.length,o,t);let{path:l,steps:c}=oB.getEinsumComputePath(s,o),u=c.length,h=null,d=i.length,p=[];for(let e=0;e<u;++e){for(let a of c[e]){let e,{permutationIndices:r,expandDims:i}=oB.getEinsumPermutation(d,o[a]);oB.isIdentityPermutation(r)?e=t[a]:(e=Cu({inputs:{x:t[a]},backend:n,attrs:{perm:r}}),p.push(e));let s=e.shape.slice();for(let e=0;e<i.length;++e)s.splice(i[e],0,1);cs.arraysEqual(e.shape,s)||(e=Cn({inputs:{x:e},backend:n,attrs:{shape:s}}),p.push(e)),null===h?h=e:(h=Ct({inputs:{a:e,b:h},backend:n}),p.push(h))}e<u-1&&(l[e]>=0&&(h=Cc({inputs:{x:h},backend:n,attrs:{axis:l[e]-(i.length-d),keepDims:!1}}),p.push(h)),d--)}for(let e of p)e!==h&&n.disposeIntermediateTensorInfo(e);return h}},{kernelName:"Elu",backendName:"webgl",kernelFunc:Td},{kernelName:td,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n}=e,{dy:a,y:r}=t,i=eT.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new SZ("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",a.shape,r.shape):new SX("return (b >= 0.0) ? a : a * (b + 1.0);",a.shape,r.shape);return n.runWebGLProgram(i,[a,r],a.dtype)}},{kernelName:tp,backendName:"webgl",kernelFunc:Tp},{kernelName:"Erf",backendName:"webgl",kernelFunc:Tf},{kernelName:"Exp",backendName:"webgl",kernelFunc:Tm},{kernelName:tf,backendName:"webgl",kernelFunc:Tg},{kernelName:tm,backendName:"webgl",kernelFunc:Ty},{kernelName:"FFT",backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{input:a}=t;return Tv(a,!1,n)}},{kernelName:tg,backendName:"webgl",kernelFunc:TN},{kernelName:tx,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n}=e,{image:a}=t,r=new Tk(a.shape);return n.runWebGLProgram(r,[a],a.dtype)}},{kernelName:ty,backendName:"webgl",kernelFunc:TC},{kernelName:tb,backendName:"webgl",kernelFunc:TT},{kernelName:nY,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{pixels:r}=t,{numChannels:i}=a,s="undefined"!=typeof HTMLVideoElement&&r instanceof HTMLVideoElement,o="undefined"!=typeof HTMLImageElement&&r instanceof HTMLImageElement,[c,u]=s?[r.videoWidth,r.videoHeight]:[r.width,r.height],h=[u,c],d=[u,c,i];if(o||s){let e=eT.getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(null==l||e!==T_)&&(T_=e,l=document.createElement("canvas").getContext("2d",{willReadFrequently:T_})),l.canvas.width=c,l.canvas.height=u,l.drawImage(r,0,0,c,u),r=l.canvas}let p=n.makeTensorInfo(h,"int32");n.texData.get(p.dataId).usage=w.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(p.dataId),r);let f=eT.getBool("WEBGL_PACK")?new TE(d):new TI(d),m=n.runWebGLProgram(f,[p],"int32");return n.disposeData(p.dataId),m}},{kernelName:nJ,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:a,attrs:r}=e,{x:i,filter:s,bias:o,preluActivationWeights:l}=n,{strides:c,pad:u,dataFormat:h,dilations:d,dimRoundingMode:p,activation:f,leakyreluAlpha:m}=r,g=oB.convertConv2DDataFormat(h),x=oB.computeConv2DInfo(i.shape,s.shape,c,d,u,p,!1,g),y=[],b=null!=o,v=null!=l,w="leakyrelu"===f,N=()=>{let e=[i,s],t=(e,t)=>{if("NCHW"===t&&1===e.shape.length&&1!==e.shape[0]){let t=Cn({inputs:{x:e},backend:a,attrs:{shape:[e.shape[0],1,1]}});return y.push(t),t}return e};if(b&&e.push(t(o,h)),v&&e.push(t(l,h)),w){let t=a.makeTensorInfo([],"float32",cs.createScalarValue(m,"float32"));e.push(t),y.push(t)}return e};if(1===x.filterHeight&&1===x.filterWidth&&1===x.dilationHeight&&1===x.dilationWidth&&1===x.strideHeight&&1===x.strideWidth&&("SAME"===x.padInfo.type||"VALID"===x.padInfo.type))t=C1({x:i,filter:s,convInfo:x,backend:a,bias:o,activation:f,preluActivationWeights:l,leakyreluAlpha:m});else if(x.strideWidth<=2&&"channelsLast"===g&&eT.getBool("WEBGL_EXP_CONV")){let e=new CJ(x,b,f?S6(f,!0):null,v,w),n=[[x.padInfo.top,x.padInfo.left],[x.strideHeight,x.strideWidth],[x.dilationHeight,x.dilationWidth],[x.inHeight,x.inWidth]],r=N();t=a.runWebGLProgram(e,r,"float32",n)}else if(eT.getBool("WEBGL_CONV_IM2COL"))t=C2({x:i,filter:s,convInfo:x,backend:a,bias:o,activation:f,preluActivationWeights:l,leakyreluAlpha:m});else{let e=new CZ(x,b,f?S6(f,!1):null,v,w),n=N();t=a.runWebGLProgram(e,n,"float32")}let k=Cn({inputs:{x:t},backend:a,attrs:{shape:x.outShape}});return y.push(t),y.forEach(e=>a.disposeIntermediateTensorInfo(e)),k}},{kernelName:n$,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:a,attrs:r}=e,{x:i,filter:s,bias:o,preluActivationWeights:l}=n,{strides:c,pad:u,dilations:h,dimRoundingMode:d,activation:p,leakyreluAlpha:f}=r,m=[],g=h;null==g&&(g=[1,1]),cs.assert(oB.eitherStridesOrDilationsAreOne(c,g),()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(c," and dilations '").concat(g,"'"));let x=oB.computeConv2DInfo(i.shape,s.shape,c,g,u,d,!0),y=eT.getBool("WEBGL_PACK_DEPTHWISECONV")&&x.strideWidth<=2&&x.outChannels/x.inChannels==1,b=p?S6(p,y):null,v=[i,s],w=null!=o,N=null!=l,k="leakyrelu"===p;if(w&&v.push(o),N&&v.push(l),k){let e=a.makeTensorInfo([],"float32",cs.createScalarValue(f,"float32"));v.push(e),m.push(e)}t=y?new To(x,w,b,N,k):new Ts(x,w,b,N,k);let S=[[x.padInfo.top,x.padInfo.left],[x.strideHeight,x.strideWidth],[x.dilationHeight,x.dilationWidth],[x.inHeight,x.inWidth]],C=a.runWebGLProgram(t,v,"float32",S);return m.forEach(e=>a.disposeIntermediateTensorInfo(e)),C}},{kernelName:tN,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{params:a,indices:r}=t,i=r.shape,s=i[i.length-1],o=cs.sizeFromShape(a.shape),[l,c,u,h]=oB.prepareAndValidate(a,r),d=Cn({inputs:{x:r},backend:n,attrs:{shape:[c,s]}}),p=Cn({inputs:{x:a},backend:n,attrs:{shape:[cs.sizeFromShape(a.shape)/u,u]}});if(n.shouldExecuteOnCPU([a,r])||"string"===a.dtype){let e=kY(n.readSync(r.dataId),n.bufferSync(a),a.dtype,c,s,u,h,a.shape,o);return n.makeTensorInfo(l,a.dtype,e.values)}let f=new TA(s,h,[c,u],a.shape),m=n.runWebGLProgram(f,[p,d],p.dtype),g=Cn({inputs:{x:m},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),g}},{kernelName:tw,backendName:"webgl",kernelFunc:TD},{kernelName:tk,backendName:"webgl",kernelFunc:TM},{kernelName:tS,backendName:"webgl",kernelFunc:TF},{kernelName:tC,backendName:"webgl",kernelFunc:SQ},{kernelName:tT,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{input:a}=t;return Tv(a,!0,n)}},{kernelName:tI,backendName:"webgl",kernelFunc:CX},{kernelName:tE,backendName:"webgl",kernelFunc:TO},{kernelName:t_,backendName:"webgl",kernelFunc:TP},{kernelName:tA,backendName:"webgl",kernelFunc:Tj},{kernelName:tR,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{alpha:i}=a,s=n.makeTensorInfo([],"float32",cs.createScalarValue(i,"float32")),o=eT.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new SZ(S0,r.shape,s.shape):new SX(S$,r.shape,s.shape),l=n.runWebGLProgram(o,[r,s],"float32");return n.disposeIntermediateTensorInfo(s),l}},{kernelName:tD,backendName:"webgl",kernelFunc:TL},{kernelName:tM,backendName:"webgl",kernelFunc:Tz},{kernelName:tF,backendName:"webgl",kernelFunc:function(e){let{backend:t,attrs:n}=e,{start:a,stop:r,num:i}=n,s=k1(a,r,i);return t.makeTensorInfo([s.length],"float32",s)}},{kernelName:"Log",backendName:"webgl",kernelFunc:TB},{kernelName:tO,backendName:"webgl",kernelFunc:TV},{kernelName:tP,backendName:"webgl",kernelFunc:TU},{kernelName:tj,backendName:"webgl",kernelFunc:TW},{kernelName:tL,backendName:"webgl",kernelFunc:TG},{kernelName:"LRN",backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{depthRadius:i,bias:s,alpha:o,beta:l}=a,c=eT.getBool("WEBGL_PACK_NORMALIZATION")?new Tq(r.shape,i,s,o,l):new TH(r.shape,i,s,o,l);return n.runWebGLProgram(c,[r],r.dtype)}},{kernelName:tz,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{x:r,y:i,dy:s}=t,{depthRadius:o,bias:l,alpha:c,beta:u}=a,h=new TK(r.shape,o,l,c,u);return n.runWebGLProgram(h,[r,i,s],r.dtype)}},{kernelName:"Max",backendName:"webgl",kernelFunc:TX},{kernelName:tB,backendName:"webgl",kernelFunc:TY},{kernelName:tV,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t;N$(r,"maxPool");let{filterSize:i,strides:s,pad:o,dimRoundingMode:l}=a;cs.assert(oB.eitherStridesOrDilationsAreOne(s,1),()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(s," and dilations '").concat(1,"'"));let c=oB.computePool2DInfo(r.shape,i,s,1,o,l);if(1===c.filterWidth&&1===c.filterHeight&&cs.arraysEqual(c.inShape,c.outShape))return SQ({inputs:{x:r},backend:n});let u=new CI(c,"max",!1);return n.runWebGLProgram(u,[r],r.dtype)}},{kernelName:tW,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{filterSize:i,strides:s,pad:o,dataFormat:l,dimRoundingMode:c}=a,u=new CE(oB.computePool3DInfo(r.shape,i,s,[1,1,1],o,c,l),"max",!1);return n.runWebGLProgram(u,[r],r.dtype)}},{kernelName:tG,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,input:i}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:c}=a,u=oB.computePool3DInfo(i.shape,s,o,[1,1,1],l,c),h=new CE(u,"max",!0),d=n.runWebGLProgram(h,[i],i.dtype),p=new TQ(u),f=n.runWebGLProgram(p,[r,d],i.dtype);return n.disposeIntermediateTensorInfo(d),f}},{kernelName:tU,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{dy:r,input:i,output:s}=t;N$([i,s],"maxPoolGrad");let{filterSize:o,strides:l,pad:c,dimRoundingMode:u}=a,h=oB.computePool2DInfo(i.shape,o,l,1,c,u),d=new CI(h,"max",!0),p=n.runWebGLProgram(d,[i],i.dtype),f=new TZ(h),m=n.runWebGLProgram(f,[r,p],i.dtype);return n.disposeIntermediateTensorInfo(p),m}},{kernelName:tH,backendName:"webgl",kernelFunc:e=>{let{inputs:t,attrs:n,backend:a}=e,{x:r}=t,{filterSize:i,strides:s,pad:o,includeBatchInIndex:l}=n;cs.assert(4===r.shape.length,()=>"Error in maxPool: input must be rank 4 but got rank ".concat(r.shape.length,"."));let c=[1,1];cs.assert(oB.eitherStridesOrDilationsAreOne(s,c),()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(s," and dilations '").concat(c,"'"));let u=oB.computePool2DInfo(r.shape,i,s,c,o),[h,d]=function(e,t,n,a){let r=new CI(n,"max",!1),i=a.runWebGLProgram(r,[e],"float32");return r=new CI(n,"max",!0,!0,t),[i,a.runWebGLProgram(r,[e],"float32")]}(r,l,u,a);return[h,d]}},{kernelName:tq,backendName:"webgl",kernelFunc:e=>{let{inputs:t,attrs:n,backend:a}=e,{x:r}=t,{keepDims:i,axis:s}=n,o=r.shape.length,l=cs.parseAxisParam(s,r.shape),c=l,u=oB.getAxesPermutation(c,o),h=null!=u,d=a.shouldExecuteOnCPU([r]),p=[],f=r;if(h){if(d){let e=a.texData.get(f.dataId).values,t=Array(o);for(let e=0;e<t.length;e++)t[e]=r.shape[u[e]];let n=Sw(e,r.shape,r.dtype,u,t);f=a.makeTensorInfo(t,r.dtype),a.texData.get(f.dataId).values=n}else f=Cl(r,u,a);p.push(f),c=oB.getInnerMostAxes(c.length,o)}oB.assertAxesAreInnerMostDims("sum",c,o);let[m,g]=oB.computeOutAndReduceShapes(f.shape,c),x=m;i&&(x=oB.expandShapeToKeepDim(m,l));let y=function(e,t,n,a){let r=cs.sizeFromShape(t),i=cs.sizeFromShape(e.shape),s=Cn({inputs:{x:e},attrs:{shape:[i/r,r]},backend:a}),o=Ci(s,"float32","mean",a),l=Cn({inputs:{x:o},attrs:{shape:n},backend:a});return a.disposeIntermediateTensorInfo(s),a.disposeIntermediateTensorInfo(o),l}(f,g,x,a);for(let e of p)a.disposeIntermediateTensorInfo(e);return y}},{kernelName:"Min",backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:a,attrs:r}=e,{x:i}=n,{axis:s,keepDims:o}=r,l=i.shape.length,c=cs.parseAxisParam(s,i.shape),u=c,h=oB.getAxesPermutation(u,l),d=i;null!=h&&(d=Cu({inputs:{x:i},backend:a,attrs:{perm:h}}),u=oB.getInnerMostAxes(u.length,i.shape.length)),oB.assertAxesAreInnerMostDims("min",u,l);let[p,f]=oB.computeOutAndReduceShapes(d.shape,u),m=Cn({inputs:{x:d},backend:a,attrs:{shape:[-1,cs.sizeFromShape(f)]}}),g=Ci(m,m.dtype,"min",a);return t=o?Cn({inputs:{x:g},backend:a,attrs:{shape:oB.expandShapeToKeepDim(p,c)}}):Cn({inputs:{x:g},backend:a,attrs:{shape:p}}),a.disposeIntermediateTensorInfo(m),a.disposeIntermediateTensorInfo(g),null!=h&&a.disposeIntermediateTensorInfo(d),t}},{kernelName:tK,backendName:"webgl",kernelFunc:TJ},{kernelName:tX,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{paddings:i,mode:s}=a,o=eT.getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new T0(r.shape,i,s):new T$(r.shape,i,s);return n.runWebGLProgram(o,[r],r.dtype)}},{kernelName:"Mod",backendName:"webgl",kernelFunc:T1},{kernelName:tY,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{logits:r}=t,{numSamples:i,seed:s,normalized:o}=a,l=o?r:T6({inputs:{logits:r},backend:n,attrs:{dim:r.shape.length-1}}),c=new T2(l.shape[0],l.shape[1],i),u=n.runWebGLProgram(c,[l],"int32",[[s]]);return o||n.disposeIntermediateTensorInfo(l),u}},{kernelName:tZ,backendName:"webgl",kernelFunc:Ct},{kernelName:"Neg",backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:a}=e,{x:r}=n;if(a.shouldExecuteOnCPU([r])){let[e,t]=k8(a.texData.get(r.dataId).values,r.shape,r.dtype);return a.makeTensorInfo(t,r.dtype,e)}return t=eT.getBool("WEBGL_PACK_UNARY_OPERATIONS")?new Sj(r.shape,"\n  vec4 result = -x;\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"):new SR(r.shape,T8),a.runWebGLProgram(t,[r],r.dtype)}},{kernelName:tJ,backendName:"webgl",kernelFunc:function(e){oB.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:n,attrs:a}=e,{boxes:r,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l}=a,{selectedIndices:c}=T9(n.readSync(r.dataId),n.readSync(i.dataId),s,o,l);return n.makeTensorInfo([c.length],"int32",new Int32Array(c))}},{kernelName:t$,backendName:"webgl",kernelFunc:function(e){oB.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:n,attrs:a}=e,{boxes:r,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:c}=a,{selectedIndices:u,validOutputs:h}=T7(n.readSync(r.dataId),n.readSync(i.dataId),s,o,l,c);return[n.makeTensorInfo([u.length],"int32",new Int32Array(u)),n.makeTensorInfo([],"int32",new Int32Array([h]))]}},{kernelName:t0,backendName:"webgl",kernelFunc:function(e){oB.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:n,attrs:a}=e,{boxes:r,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l,softNmsSigma:c}=a,u=n.readSync(r.dataId),{selectedIndices:h,selectedScores:d}=Ie(u,n.readSync(i.dataId),s,o,l,c);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([d.length],"float32",new Float32Array(d))]}},{kernelName:tQ,backendName:"webgl",kernelFunc:Cj},{kernelName:t2,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{indices:r}=t,{dtype:i,depth:s,onValue:o,offValue:l}=a,c=cs.sizeFromShape(r.shape),u=new It(c,s,o,l),h=Cn({inputs:{x:r},backend:n,attrs:{shape:[c]}}),d=n.runWebGLProgram(u,[h],i);n.disposeIntermediateTensorInfo(h);let p=Cn({inputs:{x:d},backend:n,attrs:{shape:[...r.shape,s]}});return n.disposeIntermediateTensorInfo(d),p}},{kernelName:t1,backendName:"webgl",kernelFunc:function e(t){let{inputs:n,backend:a}=t,{x:r}=n;if("string"===r.dtype)throw Error("onesLike is not supported under string dtype");if("complex64"!==r.dtype)return TN({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:a});{let t=CL({inputs:{input:r},backend:a}),n=e({inputs:{x:t},backend:a}),i=CX({inputs:{input:r},backend:a}),s=In({inputs:{x:i},backend:a}),o=SJ({inputs:{real:n,imag:s},backend:a});return a.disposeIntermediateTensorInfo(t),a.disposeIntermediateTensorInfo(n),a.disposeIntermediateTensorInfo(i),a.disposeIntermediateTensorInfo(s),o}}},{kernelName:t3,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{axis:r}=a;if(1===t.length)return Tg({inputs:{input:t[0]},backend:n,attrs:{dim:r}});let i=t[0].shape,s=t[0].dtype;t.forEach(e=>{cs.assertShapesMatch(i,e.shape,"All tensors passed to stack must have matching shapes"),cs.assert(s===e.dtype,()=>"All tensors passed to stack must have matching dtypes")});let o=[],l=CY({inputs:t.map(e=>{let t=Tg({inputs:{input:e},backend:n,attrs:{dim:r}});return o.push(t),t}),backend:n,attrs:{axis:r}});return o.forEach(e=>n.disposeIntermediateTensorInfo(e)),l}},{kernelName:t4,backendName:"webgl",kernelFunc:Ii},{kernelName:"Pow",backendName:"webgl",kernelFunc:Is},{kernelName:t5,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{x:a,alpha:r}=t,i=eT.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new SZ(S2,a.shape,r.shape):new SX(S1,a.shape,r.shape);return n.runWebGLProgram(i,[a,r],"float32")}},{kernelName:t6,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:a,attrs:r}=e,{x:i}=n,{axis:s,keepDims:o}=r,l=i.shape.length,c=[],u=cs.parseAxisParam(s,i.shape),h=u,d=oB.getAxesPermutation(h,l),p=i;if(null!=d&&(p=Cu({inputs:{x:i},backend:a,attrs:{perm:d}}),h=oB.getInnerMostAxes(h.length,l),c.push(p)),oB.assertAxesAreInnerMostDims("prod",h,l),a.shouldExecuteOnCPU([p])){let e=a.texData.get(p.dataId).values,{outVals:n,outShape:r,outDtype:i}=k7(p.shape,p.dtype,e,h);t=a.makeTensorInfo(r,i,n)}else{let[e,n]=oB.computeOutAndReduceShapes(p.shape,h),r=Cn({inputs:{x:p},backend:a,attrs:{shape:[-1,cs.sizeFromShape(n)]}}),s=Ci(r,av(i.dtype),"prod",a);t=Cn({inputs:{x:s},backend:a,attrs:{shape:e}}),c.push(r),c.push(s)}if(o){c.push(t);let e=oB.expandShapeToKeepDim(t.shape,u);t=Cn({inputs:{x:t},backend:a,attrs:{shape:e}})}return c.forEach(e=>a.disposeIntermediateTensorInfo(e)),t}},{kernelName:t8,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{paramsNestedSplits:r,paramsDenseValues:i,indices:s}=t,{outputRaggedRank:o}=a,l=r.map(e=>n.readSync(e.dataId)),c=r.map(e=>e.shape),u=n.readSync(i.dataId),h=n.readSync(s.dataId),[d,p,f]=Se(l,c,u,i.shape,i.dtype,h,s.shape,o),m=d.map(e=>n.makeTensorInfo([e.length],"int32",e)),g=n.makeTensorInfo(f,i.dtype,p);return m.concat([g])}},{kernelName:t9,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{starts:a,limits:r,deltas:i}=t,s=n.readSync(a.dataId),o=n.readSync(r.dataId),l=n.readSync(i.dataId),[c,u]=St(s,a.shape,a.dtype,o,r.shape,l,i.shape);return[n.makeTensorInfo([c.length],"int32",c),n.makeTensorInfo([u.length],a.dtype,u)]}},{kernelName:t7,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{shape:r,values:i,defaultValue:s,rowPartitionTensors:o}=t,{rowPartitionTypes:l}=a,c=n.readSync(r.dataId),u=n.readSync(i.dataId),h=n.readSync(s.dataId),d=o.map(e=>n.readSync(e.dataId)),p=o.map(e=>e.shape),[f,m]=Sn(c,r.shape,u,i.shape,i.dtype,h,s.shape,d,p,l);return n.makeTensorInfo(f,i.dtype,m)}},{kernelName:ne,backendName:"webgl",kernelFunc:Io},{kernelName:nt,backendName:"webgl",kernelFunc:CL},{kernelName:tu,backendName:"webgl",kernelFunc:T3},{kernelName:nn,backendName:"webgl",kernelFunc:Il},{kernelName:na,backendName:"webgl",kernelFunc:Ic},{kernelName:nc,backendName:"webgl",kernelFunc:Iu},{kernelName:nr,backendName:"webgl",kernelFunc:Cn},{kernelName:no,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{images:r}=t,{alignCorners:i,halfPixelCenters:s,size:o}=a,[l,c]=o,u=eT.getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Id(r.shape,l,c,i,s):new Ih(r.shape,l,c,i,s);return n.runWebGLProgram(u,[r],"float32")}},{kernelName:nl,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{images:r,dy:i}=t,{alignCorners:s}=a,o=new Ip(i.shape,r.shape,s);return n.runWebGLProgram(o,[i],i.dtype)}},{kernelName:ni,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{images:r}=t,{alignCorners:i,halfPixelCenters:s,size:o}=a,[l,c]=o,u=eT.getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Im(r.shape,l,c,i,s):new If(r.shape,l,c,i,s);return n.runWebGLProgram(u,[r],r.dtype)}},{kernelName:ns,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{images:r,dy:i}=t,{alignCorners:s}=a,o=new Ig(i.shape,r.shape,s);return n.runWebGLProgram(o,[i],i.dtype)}},{kernelName:nu,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{dims:i}=a,s=r.shape.length,o=cs.parseAxisParam(i,r.shape);if(0===s)return SQ({inputs:{x:r},backend:n});let l=eT.getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Iy(r.shape,o):new Ix(r.shape,o);return n.runWebGLProgram(l,[r],r.dtype)}},{kernelName:nZ,backendName:"webgl",kernelFunc:e=>{let{inputs:t,attrs:n,backend:a}=e,{image:r}=t,{radians:i,fillValue:s,center:o}=n,l=new Ib(r.shape,s),[c,u]=oB.getImageCenter(o,r.shape[1],r.shape[2]),h=[[c,u,Math.sin(i),Math.cos(i)]];return a.runWebGLProgram(l,[r],r.dtype,h)}},{kernelName:nh,backendName:"webgl",kernelFunc:Iv},{kernelName:nd,backendName:"webgl",kernelFunc:Iw},{kernelName:np,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:a,attrs:r}=e,{indices:i,updates:s}=n,{shape:o}=r,{sliceRank:l,numUpdates:c,sliceSize:u,strides:h,outputSize:d}=oB.calculateShapes(s,i,o),p=[d/u,u];if(0===d)return a.makeTensorInfo(o,i.dtype);let f=Cn({inputs:{x:i},backend:a,attrs:{shape:[c,l]}}),m=Cn({inputs:{x:s},backend:a,attrs:{shape:[c,u]}}),g=a.makeTensorInfo([],"float32",new Float32Array([0]));t=eT.getBool("WEBGL_PACK")?new Ik(c,l,f.shape.length,m.shape.length,h,p):new IN(c,l,f.shape.length,m.shape.length,h,p);let x=a.runWebGLProgram(t,[m,f,g],m.dtype),y=Cn({inputs:{x:x},backend:a,attrs:{shape:o}});return a.disposeIntermediateTensorInfo(f),a.disposeIntermediateTensorInfo(m),a.disposeIntermediateTensorInfo(x),a.disposeIntermediateTensorInfo(g),y}},{kernelName:nm,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{sortedSequence:r,values:i}=t,{side:s}=a,o=new IS(r.shape[0],r.shape[1],i.shape[1],s),l=[[r.shape[1]]];return n.runWebGLProgram(o,[r,i],"int32",l)}},{kernelName:ng,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{condition:a,t:r,e:i}=t,s=new IC(a.shape.length,r.shape,r.shape.length);return n.runWebGLProgram(s,[a,r,i],ab(r.dtype,i.dtype))}},{kernelName:nx,backendName:"webgl",kernelFunc:IT},{kernelName:nw,backendName:"webgl",kernelFunc:II},{kernelName:nv,backendName:"webgl",kernelFunc:IE},{kernelName:"Sin",backendName:"webgl",kernelFunc:I_},{kernelName:nb,backendName:"webgl",kernelFunc:IA},{kernelName:ny,backendName:"webgl",kernelFunc:CP},{kernelName:nT,backendName:"webgl",kernelFunc:T6},{kernelName:nN,backendName:"webgl",kernelFunc:IR},{kernelName:nS,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{blockShape:i,paddings:s}=a;cs.assert(r.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");let o=i.reduce((e,t)=>e*t),l=[[0,0]];l.push(...s);for(let e=1+i.length;e<r.shape.length;++e)l.push([0,0]);let c=[],u=Ii({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),h=oB.getReshaped(u.shape,i,o,!1),d=oB.getPermuted(h.length,i.length,!1),p=oB.getReshapedPermuted(u.shape,i,o,!1),f=Cn({inputs:{x:u},backend:n,attrs:{shape:h}}),m=Cu({inputs:{x:f},backend:n,attrs:{perm:d}}),g=Cn({inputs:{x:m},backend:n,attrs:{shape:p}});return c.push(u),c.push(f),c.push(m),c.forEach(e=>n.disposeIntermediateTensorInfo(e)),g}},{kernelName:nI,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{indices:a,values:r,denseShape:i,defaultValue:s}=t;if(1!==i.shape.length)throw Error("Dense shape must be a vector, saw:\n         ".concat(i.shape));if(2!==a.shape.length)throw Error("Indices must be a matrix, saw:\n         ".concat(a.shape));if(1!==r.shape.length)throw Error("Values must be a vector, saw:\n         ".concat(r.shape));if(0!==s.shape.length)throw Error("Default value must be a scalar, saw:\n        ".concat(s.shape));let o=n.readSync(a.dataId),l=n.readSync(r.dataId),c=n.readSync(i.dataId),u=n.readSync(s.dataId)[0],[h,d,p,f,m]=Sc(o,a.shape,a.dtype,l,r.dtype,c,u);return[n.makeTensorInfo(d,a.dtype,h),n.makeTensorInfo([d[0]],r.dtype,p),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map(e=>Number(e)))),n.makeTensorInfo([m.length],a.dtype,new Int32Array(m))]}},{kernelName:nE,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{inputIndices:a,inputShape:r,newShape:i}=t;if(2!==a.shape.length)throw Error("Input indices should be a matrix but received shape ".concat(a.shape));if(1!==r.shape.length)throw Error("Input shape should be a vector but received shape ".concat(r.shape));if(1!==i.shape.length)throw Error("Target shape should be a vector but received shape ".concat(i.shape));let s=Array.from(n.readSync(r.dataId)),o=n.readSync(a.dataId),l=Array.from(n.readSync(i.dataId)),[c,u,h]=Su(o,a.shape,a.dtype,s,l);return[n.makeTensorInfo(u,a.dtype,c),n.makeTensorInfo([h.length],i.dtype,new Int32Array(h))]}},{kernelName:n_,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{data:a,indices:r,segmentIds:i}=t;if(a.shape.length<1)throw Error("Data should be at least 1 dimensional but received scalar");if(1!==r.shape.length)throw Error("Indices should be a vector but received shape\n              ".concat(r.shape));if(1!==i.shape.length)throw Error("Segment ids should be a vector but received shape\n              ".concat(i.shape));let s=n.readSync(a.dataId),o=n.readSync(r.dataId),l=n.readSync(i.dataId),[c,u]=Sh(s,a.shape,a.dtype,o,l,!0);return n.makeTensorInfo(u,a.dtype,c)}},{kernelName:nA,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{data:a,indices:r,segmentIds:i}=t;if(a.shape.length<1)throw Error("Data should be at least 1 dimensional but received scalar");if(1!==r.shape.length)throw Error("Indices should be a vector but received shape\n             ".concat(r.shape));if(1!==i.shape.length)throw Error("Segment ids should be a vector but received shape\n             ".concat(i.shape));let s=n.readSync(a.dataId),o=n.readSync(r.dataId),l=n.readSync(i.dataId),[c,u]=Sh(s,a.shape,a.dtype,o,l);return n.makeTensorInfo(u,a.dtype,c)}},{kernelName:nR,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{sparseIndices:r,sparseValues:i,defaultValue:s}=t,{outputShape:o}=a,{sliceRank:l,numUpdates:c,sliceSize:u,strides:h,outputSize:d}=oB.calculateShapes(i,r,o);if("string"===i.dtype){let e=n.bufferSync(r),t=Si(e,n.bufferSync(i),o,d,u,c,l,h,cs.decodeString(n.readSync(s.dataId)[0]),!1);return n.makeTensorInfo(o,t.dtype,t.values)}let p=new IN(c,l,r.shape.length,i.shape.length,h,[d,1],!1),f=n.runWebGLProgram(p,[i,r,s],i.dtype),m=Cn({inputs:{x:f},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(f),m}},{kernelName:nC,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{numOrSizeSplits:i,axis:s}=a,o=cs.parseAxisParam(s,r.shape)[0],l=oB.prepareSplitSize(r,i,o),c=Array(r.shape.length).fill(0),u=r.shape.slice();return l.map(e=>{let t=[...u];t[o]=e;let a=CP({inputs:{x:r},backend:n,attrs:{begin:c,size:t}});return c[o]+=e,a})}},{kernelName:nk,backendName:"webgl",kernelFunc:IM},{kernelName:nM,backendName:"webgl",kernelFunc:IF},{kernelName:nD,backendName:"webgl",kernelFunc:IP},{kernelName:nF,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t;if("string"!==r.dtype)throw Error("Input must be of datatype string");let i=n.readSync(r.dataId),s=Sp(oB.fromUint8ToStringArray(i),"string",a);return n.makeTensorInfo(r.shape,"string",s)}},{kernelName:nX,backendName:"webgl",kernelFunc:function(e){let{inputs:t,attrs:n,backend:a}=e,{x:r}=t,i=SD+"\n    return x > 0.0 ? 1.0 : float(".concat(n.alpha,");\n  "),s=new SR(r.shape,i);return a.runWebGLProgram(s,[r],r.dtype)}},{kernelName:nO,backendName:"webgl",kernelFunc:function(e){let t,{inputs:n,backend:a,attrs:r}=e,{x:i}=n,{begin:s,end:o,strides:l,beginMask:c,endMask:u,ellipsisMask:h,newAxisMask:d,shrinkAxisMask:p}=r,{finalShapeSparse:f,finalShape:m,isIdentity:g,sliceDim0:x,isSimpleSlice:y,begin:b,end:v,strides:w}=vR.sliceInfo(i.shape,s,o,l,c,u,h,d,p);if(g)t=Cn({inputs:{x:i},backend:a,attrs:{shape:m}});else if(x||y){cs.assert(i.shape.length>=1,()=>"Input must have rank at least 1, got: ".concat(i.shape.length));let e=vR.computeOutShape(b,v,w),n=CP({inputs:{x:i},backend:a,attrs:{begin:b,size:e}});t=Cn({inputs:{x:n},backend:a,attrs:{shape:m}}),a.disposeIntermediateTensorInfo(n)}else if(a.shouldExecuteOnCPU([i])){let e=a.readSync(i.dataId),n=Sf(f,rD(i.shape,i.dtype,e),w,b);t=a.makeTensorInfo(m,i.dtype,n.values)}else{let e=new Ij(b,w,f);t=a.runWebGLProgram(e,[i],i.dtype)}let N=Cn({inputs:{x:t},backend:a,attrs:{shape:m}});return a.disposeIntermediateTensorInfo(t),N}},{kernelName:nP,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{separator:r,nGramWidths:i,leftPad:s,rightPad:o,padWidth:l,preserveShortSequences:c}=a,{data:u,dataSplits:h}=t,[d,p]=Sm(n.readSync(u.dataId),n.readSync(h.dataId),r,i,s,o,l,c);return[n.makeTensorInfo([d.length],"string",d),n.makeTensorInfo(h.shape,"int32",p)]}},{kernelName:nj,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{skipEmpty:r}=a,{input:i,delimiter:s}=t;if("string"!==i.dtype)throw Error("Input must be of datatype string");if(1!==i.shape.length)throw Error("Input must be a vector, got shape: ".concat(i.shape));if(0!==s.shape.length)throw Error("Delimiter must be a scalar, got shape: ".concat(s.shape));let[o,l,c]=Sg(n.readSync(i.dataId),n.readSync(s.dataId)[0],r),u=l.length;return[n.makeTensorInfo([u,2],"int32",o),n.makeTensorInfo([u],"string",l),n.makeTensorInfo([2],"int32",new Int32Array(c))]}},{kernelName:nL,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{numBuckets:r}=a,{input:i}=t;if("string"!==i.dtype)throw Error("Input must be of datatype string");if(r<=0)throw Error("Number of buckets must be at least 1");let s=Sx(n.readSync(i.dataId),r);return n.makeTensorInfo(i.shape,"int32",s)}},{kernelName:"Sub",backendName:"webgl",kernelFunc:T5},{kernelName:"Sum",backendName:"webgl",kernelFunc:Cc},{kernelName:"Tan",backendName:"webgl",kernelFunc:IL},{kernelName:nz,backendName:"webgl",kernelFunc:Iz},{kernelName:nf,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{tensor:r,indices:i,updates:s}=t,{}=a,{sliceRank:o,numUpdates:l,sliceSize:c,strides:u,outputSize:h}=oB.calculateShapes(s,i,r.shape),d=[h/c,c];if(0===h)return n.makeTensorInfo(r.shape,i.dtype);let p=Cn({inputs:{x:i},backend:n,attrs:{shape:[l,o]}}),f=Cn({inputs:{x:s},backend:n,attrs:{shape:[l,c]}}),m=Cn({inputs:{x:r},backend:n,attrs:{shape:d}}),g=new IN(l,o,p.shape.length,f.shape.length,u,d,!1,!0),x=n.runWebGLProgram(g,[f,p,m],m.dtype),y=Cn({inputs:{x:x},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(x),y}},{kernelName:nB,backendName:"webgl",kernelFunc:IV},{kernelName:nV,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{k:i,sorted:s}=a,o=eT.getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=eT.getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=r.shape,u=c[c.length-1];if(n.shouldExecuteOnCPU([r])||u<o||i>l){let[e,t]=Sv(n.readSync(r.dataId),c,r.dtype,i,s);return[n.makeTensorInfo(e.shape,e.dtype,e.values),n.makeTensorInfo(t.shape,t.dtype,t.values)]}if(0===i)return c[c.length-1]=0,[n.makeTensorInfo(c,r.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(1===u)return[r,TN({attrs:{shape:c,dtype:"int32",value:0},backend:n})];let h=n.texData.get(r.dataId),d=null!==h&&h.isPacked,p=d?n.unpackTensor(r):r,f=cs.sizeFromShape(c)/u,m=Cn({inputs:{x:p},attrs:{shape:[f,u]},backend:n});d&&IG(n,p);let g=IH(i),x=IH(u),y=null,b=()=>null===y?[m,m]:[m,y],v=(e,t,a)=>{let r=b(),i=new IU(a),s=[[u],[+(null===y)],[-1/0],[e],[t]],o=y;y=n.runWebGLProgram(i,r,"int32",s),IG(n,o)};for(let e=1;e<g;e*=2){let t=2*e;for(let n=e;n>=1;n/=2)v(t,n,[f,x])}for(let e=x;e>g;e/=2){let t=b(),a=new IW([f,e/2]),r=[[u],[+(null===y)],[g]],i=y;y=n.runWebGLProgram(a,t,"int32",r),IG(n,i);let s=g/2,o=2*s;for(let e=s;e>=1;e/=2)v(o,e,y.shape)}let w=y;y=CP({inputs:{x:y},backend:n,attrs:{begin:0,size:[f,i]}}),IG(n,w);let N=TD({inputs:{x:m,indices:y},backend:n,attrs:{axis:1,batchDims:1}});IG(n,m);let k=c.slice(0,-1);k.push(i),w=y,y=Cn({inputs:{x:y},attrs:{shape:k},backend:n}),IG(n,w);let S=N;return N=Cn({inputs:{x:N},attrs:{shape:k},backend:n}),IG(n,S),[N,y]}},{kernelName:nU,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{image:r,transforms:i}=t,{interpolation:s,fillMode:o,fillValue:l,outputShape:c}=a,[u,h,d,p]=r.shape,[f,m]=null!=c?c:[h,d],g=new Iq(h,d,s,o,l,[u,f,m,p]);return n.runWebGLProgram(g,[r,i],"float32")}},{kernelName:nW,backendName:"webgl",kernelFunc:Cu},{kernelName:nG,backendName:"webgl",kernelFunc:function(e){let{inputs:t,attrs:n,backend:a}=e,{axis:r}=n,{x:i}=t;N$(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");let{outputValues:s,outputShape:o,indices:l}=SN(a.readSync(i.dataId),r,i.shape,i.dtype);return[a.makeTensorInfo(o,i.dtype,s),a.makeTensorInfo([l.length],"int32",l)]}},{kernelName:nH,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{value:r}=t,{axis:i}=a;i<0&&(i+=r.shape.length);let s=r.shape.length,o=r.shape[i],l=Array(s-1),c=0;for(let e=0;e<s;e++)e!==i&&(l[c++]=r.shape[e]);let u=[],h=Array(s).fill(0),d=r.shape.slice();d[i]=1;let p=Array(o);for(let e=0;e<p.length;e++){h[i]=e;let t=CP({inputs:{x:r},backend:n,attrs:{begin:h,size:d}}),a=Cn({inputs:{x:t},backend:n,attrs:{shape:l}});p[e]=a,u.push(t)}return u.forEach(e=>n.disposeIntermediateTensorInfo(e)),p}},{kernelName:nq,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:a}=e,{x:r,segmentIds:i}=t,{numSegments:s}=a,o=r.shape.length,l=[],c=0,u=oB.getAxesPermutation([c],o),h=r;null!=u&&(h=Cu({inputs:{x:r},backend:n,attrs:{perm:u}}),l.push(h),c=oB.getInnerMostAxes(1,o)[0]);let d=oB.segment_util.computeOutShape(h.shape,c,s),p=cs.sizeFromShape([h.shape[c]]),f=Cn({inputs:{x:h},backend:n,attrs:{shape:[-1,p]}});l.push(f);let m=av(r.dtype),g=(e,t,a,r,i)=>{let s=e.shape[0],o=e.shape[1],c=oB.segment_util.segOpComputeOptimalWindowSize(o,i),u=new IK({windowSize:c,inSize:o,batchSize:s,numSegments:i},t),h=n.compileAndRun(u,[e,a],r);if(l.push(h),h.shape[1]===i)return h;let d=Io({backend:n,attrs:{start:0,stop:i,step:1,dtype:"float32"}}),p=IV({inputs:{x:d},backend:n,attrs:{reps:[o/c]}});return l.push(d),l.push(p),g(h,t,p,r,i)},x=Cn({inputs:{x:g(f,"unsortedSegmentSum",i,m,s)},backend:n,attrs:{shape:d}}),y=x;return null!=u&&(l.push(x),y=Cu({inputs:{x:y},backend:n,attrs:{perm:oB.getUndoAxesPermutation(u)}})),l.forEach(e=>n.disposeIntermediateTensorInfo(e)),y}},{kernelName:nK,backendName:"webgl",kernelFunc:In}])n6(e);e.i(81217),e.i(59007),e.s(["GPGPUContext",()=>kj,"MathBackendWebGL",()=>SU,"forceHalfFloat",()=>SH,"gpgpu_util",()=>IX,"setWebGLContext",()=>Nn,"webgl_util",()=>IY],4916),e.i(59951);var IX=SW,IY=SG;e.i(4916),e.i(20443);let IZ=[{name:"Demand Forecasting",description:"Predicts automotive parts demand using historical data and market trends",accuracy:94.7,status:"ready"},{name:"Quality Prediction",description:"Identifies potential quality issues before they occur in production",accuracy:98.2,status:"ready"},{name:"Supply Chain Risk",description:"Assesses supplier reliability and delivery risk factors",accuracy:91.5,status:"training"},{name:"Inventory Optimization",description:"Optimizes stock levels to minimize costs while ensuring availability",accuracy:96.3,status:"ready"}];function IQ(){let[e,t]=(0,C.useState)(IZ[0]),[n,a]=(0,C.useState)(null),[r,i]=(0,C.useState)(!1),[s,o]=(0,C.useState)(!1);(0,C.useEffect)(()=>{aR.ready().then(()=>{o(!0)})},[]);let l=async()=>{if(s){i(!0);try{var e;let t=(e={layers:[g9.dense({inputShape:[4],units:10,activation:"relu"}),g9.dense({units:1,activation:"sigmoid"})]},new pG(e)),n=u9([1,4]),r=t.predict(n),s=await r.data(),o=Math.floor(5e3*s[0]+2e3),l=Math.floor(20*Math.random()+80),c=["up","down","stable"],u=c[Math.floor(Math.random()*c.length)];setTimeout(()=>{a({demand:o,confidence:l,trend:u}),i(!1)},2e3),n.dispose(),r.dispose(),t.dispose()}catch(e){console.error("Prediction error:",e),i(!1)}}};return(0,S.jsx)("section",{className:"py-16 bg-gradient-to-br from-slate-900 to-blue-900",children:(0,S.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,S.jsxs)(T.motion.div,{className:"text-center mb-12",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[(0,S.jsx)("h2",{className:"text-3xl font-bold text-white mb-4",children:"AI/ML Integration Framework"}),(0,S.jsx)("p",{className:"text-lg text-slate-300 max-w-3xl mx-auto",children:"Advanced machine learning models powered by TensorFlow.js for real-time automotive predictions"})]}),(0,S.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,S.jsxs)(T.motion.div,{className:"bg-white rounded-lg shadow-xl p-6",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5},children:[(0,S.jsx)("h3",{className:"text-xl font-semibold text-automotive-carbon mb-6",children:"ML Models Portfolio"}),(0,S.jsx)("div",{className:"space-y-4",children:IZ.map(n=>(0,S.jsxs)(T.motion.div,{className:"p-4 rounded-lg border-2 cursor-pointer transition-all duration-300 ".concat(e.name===n.name?"border-primary-500 bg-primary-50":"border-automotive-chrome hover:border-primary-300"),onClick:()=>t(n),whileHover:{scale:1.02},whileTap:{scale:.98},children:[(0,S.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,S.jsx)("h4",{className:"font-semibold text-automotive-carbon",children:n.name}),(0,S.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,S.jsx)("div",{className:"w-3 h-3 rounded-full ".concat((e=>{switch(e){case"ready":return"bg-automotive-success";case"training":return"bg-automotive-warning";case"predicting":return"bg-automotive-electric";default:return"bg-automotive-steel"}})(n.status))}),(0,S.jsx)("span",{className:"text-sm text-automotive-steel capitalize",children:n.status})]})]}),(0,S.jsx)("p",{className:"text-sm text-automotive-steel mb-3",children:n.description}),(0,S.jsxs)("div",{className:"flex items-center justify-between",children:[(0,S.jsxs)("span",{className:"text-sm font-medium text-automotive-carbon",children:["Accuracy: ",n.accuracy,"%"]}),(0,S.jsx)("div",{className:"w-24 bg-automotive-chrome rounded-full h-2",children:(0,S.jsx)("div",{className:"bg-automotive-success h-2 rounded-full transition-all duration-300",style:{width:"".concat(n.accuracy,"%")}})})]})]},n.name))})]}),(0,S.jsxs)(T.motion.div,{className:"bg-white rounded-lg shadow-xl p-6",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.2},children:[(0,S.jsx)("h3",{className:"text-xl font-semibold text-automotive-carbon mb-6",children:"Live Prediction Engine"}),(0,S.jsxs)("div",{className:"mb-6",children:[(0,S.jsxs)("h4",{className:"font-semibold text-automotive-carbon mb-2",children:["Selected Model: ",e.name]}),(0,S.jsx)("p",{className:"text-sm text-automotive-steel",children:e.description})]}),(0,S.jsx)(T.motion.button,{className:"w-full py-3 px-6 rounded-lg font-semibold transition-all duration-300 ".concat(r||!s?"bg-automotive-steel text-white cursor-not-allowed":"bg-primary-500 hover:bg-primary-600 text-white shadow-lg hover:shadow-xl"),onClick:l,disabled:r||!s,whileHover:!r&&s?{scale:1.02}:{},whileTap:!r&&s?{scale:.98}:{},children:s?r?"Running Prediction...":"Generate Prediction":"Initializing TensorFlow.js..."}),(0,S.jsx)("div",{className:"mt-4 p-3 bg-slate-50 rounded-lg",children:(0,S.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,S.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(s?"bg-automotive-success":"bg-automotive-warning")}),(0,S.jsxs)("span",{className:"text-sm text-automotive-steel",children:["TensorFlow.js: ",s?"Ready":"Loading..."]})]})}),n&&(0,S.jsxs)(T.motion.div,{className:"mt-6 p-4 bg-gradient-to-r from-primary-50 to-blue-50 rounded-lg",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[(0,S.jsx)("h4",{className:"font-semibold text-automotive-carbon mb-4",children:"Prediction Results"}),(0,S.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,S.jsxs)("div",{className:"text-center",children:[(0,S.jsx)("div",{className:"text-2xl font-bold text-primary-600",children:n.demand.toLocaleString()}),(0,S.jsx)("div",{className:"text-sm text-automotive-steel",children:"Units Demand"})]}),(0,S.jsxs)("div",{className:"text-center",children:[(0,S.jsxs)("div",{className:"text-2xl font-bold text-automotive-success",children:[n.confidence,"%"]}),(0,S.jsx)("div",{className:"text-sm text-automotive-steel",children:"Confidence"})]})]}),(0,S.jsxs)("div",{className:"mt-4 flex items-center justify-center space-x-2",children:[(0,S.jsx)("span",{className:"text-2xl",children:(e=>{switch(e){case"up":return"";case"down":return"";case"stable":return"";default:return""}})(n.trend)}),(0,S.jsxs)("span",{className:"text-sm font-medium text-automotive-carbon capitalize",children:[n.trend," Trend Detected"]})]})]})]})]}),(0,S.jsxs)(T.motion.div,{className:"mt-12 bg-white rounded-lg shadow-xl p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},children:[(0,S.jsx)("h3",{className:"text-xl font-semibold text-automotive-carbon mb-6",children:"Technical Architecture"}),(0,S.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,S.jsxs)("div",{className:"text-center",children:[(0,S.jsx)("div",{className:"w-16 h-16 bg-primary-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,S.jsx)("span",{className:"text-2xl",children:""})}),(0,S.jsx)("h4",{className:"font-semibold text-automotive-carbon mb-2",children:"TensorFlow.js"}),(0,S.jsx)("p",{className:"text-sm text-automotive-steel",children:"Client-side machine learning with WebGL acceleration"})]}),(0,S.jsxs)("div",{className:"text-center",children:[(0,S.jsx)("div",{className:"w-16 h-16 bg-primary-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,S.jsx)("span",{className:"text-2xl",children:""})}),(0,S.jsx)("h4",{className:"font-semibold text-automotive-carbon mb-2",children:"Real-time Processing"}),(0,S.jsx)("p",{className:"text-sm text-automotive-steel",children:"Instant predictions without server round-trips"})]}),(0,S.jsxs)("div",{className:"text-center",children:[(0,S.jsx)("div",{className:"w-16 h-16 bg-primary-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,S.jsx)("span",{className:"text-2xl",children:""})}),(0,S.jsx)("h4",{className:"font-semibold text-automotive-carbon mb-2",children:"Privacy First"}),(0,S.jsx)("p",{className:"text-sm text-automotive-steel",children:"All processing happens locally in the browser"})]})]})]})]})})}},86446,e=>{"use strict";e.s(["default",()=>rH],86446);var t,n,a,r,i,s,o,l=e.i(43476),c=e.i(71645),u=e.i(46932),h={value:()=>{}};function d(){for(var e,t=0,n=arguments.length,a={};t<n;++t){if(!(e=arguments[t]+"")||e in a||/[\s.]/.test(e))throw Error("illegal type: "+e);a[e]=[]}return new p(a)}function p(e){this._=e}function f(e,t,n){for(var a=0,r=e.length;a<r;++a)if(e[a].name===t){e[a]=h,e=e.slice(0,a).concat(e.slice(a+1));break}return null!=n&&e.push({name:t,value:n}),e}function m(){}function g(e){return null==e?m:function(){return this.querySelector(e)}}function x(){return[]}function y(e){return null==e?x:function(){return this.querySelectorAll(e)}}function b(e){return function(){return this.matches(e)}}function v(e){return function(t){return t.matches(e)}}p.prototype=d.prototype={constructor:p,on:function(e,t){var n,a=this._,r=(e+"").trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");if(n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),e&&!a.hasOwnProperty(e))throw Error("unknown type: "+e);return{type:e,name:t}}),i=-1,s=r.length;if(arguments.length<2){for(;++i<s;)if((n=(e=r[i]).type)&&(n=function(e,t){for(var n,a=0,r=e.length;a<r;++a)if((n=e[a]).name===t)return n.value}(a[n],e.name)))return n;return}if(null!=t&&"function"!=typeof t)throw Error("invalid callback: "+t);for(;++i<s;)if(n=(e=r[i]).type)a[n]=f(a[n],e.name,t);else if(null==t)for(n in a)a[n]=f(a[n],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new p(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,a,r=Array(n),i=0;i<n;++i)r[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw Error("unknown type: "+e);for(a=this._[e],i=0,n=a.length;i<n;++i)a[i].value.apply(t,r)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw Error("unknown type: "+e);for(var a=this._[e],r=0,i=a.length;r<i;++r)a[r].value.apply(t,n)}};var w=Array.prototype.find;function N(){return this.firstElementChild}var k=Array.prototype.filter;function S(){return Array.from(this.children)}function C(e){return Array(e.length)}function T(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function I(e,t,n,a,r,i){for(var s,o=0,l=t.length,c=i.length;o<c;++o)(s=t[o])?(s.__data__=i[o],a[o]=s):n[o]=new T(e,i[o]);for(;o<l;++o)(s=t[o])&&(r[o]=s)}function E(e,t,n,a,r,i,s){var o,l,c,u=new Map,h=t.length,d=i.length,p=Array(h);for(o=0;o<h;++o)(l=t[o])&&(p[o]=c=s.call(l,l.__data__,o,t)+"",u.has(c)?r[o]=l:u.set(c,l));for(o=0;o<d;++o)c=s.call(e,i[o],o,i)+"",(l=u.get(c))?(a[o]=l,l.__data__=i[o],u.delete(c)):n[o]=new T(e,i[o]);for(o=0;o<h;++o)(l=t[o])&&u.get(p[o])===l&&(r[o]=l)}function _(e){return e.__data__}function A(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}T.prototype={constructor:T,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var R="http://www.w3.org/1999/xhtml";let D={svg:"http://www.w3.org/2000/svg",xhtml:R,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function M(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),D.hasOwnProperty(t)?{space:D[t],local:e}:e}function F(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function O(e,t){return e.style.getPropertyValue(t)||F(e).getComputedStyle(e,null).getPropertyValue(t)}function P(e){return e.trim().split(/^|\s+/)}function j(e){return e.classList||new L(e)}function L(e){this._node=e,this._names=P(e.getAttribute("class")||"")}function z(e,t){for(var n=j(e),a=-1,r=t.length;++a<r;)n.add(t[a])}function B(e,t){for(var n=j(e),a=-1,r=t.length;++a<r;)n.remove(t[a])}function V(){this.textContent=""}function U(){this.innerHTML=""}function W(){this.nextSibling&&this.parentNode.appendChild(this)}function G(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function H(e){var t=M(e);return(t.local?function(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}:function(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===R&&t.documentElement.namespaceURI===R?t.createElement(e):t.createElementNS(n,e)}})(t)}function q(){return null}function K(){var e=this.parentNode;e&&e.removeChild(this)}function X(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Y(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Z(e){return function(){var t=this.__on;if(t){for(var n,a=0,r=-1,i=t.length;a<i;++a)(n=t[a],e.type&&n.type!==e.type||n.name!==e.name)?t[++r]=n:this.removeEventListener(n.type,n.listener,n.options);++r?t.length=r:delete this.__on}}}function Q(e,t,n){return function(){var a,r=this.__on,i=function(e){t.call(this,e,this.__data__)};if(r){for(var s=0,o=r.length;s<o;++s)if((a=r[s]).type===e.type&&a.name===e.name){this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=i,a.options=n),a.value=t;return}}this.addEventListener(e.type,i,n),a={type:e.type,name:e.name,value:t,listener:i,options:n},r?r.push(a):this.__on=[a]}}function J(e,t,n){var a=F(e),r=a.CustomEvent;"function"==typeof r?r=new r(t,n):(r=a.document.createEvent("Event"),n?(r.initEvent(t,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(t,!1,!1)),e.dispatchEvent(r)}L.prototype={add:function(e){0>this._names.indexOf(e)&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var $=[null];function ee(e,t){this._groups=e,this._parents=t}function et(){return new ee([[document.documentElement]],$)}function en(e){return"string"==typeof e?new ee([[document.querySelector(e)]],[document.documentElement]):new ee([[e]],$)}function ea(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function er(e,t){var n=Object.create(e.prototype);for(var a in t)n[a]=t[a];return n}function ei(){}ee.prototype=et.prototype={constructor:ee,select:function(e){"function"!=typeof e&&(e=g(e));for(var t=this._groups,n=t.length,a=Array(n),r=0;r<n;++r)for(var i,s,o=t[r],l=o.length,c=a[r]=Array(l),u=0;u<l;++u)(i=o[u])&&(s=e.call(i,i.__data__,u,o))&&("__data__"in i&&(s.__data__=i.__data__),c[u]=s);return new ee(a,this._parents)},selectAll:function(e){if("function"==typeof e){var t;t=e,e=function(){var e;return e=t.apply(this,arguments),null==e?[]:Array.isArray(e)?e:Array.from(e)}}else e=y(e);for(var n=this._groups,a=n.length,r=[],i=[],s=0;s<a;++s)for(var o,l=n[s],c=l.length,u=0;u<c;++u)(o=l[u])&&(r.push(e.call(o,o.__data__,u,l)),i.push(o));return new ee(r,i)},selectChild:function(e){var t;return this.select(null==e?N:(t="function"==typeof e?e:v(e),function(){return w.call(this.children,t)}))},selectChildren:function(e){var t;return this.selectAll(null==e?S:(t="function"==typeof e?e:v(e),function(){return k.call(this.children,t)}))},filter:function(e){"function"!=typeof e&&(e=b(e));for(var t=this._groups,n=t.length,a=Array(n),r=0;r<n;++r)for(var i,s=t[r],o=s.length,l=a[r]=[],c=0;c<o;++c)(i=s[c])&&e.call(i,i.__data__,c,s)&&l.push(i);return new ee(a,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,_);var n=t?E:I,a=this._parents,r=this._groups;"function"!=typeof e&&(y=e,e=function(){return y});for(var i=r.length,s=Array(i),o=Array(i),l=Array(i),c=0;c<i;++c){var u=a[c],h=r[c],d=h.length,p="object"==typeof(x=e.call(u,u&&u.__data__,c,a))&&"length"in x?x:Array.from(x),f=p.length,m=o[c]=Array(f),g=s[c]=Array(f);n(u,h,m,g,l[c]=Array(d),p,t);for(var x,y,b,v,w=0,N=0;w<f;++w)if(b=m[w]){for(w>=N&&(N=w+1);!(v=g[N])&&++N<f;);b._next=v||null}}return(s=new ee(s,a))._enter=o,s._exit=l,s},enter:function(){return new ee(this._enter||this._groups.map(C),this._parents)},exit:function(){return new ee(this._exit||this._groups.map(C),this._parents)},join:function(e,t,n){var a=this.enter(),r=this,i=this.exit();return"function"==typeof e?(a=e(a))&&(a=a.selection()):a=a.append(e+""),null!=t&&(r=t(r))&&(r=r.selection()),null==n?i.remove():n(i),a&&r?a.merge(r).order():r},merge:function(e){for(var t=e.selection?e.selection():e,n=this._groups,a=t._groups,r=n.length,i=a.length,s=Math.min(r,i),o=Array(r),l=0;l<s;++l)for(var c,u=n[l],h=a[l],d=u.length,p=o[l]=Array(d),f=0;f<d;++f)(c=u[f]||h[f])&&(p[f]=c);for(;l<r;++l)o[l]=n[l];return new ee(o,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var a,r=e[t],i=r.length-1,s=r[i];--i>=0;)(a=r[i])&&(s&&4^a.compareDocumentPosition(s)&&s.parentNode.insertBefore(a,s),s=a);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=A);for(var n=this._groups,a=n.length,r=Array(a),i=0;i<a;++i){for(var s,o=n[i],l=o.length,c=r[i]=Array(l),u=0;u<l;++u)(s=o[u])&&(c[u]=s);c.sort(t)}return new ee(r,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var a=e[t],r=0,i=a.length;r<i;++r){var s=a[r];if(s)return s}return null},size:function(){let e=0;for(let t of this)++e;return e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,a=t.length;n<a;++n)for(var r,i=t[n],s=0,o=i.length;s<o;++s)(r=i[s])&&e.call(r,r.__data__,s,i);return this},attr:function(e,t){var n=M(e);if(arguments.length<2){var a=this.node();return n.local?a.getAttributeNS(n.space,n.local):a.getAttribute(n)}return this.each((null==t?n.local?function(e){return function(){this.removeAttributeNS(e.space,e.local)}}:function(e){return function(){this.removeAttribute(e)}}:"function"==typeof t?n.local?function(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}:function(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}:n.local?function(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}:function(e,t){return function(){this.setAttribute(e,t)}})(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?function(e){return function(){this.style.removeProperty(e)}}:"function"==typeof t?function(e,t,n){return function(){var a=t.apply(this,arguments);null==a?this.style.removeProperty(e):this.style.setProperty(e,a,n)}}:function(e,t,n){return function(){this.style.setProperty(e,t,n)}})(e,t,null==n?"":n)):O(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?function(e){return function(){delete this[e]}}:"function"==typeof t?function(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}:function(e,t){return function(){this[e]=t}})(e,t)):this.node()[e]},classed:function(e,t){var n=P(e+"");if(arguments.length<2){for(var a=j(this.node()),r=-1,i=n.length;++r<i;)if(!a.contains(n[r]))return!1;return!0}return this.each(("function"==typeof t?function(e,t){return function(){(t.apply(this,arguments)?z:B)(this,e)}}:t?function(e){return function(){z(this,e)}}:function(e){return function(){B(this,e)}})(n,t))},text:function(e){return arguments.length?this.each(null==e?V:("function"==typeof e?function(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}:function(e){return function(){this.textContent=e}})(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?U:("function"==typeof e?function(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}:function(e){return function(){this.innerHTML=e}})(e)):this.node().innerHTML},raise:function(){return this.each(W)},lower:function(){return this.each(G)},append:function(e){var t="function"==typeof e?e:H(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})},insert:function(e,t){var n="function"==typeof e?e:H(e),a=null==t?q:"function"==typeof t?t:g(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),a.apply(this,arguments)||null)})},remove:function(){return this.each(K)},clone:function(e){return this.select(e?Y:X)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var a,r,i=(e+"").trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}),s=i.length;if(arguments.length<2){var o=this.node().__on;if(o){for(var l,c=0,u=o.length;c<u;++c)for(a=0,l=o[c];a<s;++a)if((r=i[a]).type===l.type&&r.name===l.name)return l.value}return}for(a=0,o=t?Q:Z;a<s;++a)this.each(o(i[a],t,n));return this},dispatch:function(e,t){return this.each(("function"==typeof t?function(e,t){return function(){return J(this,e,t.apply(this,arguments))}}:function(e,t){return function(){return J(this,e,t)}})(e,t))},[Symbol.iterator]:function*(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var a,r=e[t],i=0,s=r.length;i<s;++i)(a=r[i])&&(yield a)}};var es="\\s*([+-]?\\d+)\\s*",eo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",el="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ec=/^#([0-9a-f]{3,8})$/,eu=new RegExp("^rgb\\(".concat(es,",").concat(es,",").concat(es,"\\)$")),eh=new RegExp("^rgb\\(".concat(el,",").concat(el,",").concat(el,"\\)$")),ed=new RegExp("^rgba\\(".concat(es,",").concat(es,",").concat(es,",").concat(eo,"\\)$")),ep=new RegExp("^rgba\\(".concat(el,",").concat(el,",").concat(el,",").concat(eo,"\\)$")),ef=new RegExp("^hsl\\(".concat(eo,",").concat(el,",").concat(el,"\\)$")),em=new RegExp("^hsla\\(".concat(eo,",").concat(el,",").concat(el,",").concat(eo,"\\)$")),eg={aliceblue:0xf0f8ff,antiquewhite:0xfaebd7,aqua:65535,aquamarine:8388564,azure:0xf0ffff,beige:0xf5f5dc,bisque:0xffe4c4,black:0,blanchedalmond:0xffebcd,blue:255,blueviolet:9055202,brown:0xa52a2a,burlywood:0xdeb887,cadetblue:6266528,chartreuse:8388352,chocolate:0xd2691e,coral:0xff7f50,cornflowerblue:6591981,cornsilk:0xfff8dc,crimson:0xdc143c,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:0xb8860b,darkgray:0xa9a9a9,darkgreen:25600,darkgrey:0xa9a9a9,darkkhaki:0xbdb76b,darkmagenta:9109643,darkolivegreen:5597999,darkorange:0xff8c00,darkorchid:0x9932cc,darkred:9109504,darksalmon:0xe9967a,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:0xff1493,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:0xb22222,floralwhite:0xfffaf0,forestgreen:2263842,fuchsia:0xff00ff,gainsboro:0xdcdcdc,ghostwhite:0xf8f8ff,gold:0xffd700,goldenrod:0xdaa520,gray:8421504,green:32768,greenyellow:0xadff2f,grey:8421504,honeydew:0xf0fff0,hotpink:0xff69b4,indianred:0xcd5c5c,indigo:4915330,ivory:0xfffff0,khaki:0xf0e68c,lavender:0xe6e6fa,lavenderblush:0xfff0f5,lawngreen:8190976,lemonchiffon:0xfffacd,lightblue:0xadd8e6,lightcoral:0xf08080,lightcyan:0xe0ffff,lightgoldenrodyellow:0xfafad2,lightgray:0xd3d3d3,lightgreen:9498256,lightgrey:0xd3d3d3,lightpink:0xffb6c1,lightsalmon:0xffa07a,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:0xb0c4de,lightyellow:0xffffe0,lime:65280,limegreen:3329330,linen:0xfaf0e6,magenta:0xff00ff,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:0xba55d3,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:0xc71585,midnightblue:1644912,mintcream:0xf5fffa,mistyrose:0xffe4e1,moccasin:0xffe4b5,navajowhite:0xffdead,navy:128,oldlace:0xfdf5e6,olive:8421376,olivedrab:7048739,orange:0xffa500,orangered:0xff4500,orchid:0xda70d6,palegoldenrod:0xeee8aa,palegreen:0x98fb98,paleturquoise:0xafeeee,palevioletred:0xdb7093,papayawhip:0xffefd5,peachpuff:0xffdab9,peru:0xcd853f,pink:0xffc0cb,plum:0xdda0dd,powderblue:0xb0e0e6,purple:8388736,rebeccapurple:6697881,red:0xff0000,rosybrown:0xbc8f8f,royalblue:4286945,saddlebrown:9127187,salmon:0xfa8072,sandybrown:0xf4a460,seagreen:3050327,seashell:0xfff5ee,sienna:0xa0522d,silver:0xc0c0c0,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:0xfffafa,springgreen:65407,steelblue:4620980,tan:0xd2b48c,teal:32896,thistle:0xd8bfd8,tomato:0xff6347,turquoise:4251856,violet:0xee82ee,wheat:0xf5deb3,white:0xffffff,whitesmoke:0xf5f5f5,yellow:0xffff00,yellowgreen:0x9acd32};function ex(){return this.rgb().formatHex()}function ey(){return this.rgb().formatRgb()}function eb(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=ec.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?ev(t):3===n?new ek(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?ew(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?ew(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=eu.exec(e))?new ek(t[1],t[2],t[3],1):(t=eh.exec(e))?new ek(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=ed.exec(e))?ew(t[1],t[2],t[3],t[4]):(t=ep.exec(e))?ew(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=ef.exec(e))?e_(t[1],t[2]/100,t[3]/100,1):(t=em.exec(e))?e_(t[1],t[2]/100,t[3]/100,t[4]):eg.hasOwnProperty(e)?ev(eg[e]):"transparent"===e?new ek(NaN,NaN,NaN,0):null}function ev(e){return new ek(e>>16&255,e>>8&255,255&e,1)}function ew(e,t,n,a){return a<=0&&(e=t=n=NaN),new ek(e,t,n,a)}function eN(e,t,n,a){var r;return 1==arguments.length?((r=e)instanceof ei||(r=eb(r)),r)?new ek((r=r.rgb()).r,r.g,r.b,r.opacity):new ek:new ek(e,t,n,null==a?1:a)}function ek(e,t,n,a){this.r=+e,this.g=+t,this.b=+n,this.opacity=+a}function eS(){return"#".concat(eE(this.r)).concat(eE(this.g)).concat(eE(this.b))}function eC(){let e=eT(this.opacity);return"".concat(1===e?"rgb(":"rgba(").concat(eI(this.r),", ").concat(eI(this.g),", ").concat(eI(this.b)).concat(1===e?")":", ".concat(e,")"))}function eT(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function eI(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function eE(e){return((e=eI(e))<16?"0":"")+e.toString(16)}function e_(e,t,n,a){return a<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new eR(e,t,n,a)}function eA(e){if(e instanceof eR)return new eR(e.h,e.s,e.l,e.opacity);if(e instanceof ei||(e=eb(e)),!e)return new eR;if(e instanceof eR)return e;var t=(e=e.rgb()).r/255,n=e.g/255,a=e.b/255,r=Math.min(t,n,a),i=Math.max(t,n,a),s=NaN,o=i-r,l=(i+r)/2;return o?(s=t===i?(n-a)/o+(n<a)*6:n===i?(a-t)/o+2:(t-n)/o+4,o/=l<.5?i+r:2-i-r,s*=60):o=l>0&&l<1?0:s,new eR(s,o,l,e.opacity)}function eR(e,t,n,a){this.h=+e,this.s=+t,this.l=+n,this.opacity=+a}function eD(e){return(e=(e||0)%360)<0?e+360:e}function eM(e){return Math.max(0,Math.min(1,e||0))}function eF(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}function eO(e,t,n,a,r){var i=e*e,s=i*e;return((1-3*e+3*i-s)*t+(4-6*i+3*s)*n+(1+3*e+3*i-3*s)*a+s*r)/6}ea(ei,eb,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:ex,formatHex:ex,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return eA(this).formatHsl()},formatRgb:ey,toString:ey}),ea(ek,eN,er(ei,{brighter(e){return e=null==e?1.4285714285714286:Math.pow(1.4285714285714286,e),new ek(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?.7:Math.pow(.7,e),new ek(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ek(eI(this.r),eI(this.g),eI(this.b),eT(this.opacity))},displayable(){return -.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:eS,formatHex:eS,formatHex8:function(){return"#".concat(eE(this.r)).concat(eE(this.g)).concat(eE(this.b)).concat(eE((isNaN(this.opacity)?1:this.opacity)*255))},formatRgb:eC,toString:eC})),ea(eR,function(e,t,n,a){return 1==arguments.length?eA(e):new eR(e,t,n,null==a?1:a)},er(ei,{brighter(e){return e=null==e?1.4285714285714286:Math.pow(1.4285714285714286,e),new eR(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?.7:Math.pow(.7,e),new eR(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,a=n+(n<.5?n:1-n)*t,r=2*n-a;return new ek(eF(e>=240?e-240:e+120,r,a),eF(e,r,a),eF(e<120?e+240:e-120,r,a),this.opacity)},clamp(){return new eR(eD(this.h),eM(this.s),eM(this.l),eT(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=eT(this.opacity);return"".concat(1===e?"hsl(":"hsla(").concat(eD(this.h),", ").concat(100*eM(this.s),"%, ").concat(100*eM(this.l),"%").concat(1===e?")":", ".concat(e,")"))}}));let eP=e=>()=>e;function ej(e,t){var n=t-e;return n?function(t){return e+t*n}:eP(isNaN(e)?t:e)}let eL=function e(t){var n,a=1==(n=+t)?ej:function(e,t){var a,r,i;return t-e?(a=e,r=t,a=Math.pow(a,i=n),r=Math.pow(r,i)-a,i=1/i,function(e){return Math.pow(a+e*r,i)}):eP(isNaN(e)?t:e)};function r(e,t){var n=a((e=eN(e)).r,(t=eN(t)).r),r=a(e.g,t.g),i=a(e.b,t.b),s=ej(e.opacity,t.opacity);return function(t){return e.r=n(t),e.g=r(t),e.b=i(t),e.opacity=s(t),e+""}}return r.gamma=e,r}(1);function ez(e){return function(t){var n,a,r=t.length,i=Array(r),s=Array(r),o=Array(r);for(n=0;n<r;++n)a=eN(t[n]),i[n]=a.r||0,s[n]=a.g||0,o[n]=a.b||0;return i=e(i),s=e(s),o=e(o),a.opacity=1,function(e){return a.r=i(e),a.g=s(e),a.b=o(e),a+""}}}var eB=ez(function(e){var t=e.length-1;return function(n){var a=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),r=e[a],i=e[a+1],s=a>0?e[a-1]:2*r-i,o=a<t-1?e[a+2]:2*i-r;return eO((n-a/t)*t,s,r,i,o)}});function eV(e,t){return e*=1,t*=1,function(n){return e*(1-n)+t*n}}ez(function(e){var t=e.length;return function(n){var a=Math.floor(((n%=1)<0?++n:n)*t),r=e[(a+t-1)%t],i=e[a%t],s=e[(a+1)%t],o=e[(a+2)%t];return eO((n-a/t)*t,r,i,s,o)}});var eU=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,eW=RegExp(eU.source,"g");function eG(e,t){var n,a,r,i,s,o=eU.lastIndex=eW.lastIndex=0,l=-1,c=[],u=[];for(e+="",t+="";(r=eU.exec(e))&&(i=eW.exec(t));)(s=i.index)>o&&(s=t.slice(o,s),c[l]?c[l]+=s:c[++l]=s),(r=r[0])===(i=i[0])?c[l]?c[l]+=i:c[++l]=i:(c[++l]=null,u.push({i:l,x:eV(r,i)})),o=eW.lastIndex;return o<t.length&&(s=t.slice(o),c[l]?c[l]+=s:c[++l]=s),c.length<2?u[0]?(n=u[0].x,function(e){return n(e)+""}):(a=t,function(){return a}):(t=u.length,function(e){for(var n,a=0;a<t;++a)c[(n=u[a]).i]=n.x(e);return c.join("")})}function eH(e,t){var n,a,r=typeof t;return null==t||"boolean"===r?eP(t):("number"===r?eV:"string"===r?(a=eb(t))?(t=a,eL):eG:t instanceof eb?eL:t instanceof Date?function(e,t){var n=new Date;return e*=1,t*=1,function(a){return n.setTime(e*(1-a)+t*a),n}}:!ArrayBuffer.isView(n=t)||n instanceof DataView?Array.isArray(t)?function(e,t){var n,a=t?t.length:0,r=e?Math.min(a,e.length):0,i=Array(r),s=Array(a);for(n=0;n<r;++n)i[n]=eH(e[n],t[n]);for(;n<a;++n)s[n]=t[n];return function(e){for(n=0;n<r;++n)s[n]=i[n](e);return s}}:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?function(e,t){var n,a={},r={};for(n in(null===e||"object"!=typeof e)&&(e={}),(null===t||"object"!=typeof t)&&(t={}),t)n in e?a[n]=eH(e[n],t[n]):r[n]=t[n];return function(e){for(n in a)r[n]=a[n](e);return r}}:eV:function(e,t){t||(t=[]);var n,a=e?Math.min(t.length,e.length):0,r=t.slice();return function(i){for(n=0;n<a;++n)r[n]=e[n]*(1-i)+t[n]*i;return r}})(e,t)}var eq,eK,eX=0,eY=0,eZ=0,eQ=0,eJ=0,e$=0,e0="object"==typeof performance&&performance.now?performance:Date,e1="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function e2(){return eJ||(e1(e3),eJ=e0.now()+e$)}function e3(){eJ=0}function e4(){this._call=this._time=this._next=null}function e5(e,t,n){var a=new e4;return a.restart(e,t,n),a}function e6(){eJ=(eQ=e0.now())+e$,eX=eY=0;try{e2(),++eX;for(var e,t=eq;t;)(e=eJ-t._time)>=0&&t._call.call(void 0,e),t=t._next;--eX}finally{eX=0,function(){for(var e,t,n=eq,a=1/0;n;)n._call?(a>n._time&&(a=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:eq=t);eK=e,e9(a)}(),eJ=0}}function e8(){var e=e0.now(),t=e-eQ;t>1e3&&(e$-=t,eQ=e)}function e9(e){!eX&&(eY&&(eY=clearTimeout(eY)),e-eJ>24?(e<1/0&&(eY=setTimeout(e6,e-e0.now()-e$)),eZ&&(eZ=clearInterval(eZ))):(eZ||(eQ=e0.now(),eZ=setInterval(e8,1e3)),eX=1,e1(e6)))}function e7(e,t,n){var a=new e4;return t=null==t?0:+t,a.restart(n=>{a.stop(),e(n+t)},t,n),a}e4.prototype=e5.prototype={constructor:e4,restart:function(e,t,n){if("function"!=typeof e)throw TypeError("callback is not a function");n=(null==n?e2():+n)+(null==t?0:+t),this._next||eK===this||(eK?eK._next=this:eq=this,eK=this),this._call=e,this._time=n,e9()},stop:function(){this._call&&(this._call=null,this._time=1/0,e9())}};var te=d("start","end","cancel","interrupt"),tt=[];function tn(e,t,n,a,r,i){var s=e.__transition;if(s){if(n in s)return}else e.__transition={};!function(e,t,n){var a,r=e.__transition;function i(l){var c,u,h,d;if(1!==n.state)return o();for(c in r)if((d=r[c]).name===n.name){if(3===d.state)return e7(i);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",e,e.__data__,d.index,d.group),delete r[c]):+c<t&&(d.state=6,d.timer.stop(),d.on.call("cancel",e,e.__data__,d.index,d.group),delete r[c])}if(e7(function(){3===n.state&&(n.state=4,n.timer.restart(s,n.delay,n.time),s(l))}),n.state=2,n.on.call("start",e,e.__data__,n.index,n.group),2===n.state){for(c=0,n.state=3,a=Array(h=n.tween.length),u=-1;c<h;++c)(d=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(a[++u]=d);a.length=u+1}}function s(t){for(var r=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(o),n.state=5,1),i=-1,s=a.length;++i<s;)a[i].call(e,r);5===n.state&&(n.on.call("end",e,e.__data__,n.index,n.group),o())}function o(){for(var a in n.state=6,n.timer.stop(),delete r[t],r)return;delete e.__transition}r[t]=n,n.timer=e5(function(e){n.state=1,n.timer.restart(i,n.delay,n.time),n.delay<=e&&i(e-n.delay)},0,n.time)}(e,n,{name:t,index:a,group:r,on:te,tween:tt,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:0})}function ta(e,t){var n=ti(e,t);if(n.state>0)throw Error("too late; already scheduled");return n}function tr(e,t){var n=ti(e,t);if(n.state>3)throw Error("too late; already running");return n}function ti(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw Error("transition not found");return n}var ts=180/Math.PI,to={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function tl(e,t,n,a,r,i){var s,o,l;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(l=e*n+t*a)&&(n-=e*l,a-=t*l),(o=Math.sqrt(n*n+a*a))&&(n/=o,a/=o,l/=o),e*a<t*n&&(e=-e,t=-t,l=-l,s=-s),{translateX:r,translateY:i,rotate:Math.atan2(t,e)*ts,skewX:Math.atan(l)*ts,scaleX:s,scaleY:o}}function tc(e,t,n,a){function r(e){return e.length?e.pop()+" ":""}return function(i,s){var o,l,c,u,h=[],d=[];return i=e(i),s=e(s),!function(e,a,r,i,s,o){if(e!==r||a!==i){var l=s.push("translate(",null,t,null,n);o.push({i:l-4,x:eV(e,r)},{i:l-2,x:eV(a,i)})}else(r||i)&&s.push("translate("+r+t+i+n)}(i.translateX,i.translateY,s.translateX,s.translateY,h,d),o=i.rotate,l=s.rotate,o!==l?(o-l>180?l+=360:l-o>180&&(o+=360),d.push({i:h.push(r(h)+"rotate(",null,a)-2,x:eV(o,l)})):l&&h.push(r(h)+"rotate("+l+a),c=i.skewX,u=s.skewX,c!==u?d.push({i:h.push(r(h)+"skewX(",null,a)-2,x:eV(c,u)}):u&&h.push(r(h)+"skewX("+u+a),!function(e,t,n,a,i,s){if(e!==n||t!==a){var o=i.push(r(i)+"scale(",null,",",null,")");s.push({i:o-4,x:eV(e,n)},{i:o-2,x:eV(t,a)})}else(1!==n||1!==a)&&i.push(r(i)+"scale("+n+","+a+")")}(i.scaleX,i.scaleY,s.scaleX,s.scaleY,h,d),i=s=null,function(e){for(var t,n=-1,a=d.length;++n<a;)h[(t=d[n]).i]=t.x(e);return h.join("")}}}var tu=tc(function(e){let t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?to:tl(t.a,t.b,t.c,t.d,t.e,t.f)},"px, ","px)","deg)"),th=tc(function(e){return null==e?to:(t||(t=document.createElementNS("http://www.w3.org/2000/svg","g")),t.setAttribute("transform",e),e=t.transform.baseVal.consolidate())?tl((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):to},", ",")",")");function td(e,t,n){var a=e._id;return e.each(function(){var e=tr(this,a);(e.value||(e.value={}))[t]=n.apply(this,arguments)}),function(e){return ti(e,a).value[t]}}function tp(e,t){var n;return("number"==typeof t?eV:t instanceof eb?eL:(n=eb(t))?(t=n,eL):eG)(e,t)}var tf=et.prototype.constructor;function tm(e){return function(){this.style.removeProperty(e)}}var tg=0;function tx(e,t,n,a){this._groups=e,this._parents=t,this._name=n,this._id=a}var ty=et.prototype;tx.prototype=(function(e){return et().transition(e)}).prototype={constructor:tx,select:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=g(e));for(var a=this._groups,r=a.length,i=Array(r),s=0;s<r;++s)for(var o,l,c=a[s],u=c.length,h=i[s]=Array(u),d=0;d<u;++d)(o=c[d])&&(l=e.call(o,o.__data__,d,c))&&("__data__"in o&&(l.__data__=o.__data__),h[d]=l,tn(h[d],t,n,d,h,ti(o,n)));return new tx(i,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=y(e));for(var a=this._groups,r=a.length,i=[],s=[],o=0;o<r;++o)for(var l,c=a[o],u=c.length,h=0;h<u;++h)if(l=c[h]){for(var d,p=e.call(l,l.__data__,h,c),f=ti(l,n),m=0,g=p.length;m<g;++m)(d=p[m])&&tn(d,t,n,m,p,f);i.push(p),s.push(l)}return new tx(i,s,t,n)},selectChild:ty.selectChild,selectChildren:ty.selectChildren,filter:function(e){"function"!=typeof e&&(e=b(e));for(var t=this._groups,n=t.length,a=Array(n),r=0;r<n;++r)for(var i,s=t[r],o=s.length,l=a[r]=[],c=0;c<o;++c)(i=s[c])&&e.call(i,i.__data__,c,s)&&l.push(i);return new tx(a,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw Error();for(var t=this._groups,n=e._groups,a=t.length,r=n.length,i=Math.min(a,r),s=Array(a),o=0;o<i;++o)for(var l,c=t[o],u=n[o],h=c.length,d=s[o]=Array(h),p=0;p<h;++p)(l=c[p]||u[p])&&(d[p]=l);for(;o<a;++o)s[o]=t[o];return new tx(s,this._parents,this._name,this._id)},selection:function(){return new tf(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=++tg,a=this._groups,r=a.length,i=0;i<r;++i)for(var s,o=a[i],l=o.length,c=0;c<l;++c)if(s=o[c]){var u=ti(s,t);tn(s,e,n,c,o,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new tx(a,this._parents,e,n)},call:ty.call,nodes:ty.nodes,node:ty.node,size:ty.size,empty:ty.empty,each:ty.each,on:function(e,t){var n,a,r,i,s,o,l=this._id;return arguments.length<2?ti(this.node(),l).on.on(e):this.each((n=l,a=e,r=t,o=(a+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e})?ta:tr,function(){var e=o(this,n),t=e.on;t!==i&&(s=(i=t).copy()).on(a,r),e.on=s}))},attr:function(e,t){var n=M(e),a="transform"===n?th:tp;return this.attrTween(e,"function"==typeof t?(n.local?function(e,t,n){var a,r,i;return function(){var s,o,l=n(this);return null==l?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local))===(o=l+"")?null:s===a&&o===r?i:(r=o,i=t(a=s,l))}}:function(e,t,n){var a,r,i;return function(){var s,o,l=n(this);return null==l?void this.removeAttribute(e):(s=this.getAttribute(e))===(o=l+"")?null:s===a&&o===r?i:(r=o,i=t(a=s,l))}})(n,a,td(this,"attr."+e,t)):null==t?(n.local?function(e){return function(){this.removeAttributeNS(e.space,e.local)}}:function(e){return function(){this.removeAttribute(e)}})(n):(n.local?function(e,t,n){var a,r,i=n+"";return function(){var s=this.getAttributeNS(e.space,e.local);return s===i?null:s===a?r:r=t(a=s,n)}}:function(e,t,n){var a,r,i=n+"";return function(){var s=this.getAttribute(e);return s===i?null:s===a?r:r=t(a=s,n)}})(n,a,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw Error();var a=M(e);return this.tween(n,(a.local?function(e,t){var n,a;function r(){var r=t.apply(this,arguments);return r!==a&&(n=(a=r)&&function(t){this.setAttributeNS(e.space,e.local,r.call(this,t))}),n}return r._value=t,r}:function(e,t){var n,a;function r(){var r=t.apply(this,arguments);return r!==a&&(n=(a=r)&&function(t){this.setAttribute(e,r.call(this,t))}),n}return r._value=t,r})(a,t))},style:function(e,t,n){var a,r,i,s,o,l,c,u,h,d,p,f,m,g,x,y,b,v,w,N,k,S="transform"==(e+="")?tu:tp;return null==t?this.styleTween(e,(a=e,function(){var e=O(this,a),t=(this.style.removeProperty(a),O(this,a));return e===t?null:e===r&&t===i?s:s=S(r=e,i=t)})).on("end.style."+e,tm(e)):"function"==typeof t?this.styleTween(e,(o=e,l=td(this,"style."+e,t),function(){var e=O(this,o),t=l(this),n=t+"";return null==t&&(this.style.removeProperty(o),n=t=O(this,o)),e===n?null:e===c&&n===u?h:(u=n,h=S(c=e,t))})).each((d=this._id,b="end."+(y="style."+(p=e)),function(){var e=tr(this,d),t=e.on,n=null==e.value[y]?x||(x=tm(p)):void 0;(t!==f||g!==n)&&(m=(f=t).copy()).on(b,g=n),e.on=m})):this.styleTween(e,(v=e,k=t+"",function(){var e=O(this,v);return e===k?null:e===w?N:N=S(w=e,t)}),n).on("end.style."+e,null)},styleTween:function(e,t,n){var a="style."+(e+="");if(arguments.length<2)return(a=this.tween(a))&&a._value;if(null==t)return this.tween(a,null);if("function"!=typeof t)throw Error();return this.tween(a,function(e,t,n){var a,r;function i(){var i=t.apply(this,arguments);return i!==r&&(a=(r=i)&&function(t){this.style.setProperty(e,i.call(this,t),n)}),a}return i._value=t,i}(e,t,null==n?"":n))},text:function(e){var t,n;return this.tween("text","function"==typeof e?(t=td(this,"text",e),function(){var e=t(this);this.textContent=null==e?"":e}):(n=null==e?"":e+"",function(){this.textContent=n}))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!=typeof e)throw Error();return this.tween(t,function(e){var t,n;function a(){var a=e.apply(this,arguments);return a!==n&&(t=(n=a)&&function(e){this.textContent=a.call(this,e)}),t}return a._value=e,a}(e))},remove:function(){var e;return this.on("end.remove",(e=this._id,function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}))},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var a,r=ti(this.node(),n).tween,i=0,s=r.length;i<s;++i)if((a=r[i]).name===e)return a.value;return null}return this.each((null==t?function(e,t){var n,a;return function(){var r=tr(this,e),i=r.tween;if(i!==n){a=n=i;for(var s=0,o=a.length;s<o;++s)if(a[s].name===t){(a=a.slice()).splice(s,1);break}}r.tween=a}}:function(e,t,n){var a,r;if("function"!=typeof n)throw Error();return function(){var i=tr(this,e),s=i.tween;if(s!==a){r=(a=s).slice();for(var o={name:t,value:n},l=0,c=r.length;l<c;++l)if(r[l].name===t){r[l]=o;break}l===c&&r.push(o)}i.tween=r}})(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?function(e,t){return function(){ta(this,e).delay=+t.apply(this,arguments)}}:function(e,t){return t*=1,function(){ta(this,e).delay=t}})(t,e)):ti(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?function(e,t){return function(){tr(this,e).duration=+t.apply(this,arguments)}}:function(e,t){return t*=1,function(){tr(this,e).duration=t}})(t,e)):ti(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(function(e,t){if("function"!=typeof t)throw Error();return function(){tr(this,e).ease=t}}(t,e)):ti(this.node(),t).ease},easeVarying:function(e){var t;if("function"!=typeof e)throw Error();return this.each((t=this._id,function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw Error();tr(this,t).ease=n}))},end:function(){var e,t,n=this,a=n._id,r=n.size();return new Promise(function(i,s){var o={value:s},l={value:function(){0==--r&&i()}};n.each(function(){var n=tr(this,a),r=n.on;r!==e&&((t=(e=r).copy())._.cancel.push(o),t._.interrupt.push(o),t._.end.push(l)),n.on=t}),0===r&&i()})},[Symbol.iterator]:ty[Symbol.iterator]};var tb={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};et.prototype.interrupt=function(e){return this.each(function(){!function(e,t){var n,a,r,i=e.__transition,s=!0;if(i){for(r in t=null==t?null:t+"",i){if((n=i[r]).name!==t){s=!1;continue}a=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(a?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete i[r]}s&&delete e.__transition}}(this,e)})},et.prototype.transition=function(e){var t,n;e instanceof tx?(t=e._id,e=e._name):(t=++tg,(n=tb).time=e2(),e=null==e?null:e+"");for(var a=this._groups,r=a.length,i=0;i<r;++i)for(var s,o=a[i],l=o.length,c=0;c<l;++c)(s=o[c])&&tn(s,e,t,c,o,n||function(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw Error("transition ".concat(t," not found"));return n}(s,t));return new tx(a,this._parents,e,t)};let{abs:tv,max:tw,min:tN}=Math;function tk(e){return{type:e}}function tS(e){return((e=Math.exp(e))+1/e)/2}function tC(e,t,n){this.k=e,this.x=t,this.y=n}["w","e"].map(tk),["n","s"].map(tk),["n","w","e","s","nw","ne","sw","se"].map(tk),!function e(t,n,a){function r(e,r){var i,s,o=e[0],l=e[1],c=e[2],u=r[0],h=r[1],d=r[2],p=u-o,f=h-l,m=p*p+f*f;if(m<1e-12)s=Math.log(d/c)/t,i=function(e){return[o+e*p,l+e*f,c*Math.exp(t*e*s)]};else{var g=Math.sqrt(m),x=(d*d-c*c+a*m)/(2*c*n*g),y=(d*d-c*c-a*m)/(2*d*n*g),b=Math.log(Math.sqrt(x*x+1)-x);s=(Math.log(Math.sqrt(y*y+1)-y)-b)/t,i=function(e){var a,r,i=e*s,u=tS(b),h=c/(n*g)*(u*(((a=Math.exp(2*(a=t*i+b)))-1)/(a+1))-((r=Math.exp(r=b))-1/r)/2);return[o+h*p,l+h*f,c*u/tS(t*i+b)]}}return i.duration=1e3*s*t/Math.SQRT2,i}return r.rho=function(t){var n=Math.max(.001,+t),a=n*n;return e(n,a,a*a)},r}(Math.SQRT2,2,4),tC.prototype={constructor:tC,scale:function(e){return 1===e?this:new tC(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new tC(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};new tC(1,0,0);tC.prototype;let tT=new Date,tI=new Date;function tE(e,t,n,a){function r(t){return e(t=0==arguments.length?new Date:new Date(+t)),t}return r.floor=t=>(e(t=new Date(+t)),t),r.ceil=n=>(e(n=new Date(n-1)),t(n,1),e(n),n),r.round=e=>{let t=r(e),n=r.ceil(e);return e-t<n-e?t:n},r.offset=(e,n)=>(t(e=new Date(+e),null==n?1:Math.floor(n)),e),r.range=(n,a,i)=>{let s,o=[];if(n=r.ceil(n),i=null==i?1:Math.floor(i),!(n<a)||!(i>0))return o;do o.push(s=new Date(+n)),t(n,i),e(n);while(s<n&&n<a)return o},r.filter=n=>tE(t=>{if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)},(e,a)=>{if(e>=e)if(a<0)for(;++a<=0;)for(;t(e,-1),!n(e););else for(;--a>=0;)for(;t(e,1),!n(e););}),n&&(r.count=(t,a)=>(tT.setTime(+t),tI.setTime(+a),e(tT),e(tI),Math.floor(n(tT,tI))),r.every=e=>isFinite(e=Math.floor(e))&&e>0?e>1?r.filter(a?t=>a(t)%e==0:t=>r.count(0,t)%e==0):r:null),r}let t_=tE(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());t_.every=e=>isFinite(e=Math.floor(e))&&e>0?tE(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)}):null,t_.range;let tA=tE(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());tA.every=e=>isFinite(e=Math.floor(e))&&e>0?tE(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)}):null,tA.range;let tR=tE(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());tR.range;let tD=tE(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());tD.range;function tM(e){return tE(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(e,t)=>{e.setDate(e.getDate()+7*t)},(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*6e4)/6048e5)}let tF=tM(0),tO=tM(1),tP=tM(2),tj=tM(3),tL=tM(4),tz=tM(5),tB=tM(6);function tV(e){return tE(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+7*t)},(e,t)=>(t-e)/6048e5)}tF.range,tO.range,tP.range,tj.range,tL.range,tz.range,tB.range;let tU=tV(0),tW=tV(1),tG=tV(2),tH=tV(3),tq=tV(4),tK=tV(5),tX=tV(6);tU.range,tW.range,tG.range,tH.range,tq.range,tK.range,tX.range;let tY=tE(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*6e4)/864e5,e=>e.getDate()-1);tY.range;let tZ=tE(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/864e5,e=>e.getUTCDate()-1);tZ.range;let tQ=tE(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/864e5,e=>Math.floor(e/864e5));tQ.range;let tJ=tE(e=>{e.setTime(e-e.getMilliseconds()-1e3*e.getSeconds()-6e4*e.getMinutes())},(e,t)=>{e.setTime(+e+36e5*t)},(e,t)=>(t-e)/36e5,e=>e.getHours());tJ.range;let t$=tE(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+36e5*t)},(e,t)=>(t-e)/36e5,e=>e.getUTCHours());t$.range;let t0=tE(e=>{e.setTime(e-e.getMilliseconds()-1e3*e.getSeconds())},(e,t)=>{e.setTime(+e+6e4*t)},(e,t)=>(t-e)/6e4,e=>e.getMinutes());t0.range;let t1=tE(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+6e4*t)},(e,t)=>(t-e)/6e4,e=>e.getUTCMinutes());t1.range;let t2=tE(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+1e3*t)},(e,t)=>(t-e)/1e3,e=>e.getUTCSeconds());function t3(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function t4(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function t5(e){let t,n,a;function r(e,a){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(r<i){if(0!==t(a,a))return i;do{let t=r+i>>>1;0>n(e[t],a)?r=t+1:i=t}while(r<i)}return r}return 2!==e.length?(t=t3,n=(t,n)=>t3(e(t),n),a=(t,n)=>e(t)-n):(t=e===t3||e===t4?e:t6,n=e,a=e),{left:r,center:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length,s=r(e,t,n,i-1);return s>n&&a(e[s-1],t)>-a(e[s],t)?s-1:s},right:function(e,a){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(r<i){if(0!==t(a,a))return i;do{let t=r+i>>>1;0>=n(e[t],a)?r=t+1:i=t}while(r<i)}return r}}}function t6(){return 0}t2.range;let t8=Math.sqrt(50),t9=Math.sqrt(10),t7=Math.sqrt(2);function ne(e,t,n){let a,r,i,s=(t-e)/Math.max(0,n),o=Math.floor(Math.log10(s)),l=s/Math.pow(10,o),c=l>=t8?10:l>=t9?5:l>=t7?2:1;return(o<0?(a=Math.round(e*(i=Math.pow(10,-o)/c)),r=Math.round(t*i),a/i<e&&++a,r/i>t&&--r,i=-i):(a=Math.round(e/(i=Math.pow(10,o)*c)),r=Math.round(t/i),a*i<e&&++a,r*i>t&&--r),r<a&&.5<=n&&n<2)?ne(e,t,2*n):[a,r,i]}function nt(e,t,n){return ne(e*=1,t*=1,n*=1)[2]}function nn(e,t,n){t*=1,e*=1,n*=1;let a=t<e,r=a?nt(t,e,n):nt(e,t,n);return(a?-1:1)*(r<0?-(1/r):r)}let na=tE(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);function nr(e,t,n,a,r,i){let s=[[t2,1,1e3],[t2,5,5e3],[t2,15,15e3],[t2,30,3e4],[i,1,6e4],[i,5,3e5],[i,15,9e5],[i,30,18e5],[r,1,36e5],[r,3,108e5],[r,6,216e5],[r,12,432e5],[a,1,864e5],[a,2,1728e5],[n,1,6048e5],[t,1,2592e6],[t,3,7776e6],[e,1,31536e6]];function o(t,n,a){let r=Math.abs(n-t)/a,i=t5(e=>{let[,,t]=e;return t}).right(s,r);if(i===s.length)return e.every(nn(t/31536e6,n/31536e6,a));if(0===i)return na.every(Math.max(nn(t,n,a),1));let[o,l]=s[r/s[i-1][2]<s[i][2]/r?i-1:i];return o.every(l)}return[function(e,t,n){let a=t<e;a&&([e,t]=[t,e]);let r=n&&"function"==typeof n.range?n:o(e,t,n),i=r?r.range(e,+t+1):[];return a?i.reverse():i},o]}na.every=e=>isFinite(e=Math.floor(e))&&e>0?e>1?tE(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):na:null,na.range;let[ni,ns]=nr(tA,tD,tU,tQ,t$,t1),[no,nl]=nr(t_,tR,tF,tY,tJ,t0);function nc(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function nu(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function nh(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}var nd={"-":"",_:" ",0:"0"},np=/^\s*\d+/,nf=/^%/,nm=/[\\^$*+?|[\]().{}]/g;function ng(e,t,n){var a=e<0?"-":"",r=(a?-e:e)+"",i=r.length;return a+(i<n?Array(n-i+1).join(t)+r:r)}function nx(e){return e.replace(nm,"\\$&")}function ny(e){return RegExp("^(?:"+e.map(nx).join("|")+")","i")}function nb(e){return new Map(e.map((e,t)=>[e.toLowerCase(),t]))}function nv(e,t,n){var a=np.exec(t.slice(n,n+1));return a?(e.w=+a[0],n+a[0].length):-1}function nw(e,t,n){var a=np.exec(t.slice(n,n+1));return a?(e.u=+a[0],n+a[0].length):-1}function nN(e,t,n){var a=np.exec(t.slice(n,n+2));return a?(e.U=+a[0],n+a[0].length):-1}function nk(e,t,n){var a=np.exec(t.slice(n,n+2));return a?(e.V=+a[0],n+a[0].length):-1}function nS(e,t,n){var a=np.exec(t.slice(n,n+2));return a?(e.W=+a[0],n+a[0].length):-1}function nC(e,t,n){var a=np.exec(t.slice(n,n+4));return a?(e.y=+a[0],n+a[0].length):-1}function nT(e,t,n){var a=np.exec(t.slice(n,n+2));return a?(e.y=+a[0]+(+a[0]>68?1900:2e3),n+a[0].length):-1}function nI(e,t,n){var a=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return a?(e.Z=a[1]?0:-(a[2]+(a[3]||"00")),n+a[0].length):-1}function nE(e,t,n){var a=np.exec(t.slice(n,n+1));return a?(e.q=3*a[0]-3,n+a[0].length):-1}function n_(e,t,n){var a=np.exec(t.slice(n,n+2));return a?(e.m=a[0]-1,n+a[0].length):-1}function nA(e,t,n){var a=np.exec(t.slice(n,n+2));return a?(e.d=+a[0],n+a[0].length):-1}function nR(e,t,n){var a=np.exec(t.slice(n,n+3));return a?(e.m=0,e.d=+a[0],n+a[0].length):-1}function nD(e,t,n){var a=np.exec(t.slice(n,n+2));return a?(e.H=+a[0],n+a[0].length):-1}function nM(e,t,n){var a=np.exec(t.slice(n,n+2));return a?(e.M=+a[0],n+a[0].length):-1}function nF(e,t,n){var a=np.exec(t.slice(n,n+2));return a?(e.S=+a[0],n+a[0].length):-1}function nO(e,t,n){var a=np.exec(t.slice(n,n+3));return a?(e.L=+a[0],n+a[0].length):-1}function nP(e,t,n){var a=np.exec(t.slice(n,n+6));return a?(e.L=Math.floor(a[0]/1e3),n+a[0].length):-1}function nj(e,t,n){var a=nf.exec(t.slice(n,n+1));return a?n+a[0].length:-1}function nL(e,t,n){var a=np.exec(t.slice(n));return a?(e.Q=+a[0],n+a[0].length):-1}function nz(e,t,n){var a=np.exec(t.slice(n));return a?(e.s=+a[0],n+a[0].length):-1}function nB(e,t){return ng(e.getDate(),t,2)}function nV(e,t){return ng(e.getHours(),t,2)}function nU(e,t){return ng(e.getHours()%12||12,t,2)}function nW(e,t){return ng(1+tY.count(t_(e),e),t,3)}function nG(e,t){return ng(e.getMilliseconds(),t,3)}function nH(e,t){return nG(e,t)+"000"}function nq(e,t){return ng(e.getMonth()+1,t,2)}function nK(e,t){return ng(e.getMinutes(),t,2)}function nX(e,t){return ng(e.getSeconds(),t,2)}function nY(e){var t=e.getDay();return 0===t?7:t}function nZ(e,t){return ng(tF.count(t_(e)-1,e),t,2)}function nQ(e){var t=e.getDay();return t>=4||0===t?tL(e):tL.ceil(e)}function nJ(e,t){return e=nQ(e),ng(tL.count(t_(e),e)+(4===t_(e).getDay()),t,2)}function n$(e){return e.getDay()}function n0(e,t){return ng(tO.count(t_(e)-1,e),t,2)}function n1(e,t){return ng(e.getFullYear()%100,t,2)}function n2(e,t){return ng((e=nQ(e)).getFullYear()%100,t,2)}function n3(e,t){return ng(e.getFullYear()%1e4,t,4)}function n4(e,t){var n=e.getDay();return ng((e=n>=4||0===n?tL(e):tL.ceil(e)).getFullYear()%1e4,t,4)}function n5(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+ng(t/60|0,"0",2)+ng(t%60,"0",2)}function n6(e,t){return ng(e.getUTCDate(),t,2)}function n8(e,t){return ng(e.getUTCHours(),t,2)}function n9(e,t){return ng(e.getUTCHours()%12||12,t,2)}function n7(e,t){return ng(1+tZ.count(tA(e),e),t,3)}function ae(e,t){return ng(e.getUTCMilliseconds(),t,3)}function at(e,t){return ae(e,t)+"000"}function an(e,t){return ng(e.getUTCMonth()+1,t,2)}function aa(e,t){return ng(e.getUTCMinutes(),t,2)}function ar(e,t){return ng(e.getUTCSeconds(),t,2)}function ai(e){var t=e.getUTCDay();return 0===t?7:t}function as(e,t){return ng(tU.count(tA(e)-1,e),t,2)}function ao(e){var t=e.getUTCDay();return t>=4||0===t?tq(e):tq.ceil(e)}function al(e,t){return e=ao(e),ng(tq.count(tA(e),e)+(4===tA(e).getUTCDay()),t,2)}function ac(e){return e.getUTCDay()}function au(e,t){return ng(tW.count(tA(e)-1,e),t,2)}function ah(e,t){return ng(e.getUTCFullYear()%100,t,2)}function ad(e,t){return ng((e=ao(e)).getUTCFullYear()%100,t,2)}function ap(e,t){return ng(e.getUTCFullYear()%1e4,t,4)}function af(e,t){var n=e.getUTCDay();return ng((e=n>=4||0===n?tq(e):tq.ceil(e)).getUTCFullYear()%1e4,t,4)}function am(){return"+0000"}function ag(){return"%"}function ax(e){return+e}function ay(e){return Math.floor(e/1e3)}a=(n=function(e){var t=e.dateTime,n=e.date,a=e.time,r=e.periods,i=e.days,s=e.shortDays,o=e.months,l=e.shortMonths,c=ny(r),u=nb(r),h=ny(i),d=nb(i),p=ny(s),f=nb(s),m=ny(o),g=nb(o),x=ny(l),y=nb(l),b={a:function(e){return s[e.getDay()]},A:function(e){return i[e.getDay()]},b:function(e){return l[e.getMonth()]},B:function(e){return o[e.getMonth()]},c:null,d:nB,e:nB,f:nH,g:n2,G:n4,H:nV,I:nU,j:nW,L:nG,m:nq,M:nK,p:function(e){return r[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:ax,s:ay,S:nX,u:nY,U:nZ,V:nJ,w:n$,W:n0,x:null,X:null,y:n1,Y:n3,Z:n5,"%":ag},v={a:function(e){return s[e.getUTCDay()]},A:function(e){return i[e.getUTCDay()]},b:function(e){return l[e.getUTCMonth()]},B:function(e){return o[e.getUTCMonth()]},c:null,d:n6,e:n6,f:at,g:ad,G:af,H:n8,I:n9,j:n7,L:ae,m:an,M:aa,p:function(e){return r[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:ax,s:ay,S:ar,u:ai,U:as,V:al,w:ac,W:au,x:null,X:null,y:ah,Y:ap,Z:am,"%":ag},w={a:function(e,t,n){var a=p.exec(t.slice(n));return a?(e.w=f.get(a[0].toLowerCase()),n+a[0].length):-1},A:function(e,t,n){var a=h.exec(t.slice(n));return a?(e.w=d.get(a[0].toLowerCase()),n+a[0].length):-1},b:function(e,t,n){var a=x.exec(t.slice(n));return a?(e.m=y.get(a[0].toLowerCase()),n+a[0].length):-1},B:function(e,t,n){var a=m.exec(t.slice(n));return a?(e.m=g.get(a[0].toLowerCase()),n+a[0].length):-1},c:function(e,n,a){return S(e,t,n,a)},d:nA,e:nA,f:nP,g:nT,G:nC,H:nD,I:nD,j:nR,L:nO,m:n_,M:nM,p:function(e,t,n){var a=c.exec(t.slice(n));return a?(e.p=u.get(a[0].toLowerCase()),n+a[0].length):-1},q:nE,Q:nL,s:nz,S:nF,u:nw,U:nN,V:nk,w:nv,W:nS,x:function(e,t,a){return S(e,n,t,a)},X:function(e,t,n){return S(e,a,t,n)},y:nT,Y:nC,Z:nI,"%":nj};function N(e,t){return function(n){var a,r,i,s=[],o=-1,l=0,c=e.length;for(n instanceof Date||(n=new Date(+n));++o<c;)37===e.charCodeAt(o)&&(s.push(e.slice(l,o)),null!=(r=nd[a=e.charAt(++o)])?a=e.charAt(++o):r="e"===a?" ":"0",(i=t[a])&&(a=i(n,r)),s.push(a),l=o+1);return s.push(e.slice(l,o)),s.join("")}}function k(e,t){return function(n){var a,r,i=nh(1900,void 0,1);if(S(i,e,n+="",0)!=n.length)return null;if("Q"in i)return new Date(i.Q);if("s"in i)return new Date(1e3*i.s+("L"in i?i.L:0));if(!t||"Z"in i||(i.Z=0),"p"in i&&(i.H=i.H%12+12*i.p),void 0===i.m&&(i.m="q"in i?i.q:0),"V"in i){if(i.V<1||i.V>53)return null;"w"in i||(i.w=1),"Z"in i?(a=(r=(a=nu(nh(i.y,0,1))).getUTCDay())>4||0===r?tW.ceil(a):tW(a),a=tZ.offset(a,(i.V-1)*7),i.y=a.getUTCFullYear(),i.m=a.getUTCMonth(),i.d=a.getUTCDate()+(i.w+6)%7):(a=(r=(a=nc(nh(i.y,0,1))).getDay())>4||0===r?tO.ceil(a):tO(a),a=tY.offset(a,(i.V-1)*7),i.y=a.getFullYear(),i.m=a.getMonth(),i.d=a.getDate()+(i.w+6)%7)}else("W"in i||"U"in i)&&("w"in i||(i.w="u"in i?i.u%7:+("W"in i)),r="Z"in i?nu(nh(i.y,0,1)).getUTCDay():nc(nh(i.y,0,1)).getDay(),i.m=0,i.d="W"in i?(i.w+6)%7+7*i.W-(r+5)%7:i.w+7*i.U-(r+6)%7);return"Z"in i?(i.H+=i.Z/100|0,i.M+=i.Z%100,nu(i)):nc(i)}}function S(e,t,n,a){for(var r,i,s=0,o=t.length,l=n.length;s<o;){if(a>=l)return -1;if(37===(r=t.charCodeAt(s++))){if(!(i=w[(r=t.charAt(s++))in nd?t.charAt(s++):r])||(a=i(e,n,a))<0)return -1}else if(r!=n.charCodeAt(a++))return -1}return a}return b.x=N(n,b),b.X=N(a,b),b.c=N(t,b),v.x=N(n,v),v.X=N(a,v),v.c=N(t,v),{format:function(e){var t=N(e+="",b);return t.toString=function(){return e},t},parse:function(e){var t=k(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=N(e+="",v);return t.toString=function(){return e},t},utcParse:function(e){var t=k(e+="",!0);return t.toString=function(){return e},t}}}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]})).format,n.parse,n.utcFormat,n.utcParse;let ab=t5(t3),av=ab.right;function aw(e,t){return e*=1,t*=1,function(n){return Math.round(e*(1-n)+t*n)}}function aN(e){return+e}ab.left,t5(function(e){return null===e?NaN:+e}).center;var ak=[0,1];function aS(e){return e}function aC(e,t){var n;return(t-=e*=1)?function(n){return(n-e)/t}:(n=isNaN(t)?NaN:.5,function(){return n})}function aT(e,t,n){var a=e[0],r=e[1],i=t[0],s=t[1];return r<a?(a=aC(r,a),i=n(s,i)):(a=aC(a,r),i=n(i,s)),function(e){return i(a(e))}}function aI(e,t,n){var a=Math.min(e.length,t.length)-1,r=Array(a),i=Array(a),s=-1;for(e[a]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<a;)r[s]=aC(e[s],e[s+1]),i[s]=n(t[s],t[s+1]);return function(t){var n=av(e,t,1,a)-1;return i[n](r[n](t))}}function aE(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function a_(){return(function(){var e,t,n,a,r,i,s=ak,o=ak,l=eH,c=aS;function u(){var e,t,n,l=Math.min(s.length,o.length);return c!==aS&&(e=s[0],t=s[l-1],e>t&&(n=e,e=t,t=n),c=function(n){return Math.max(e,Math.min(t,n))}),a=l>2?aI:aT,r=i=null,h}function h(t){return null==t||isNaN(t*=1)?n:(r||(r=a(s.map(e),o,l)))(e(c(t)))}return h.invert=function(n){return c(t((i||(i=a(o,s.map(e),eV)))(n)))},h.domain=function(e){return arguments.length?(s=Array.from(e,aN),u()):s.slice()},h.range=function(e){return arguments.length?(o=Array.from(e),u()):o.slice()},h.rangeRound=function(e){return o=Array.from(e),l=aw,u()},h.clamp=function(e){return arguments.length?(c=!!e||aS,u()):c!==aS},h.interpolate=function(e){return arguments.length?(l=e,u()):l},h.unknown=function(e){return arguments.length?(n=e,h):n},function(n,a){return e=n,t=a,u()}})()(aS,aS)}function aA(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function aR(e,t){switch(arguments.length){case 0:break;case 1:"function"==typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"==typeof t?this.interpolator(t):this.range(t)}return this}function aD(e){return new Date(e)}function aM(e){return e instanceof Date?+e:+new Date(+e)}function aF(e,t){let n,a;if(void 0===t)for(let t of e)null!=t&&(void 0===n?t>=t&&(n=a=t):(n>t&&(n=t),a<t&&(a=t)));else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(void 0===n?i>=i&&(n=a=i):(n>i&&(n=i),a<i&&(a=i)))}return[n,a]}function aO(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,a=e.slice(0,n);return[a.length>1?a[0]+a.slice(2):a,+e.slice(n+1)]}function aP(e){return(e=aO(Math.abs(e)))?e[1]:NaN}var aj=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function aL(e){var t;if(!(t=aj.exec(e)))throw Error("invalid format: "+e);return new az({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function az(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function aB(e,t){var n=aO(e,t);if(!n)return e+"";var a=n[0],r=n[1];return r<0?"0."+Array(-r).join("0")+a:a.length>r+1?a.slice(0,r+1)+"."+a.slice(r+1):a+Array(r-a.length+2).join("0")}aL.prototype=az.prototype,az.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};let aV={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>aB(100*e,t),r:aB,s:function(e,t){var n=aO(e,t);if(!n)return e+"";var a=n[0],i=n[1],s=i-(r=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=a.length;return s===o?a:s>o?a+Array(s-o+1).join("0"):s>0?a.slice(0,s)+"."+a.slice(s):"0."+Array(1-s).join("0")+aO(e,Math.max(0,t+s-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function aU(e){return e}var aW=Array.prototype.map,aG=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function aH(e){var t=e.domain;return e.ticks=function(e){var n=t();return function(e,t,n){if(t*=1,e*=1,!((n*=1)>0))return[];if(e===t)return[e];let a=t<e,[r,i,s]=a?ne(t,e,n):ne(e,t,n);if(!(i>=r))return[];let o=i-r+1,l=Array(o);if(a)if(s<0)for(let e=0;e<o;++e)l[e]=-((i-e)/s);else for(let e=0;e<o;++e)l[e]=(i-e)*s;else if(s<0)for(let e=0;e<o;++e)l[e]=-((r+e)/s);else for(let e=0;e<o;++e)l[e]=(r+e)*s;return l}(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var a=t();return function(e,t,n,a){var r,i,l=nn(e,t,n);switch((a=aL(null==a?",f":a)).type){case"s":var c=Math.max(Math.abs(e),Math.abs(t));return null!=a.precision||isNaN(i=Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(aP(c)/3)))-aP(Math.abs(l))))||(a.precision=i),o(a,c);case"":case"e":case"g":case"p":case"r":null!=a.precision||isNaN(i=Math.max(0,aP(Math.abs(Math.max(Math.abs(e),Math.abs(t)))-(r=Math.abs(r=l)))-aP(r))+1)||(a.precision=i-("e"===a.type));break;case"f":case"%":null!=a.precision||isNaN(i=Math.max(0,-aP(Math.abs(l))))||(a.precision=i-("%"===a.type)*2)}return s(a)}(a[0],a[a.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var a,r,i=t(),s=0,o=i.length-1,l=i[s],c=i[o],u=10;for(c<l&&(r=l,l=c,c=r,r=s,s=o,o=r);u-- >0;){if((r=nt(l,c,n))===a)return i[s]=l,i[o]=c,t(i);if(r>0)l=Math.floor(l/r)*r,c=Math.ceil(c/r)*r;else if(r<0)l=Math.ceil(l*r)/r,c=Math.floor(c*r)/r;else break;a=r}return e},e}function aq(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function aK(e){return function(){return e}}function aX(e){this._context=e}function aY(e){return new aX(e)}function aZ(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function aQ(){let e=aZ(["M",",",""]);return aQ=function(){return e},e}function aJ(){let e=aZ(["Z"]);return aJ=function(){return e},e}function a$(){let e=aZ(["L",",",""]);return a$=function(){return e},e}function a0(){let e=aZ(["Q",",",",",",",""]);return a0=function(){return e},e}function a1(){let e=aZ(["C",",",",",",",",",",",""]);return a1=function(){return e},e}function a2(){let e=aZ(["M",",",""]);return a2=function(){return e},e}function a3(){let e=aZ(["L",",",""]);return a3=function(){return e},e}function a4(){let e=aZ(["L",",",""]);return a4=function(){return e},e}function a5(){let e=aZ(["A",",",",0,0,",",",",",""]);return a5=function(){return e},e}function a6(){let e=aZ(["M",",",""]);return a6=function(){return e},e}function a8(){let e=aZ(["L",",",""]);return a8=function(){return e},e}function a9(){let e=aZ(["A",",",",0,1,",",",",","A",",",",0,1,",",",",",""]);return a9=function(){return e},e}function a7(){let e=aZ(["A",",",",0,",",",",",",",""]);return a7=function(){return e},e}function re(){let e=aZ(["M",",","h","v","h","Z"]);return re=function(){return e},e}s=(i=function(e){var t,n,a,i=void 0===e.grouping||void 0===e.thousands?aU:(t=aW.call(e.grouping,Number),n=e.thousands+"",function(e,a){for(var r=e.length,i=[],s=0,o=t[0],l=0;r>0&&o>0&&(l+o+1>a&&(o=Math.max(1,a-l)),i.push(e.substring(r-=o,r+o)),!((l+=o+1)>a));)o=t[s=(s+1)%t.length];return i.reverse().join(n)}),s=void 0===e.currency?"":e.currency[0]+"",o=void 0===e.currency?"":e.currency[1]+"",l=void 0===e.decimal?".":e.decimal+"",c=void 0===e.numerals?aU:(a=aW.call(e.numerals,String),function(e){return e.replace(/[0-9]/g,function(e){return a[+e]})}),u=void 0===e.percent?"%":e.percent+"",h=void 0===e.minus?"":e.minus+"",d=void 0===e.nan?"NaN":e.nan+"";function p(e){var t=(e=aL(e)).fill,n=e.align,a=e.sign,p=e.symbol,f=e.zero,m=e.width,g=e.comma,x=e.precision,y=e.trim,b=e.type;"n"===b?(g=!0,b="g"):aV[b]||(void 0===x&&(x=12),y=!0,b="g"),(f||"0"===t&&"="===n)&&(f=!0,t="0",n="=");var v="$"===p?s:"#"===p&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",w="$"===p?o:/[%p]/.test(b)?u:"",N=aV[b],k=/[defgprs%]/.test(b);function S(e){var s,o,u,p=v,S=w;if("c"===b)S=N(e)+S,e="";else{var C=(e*=1)<0||1/e<0;if(e=isNaN(e)?d:N(Math.abs(e),x),y&&(e=function(e){e:for(var t,n=e.length,a=1,r=-1;a<n;++a)switch(e[a]){case".":r=t=a;break;case"0":0===r&&(r=a),t=a;break;default:if(!+e[a])break e;r>0&&(r=0)}return r>0?e.slice(0,r)+e.slice(t+1):e}(e)),C&&0==+e&&"+"!==a&&(C=!1),p=(C?"("===a?a:h:"-"===a||"("===a?"":a)+p,S=("s"===b?aG[8+r/3]:"")+S+(C&&"("===a?")":""),k){for(s=-1,o=e.length;++s<o;)if(48>(u=e.charCodeAt(s))||u>57){S=(46===u?l+e.slice(s+1):e.slice(s))+S,e=e.slice(0,s);break}}}g&&!f&&(e=i(e,1/0));var T=p.length+e.length+S.length,I=T<m?Array(m-T+1).join(t):"";switch(g&&f&&(e=i(I+e,I.length?m-S.length:1/0),I=""),n){case"<":e=p+e+S+I;break;case"=":e=p+I+e+S;break;case"^":e=I.slice(0,T=I.length>>1)+p+e+S+I.slice(T);break;default:e=I+p+e+S}return c(e)}return x=void 0===x?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,x)):Math.max(0,Math.min(20,x)),S.toString=function(){return e+""},S}return{format:p,formatPrefix:function(e,t){var n=p(((e=aL(e)).type="f",e)),a=3*Math.max(-8,Math.min(8,Math.floor(aP(t)/3))),r=Math.pow(10,-a),i=aG[8+a/3];return function(e){return n(r*e)+i}}}}({thousands:",",grouping:[3],currency:["$",""]})).format,o=i.formatPrefix,Array.prototype.slice,aX.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e*=1,t*=1,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}};let rt=Math.PI,rn=2*rt,ra=rn-1e-6;function rr(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}class ri{moveTo(e,t){this._append(aQ(),this._x0=this._x1=+e,this._y0=this._y1=+t)}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append(aJ()))}lineTo(e,t){this._append(a$(),this._x1=+e,this._y1=+t)}quadraticCurveTo(e,t,n,a){this._append(a0(),+e,+t,this._x1=+n,this._y1=+a)}bezierCurveTo(e,t,n,a,r,i){this._append(a1(),+e,+t,+n,+a,this._x1=+r,this._y1=+i)}arcTo(e,t,n,a,r){if(e*=1,t*=1,n*=1,a*=1,(r*=1)<0)throw Error("negative radius: ".concat(r));let i=this._x1,s=this._y1,o=n-e,l=a-t,c=i-e,u=s-t,h=c*c+u*u;if(null===this._x1)this._append(a2(),this._x1=e,this._y1=t);else if(h>1e-6)if(Math.abs(u*o-l*c)>1e-6&&r){let d=n-i,p=a-s,f=o*o+l*l,m=Math.sqrt(f),g=Math.sqrt(h),x=r*Math.tan((rt-Math.acos((f+h-(d*d+p*p))/(2*m*g)))/2),y=x/g,b=x/m;Math.abs(y-1)>1e-6&&this._append(a4(),e+y*c,t+y*u),this._append(a5(),r,r,+(u*d>c*p),this._x1=e+b*o,this._y1=t+b*l)}else this._append(a3(),this._x1=e,this._y1=t)}arc(e,t,n,a,r,i){if(e*=1,t*=1,n*=1,i=!!i,n<0)throw Error("negative radius: ".concat(n));let s=n*Math.cos(a),o=n*Math.sin(a),l=e+s,c=t+o,u=1^i,h=i?a-r:r-a;null===this._x1?this._append(a6(),l,c):(Math.abs(this._x1-l)>1e-6||Math.abs(this._y1-c)>1e-6)&&this._append(a8(),l,c),n&&(h<0&&(h=h%rn+rn),h>ra?this._append(a9(),n,n,u,e-s,t-o,n,n,u,this._x1=l,this._y1=c):h>1e-6&&this._append(a7(),n,n,+(h>=rt),u,this._x1=e+n*Math.cos(r),this._y1=t+n*Math.sin(r)))}rect(e,t,n,a){this._append(re(),this._x0=this._x1=+e,this._y0=this._y1=+t,n*=1,+a,-n)}toString(){return this._}constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?rr:function(e){let t=Math.floor(e);if(!(t>=0))throw Error("invalid digits: ".concat(e));if(t>15)return rr;let n=10**t;return function(e){this._+=e[0];for(let t=1,a=e.length;t<a;++t)this._+=Math.round(arguments[t]*n)/n+e[t]}}(e)}}function rs(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(null==n)t=null;else{let e=Math.floor(n);if(!(e>=0))throw RangeError("invalid digits: ".concat(n));t=e}return e},()=>new ri(t)}function ro(e){return e[0]}function rl(e){return e[1]}function rc(e,t){var n=aK(!0),a=null,r=aY,i=null,s=rs(o);function o(o){var l,c,u,h=(o=aq(o)).length,d=!1;for(null==a&&(i=r(u=s())),l=0;l<=h;++l)!(l<h&&n(c=o[l],l,o))===d&&((d=!d)?i.lineStart():i.lineEnd()),d&&i.point(+e(c,l,o),+t(c,l,o));if(u)return i=null,u+""||null}return e="function"==typeof e?e:void 0===e?ro:aK(e),t="function"==typeof t?t:void 0===t?rl:aK(t),o.x=function(t){return arguments.length?(e="function"==typeof t?t:aK(+t),o):e},o.y=function(e){return arguments.length?(t="function"==typeof e?e:aK(+e),o):t},o.defined=function(e){return arguments.length?(n="function"==typeof e?e:aK(!!e),o):n},o.curve=function(e){return arguments.length?(r=e,null!=a&&(i=r(a)),o):r},o.context=function(e){return arguments.length?(null==e?a=i=null:i=r(a=e),o):a},o}function ru(e,t,n){var a=e._x1-e._x0,r=t-e._x1,i=(e._y1-e._y0)/(a||r<0&&-0),s=(n-e._y1)/(r||a<0&&-0);return((i<0?-1:1)+(s<0?-1:1))*Math.min(Math.abs(i),Math.abs(s),.5*Math.abs((i*r+s*a)/(a+r)))||0}function rh(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function rd(e,t,n){var a=e._x0,r=e._y0,i=e._x1,s=e._y1,o=(i-a)/3;e._context.bezierCurveTo(a+o,r+o*t,i-o,s-o*n,i,s)}function rp(e){this._context=e}function rf(e){this._context=e}function rm(e){return new rp(e)}function rg(e){return e}function rx(e){return"translate("+e+",0)"}function ry(e){return"translate(0,"+e+")"}function rb(){return!this.__axis}function rv(e,t){var n=[],a=null,r=null,i=6,s=6,o=3,l="undefined"!=typeof window&&window.devicePixelRatio>1?0:.5,c=1===e||4===e?-1:1,u=4===e||2===e?"x":"y",h=1===e||3===e?rx:ry;function d(d){var p=null==a?t.ticks?t.ticks.apply(t,n):t.domain():a,f=null==r?t.tickFormat?t.tickFormat.apply(t,n):rg:r,m=Math.max(i,0)+o,g=t.range(),x=+g[0]+l,y=+g[g.length-1]+l,b=(t.bandwidth?function(e,t){return t=Math.max(0,e.bandwidth()-2*t)/2,e.round()&&(t=Math.round(t)),n=>+e(n)+t}:function(e){return t=>+e(t)})(t.copy(),l),v=d.selection?d.selection():d,w=v.selectAll(".domain").data([null]),N=v.selectAll(".tick").data(p,t).order(),k=N.exit(),S=N.enter().append("g").attr("class","tick"),C=N.select("line"),T=N.select("text");w=w.merge(w.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),N=N.merge(S),C=C.merge(S.append("line").attr("stroke","currentColor").attr(u+"2",c*i)),T=T.merge(S.append("text").attr("fill","currentColor").attr(u,c*m).attr("dy",1===e?"0em":3===e?"0.71em":"0.32em")),d!==v&&(w=w.transition(d),N=N.transition(d),C=C.transition(d),T=T.transition(d),k=k.transition(d).attr("opacity",1e-6).attr("transform",function(e){return isFinite(e=b(e))?h(e+l):this.getAttribute("transform")}),S.attr("opacity",1e-6).attr("transform",function(e){var t=this.parentNode.__axis;return h((t&&isFinite(t=t(e))?t:b(e))+l)})),k.remove(),w.attr("d",4===e||2===e?s?"M"+c*s+","+x+"H"+l+"V"+y+"H"+c*s:"M"+l+","+x+"V"+y:s?"M"+x+","+c*s+"V"+l+"H"+y+"V"+c*s:"M"+x+","+l+"H"+y),N.attr("opacity",1).attr("transform",function(e){return h(b(e)+l)}),C.attr(u+"2",c*i),T.attr(u,c*m).text(f),v.filter(rb).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===e?"start":4===e?"end":"middle"),v.each(function(){this.__axis=b})}return d.scale=function(e){return arguments.length?(t=e,d):t},d.ticks=function(){return n=Array.from(arguments),d},d.tickArguments=function(e){return arguments.length?(n=null==e?[]:Array.from(e),d):n.slice()},d.tickValues=function(e){return arguments.length?(a=null==e?null:Array.from(e),d):a&&a.slice()},d.tickFormat=function(e){return arguments.length?(r=e,d):r},d.tickSize=function(e){return arguments.length?(i=s=+e,d):i},d.tickSizeInner=function(e){return arguments.length?(i=+e,d):i},d.tickSizeOuter=function(e){return arguments.length?(s=+e,d):s},d.tickPadding=function(e){return arguments.length?(o=+e,d):o},d.offset=function(e){return arguments.length?(l=+e,d):l},d}ri.prototype,rp.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:rd(this,this._t0,rh(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t*=1,(e*=1)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,rd(this,rh(this,n=ru(this,e,t)),n);break;default:rd(this,this._t0,n=ru(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},((function(e){this._context=new rf(e)}).prototype=Object.create(rp.prototype)).point=function(e,t){rp.prototype.point.call(this,t,e)},rf.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,a,r,i){this._context.bezierCurveTo(t,e,a,n,i,r)}};let rw=Math.abs,rN=Math.atan2,rk=Math.cos,rS=Math.max,rC=Math.min,rT=Math.sin,rI=Math.sqrt,rE=Math.PI,r_=rE/2,rA=2*rE;function rR(e){return e>=1?r_:e<=-1?-r_:Math.asin(e)}function rD(e){return e.innerRadius}function rM(e){return e.outerRadius}function rF(e){return e.startAngle}function rO(e){return e.endAngle}function rP(e){return e&&e.padAngle}function rj(e,t,n,a,r,i,s){var o=e-n,l=t-a,c=(s?i:-i)/rI(o*o+l*l),u=c*l,h=-c*o,d=e+u,p=t+h,f=n+u,m=a+h,g=(d+f)/2,x=(p+m)/2,y=f-d,b=m-p,v=y*y+b*b,w=r-i,N=d*m-f*p,k=(b<0?-1:1)*rI(rS(0,w*w*v-N*N)),S=(N*b-y*k)/v,C=(-N*y-b*k)/v,T=(N*b+y*k)/v,I=(-N*y+b*k)/v,E=S-g,_=C-x,A=T-g,R=I-x;return E*E+_*_>A*A+R*R&&(S=T,C=I),{cx:S,cy:C,x01:-u,y01:-h,x11:S*(r/w-1),y11:C*(r/w-1)}}function rL(){var e=rD,t=rM,n=aK(0),a=null,r=rF,i=rO,s=rP,o=null,l=rs(c);function c(){var c,u,h=+e.apply(this,arguments),d=+t.apply(this,arguments),p=r.apply(this,arguments)-r_,f=i.apply(this,arguments)-r_,m=rw(f-p),g=f>p;if(o||(o=c=l()),d<h&&(u=d,d=h,h=u),d>1e-12)if(m>rA-1e-12)o.moveTo(d*rk(p),d*rT(p)),o.arc(0,0,d,p,f,!g),h>1e-12&&(o.moveTo(h*rk(f),h*rT(f)),o.arc(0,0,h,f,p,g));else{var x,y,b=p,v=f,w=p,N=f,k=m,S=m,C=s.apply(this,arguments)/2,T=C>1e-12&&(a?+a.apply(this,arguments):rI(h*h+d*d)),I=rC(rw(d-h)/2,+n.apply(this,arguments)),E=I,_=I;if(T>1e-12){var A=rR(T/h*rT(C)),R=rR(T/d*rT(C));(k-=2*A)>1e-12?(A*=g?1:-1,w+=A,N-=A):(k=0,w=N=(p+f)/2),(S-=2*R)>1e-12?(R*=g?1:-1,b+=R,v-=R):(S=0,b=v=(p+f)/2)}var D=d*rk(b),M=d*rT(b),F=h*rk(N),O=h*rT(N);if(I>1e-12){var P,j=d*rk(v),L=d*rT(v),z=h*rk(w),B=h*rT(w);if(m<rE)if(P=function(e,t,n,a,r,i,s,o){var l=n-e,c=a-t,u=s-r,h=o-i,d=h*l-u*c;if(!(d*d<1e-12))return d=(u*(t-i)-h*(e-r))/d,[e+d*l,t+d*c]}(D,M,z,B,j,L,F,O)){var V,U=D-P[0],W=M-P[1],G=j-P[0],H=L-P[1],q=1/rT(((V=(U*G+W*H)/(rI(U*U+W*W)*rI(G*G+H*H)))>1?0:V<-1?rE:Math.acos(V))/2),K=rI(P[0]*P[0]+P[1]*P[1]);E=rC(I,(h-K)/(q-1)),_=rC(I,(d-K)/(q+1))}else E=_=0}S>1e-12?_>1e-12?(x=rj(z,B,D,M,d,_,g),y=rj(j,L,F,O,d,_,g),o.moveTo(x.cx+x.x01,x.cy+x.y01),_<I?o.arc(x.cx,x.cy,_,rN(x.y01,x.x01),rN(y.y01,y.x01),!g):(o.arc(x.cx,x.cy,_,rN(x.y01,x.x01),rN(x.y11,x.x11),!g),o.arc(0,0,d,rN(x.cy+x.y11,x.cx+x.x11),rN(y.cy+y.y11,y.cx+y.x11),!g),o.arc(y.cx,y.cy,_,rN(y.y11,y.x11),rN(y.y01,y.x01),!g))):(o.moveTo(D,M),o.arc(0,0,d,b,v,!g)):o.moveTo(D,M),h>1e-12&&k>1e-12?E>1e-12?(x=rj(F,O,j,L,h,-E,g),y=rj(D,M,z,B,h,-E,g),o.lineTo(x.cx+x.x01,x.cy+x.y01),E<I?o.arc(x.cx,x.cy,E,rN(x.y01,x.x01),rN(y.y01,y.x01),!g):(o.arc(x.cx,x.cy,E,rN(x.y01,x.x01),rN(x.y11,x.x11),!g),o.arc(0,0,h,rN(x.cy+x.y11,x.cx+x.x11),rN(y.cy+y.y11,y.cx+y.x11),g),o.arc(y.cx,y.cy,E,rN(y.y11,y.x11),rN(y.y01,y.x01),!g))):o.arc(0,0,h,N,w,g):o.lineTo(F,O)}else o.moveTo(0,0);if(o.closePath(),c)return o=null,c+""||null}return c.centroid=function(){var n=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,a=(+r.apply(this,arguments)+ +i.apply(this,arguments))/2-rE/2;return[rk(a)*n,rT(a)*n]},c.innerRadius=function(t){return arguments.length?(e="function"==typeof t?t:aK(+t),c):e},c.outerRadius=function(e){return arguments.length?(t="function"==typeof e?e:aK(+e),c):t},c.cornerRadius=function(e){return arguments.length?(n="function"==typeof e?e:aK(+e),c):n},c.padRadius=function(e){return arguments.length?(a=null==e?null:"function"==typeof e?e:aK(+e),c):a},c.startAngle=function(e){return arguments.length?(r="function"==typeof e?e:aK(+e),c):r},c.endAngle=function(e){return arguments.length?(i="function"==typeof e?e:aK(+e),c):i},c.padAngle=function(e){return arguments.length?(s="function"==typeof e?e:aK(+e),c):s},c.context=function(e){return arguments.length?(o=null==e?null:e,c):o},c}let rz=(e=>eB(e[e.length-1]))([,,,].concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(function(e){for(var t=e.length/6|0,n=Array(t),a=0;a<t;)n[a]="#"+e.slice(6*a,6*++a);return n})),rB=(e,t,n)=>{let a=[],r=new Date;for(let i=e;i>=0;i--){let s=new Date(r.getTime()-24*i*36e5),o=t*(1+(Math.random()-.5)*n)*(1+(e-i)*.001);a.push({timestamp:s,value:Math.round(100*o)/100,category:"automotive"})}return a},rV=[{id:"production-efficiency",title:"Production Efficiency Trend",type:"line",data:rB(30,94,.05),color:"#0ea5e9",unit:"%"},{id:"quality-metrics",title:"Quality Score Distribution",type:"bar",data:rB(7,98,.02),color:"#10b981",unit:"%"},{id:"supply-chain-health",title:"Supply Chain Health",type:"gauge",data:[{timestamp:new Date,value:87.5,category:"health"}],color:"#f59e0b",unit:"/100"},{id:"delivery-performance",title:"Delivery Performance Heatmap",type:"heatmap",data:rB(14,96,.08),color:"#8b5cf6",unit:"%"}],rU=e=>{let{data:t,color:n,width:r=400,height:i=200}=e,s=(0,c.useRef)(null);return(0,c.useEffect)(()=>{if(!s.current||!t.length)return;let e=en(s.current);e.selectAll("*").remove();let o={top:20,right:30,bottom:40,left:50},l=r-o.left-o.right,c=i-o.top-o.bottom,u=(function(){return aA.apply((function e(t,n,a,r,i,s,o,l,c,u){var h=a_(),d=h.invert,p=h.domain,f=u(".%L"),m=u(":%S"),g=u("%I:%M"),x=u("%I %p"),y=u("%a %d"),b=u("%b %d"),v=u("%B"),w=u("%Y");function N(e){return(c(e)<e?f:l(e)<e?m:o(e)<e?g:s(e)<e?x:r(e)<e?i(e)<e?y:b:a(e)<e?v:w)(e)}return h.invert=function(e){return new Date(d(e))},h.domain=function(e){return arguments.length?p(Array.from(e,aM)):p().map(aD)},h.ticks=function(e){var n=p();return t(n[0],n[n.length-1],null==e?10:e)},h.tickFormat=function(e,t){return null==t?N:u(t)},h.nice=function(e){var t,a,r,i,s,o,l,c=p();return e&&"function"==typeof e.range||(e=n(c[0],c[c.length-1],null==e?10:e)),e?p((t=c,a=e,t=t.slice(),i=0,s=t.length-1,o=t[i],(l=t[s])<o&&(r=i,i=s,s=r,r=o,o=l,l=r),t[i]=a.floor(o),t[s]=a.ceil(l),t)):h},h.copy=function(){return aE(h,e(t,n,a,r,i,s,o,l,c,u))},h})(no,nl,t_,tR,tF,tY,tJ,t0,t2,a).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)})().domain(aF(t,e=>e.timestamp)).range([0,l]),h=(function e(){var t=a_();return t.copy=function(){return aE(t,e())},aA.apply(t,arguments),aH(t)})().domain(aF(t,e=>e.value)).nice().range([c,0]),d=rc().x(e=>u(e.timestamp)).y(e=>h(e.value)).curve(rm),p=e.append("g").attr("transform","translate(".concat(o.left,",").concat(o.top,")")),f=e.append("defs").append("linearGradient").attr("id","gradient-".concat(n.replace("#",""))).attr("gradientUnits","userSpaceOnUse").attr("x1",0).attr("y1",i).attr("x2",0).attr("y2",0);f.append("stop").attr("offset","0%").attr("stop-color",n).attr("stop-opacity",.1),f.append("stop").attr("offset","100%").attr("stop-color",n).attr("stop-opacity",.8);let m=(function(e,t,n){var a=null,r=aK(!0),i=null,s=aY,o=null,l=rs(c);function c(c){var u,h,d,p,f,m=(c=aq(c)).length,g=!1,x=Array(m),y=Array(m);for(null==i&&(o=s(f=l())),u=0;u<=m;++u){if(!(u<m&&r(p=c[u],u,c))===g)if(g=!g)h=u,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),d=u-1;d>=h;--d)o.point(x[d],y[d]);o.lineEnd(),o.areaEnd()}g&&(x[u]=+e(p,u,c),y[u]=+t(p,u,c),o.point(a?+a(p,u,c):x[u],n?+n(p,u,c):y[u]))}if(f)return o=null,f+""||null}function u(){return rc().defined(r).curve(s).context(i)}return e="function"==typeof e?e:void 0===e?ro:aK(+e),t="function"==typeof t?t:void 0===t?aK(0):aK(+t),n="function"==typeof n?n:void 0===n?rl:aK(+n),c.x=function(t){return arguments.length?(e="function"==typeof t?t:aK(+t),a=null,c):e},c.x0=function(t){return arguments.length?(e="function"==typeof t?t:aK(+t),c):e},c.x1=function(e){return arguments.length?(a=null==e?null:"function"==typeof e?e:aK(+e),c):a},c.y=function(e){return arguments.length?(t="function"==typeof e?e:aK(+e),n=null,c):t},c.y0=function(e){return arguments.length?(t="function"==typeof e?e:aK(+e),c):t},c.y1=function(e){return arguments.length?(n=null==e?null:"function"==typeof e?e:aK(+e),c):n},c.lineX0=c.lineY0=function(){return u().x(e).y(t)},c.lineY1=function(){return u().x(e).y(n)},c.lineX1=function(){return u().x(a).y(t)},c.defined=function(e){return arguments.length?(r="function"==typeof e?e:aK(!!e),c):r},c.curve=function(e){return arguments.length?(s=e,null!=i&&(o=s(i)),c):s},c.context=function(e){return arguments.length?(null==e?i=o=null:o=s(i=e),c):i},c})().x(e=>u(e.timestamp)).y0(c).y1(e=>h(e.value)).curve(rm);p.append("path").datum(t).attr("fill","url(#gradient-".concat(n.replace("#",""),")")).attr("d",m),p.append("path").datum(t).attr("fill","none").attr("stroke",n).attr("stroke-width",2).attr("d",d),p.selectAll(".dot").data(t).enter().append("circle").attr("class","dot").attr("cx",e=>u(e.timestamp)).attr("cy",e=>h(e.value)).attr("r",3).attr("fill",n),p.append("g").attr("transform","translate(0,".concat(c,")")).call(rv(3,u).tickFormat(a("%m/%d"))),p.append("g").call(rv(4,h))},[t,n,r,i]),(0,l.jsx)("svg",{ref:s,width:r,height:i})},rW=e=>{let{value:t,color:n,width:a=200,height:r=200}=e,i=(0,c.useRef)(null);return(0,c.useEffect)(()=>{if(!i.current)return;let e=en(i.current);e.selectAll("*").remove();let s=Math.min(a,r)/2-20,o=a/2,l=r/2,c=e.append("g").attr("transform","translate(".concat(o,",").concat(l,")")),u=rL().innerRadius(s-20).outerRadius(s).startAngle(-Math.PI/2).endAngle(Math.PI/2)({startAngle:-Math.PI/2,endAngle:Math.PI/2,innerRadius:s-20,outerRadius:s});c.append("path").attr("d",u).attr("fill","#e5e7eb");let h=rL().innerRadius(s-20).outerRadius(s).startAngle(-Math.PI/2).endAngle(-Math.PI/2+Math.PI*t/100)({startAngle:-Math.PI/2,endAngle:-Math.PI/2+Math.PI*t/100,innerRadius:s-20,outerRadius:s});c.append("path").attr("d",h).attr("fill",n),c.append("text").attr("text-anchor","middle").attr("dy","0.35em").attr("font-size","24px").attr("font-weight","bold").attr("fill",n).text("".concat(t.toFixed(1)))},[t,n,a,r]),(0,l.jsx)("svg",{ref:i,width:a,height:r})},rG=e=>{let{data:t,color:n,width:a=400,height:r=200}=e,i=(0,c.useRef)(null);return(0,c.useEffect)(()=>{if(!i.current||!t.length)return;let e=en(i.current);e.selectAll("*").remove();let n={top:20,right:30,bottom:40,left:50},s=a-n.left-n.right,o=r-n.top-n.bottom,l=s/t.length,c=o/7,u=(function e(){var t=aH((function(){var e,t,n,a,r,i=0,s=1,o=aS,l=!1;function c(t){return null==t||isNaN(t*=1)?r:o(0===n?.5:(t=(a(t)-e)*n,l?Math.max(0,Math.min(1,t)):t))}function u(e){return function(t){var n,a;return arguments.length?([n,a]=t,o=e(n,a),c):[o(0),o(1)]}}return c.domain=function(r){return arguments.length?([i,s]=r,e=a(i*=1),t=a(s*=1),n=e===t?0:1/(t-e),c):[i,s]},c.clamp=function(e){return arguments.length?(l=!!e,c):l},c.interpolator=function(e){return arguments.length?(o=e,c):o},c.range=u(eH),c.rangeRound=u(aw),c.unknown=function(e){return arguments.length?(r=e,c):r},function(r){return a=r,e=r(i),t=r(s),n=e===t?0:1/(t-e),c}})()(aS));return t.copy=function(){return e().domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())},aR.apply(t,arguments)})().interpolator(rz).domain(aF(t,e=>e.value)),h=e.append("g").attr("transform","translate(".concat(n.left,",").concat(n.top,")"));t.forEach((e,t)=>{let n=e.timestamp.getDay();h.append("rect").attr("x",t*l).attr("y",n*c).attr("width",l-1).attr("height",c-1).attr("fill",u(e.value)).attr("stroke","#fff").attr("stroke-width",1),l>30&&h.append("text").attr("x",t*l+l/2).attr("y",n*c+c/2).attr("text-anchor","middle").attr("dy","0.35em").attr("font-size","10px").attr("fill",e.value>95?"#fff":"#000").text(e.value.toFixed(0))})},[t,n,a,r]),(0,l.jsx)("svg",{ref:i,width:a,height:r})};function rH(){let[e,t]=(0,c.useState)(null),[n,a]=(0,c.useState)(!0);return(0,c.useEffect)(()=>{if(!n)return;let e=setInterval(()=>{rV.forEach(e=>{"gauge"===e.type&&(e.data[0].value=100*Math.random())})},3e3);return()=>clearInterval(e)},[n]),(0,l.jsx)("section",{className:"py-16 bg-slate-50",children:(0,l.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,l.jsxs)(u.motion.div,{className:"text-center mb-12",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[(0,l.jsx)("h2",{className:"text-3xl font-bold text-automotive-carbon mb-4",children:"Advanced Analytics Dashboard"}),(0,l.jsx)("p",{className:"text-lg text-automotive-steel max-w-3xl mx-auto",children:"Real-time data visualization powered by D3.js for comprehensive automotive insights"}),(0,l.jsx)("div",{className:"mt-6 flex justify-center",children:(0,l.jsx)("button",{onClick:()=>a(!n),className:"px-4 py-2 rounded-lg font-medium transition-all duration-300 ".concat(n?"bg-automotive-success text-white":"bg-automotive-chrome text-automotive-carbon"),children:n?" Real-time Active":" Real-time Paused"})})]}),(0,l.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:rV.map((n,a)=>{var r,i;return(0,l.jsxs)(u.motion.div,{className:"bg-white rounded-lg shadow-lg p-6 border-2 transition-all duration-300 ".concat(e===n.id?"border-primary-500 shadow-xl":"border-automotive-chrome hover:border-primary-300"),initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1*a},onClick:()=>t(e===n.id?null:n.id),whileHover:{scale:1.02},children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-automotive-carbon",children:n.title}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:n.color}}),(0,l.jsx)("span",{className:"text-sm text-automotive-steel",children:n.type.toUpperCase()})]})]}),(0,l.jsxs)("div",{className:"flex justify-center",children:["line"===n.type&&(0,l.jsx)(rU,{data:n.data,color:n.color,width:350,height:200}),"bar"===n.type&&(0,l.jsx)(rU,{data:n.data,color:n.color,width:350,height:200}),"gauge"===n.type&&(0,l.jsx)(rW,{value:(null==(r=n.data[0])?void 0:r.value)||0,color:n.color,width:200,height:200}),"heatmap"===n.type&&(0,l.jsx)(rG,{data:n.data,color:n.color,width:350,height:150})]}),(0,l.jsxs)("div",{className:"mt-4 pt-4 border-t border-automotive-chrome",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("span",{className:"text-sm text-automotive-steel",children:"Current Value:"}),(0,l.jsxs)("span",{className:"font-semibold text-automotive-carbon",children:[null==(i=n.data[n.data.length-1])?void 0:i.value.toFixed(1),n.unit]})]}),(0,l.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,l.jsx)("span",{className:"text-sm text-automotive-steel",children:"Data Points:"}),(0,l.jsx)("span",{className:"font-semibold text-automotive-carbon",children:n.data.length})]})]})]},n.id)})}),(0,l.jsxs)(u.motion.div,{className:"mt-12 bg-white rounded-lg shadow-lg p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.6},children:[(0,l.jsx)("h3",{className:"text-xl font-semibold text-automotive-carbon mb-4",children:"D3.js Visualization Features"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-primary-100 rounded-lg flex items-center justify-center mx-auto mb-3",children:(0,l.jsx)("span",{className:"text-xl",children:""})}),(0,l.jsx)("h4",{className:"font-semibold text-automotive-carbon mb-2",children:"Interactive Charts"}),(0,l.jsx)("p",{className:"text-sm text-automotive-steel",children:"Click and hover interactions"})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-primary-100 rounded-lg flex items-center justify-center mx-auto mb-3",children:(0,l.jsx)("span",{className:"text-xl",children:""})}),(0,l.jsx)("h4",{className:"font-semibold text-automotive-carbon mb-2",children:"Real-time Updates"}),(0,l.jsx)("p",{className:"text-sm text-automotive-steel",children:"Live data streaming"})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-primary-100 rounded-lg flex items-center justify-center mx-auto mb-3",children:(0,l.jsx)("span",{className:"text-xl",children:""})}),(0,l.jsx)("h4",{className:"font-semibold text-automotive-carbon mb-2",children:"Custom Styling"}),(0,l.jsx)("p",{className:"text-sm text-automotive-steel",children:"Automotive brand colors"})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-primary-100 rounded-lg flex items-center justify-center mx-auto mb-3",children:(0,l.jsx)("span",{className:"text-xl",children:""})}),(0,l.jsx)("h4",{className:"font-semibold text-automotive-carbon mb-2",children:"Responsive Design"}),(0,l.jsx)("p",{className:"text-sm text-automotive-steel",children:"Mobile-optimized views"})]})]})]})]})})}},91773,e=>{"use strict";e.s(["default",()=>i]);var t=e.i(43476),n=e.i(71645),a=e.i(46932);let r=[{id:"1",name:"Production Data",method:"GET",path:"/api/v1/production/metrics",description:"Real-time production efficiency metrics",status:"active",responseTime:45,usage:98.7},{id:"2",name:"Quality Analytics",method:"GET",path:"/api/v1/quality/scores",description:"Quality control data and predictions",status:"active",responseTime:32,usage:94.2},{id:"3",name:"Supply Chain",method:"POST",path:"/api/v1/supply-chain/optimize",description:"Supply chain optimization requests",status:"beta",responseTime:156,usage:78.5},{id:"4",name:"Predictive Models",method:"POST",path:"/api/v1/ml/predict",description:"Machine learning prediction endpoints",status:"active",responseTime:89,usage:91.3}];function i(){let[e,i]=(0,n.useState)(null),[s,o]=(0,n.useState)(null),l=e=>{switch(e){case"GET":return"bg-automotive-success text-white";case"POST":return"bg-primary-500 text-white";case"PUT":return"bg-automotive-warning text-white";case"DELETE":return"bg-automotive-danger text-white";default:return"bg-automotive-steel text-white"}},c=async e=>{o("Testing..."),setTimeout(()=>{o(JSON.stringify({status:200,responseTime:e.responseTime,data:{success:!0,message:"".concat(e.name," API is functioning correctly"),timestamp:new Date().toISOString()}},null,2))},1500)};return(0,t.jsx)("section",{className:"py-16 bg-white",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,t.jsxs)(a.motion.div,{className:"text-center mb-12",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[(0,t.jsx)("h2",{className:"text-3xl font-bold text-automotive-carbon mb-4",children:"API Management Platform"}),(0,t.jsx)("p",{className:"text-lg text-automotive-steel max-w-3xl mx-auto",children:"Comprehensive API integration hub for automotive systems and third-party connectors"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,t.jsxs)(a.motion.div,{className:"bg-slate-50 rounded-lg p-6",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5},children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-automotive-carbon mb-6",children:"Available Endpoints"}),(0,t.jsx)("div",{className:"space-y-4",children:r.map(n=>(0,t.jsxs)(a.motion.div,{className:"p-4 bg-white rounded-lg border-2 cursor-pointer transition-all duration-300 ".concat((null==e?void 0:e.id)===n.id?"border-primary-500 shadow-lg":"border-automotive-chrome hover:border-primary-300"),onClick:()=>i(n),whileHover:{scale:1.02},children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("span",{className:"px-2 py-1 rounded text-xs font-semibold ".concat(l(n.method)),children:n.method}),(0,t.jsx)("span",{className:"font-semibold text-automotive-carbon",children:n.name})]}),(0,t.jsx)("span",{className:"text-sm font-medium capitalize ".concat((e=>{switch(e){case"active":return"text-automotive-success";case"beta":return"text-automotive-warning";case"deprecated":return"text-automotive-danger";default:return"text-automotive-steel"}})(n.status)),children:n.status})]}),(0,t.jsx)("p",{className:"text-sm text-automotive-steel mb-3",children:n.description}),(0,t.jsxs)("div",{className:"flex items-center justify-between text-xs text-automotive-steel",children:[(0,t.jsx)("span",{children:n.path}),(0,t.jsxs)("div",{className:"flex space-x-4",children:[(0,t.jsxs)("span",{children:[n.responseTime,"ms"]}),(0,t.jsxs)("span",{children:[n.usage,"% uptime"]})]})]})]},n.id))})]}),(0,t.jsxs)(a.motion.div,{className:"bg-slate-50 rounded-lg p-6",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.2},children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-automotive-carbon mb-6",children:"API Testing Console"}),e?(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"mb-4 p-4 bg-white rounded-lg",children:[(0,t.jsx)("h4",{className:"font-semibold text-automotive-carbon mb-2",children:e.name}),(0,t.jsx)("p",{className:"text-sm text-automotive-steel mb-3",children:e.description}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,t.jsx)("span",{className:"px-2 py-1 rounded text-xs font-semibold ".concat(l(e.method)),children:e.method}),(0,t.jsx)("code",{className:"text-sm bg-slate-100 px-2 py-1 rounded",children:e.path})]}),(0,t.jsx)("button",{onClick:()=>c(e),className:"w-full bg-primary-500 hover:bg-primary-600 text-white font-semibold py-2 px-4 rounded-lg transition-colors duration-300",children:"Test Endpoint"})]}),s&&(0,t.jsxs)(a.motion.div,{className:"bg-automotive-carbon text-white p-4 rounded-lg",initial:{opacity:0,y:10},animate:{opacity:1,y:0},children:[(0,t.jsx)("h5",{className:"font-semibold mb-2",children:"Response:"}),(0,t.jsx)("pre",{className:"text-sm overflow-x-auto",children:s})]})]}):(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("div",{className:"text-6xl mb-4",children:""}),(0,t.jsx)("p",{className:"text-automotive-steel",children:"Select an endpoint to test"})]})]})]}),(0,t.jsxs)(a.motion.div,{className:"mt-12 bg-slate-50 rounded-lg p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-automotive-carbon mb-6",children:"Integration Partners"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:[(0,t.jsxs)("div",{className:"text-center p-4 bg-white rounded-lg",children:[(0,t.jsx)("div",{className:"text-3xl mb-2",children:""}),(0,t.jsx)("h4",{className:"font-semibold text-automotive-carbon",children:"SAP ERP"}),(0,t.jsx)("p",{className:"text-sm text-automotive-steel",children:"Enterprise Resource Planning"})]}),(0,t.jsxs)("div",{className:"text-center p-4 bg-white rounded-lg",children:[(0,t.jsx)("div",{className:"text-3xl mb-2",children:""}),(0,t.jsx)("h4",{className:"font-semibold text-automotive-carbon",children:"QAD MFG"}),(0,t.jsx)("p",{className:"text-sm text-automotive-steel",children:"Manufacturing Execution"})]}),(0,t.jsxs)("div",{className:"text-center p-4 bg-white rounded-lg",children:[(0,t.jsx)("div",{className:"text-3xl mb-2",children:""}),(0,t.jsx)("h4",{className:"font-semibold text-automotive-carbon",children:"Ariba"}),(0,t.jsx)("p",{className:"text-sm text-automotive-steel",children:"Supplier Network"})]}),(0,t.jsxs)("div",{className:"text-center p-4 bg-white rounded-lg",children:[(0,t.jsx)("div",{className:"text-3xl mb-2",children:""}),(0,t.jsx)("h4",{className:"font-semibold text-automotive-carbon",children:"Power BI"}),(0,t.jsx)("p",{className:"text-sm text-automotive-steel",children:"Business Intelligence"})]})]})]})]})})}},83056,e=>{"use strict";e.s(["default",()=>s]);var t=e.i(43476),n=e.i(71645),a=e.i(46932);let r=[{id:"PO-001",partNumber:"ENG-V8-2024",description:"V8 Engine Block Assembly",quantity:150,priority:"high",status:"in-progress",startDate:"2024-01-15",endDate:"2024-01-22",assignedLine:"Line A",progress:65},{id:"PO-002",partNumber:"TRANS-AUTO-X7",description:"Automatic Transmission Unit",quantity:200,priority:"medium",status:"planned",startDate:"2024-01-20",endDate:"2024-01-28",assignedLine:"Line B",progress:0},{id:"PO-003",partNumber:"BRAKE-DISC-F1",description:"Front Brake Disc Set",quantity:500,priority:"high",status:"completed",startDate:"2024-01-10",endDate:"2024-01-18",assignedLine:"Line C",progress:100},{id:"PO-004",partNumber:"SUSP-STRUT-R2",description:"Rear Suspension Strut",quantity:300,priority:"low",status:"delayed",startDate:"2024-01-12",endDate:"2024-01-25",assignedLine:"Line A",progress:45}],i=[{id:"line-a",name:"Line A - Engine Assembly",capacity:100,currentLoad:85,efficiency:94.2,status:"active",nextMaintenance:"2024-01-30"},{id:"line-b",name:"Line B - Transmission",capacity:80,currentLoad:60,efficiency:91.8,status:"active",nextMaintenance:"2024-02-05"},{id:"line-c",name:"Line C - Components",capacity:150,currentLoad:120,efficiency:96.5,status:"active",nextMaintenance:"2024-01-28"},{id:"line-d",name:"Line D - Quality Control",capacity:200,currentLoad:0,efficiency:0,status:"maintenance",nextMaintenance:"2024-01-25"}];function s(){let[e,s]=(0,n.useState)("orders"),[o]=(0,n.useState)(r),[l]=(0,n.useState)(i);return(0,t.jsx)("section",{className:"py-16 bg-gradient-to-br from-slate-50 to-blue-50",children:(0,t.jsxs)("div",{className:"container mx-auto px-4",children:[(0,t.jsxs)(a.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-12",children:[(0,t.jsx)("h2",{className:"text-4xl font-bold text-automotive-carbon mb-4",children:"Production Planning & Optimization"}),(0,t.jsx)("p",{className:"text-xl text-automotive-steel max-w-3xl mx-auto",children:"Advanced automotive manufacturing workflow management with real-time capacity planning and resource optimization"})]}),(0,t.jsx)("div",{className:"flex justify-center mb-8",children:(0,t.jsx)("div",{className:"bg-white rounded-lg p-1 shadow-lg",children:[{id:"orders",label:"Production Orders",icon:""},{id:"lines",label:"Production Lines",icon:""},{id:"schedule",label:"Schedule View",icon:""}].map(n=>(0,t.jsxs)("button",{onClick:()=>s(n.id),className:"px-6 py-3 rounded-md font-medium transition-all duration-300 ".concat(e===n.id?"bg-primary-500 text-white shadow-md":"text-automotive-steel hover:bg-gray-50"),children:[(0,t.jsx)("span",{className:"mr-2",children:n.icon}),n.label]},n.id))})}),(0,t.jsxs)(a.motion.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.4},className:"bg-white rounded-xl shadow-xl p-8",children:["orders"===e&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h3",{className:"text-2xl font-semibold text-automotive-carbon",children:"Production Orders"}),(0,t.jsx)("button",{className:"bg-primary-500 text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors",children:"+ New Order"})]}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-gray-200",children:[(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Order ID"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Part Number"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Description"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Quantity"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Priority"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Status"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Progress"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Line"})]})}),(0,t.jsx)("tbody",{children:o.map(e=>(0,t.jsxs)("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"py-4 px-4 font-medium text-automotive-carbon",children:e.id}),(0,t.jsx)("td",{className:"py-4 px-4 text-automotive-steel",children:e.partNumber}),(0,t.jsx)("td",{className:"py-4 px-4 text-automotive-steel",children:e.description}),(0,t.jsx)("td",{className:"py-4 px-4 text-automotive-steel",children:e.quantity.toLocaleString()}),(0,t.jsx)("td",{className:"py-4 px-4",children:(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat((e=>{switch(e){case"high":return"bg-red-100 text-red-800 border-red-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"low":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(e.priority)),children:e.priority.toUpperCase()})}),(0,t.jsx)("td",{className:"py-4 px-4",children:(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat((e=>{switch(e){case"completed":return"bg-green-100 text-green-800 border-green-200";case"in-progress":return"bg-blue-100 text-blue-800 border-blue-200";case"planned":return"bg-purple-100 text-purple-800 border-purple-200";case"delayed":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(e.status)),children:e.status.replace("-"," ").toUpperCase()})}),(0,t.jsx)("td",{className:"py-4 px-4",children:(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("div",{className:"w-20 bg-gray-200 rounded-full h-2",children:(0,t.jsx)("div",{className:"bg-primary-500 h-2 rounded-full transition-all duration-300",style:{width:"".concat(e.progress,"%")}})}),(0,t.jsxs)("span",{className:"text-sm text-automotive-steel",children:[e.progress,"%"]})]})}),(0,t.jsx)("td",{className:"py-4 px-4 text-automotive-steel",children:e.assignedLine})]},e.id))})]})})]}),"lines"===e&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h3",{className:"text-2xl font-semibold text-automotive-carbon",children:"Production Lines Status"}),(0,t.jsx)("button",{className:"bg-primary-500 text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors",children:"Schedule Maintenance"})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:l.map(e=>(0,t.jsxs)(a.motion.div,{className:"bg-gradient-to-r from-white to-gray-50 rounded-lg p-6 border border-gray-200",whileHover:{scale:1.02},transition:{duration:.2},children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-automotive-carbon",children:e.name}),(0,t.jsxs)("span",{className:"text-sm font-medium ".concat((e=>{switch(e){case"active":return"text-green-600";case"maintenance":return"text-orange-600";default:return"text-gray-600"}})(e.status)),children:[" ",e.status.toUpperCase()]})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-automotive-steel",children:"Capacity Utilization:"}),(0,t.jsxs)("span",{className:"font-medium text-automotive-carbon",children:[e.currentLoad,"/",e.capacity," (",Math.round(e.currentLoad/e.capacity*100),"%)"]})]}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3",children:(0,t.jsx)("div",{className:"h-3 rounded-full transition-all duration-300 ".concat(e.currentLoad/e.capacity>.9?"bg-red-500":e.currentLoad/e.capacity>.7?"bg-yellow-500":"bg-green-500"),style:{width:"".concat(e.currentLoad/e.capacity*100,"%")}})}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-automotive-steel",children:"Efficiency:"}),(0,t.jsxs)("span",{className:"font-medium text-automotive-carbon",children:[e.efficiency,"%"]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-automotive-steel",children:"Next Maintenance:"}),(0,t.jsx)("span",{className:"font-medium text-automotive-carbon",children:e.nextMaintenance})]})]})]},e.id))})]}),"schedule"===e&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h3",{className:"text-2xl font-semibold text-automotive-carbon",children:"Production Schedule"}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("button",{className:"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Week View"}),(0,t.jsx)("button",{className:"bg-primary-500 text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors",children:"Month View"})]})]}),(0,t.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg p-8 text-center",children:[(0,t.jsx)("div",{className:"text-6xl mb-4",children:""}),(0,t.jsx)("h4",{className:"text-xl font-semibold text-automotive-carbon mb-2",children:"Advanced Scheduling Interface"}),(0,t.jsx)("p",{className:"text-automotive-steel mb-4",children:"Interactive Gantt chart with drag-and-drop scheduling, resource allocation, and bottleneck analysis"}),(0,t.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow-md",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-primary-500",children:"24"}),(0,t.jsx)("div",{className:"text-sm text-automotive-steel",children:"Active Orders"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow-md",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-green-500",children:"94.2%"}),(0,t.jsx)("div",{className:"text-sm text-automotive-steel",children:"Avg Efficiency"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow-md",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-orange-500",children:"3"}),(0,t.jsx)("div",{className:"text-sm text-automotive-steel",children:"Bottlenecks"})]})]})]})]})]},e)]})})}},24680,e=>{"use strict";e.s(["default",()=>l]);var t=e.i(43476),n=e.i(71645),a=e.i(46932);let r=[{id:"defect-rate",name:"Defect Rate",value:.8,target:1,unit:"%",trend:"down",status:"excellent",lastUpdated:"2024-01-15T10:30:00Z"},{id:"first-pass-yield",name:"First Pass Yield",value:98.5,target:97,unit:"%",trend:"up",status:"excellent",lastUpdated:"2024-01-15T10:30:00Z"},{id:"customer-complaints",name:"Customer Complaints",value:2,target:5,unit:"per 1000",trend:"stable",status:"good",lastUpdated:"2024-01-15T10:30:00Z"},{id:"inspection-coverage",name:"Inspection Coverage",value:95.2,target:98,unit:"%",trend:"up",status:"warning",lastUpdated:"2024-01-15T10:30:00Z"},{id:"supplier-quality",name:"Supplier Quality Score",value:94.7,target:95,unit:"%",trend:"down",status:"warning",lastUpdated:"2024-01-15T10:30:00Z"},{id:"audit-score",name:"ISO Audit Score",value:96.8,target:95,unit:"%",trend:"up",status:"excellent",lastUpdated:"2024-01-15T10:30:00Z"}],i=[{id:"QI-001",partNumber:"ENG-V8-2024",defectType:"Surface Roughness",severity:"medium",detectedAt:"Final Inspection",status:"investigating",assignedTo:"John Smith",description:"Surface roughness exceeds specification on cylinder head"},{id:"QI-002",partNumber:"BRAKE-DISC-F1",defectType:"Dimensional Variance",severity:"high",detectedAt:"In-Process Check",status:"open",assignedTo:"Sarah Johnson",description:"Brake disc thickness variance beyond tolerance"},{id:"QI-003",partNumber:"TRANS-AUTO-X7",defectType:"Material Defect",severity:"critical",detectedAt:"Incoming Inspection",status:"resolved",assignedTo:"Mike Wilson",description:"Material hardness below specification"}],s=[{id:"INS-001",batchId:"B-2024-001",partNumber:"ENG-V8-2024",inspectionType:"Dimensional",result:"pass",defectsFound:0,inspector:"Alice Brown",timestamp:"2024-01-15T09:15:00Z"},{id:"INS-002",batchId:"B-2024-002",partNumber:"BRAKE-DISC-F1",inspectionType:"Visual",result:"conditional",defectsFound:2,inspector:"Bob Davis",timestamp:"2024-01-15T09:30:00Z"},{id:"INS-003",batchId:"B-2024-003",partNumber:"SUSP-STRUT-R2",inspectionType:"Functional",result:"pass",defectsFound:0,inspector:"Carol White",timestamp:"2024-01-15T10:00:00Z"}],o=e=>{switch(e){case"excellent":return"bg-green-100 text-green-800 border-green-200";case"good":return"bg-blue-100 text-blue-800 border-blue-200";case"warning":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"critical":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};function l(){let[e,l]=(0,n.useState)("metrics");return(0,t.jsx)("section",{className:"py-16 bg-gradient-to-br from-green-50 to-blue-50",children:(0,t.jsxs)("div",{className:"container mx-auto px-4",children:[(0,t.jsxs)(a.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-12",children:[(0,t.jsx)("h2",{className:"text-4xl font-bold text-automotive-carbon mb-4",children:"Quality Control Dashboard"}),(0,t.jsx)("p",{className:"text-xl text-automotive-steel max-w-3xl mx-auto",children:"Comprehensive automotive quality management with real-time metrics, incident tracking, and ISO compliance monitoring"})]}),(0,t.jsx)("div",{className:"flex justify-center mb-8",children:(0,t.jsx)("div",{className:"bg-white rounded-lg p-1 shadow-lg",children:[{id:"metrics",label:"Quality Metrics",icon:""},{id:"incidents",label:"Quality Incidents",icon:""},{id:"inspections",label:"Inspection Results",icon:""}].map(n=>(0,t.jsxs)("button",{onClick:()=>l(n.id),className:"px-6 py-3 rounded-md font-medium transition-all duration-300 ".concat(e===n.id?"bg-primary-500 text-white shadow-md":"text-automotive-steel hover:bg-gray-50"),children:[(0,t.jsx)("span",{className:"mr-2",children:n.icon}),n.label]},n.id))})}),(0,t.jsxs)(a.motion.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.4},className:"bg-white rounded-xl shadow-xl p-8",children:["metrics"===e&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h3",{className:"text-2xl font-semibold text-automotive-carbon",children:"Quality Metrics Overview"}),(0,t.jsx)("button",{className:"bg-primary-500 text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors",children:"Export Report"})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:r.map(e=>(0,t.jsxs)(a.motion.div,{className:"bg-gradient-to-r from-white to-gray-50 rounded-lg p-6 border border-gray-200",whileHover:{scale:1.02},transition:{duration:.2},children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-automotive-carbon",children:e.name}),(0,t.jsx)("span",{className:"text-xl",children:(e=>{switch(e){case"up":return"";case"down":return"";default:return""}})(e.trend)})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-baseline justify-between",children:[(0,t.jsx)("span",{className:"text-3xl font-bold text-automotive-carbon",children:e.value}),(0,t.jsx)("span",{className:"text-lg text-automotive-steel",children:e.unit})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsxs)("span",{className:"text-automotive-steel",children:["Target: ",e.target,e.unit]}),(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat(o(e.status)),children:e.status.toUpperCase()})]}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,t.jsx)("div",{className:"h-2 rounded-full transition-all duration-300 ".concat("excellent"===e.status?"bg-green-500":"good"===e.status?"bg-blue-500":"warning"===e.status?"bg-yellow-500":"bg-red-500"),style:{width:"".concat(Math.min(e.value/e.target*100,100),"%")}})})]})]},e.id))}),(0,t.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 rounded-lg p-8 text-center",children:[(0,t.jsx)("div",{className:"text-6xl mb-4",children:""}),(0,t.jsx)("h4",{className:"text-xl font-semibold text-automotive-carbon mb-2",children:"Quality Trends Analysis"}),(0,t.jsx)("p",{className:"text-automotive-steel mb-4",children:"Interactive charts showing quality metrics over time with predictive analytics"})]})]}),"incidents"===e&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h3",{className:"text-2xl font-semibold text-automotive-carbon",children:"Quality Incidents"}),(0,t.jsx)("button",{className:"bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-colors",children:"+ Report Incident"})]}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-gray-200",children:[(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Incident ID"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Part Number"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Defect Type"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Severity"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Detected At"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Status"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Assigned To"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Actions"})]})}),(0,t.jsx)("tbody",{children:i.map(e=>(0,t.jsxs)("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"py-4 px-4 font-medium text-automotive-carbon",children:e.id}),(0,t.jsx)("td",{className:"py-4 px-4 text-automotive-steel",children:e.partNumber}),(0,t.jsx)("td",{className:"py-4 px-4 text-automotive-steel",children:e.defectType}),(0,t.jsx)("td",{className:"py-4 px-4",children:(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat((e=>{switch(e){case"low":return"bg-green-100 text-green-800 border-green-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"critical":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(e.severity)),children:e.severity.toUpperCase()})}),(0,t.jsx)("td",{className:"py-4 px-4 text-automotive-steel",children:e.detectedAt}),(0,t.jsx)("td",{className:"py-4 px-4",children:(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat(o("resolved"===e.status?"good":"warning")),children:e.status.toUpperCase()})}),(0,t.jsx)("td",{className:"py-4 px-4 text-automotive-steel",children:e.assignedTo}),(0,t.jsx)("td",{className:"py-4 px-4",children:(0,t.jsx)("button",{className:"text-primary-500 hover:text-primary-600 font-medium",children:"View Details"})})]},e.id))})]})})]}),"inspections"===e&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h3",{className:"text-2xl font-semibold text-automotive-carbon",children:"Recent Inspection Results"}),(0,t.jsx)("button",{className:"bg-primary-500 text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors",children:"Schedule Inspection"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[(0,t.jsxs)("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 rounded-lg p-6",children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-automotive-carbon mb-4",children:"Inspection Summary"}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-green-500",children:"85%"}),(0,t.jsx)("div",{className:"text-sm text-automotive-steel",children:"Pass Rate"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-yellow-500",children:"12%"}),(0,t.jsx)("div",{className:"text-sm text-automotive-steel",children:"Conditional"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-red-500",children:"3%"}),(0,t.jsx)("div",{className:"text-sm text-automotive-steel",children:"Fail Rate"})]})]})]}),(0,t.jsxs)("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg p-6",children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-automotive-carbon mb-4",children:"Inspection Types"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-automotive-steel",children:"Dimensional"}),(0,t.jsx)("span",{className:"font-medium text-automotive-carbon",children:"45%"})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-automotive-steel",children:"Visual"}),(0,t.jsx)("span",{className:"font-medium text-automotive-carbon",children:"30%"})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-automotive-steel",children:"Functional"}),(0,t.jsx)("span",{className:"font-medium text-automotive-carbon",children:"25%"})]})]})]})]}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-gray-200",children:[(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Inspection ID"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Batch ID"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Part Number"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Type"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Result"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Defects"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Inspector"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Timestamp"})]})}),(0,t.jsx)("tbody",{children:s.map(e=>(0,t.jsxs)("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"py-4 px-4 font-medium text-automotive-carbon",children:e.id}),(0,t.jsx)("td",{className:"py-4 px-4 text-automotive-steel",children:e.batchId}),(0,t.jsx)("td",{className:"py-4 px-4 text-automotive-steel",children:e.partNumber}),(0,t.jsx)("td",{className:"py-4 px-4 text-automotive-steel",children:e.inspectionType}),(0,t.jsx)("td",{className:"py-4 px-4",children:(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat((e=>{switch(e){case"pass":return"bg-green-100 text-green-800 border-green-200";case"conditional":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"fail":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(e.result)),children:e.result.toUpperCase()})}),(0,t.jsx)("td",{className:"py-4 px-4 text-automotive-steel",children:e.defectsFound}),(0,t.jsx)("td",{className:"py-4 px-4 text-automotive-steel",children:e.inspector}),(0,t.jsx)("td",{className:"py-4 px-4 text-automotive-steel",children:new Date(e.timestamp).toLocaleString()})]},e.id))})]})})]})]},e)]})})}},66197,e=>{"use strict";e.s(["default",()=>o]);var t=e.i(43476),n=e.i(71645),a=e.i(46932);let r=[{id:"SUP-001",name:"Premium Auto Components Ltd",category:"Engine Parts",location:"Birmingham, UK",qualityRating:96.5,deliveryRating:94.2,costRating:88.7,overallScore:93.1,certifications:["ISO 9001","TS 16949","ISO 14001"],status:"active",riskLevel:"low",lastAudit:"2023-11-15",nextAudit:"2024-05-15",contractValue:25e5},{id:"SUP-002",name:"European Brake Systems GmbH",category:"Brake Components",location:"Stuttgart, Germany",qualityRating:98.2,deliveryRating:96.8,costRating:85.3,overallScore:93.4,certifications:["ISO 9001","TS 16949","VDA 6.3"],status:"active",riskLevel:"low",lastAudit:"2023-12-08",nextAudit:"2024-06-08",contractValue:18e5},{id:"SUP-003",name:"Advanced Materials Inc",category:"Raw Materials",location:"Detroit, USA",qualityRating:89.5,deliveryRating:87.3,costRating:92.1,overallScore:89.6,certifications:["ISO 9001","OHSAS 18001"],status:"pending",riskLevel:"medium",lastAudit:"2023-09-22",nextAudit:"2024-03-22",contractValue:95e4},{id:"SUP-004",name:"Precision Electronics Co",category:"Electronics",location:"Shenzhen, China",qualityRating:85.7,deliveryRating:82.4,costRating:95.8,overallScore:87.9,certifications:["ISO 9001","IPC-A-610"],status:"active",riskLevel:"high",lastAudit:"2023-10-10",nextAudit:"2024-04-10",contractValue:75e4}],i=[{id:"iso-9001",name:"ISO 9001",description:"Quality Management Systems",required:!0,validityPeriod:"3 years"},{id:"ts-16949",name:"TS 16949",description:"Automotive Quality Management Standard",required:!0,validityPeriod:"3 years"},{id:"iso-14001",name:"ISO 14001",description:"Environmental Management Systems",required:!1,validityPeriod:"3 years"},{id:"vda-63",name:"VDA 6.3",description:"Process Audit Standard",required:!1,validityPeriod:"3 years"},{id:"ohsas-18001",name:"OHSAS 18001",description:"Occupational Health and Safety",required:!1,validityPeriod:"3 years"}],s=e=>e>=95?"text-green-600":e>=85?"text-blue-600":e>=75?"text-yellow-600":"text-red-600";function o(){let[e,o]=(0,n.useState)("suppliers"),[l]=(0,n.useState)(r);return(0,t.jsx)("section",{className:"py-16 bg-gradient-to-br from-purple-50 to-blue-50",children:(0,t.jsxs)("div",{className:"container mx-auto px-4",children:[(0,t.jsxs)(a.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-12",children:[(0,t.jsx)("h2",{className:"text-4xl font-bold text-automotive-carbon mb-4",children:"Supplier Management System"}),(0,t.jsx)("p",{className:"text-xl text-automotive-steel max-w-3xl mx-auto",children:"Comprehensive automotive supplier lifecycle management with quality tracking, certification monitoring, and risk assessment"})]}),(0,t.jsx)("div",{className:"flex justify-center mb-8",children:(0,t.jsx)("div",{className:"bg-white rounded-lg p-1 shadow-lg",children:[{id:"suppliers",label:"Supplier Directory",icon:""},{id:"performance",label:"Performance Metrics",icon:""},{id:"certifications",label:"Certifications",icon:""},{id:"audits",label:"Audit Schedule",icon:""}].map(n=>(0,t.jsxs)("button",{onClick:()=>o(n.id),className:"px-6 py-3 rounded-md font-medium transition-all duration-300 ".concat(e===n.id?"bg-primary-500 text-white shadow-md":"text-automotive-steel hover:bg-gray-50"),children:[(0,t.jsx)("span",{className:"mr-2",children:n.icon}),n.label]},n.id))})}),(0,t.jsxs)(a.motion.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.4},className:"bg-white rounded-xl shadow-xl p-8",children:["suppliers"===e&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h3",{className:"text-2xl font-semibold text-automotive-carbon",children:"Supplier Directory"}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("button",{className:"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Import Suppliers"}),(0,t.jsx)("button",{className:"bg-primary-500 text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors",children:"+ Add Supplier"})]})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:l.map(e=>(0,t.jsxs)(a.motion.div,{className:"bg-gradient-to-r from-white to-gray-50 rounded-lg p-6 border border-gray-200",whileHover:{scale:1.02},transition:{duration:.2},children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-automotive-carbon",children:e.name}),(0,t.jsx)("p",{className:"text-sm text-automotive-steel",children:e.category}),(0,t.jsx)("p",{className:"text-sm text-automotive-steel",children:e.location})]}),(0,t.jsx)("div",{className:"text-right",children:(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat((e=>{switch(e){case"active":return"bg-green-100 text-green-800 border-green-200";case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"suspended":return"bg-orange-100 text-orange-800 border-orange-200";case"terminated":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(e.status)),children:e.status.toUpperCase()})})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm text-automotive-steel",children:"Overall Score:"}),(0,t.jsxs)("span",{className:"text-lg font-bold ".concat(s(e.overallScore)),children:[e.overallScore.toFixed(1),"%"]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-automotive-steel",children:"Quality:"}),(0,t.jsxs)("span",{className:"font-medium",children:[e.qualityRating.toFixed(1),"%"]})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-automotive-steel",children:"Delivery:"}),(0,t.jsxs)("span",{className:"font-medium",children:[e.deliveryRating.toFixed(1),"%"]})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-automotive-steel",children:"Cost:"}),(0,t.jsxs)("span",{className:"font-medium",children:[e.costRating.toFixed(1),"%"]})]})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm text-automotive-steel",children:"Risk Level:"}),(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat((e=>{switch(e){case"low":return"bg-green-100 text-green-800 border-green-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"high":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(e.riskLevel)),children:e.riskLevel.toUpperCase()})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-automotive-steel",children:"Contract Value:"}),(0,t.jsxs)("span",{className:"font-medium",children:["",e.contractValue.toLocaleString()]})]}),(0,t.jsx)("div",{className:"pt-2 border-t border-gray-200",children:(0,t.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.certifications.slice(0,3).map(e=>(0,t.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:e},e)),e.certifications.length>3&&(0,t.jsxs)("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded",children:["+",e.certifications.length-3," more"]})]})})]})]},e.id))})]}),"performance"===e&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h3",{className:"text-2xl font-semibold text-automotive-carbon",children:"Supplier Performance Metrics"}),(0,t.jsx)("button",{className:"bg-primary-500 text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors",children:"Generate Report"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,t.jsxs)("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 rounded-lg p-6 text-center",children:[(0,t.jsx)("div",{className:"text-3xl font-bold text-green-600",children:"94.2%"}),(0,t.jsx)("div",{className:"text-sm text-automotive-steel",children:"Avg On-Time Delivery"})]}),(0,t.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg p-6 text-center",children:[(0,t.jsx)("div",{className:"text-3xl font-bold text-blue-600",children:"96.8%"}),(0,t.jsx)("div",{className:"text-sm text-automotive-steel",children:"Avg Quality Score"})]}),(0,t.jsxs)("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg p-6 text-center",children:[(0,t.jsx)("div",{className:"text-3xl font-bold text-purple-600",children:"2.3%"}),(0,t.jsx)("div",{className:"text-sm text-automotive-steel",children:"Cost Variance"})]}),(0,t.jsxs)("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 rounded-lg p-6 text-center",children:[(0,t.jsx)("div",{className:"text-3xl font-bold text-orange-600",children:"12"}),(0,t.jsx)("div",{className:"text-sm text-automotive-steel",children:"Active Incidents"})]})]}),(0,t.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 rounded-lg p-8 text-center",children:[(0,t.jsx)("div",{className:"text-6xl mb-4",children:""}),(0,t.jsx)("h4",{className:"text-xl font-semibold text-automotive-carbon mb-2",children:"Performance Analytics Dashboard"}),(0,t.jsx)("p",{className:"text-automotive-steel mb-4",children:"Interactive charts showing supplier performance trends, benchmarking, and predictive analytics"})]})]}),"certifications"===e&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h3",{className:"text-2xl font-semibold text-automotive-carbon",children:"Automotive Certifications"}),(0,t.jsx)("button",{className:"bg-primary-500 text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors",children:"Certification Audit"})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:i.map(e=>(0,t.jsxs)(a.motion.div,{className:"bg-gradient-to-r from-white to-gray-50 rounded-lg p-6 border border-gray-200",whileHover:{scale:1.02},transition:{duration:.2},children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-automotive-carbon",children:e.name}),(0,t.jsx)("p",{className:"text-sm text-automotive-steel",children:e.description})]}),(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat(e.required?"bg-red-100 text-red-800 border-red-200":"bg-blue-100 text-blue-800 border-blue-200"),children:e.required?"REQUIRED":"OPTIONAL"})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-automotive-steel",children:"Validity Period:"}),(0,t.jsx)("span",{className:"font-medium text-automotive-carbon",children:e.validityPeriod})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-automotive-steel",children:"Suppliers with this cert:"}),(0,t.jsxs)("span",{className:"font-medium text-automotive-carbon",children:[l.filter(t=>t.certifications.includes(e.name)).length," / ",l.length]})]}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,t.jsx)("div",{className:"bg-primary-500 h-2 rounded-full transition-all duration-300",style:{width:"".concat(l.filter(t=>t.certifications.includes(e.name)).length/l.length*100,"%")}})})]})]},e.id))})]}),"audits"===e&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h3",{className:"text-2xl font-semibold text-automotive-carbon",children:"Audit Schedule & Results"}),(0,t.jsx)("button",{className:"bg-primary-500 text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors",children:"Schedule Audit"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,t.jsxs)("div",{className:"bg-gradient-to-r from-yellow-50 to-orange-50 rounded-lg p-6 text-center",children:[(0,t.jsx)("div",{className:"text-3xl font-bold text-yellow-600",children:"8"}),(0,t.jsx)("div",{className:"text-sm text-automotive-steel",children:"Pending Audits"})]}),(0,t.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 rounded-lg p-6 text-center",children:[(0,t.jsx)("div",{className:"text-3xl font-bold text-blue-600",children:"15"}),(0,t.jsx)("div",{className:"text-sm text-automotive-steel",children:"Completed This Quarter"})]}),(0,t.jsxs)("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 rounded-lg p-6 text-center",children:[(0,t.jsx)("div",{className:"text-3xl font-bold text-green-600",children:"92%"}),(0,t.jsx)("div",{className:"text-sm text-automotive-steel",children:"Avg Audit Score"})]})]}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-gray-200",children:[(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Supplier"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Last Audit"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Score"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Next Audit"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Status"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Actions"})]})}),(0,t.jsx)("tbody",{children:l.map(e=>(0,t.jsxs)("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"py-4 px-4",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium text-automotive-carbon",children:e.name}),(0,t.jsx)("div",{className:"text-sm text-automotive-steel",children:e.category})]})}),(0,t.jsx)("td",{className:"py-4 px-4 text-automotive-steel",children:e.lastAudit}),(0,t.jsx)("td",{className:"py-4 px-4",children:(0,t.jsxs)("span",{className:"font-medium ".concat(s(e.overallScore)),children:[e.overallScore.toFixed(1),"%"]})}),(0,t.jsx)("td",{className:"py-4 px-4 text-automotive-steel",children:e.nextAudit}),(0,t.jsx)("td",{className:"py-4 px-4",children:(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat(new Date(e.nextAudit)<new Date?"bg-red-100 text-red-800 border-red-200":new Date(e.nextAudit)<new Date(Date.now()+2592e6)?"bg-yellow-100 text-yellow-800 border-yellow-200":"bg-green-100 text-green-800 border-green-200"),children:new Date(e.nextAudit)<new Date?"OVERDUE":new Date(e.nextAudit)<new Date(Date.now()+2592e6)?"DUE SOON":"SCHEDULED"})}),(0,t.jsx)("td",{className:"py-4 px-4",children:(0,t.jsx)("button",{className:"text-primary-500 hover:text-primary-600 font-medium",children:"View Report"})})]},e.id))})]})})]})]},e)]})})}},26234,e=>{"use strict";e.s(["default",()=>o]);var t=e.i(43476),n=e.i(71645),a=e.i(46932);let r=[{id:"iso-9001",name:"ISO 9001:2015",description:"Quality Management Systems - Requirements",version:"2015",status:"compliant",lastAudit:"2023-11-15",nextAudit:"2024-11-15",score:96.8,requirements:125,compliantRequirements:121,criticalFindings:0,majorFindings:2,minorFindings:8},{id:"ts-16949",name:"IATF 16949:2016",description:"Automotive Quality Management System Standard",version:"2016",status:"compliant",lastAudit:"2023-12-08",nextAudit:"2024-12-08",score:94.2,requirements:186,compliantRequirements:175,criticalFindings:0,majorFindings:3,minorFindings:12},{id:"iso-14001",name:"ISO 14001:2015",description:"Environmental Management Systems",version:"2015",status:"partial",lastAudit:"2023-10-22",nextAudit:"2024-04-22",score:87.5,requirements:98,compliantRequirements:86,criticalFindings:1,majorFindings:4,minorFindings:7},{id:"iso-45001",name:"ISO 45001:2018",description:"Occupational Health and Safety Management Systems",version:"2018",status:"pending",lastAudit:"2023-09-10",nextAudit:"2024-03-10",score:82.3,requirements:112,compliantRequirements:92,criticalFindings:2,majorFindings:6,minorFindings:12}],i=[{id:"CA-001",standardId:"iso-14001",requirement:"6.1.2 Environmental Aspects",finding:"Environmental aspects register needs updating for new production line",severity:"critical",status:"in-progress",assignedTo:"Environmental Manager",dueDate:"2024-02-15",description:"Update environmental aspects register to include new automotive paint line operations"},{id:"CA-002",standardId:"ts-16949",requirement:"8.3.2.3 Product Design Output",finding:"Design output documentation incomplete for brake component specifications",severity:"major",status:"open",assignedTo:"Design Engineer",dueDate:"2024-02-28",description:"Complete design output documentation including material specifications and testing requirements"},{id:"CA-003",standardId:"iso-45001",requirement:"8.1.1 Operational Planning",finding:"Risk assessment for new equipment installation not documented",severity:"major",status:"resolved",assignedTo:"Safety Officer",dueDate:"2024-01-30",description:"Conduct and document risk assessment for new automated assembly equipment"}],s=[{id:"AUD-001",standardId:"iso-9001",auditType:"surveillance",scheduledDate:"2024-02-20",auditor:"BSI Group",status:"scheduled",scope:"Quality Management System - Production and Design"},{id:"AUD-002",standardId:"ts-16949",auditType:"internal",scheduledDate:"2024-02-15",auditor:"Internal Audit Team",status:"in-progress",scope:"Customer-Specific Requirements and Product Safety"},{id:"AUD-003",standardId:"iso-14001",auditType:"recertification",scheduledDate:"2024-03-10",auditor:"Lloyd's Register",status:"scheduled",scope:"Environmental Management System - Full Scope"}];function o(){let[e,o]=(0,n.useState)("standards");return(0,t.jsx)("section",{className:"py-16 bg-gradient-to-br from-indigo-50 to-purple-50",children:(0,t.jsxs)("div",{className:"container mx-auto px-4",children:[(0,t.jsxs)(a.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-12",children:[(0,t.jsx)("h2",{className:"text-4xl font-bold text-automotive-carbon mb-4",children:"ISO Compliance Management"}),(0,t.jsx)("p",{className:"text-xl text-automotive-steel max-w-3xl mx-auto",children:"Comprehensive automotive industry standards compliance tracking with automated reporting and audit management"})]}),(0,t.jsx)("div",{className:"flex justify-center mb-8",children:(0,t.jsx)("div",{className:"bg-white rounded-lg p-1 shadow-lg",children:[{id:"standards",label:"Standards Overview",icon:""},{id:"actions",label:"Corrective Actions",icon:""},{id:"audits",label:"Audit Schedule",icon:""},{id:"reports",label:"Compliance Reports",icon:""}].map(n=>(0,t.jsxs)("button",{onClick:()=>o(n.id),className:"px-6 py-3 rounded-md font-medium transition-all duration-300 ".concat(e===n.id?"bg-primary-500 text-white shadow-md":"text-automotive-steel hover:bg-gray-50"),children:[(0,t.jsx)("span",{className:"mr-2",children:n.icon}),n.label]},n.id))})}),(0,t.jsxs)(a.motion.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.4},className:"bg-white rounded-xl shadow-xl p-8",children:["standards"===e&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h3",{className:"text-2xl font-semibold text-automotive-carbon",children:"Compliance Standards Overview"}),(0,t.jsx)("button",{className:"bg-primary-500 text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors",children:"Add Standard"})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:r.map(e=>(0,t.jsxs)(a.motion.div,{className:"bg-gradient-to-r from-white to-gray-50 rounded-lg p-6 border border-gray-200",whileHover:{scale:1.02},transition:{duration:.2},children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-automotive-carbon",children:e.name}),(0,t.jsx)("p",{className:"text-sm text-automotive-steel",children:e.description})]}),(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat((e=>{switch(e){case"compliant":return"bg-green-100 text-green-800 border-green-200";case"partial":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"non-compliant":return"bg-red-100 text-red-800 border-red-200";case"pending":return"bg-blue-100 text-blue-800 border-blue-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(e.status)),children:e.status.toUpperCase()})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm text-automotive-steel",children:"Compliance Score:"}),(0,t.jsxs)("span",{className:"text-lg font-bold text-automotive-carbon",children:[e.score.toFixed(1),"%"]})]}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3",children:(0,t.jsx)("div",{className:"h-3 rounded-full transition-all duration-300 ".concat(e.score>=95?"bg-green-500":e.score>=85?"bg-blue-500":e.score>=75?"bg-yellow-500":"bg-red-500"),style:{width:"".concat(e.score,"%")}})}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-automotive-steel",children:"Requirements:"}),(0,t.jsxs)("div",{className:"font-medium text-automotive-carbon",children:[e.compliantRequirements,"/",e.requirements]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-automotive-steel",children:"Last Audit:"}),(0,t.jsx)("div",{className:"font-medium text-automotive-carbon",children:e.lastAudit})]})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm pt-2 border-t border-gray-200",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"font-bold text-red-600",children:e.criticalFindings}),(0,t.jsx)("div",{className:"text-automotive-steel",children:"Critical"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"font-bold text-orange-600",children:e.majorFindings}),(0,t.jsx)("div",{className:"text-automotive-steel",children:"Major"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"font-bold text-yellow-600",children:e.minorFindings}),(0,t.jsx)("div",{className:"text-automotive-steel",children:"Minor"})]})]})]})]},e.id))})]}),"actions"===e&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h3",{className:"text-2xl font-semibold text-automotive-carbon",children:"Corrective Actions"}),(0,t.jsx)("button",{className:"bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-colors",children:"+ New Action"})]}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-gray-200",children:[(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Action ID"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Standard"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Requirement"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Severity"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Status"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Assigned To"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Due Date"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Actions"})]})}),(0,t.jsx)("tbody",{children:i.map(e=>{var n;return(0,t.jsxs)("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"py-4 px-4 font-medium text-automotive-carbon",children:e.id}),(0,t.jsx)("td",{className:"py-4 px-4 text-automotive-steel",children:(null==(n=r.find(t=>t.id===e.standardId))?void 0:n.name)||e.standardId}),(0,t.jsx)("td",{className:"py-4 px-4 text-automotive-steel",children:e.requirement}),(0,t.jsx)("td",{className:"py-4 px-4",children:(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat((e=>{switch(e){case"critical":return"bg-red-100 text-red-800 border-red-200";case"major":return"bg-orange-100 text-orange-800 border-orange-200";case"minor":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(e.severity)),children:e.severity.toUpperCase()})}),(0,t.jsx)("td",{className:"py-4 px-4",children:(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat((e=>{switch(e){case"resolved":return"bg-green-100 text-green-800 border-green-200";case"in-progress":return"bg-blue-100 text-blue-800 border-blue-200";case"verified":return"bg-purple-100 text-purple-800 border-purple-200";case"open":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(e.status)),children:e.status.replace("-"," ").toUpperCase()})}),(0,t.jsx)("td",{className:"py-4 px-4 text-automotive-steel",children:e.assignedTo}),(0,t.jsx)("td",{className:"py-4 px-4 text-automotive-steel",children:e.dueDate}),(0,t.jsx)("td",{className:"py-4 px-4",children:(0,t.jsx)("button",{className:"text-primary-500 hover:text-primary-600 font-medium",children:"View Details"})})]},e.id)})})]})})]}),"audits"===e&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h3",{className:"text-2xl font-semibold text-automotive-carbon",children:"Audit Schedule"}),(0,t.jsx)("button",{className:"bg-primary-500 text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors",children:"Schedule Audit"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,t.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg p-6 text-center",children:[(0,t.jsx)("div",{className:"text-3xl font-bold text-blue-600",children:"6"}),(0,t.jsx)("div",{className:"text-sm text-automotive-steel",children:"Scheduled Audits"})]}),(0,t.jsxs)("div",{className:"bg-gradient-to-r from-yellow-50 to-orange-50 rounded-lg p-6 text-center",children:[(0,t.jsx)("div",{className:"text-3xl font-bold text-yellow-600",children:"2"}),(0,t.jsx)("div",{className:"text-sm text-automotive-steel",children:"In Progress"})]}),(0,t.jsxs)("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 rounded-lg p-6 text-center",children:[(0,t.jsx)("div",{className:"text-3xl font-bold text-green-600",children:"12"}),(0,t.jsx)("div",{className:"text-sm text-automotive-steel",children:"Completed YTD"})]}),(0,t.jsxs)("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg p-6 text-center",children:[(0,t.jsx)("div",{className:"text-3xl font-bold text-purple-600",children:"94.2%"}),(0,t.jsx)("div",{className:"text-sm text-automotive-steel",children:"Avg Score"})]})]}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-gray-200",children:[(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Audit ID"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Standard"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Type"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Date"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Auditor"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Status"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-automotive-carbon",children:"Scope"})]})}),(0,t.jsx)("tbody",{children:s.map(e=>{var n;return(0,t.jsxs)("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"py-4 px-4 font-medium text-automotive-carbon",children:e.id}),(0,t.jsx)("td",{className:"py-4 px-4 text-automotive-steel",children:(null==(n=r.find(t=>t.id===e.standardId))?void 0:n.name)||e.standardId}),(0,t.jsx)("td",{className:"py-4 px-4 text-automotive-steel capitalize",children:e.auditType}),(0,t.jsx)("td",{className:"py-4 px-4 text-automotive-steel",children:e.scheduledDate}),(0,t.jsx)("td",{className:"py-4 px-4 text-automotive-steel",children:e.auditor}),(0,t.jsx)("td",{className:"py-4 px-4",children:(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat((e=>{switch(e){case"completed":return"bg-green-100 text-green-800 border-green-200";case"in-progress":return"bg-blue-100 text-blue-800 border-blue-200";case"scheduled":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"cancelled":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(e.status)),children:e.status.replace("-"," ").toUpperCase()})}),(0,t.jsx)("td",{className:"py-4 px-4 text-automotive-steel",children:e.scope})]},e.id)})})]})})]}),"reports"===e&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h3",{className:"text-2xl font-semibold text-automotive-carbon",children:"Compliance Reports"}),(0,t.jsx)("button",{className:"bg-primary-500 text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors",children:"Generate Report"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[(0,t.jsxs)(a.motion.div,{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg p-6 text-center cursor-pointer",whileHover:{scale:1.05},transition:{duration:.2},children:[(0,t.jsx)("div",{className:"text-4xl mb-4",children:""}),(0,t.jsx)("h4",{className:"text-lg font-semibold text-automotive-carbon mb-2",children:"Compliance Dashboard"}),(0,t.jsx)("p",{className:"text-sm text-automotive-steel",children:"Executive summary of all compliance standards"})]}),(0,t.jsxs)(a.motion.div,{className:"bg-gradient-to-r from-green-50 to-blue-50 rounded-lg p-6 text-center cursor-pointer",whileHover:{scale:1.05},transition:{duration:.2},children:[(0,t.jsx)("div",{className:"text-4xl mb-4",children:""}),(0,t.jsx)("h4",{className:"text-lg font-semibold text-automotive-carbon mb-2",children:"Audit Report"}),(0,t.jsx)("p",{className:"text-sm text-automotive-steel",children:"Detailed audit findings and recommendations"})]}),(0,t.jsxs)(a.motion.div,{className:"bg-gradient-to-r from-orange-50 to-red-50 rounded-lg p-6 text-center cursor-pointer",whileHover:{scale:1.05},transition:{duration:.2},children:[(0,t.jsx)("div",{className:"text-4xl mb-4",children:""}),(0,t.jsx)("h4",{className:"text-lg font-semibold text-automotive-carbon mb-2",children:"Action Plan Report"}),(0,t.jsx)("p",{className:"text-sm text-automotive-steel",children:"Corrective actions status and timeline"})]}),(0,t.jsxs)(a.motion.div,{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg p-6 text-center cursor-pointer",whileHover:{scale:1.05},transition:{duration:.2},children:[(0,t.jsx)("div",{className:"text-4xl mb-4",children:""}),(0,t.jsx)("h4",{className:"text-lg font-semibold text-automotive-carbon mb-2",children:"Trend Analysis"}),(0,t.jsx)("p",{className:"text-sm text-automotive-steel",children:"Compliance performance over time"})]}),(0,t.jsxs)(a.motion.div,{className:"bg-gradient-to-r from-yellow-50 to-orange-50 rounded-lg p-6 text-center cursor-pointer",whileHover:{scale:1.05},transition:{duration:.2},children:[(0,t.jsx)("div",{className:"text-4xl mb-4",children:""}),(0,t.jsx)("h4",{className:"text-lg font-semibold text-automotive-carbon mb-2",children:"Risk Assessment"}),(0,t.jsx)("p",{className:"text-sm text-automotive-steel",children:"Compliance risk matrix and mitigation"})]}),(0,t.jsxs)(a.motion.div,{className:"bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg p-6 text-center cursor-pointer",whileHover:{scale:1.05},transition:{duration:.2},children:[(0,t.jsx)("div",{className:"text-4xl mb-4",children:""}),(0,t.jsx)("h4",{className:"text-lg font-semibold text-automotive-carbon mb-2",children:"Certification Status"}),(0,t.jsx)("p",{className:"text-sm text-automotive-steel",children:"Certificate validity and renewal schedule"})]})]})]})]},e)]})})}},32028,e=>{"use strict";e.s(["default",()=>s]);var t=e.i(43476),n=e.i(71645),a=e.i(46932),r=e.i(56125);let i=[{id:"production",name:"Production Excellence",icon:"",color:"blue",metrics:[{id:"oee",name:"Overall Equipment Effectiveness (OEE)",value:87.5,target:85,unit:"%",category:"production",trend:"up",trendValue:2.3,status:"excellent",description:"Measures manufacturing productivity combining availability, performance, and quality",lastUpdated:"2024-01-15T10:30:00Z"},{id:"cycle-time",name:"Average Cycle Time",value:45.2,target:50,unit:"minutes",category:"production",trend:"down",trendValue:-1.8,status:"excellent",description:"Time required to complete one production cycle",lastUpdated:"2024-01-15T10:30:00Z"},{id:"throughput",name:"Production Throughput",value:1247,target:1200,unit:"units/day",category:"production",trend:"up",trendValue:3.9,status:"excellent",description:"Daily production output across all lines",lastUpdated:"2024-01-15T10:30:00Z"},{id:"downtime",name:"Unplanned Downtime",value:2.1,target:3,unit:"%",category:"production",trend:"down",trendValue:-.5,status:"good",description:"Percentage of time production lines are down unexpectedly",lastUpdated:"2024-01-15T10:30:00Z"}]},{id:"quality",name:"Quality Assurance",icon:"",color:"green",metrics:[{id:"first-pass-yield",name:"First Pass Yield",value:98.7,target:97,unit:"%",category:"quality",trend:"up",trendValue:.8,status:"excellent",description:"Percentage of products passing quality inspection on first attempt",lastUpdated:"2024-01-15T10:30:00Z"},{id:"defect-rate",name:"Defect Rate",value:.65,target:1,unit:"%",category:"quality",trend:"down",trendValue:-.15,status:"excellent",description:"Percentage of products with defects",lastUpdated:"2024-01-15T10:30:00Z"},{id:"customer-complaints",name:"Customer Complaints",value:1.8,target:3,unit:"per 1000",category:"quality",trend:"stable",trendValue:.1,status:"good",description:"Customer complaints per 1000 units shipped",lastUpdated:"2024-01-15T10:30:00Z"},{id:"warranty-claims",name:"Warranty Claims",value:.42,target:.5,unit:"%",category:"quality",trend:"down",trendValue:-.08,status:"excellent",description:"Percentage of products with warranty claims",lastUpdated:"2024-01-15T10:30:00Z"}]},{id:"delivery",name:"Delivery Performance",icon:"",color:"purple",metrics:[{id:"on-time-delivery",name:"On-Time Delivery",value:96.3,target:95,unit:"%",category:"delivery",trend:"up",trendValue:1.2,status:"excellent",description:"Percentage of orders delivered on or before promised date",lastUpdated:"2024-01-15T10:30:00Z"},{id:"lead-time",name:"Average Lead Time",value:12.5,target:14,unit:"days",category:"delivery",trend:"down",trendValue:-1.5,status:"excellent",description:"Average time from order to delivery",lastUpdated:"2024-01-15T10:30:00Z"},{id:"fill-rate",name:"Order Fill Rate",value:94.8,target:95,unit:"%",category:"delivery",trend:"stable",trendValue:-.2,status:"warning",description:"Percentage of orders fulfilled completely",lastUpdated:"2024-01-15T10:30:00Z"}]},{id:"cost",name:"Cost Management",icon:"",color:"yellow",metrics:[{id:"cost-per-unit",name:"Cost Per Unit",value:127.5,target:135,unit:"",category:"cost",trend:"down",trendValue:-5.6,status:"excellent",description:"Average manufacturing cost per unit",lastUpdated:"2024-01-15T10:30:00Z"},{id:"material-variance",name:"Material Cost Variance",value:2.3,target:5,unit:"%",category:"cost",trend:"up",trendValue:.8,status:"good",description:"Variance from standard material costs",lastUpdated:"2024-01-15T10:30:00Z"},{id:"labor-efficiency",name:"Labor Efficiency",value:92.1,target:90,unit:"%",category:"cost",trend:"up",trendValue:1.5,status:"excellent",description:"Actual vs. standard labor hours",lastUpdated:"2024-01-15T10:30:00Z"}]},{id:"safety",name:"Safety & Health",icon:"",color:"red",metrics:[{id:"ltir",name:"Lost Time Injury Rate",value:.8,target:1.5,unit:"per 200k hours",category:"safety",trend:"down",trendValue:-.3,status:"excellent",description:"Number of lost time injuries per 200,000 work hours",lastUpdated:"2024-01-15T10:30:00Z"},{id:"near-misses",name:"Near Miss Reports",value:45,target:40,unit:"per month",category:"safety",trend:"up",trendValue:12.5,status:"warning",description:"Number of near miss incidents reported monthly",lastUpdated:"2024-01-15T10:30:00Z"},{id:"safety-training",name:"Safety Training Completion",value:98.2,target:100,unit:"%",category:"safety",trend:"up",trendValue:2.1,status:"good",description:"Percentage of employees with current safety training",lastUpdated:"2024-01-15T10:30:00Z"}]},{id:"environmental",name:"Environmental Impact",icon:"",color:"emerald",metrics:[{id:"energy-consumption",name:"Energy Consumption",value:2.45,target:2.8,unit:"kWh/unit",category:"environmental",trend:"down",trendValue:-12.5,status:"excellent",description:"Energy consumption per unit produced",lastUpdated:"2024-01-15T10:30:00Z"},{id:"waste-reduction",name:"Waste Reduction",value:15.7,target:10,unit:"%",category:"environmental",trend:"up",trendValue:5.7,status:"excellent",description:"Percentage reduction in waste generation",lastUpdated:"2024-01-15T10:30:00Z"},{id:"carbon-footprint",name:"Carbon Footprint",value:1.85,target:2,unit:"kg CO2/unit",category:"environmental",trend:"down",trendValue:-7.5,status:"excellent",description:"Carbon emissions per unit produced",lastUpdated:"2024-01-15T10:30:00Z"}]}];function s(){let[e,s]=(0,n.useState)("production"),o=i.find(t=>t.id===e);return(0,t.jsx)("section",{className:"py-16 bg-gradient-to-br from-gray-50 to-blue-50",children:(0,t.jsxs)("div",{className:"container mx-auto px-4",children:[(0,t.jsxs)(a.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-12",children:[(0,t.jsx)("h2",{className:"text-4xl font-bold text-automotive-carbon mb-4",children:"Automotive KPI Monitoring"}),(0,t.jsx)("p",{className:"text-xl text-automotive-steel max-w-3xl mx-auto",children:"Comprehensive automotive industry key performance indicators with real-time monitoring and trend analysis"})]}),(0,t.jsx)("div",{className:"flex flex-wrap justify-center gap-4 mb-8",children:i.map(n=>(0,t.jsxs)("button",{onClick:()=>s(n.id),className:"px-6 py-3 rounded-lg font-medium transition-all duration-300 ".concat(e===n.id?"bg-gradient-to-r ".concat({blue:"from-blue-500 to-blue-600",green:"from-green-500 to-green-600",purple:"from-purple-500 to-purple-600",yellow:"from-yellow-500 to-yellow-600",red:"from-red-500 to-red-600",emerald:"from-emerald-500 to-emerald-600"}[n.color]||"from-gray-500 to-gray-600"," text-white shadow-lg"):"bg-white text-automotive-steel hover:bg-gray-50 shadow-md"),children:[(0,t.jsx)("span",{className:"mr-2",children:n.icon}),n.name]},n.id))}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:i.map(e=>{let n=e.metrics.reduce((e,t)=>e+t.value/t.target*100,0)/e.metrics.length;return(0,t.jsxs)(a.motion.div,{className:"bg-white rounded-lg p-6 shadow-lg border border-gray-200",whileHover:{scale:1.02},transition:{duration:.2},children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("span",{className:"text-2xl",children:e.icon}),(0,t.jsxs)("span",{className:"text-2xl font-bold ".concat(n>=100?"text-green-600":n>=90?"text-blue-600":n>=80?"text-yellow-600":"text-red-600"),children:[n.toFixed(0),"%"]})]}),(0,t.jsx)("h3",{className:"font-semibold text-automotive-carbon mb-2",children:e.name}),(0,t.jsxs)("div",{className:"text-sm text-automotive-steel",children:[e.metrics.length," metrics tracked"]})]},e.id)})}),o&&(0,t.jsxs)(a.motion.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.4},className:"bg-white rounded-xl shadow-xl p-8",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("span",{className:"text-3xl mr-3",children:o.icon}),(0,t.jsx)("h3",{className:"text-2xl font-semibold text-automotive-carbon",children:o.name})]}),(0,t.jsx)("button",{className:"bg-primary-500 text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors",children:"Export Data"})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:o.metrics.map(e=>(0,t.jsxs)(a.motion.div,{className:"bg-gradient-to-r from-white to-gray-50 rounded-lg p-6 border border-gray-200 cursor-pointer",whileHover:{scale:1.03},transition:{duration:.2},onClick:()=>{},children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-automotive-carbon",children:e.name}),(0,t.jsx)("span",{className:"text-xl",children:(e=>{switch(e){case"up":return"";case"down":return"";default:return""}})(e.trend)})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-baseline justify-between",children:[(0,t.jsxs)("div",{className:"flex items-baseline",children:[(0,t.jsx)(r.default,{end:e.value,decimals:"%"===e.unit||e.unit.includes("per")?1:2,className:"text-3xl font-bold text-automotive-carbon"}),(0,t.jsx)("span",{className:"text-lg text-automotive-steel ml-1",children:e.unit})]}),(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat((e=>{switch(e){case"excellent":return"bg-green-100 text-green-800 border-green-200";case"good":return"bg-blue-100 text-blue-800 border-blue-200";case"warning":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"critical":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(e.status)),children:e.status.toUpperCase()})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsxs)("span",{className:"text-automotive-steel",children:["Target: ",e.target,e.unit]}),(0,t.jsxs)("span",{className:"font-medium ".concat("up"===e.trend?"text-green-600":"down"===e.trend?"text-red-600":"text-gray-600"),children:["up"===e.trend?"+":"down"===e.trend?"":"",e.trendValue.toFixed(1),"%"]})]}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,t.jsx)("div",{className:"h-2 rounded-full transition-all duration-300 ".concat("excellent"===e.status?"bg-green-500":"good"===e.status?"bg-blue-500":"warning"===e.status?"bg-yellow-500":"bg-red-500"),style:{width:"".concat(Math.min(e.value/e.target*100,100),"%")}})}),(0,t.jsx)("p",{className:"text-xs text-automotive-steel",children:e.description})]})]},e.id))})]},e),(0,t.jsxs)(a.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"mt-8 bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl p-8 text-center",children:[(0,t.jsx)("div",{className:"text-6xl mb-4",children:""}),(0,t.jsx)("h4",{className:"text-2xl font-semibold text-automotive-carbon mb-4",children:"Advanced KPI Analytics"}),(0,t.jsx)("p",{className:"text-automotive-steel mb-6 max-w-2xl mx-auto",children:"Interactive dashboards with predictive analytics, benchmarking against industry standards, and automated alerting for critical KPI deviations"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow-md",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:"24/7"}),(0,t.jsx)("div",{className:"text-sm text-automotive-steel",children:"Real-time Monitoring"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow-md",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-green-600",children:"95%"}),(0,t.jsx)("div",{className:"text-sm text-automotive-steel",children:"Prediction Accuracy"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow-md",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:"50+"}),(0,t.jsx)("div",{className:"text-sm text-automotive-steel",children:"KPIs Tracked"})]})]})]})]})})}},31549,e=>{"use strict";e.s(["default",()=>s]);var t=e.i(43476),n=e.i(71645),a=e.i(46932);let r=[{id:"prod-line-1",name:"Production Line 1 - Engine Assembly",type:"production",position:{x:-20,y:0,z:0},dimensions:{width:15,height:5,depth:8},status:"active",utilization:85,capacity:100},{id:"prod-line-2",name:"Production Line 2 - Transmission",type:"production",position:{x:0,y:0,z:0},dimensions:{width:12,height:5,depth:6},status:"active",utilization:72,capacity:80},{id:"quality-station",name:"Quality Control Station",type:"quality",position:{x:20,y:0,z:0},dimensions:{width:8,height:4,depth:6},status:"active",utilization:95,capacity:100},{id:"warehouse-1",name:"Raw Materials Warehouse",type:"warehouse",position:{x:-10,y:0,z:-15},dimensions:{width:20,height:8,depth:10},status:"active",utilization:68,capacity:1e3},{id:"warehouse-2",name:"Finished Goods Warehouse",type:"warehouse",position:{x:10,y:0,z:15},dimensions:{width:18,height:8,depth:12},status:"active",utilization:45,capacity:800},{id:"office-1",name:"Administrative Office",type:"office",position:{x:-25,y:0,z:15},dimensions:{width:10,height:6,depth:8},status:"active",utilization:60,capacity:50}],i=[{id:"step-1",name:"Material Transfer to Production",fromFacility:"warehouse-1",toFacility:"prod-line-1",duration:15,status:"active",progress:65},{id:"step-2",name:"Engine to Transmission Assembly",fromFacility:"prod-line-1",toFacility:"prod-line-2",duration:30,status:"active",progress:40},{id:"step-3",name:"Quality Inspection",fromFacility:"prod-line-2",toFacility:"quality-station",duration:20,status:"pending",progress:0},{id:"step-4",name:"Finished Goods Storage",fromFacility:"quality-station",toFacility:"warehouse-2",duration:10,status:"completed",progress:100}];function s(){let[e,s]=(0,n.useState)("overview"),[o,l]=(0,n.useState)(!0);return(0,t.jsx)("section",{className:"py-16 bg-gradient-to-br from-slate-50 to-indigo-50",children:(0,t.jsxs)("div",{className:"container mx-auto px-4",children:[(0,t.jsxs)(a.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-12",children:[(0,t.jsx)("h2",{className:"text-4xl font-bold text-automotive-carbon mb-4",children:"3D Facility Visualization"}),(0,t.jsx)("p",{className:"text-xl text-automotive-steel max-w-3xl mx-auto",children:"Interactive 3D visualization of automotive manufacturing facilities with real-time workflow animation and performance monitoring"})]}),(0,t.jsx)("div",{className:"flex justify-center mb-8",children:(0,t.jsx)("div",{className:"bg-white rounded-lg p-1 shadow-lg",children:[{id:"overview",label:"Facility Overview",icon:""},{id:"production",label:"Production Lines",icon:""},{id:"warehouse",label:"Warehouses",icon:""},{id:"workflow",label:"Workflow Animation",icon:""}].map(n=>(0,t.jsxs)("button",{onClick:()=>s(n.id),className:"px-6 py-3 rounded-md font-medium transition-all duration-300 ".concat(e===n.id?"bg-primary-500 text-white shadow-md":"text-automotive-steel hover:bg-gray-50"),children:[(0,t.jsx)("span",{className:"mr-2",children:n.icon}),n.label]},n.id))})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[(0,t.jsx)("div",{className:"lg:col-span-3",children:(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-xl overflow-hidden",children:[(0,t.jsxs)("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-automotive-carbon",children:"Interactive 3D Factory Layout"}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("button",{onClick:()=>l(!o),className:"px-4 py-2 rounded-lg font-medium transition-colors ".concat(o?"bg-red-500 text-white hover:bg-red-600":"bg-green-500 text-white hover:bg-green-600"),children:o?"Stop Animation":"Start Animation"}),(0,t.jsx)("button",{className:"bg-primary-500 text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors",children:"Reset View"})]})]}),(0,t.jsx)("div",{className:"w-full h-96 lg:h-[600px] bg-gradient-to-br from-slate-100 to-blue-100 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-6xl mb-4",children:""}),(0,t.jsx)("h4",{className:"text-2xl font-bold text-automotive-carbon mb-2",children:"3D Factory Visualization"}),(0,t.jsx)("p",{className:"text-automotive-steel mb-4",children:"Interactive WebGL-based facility layout with real-time monitoring"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 max-w-md mx-auto",children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg p-3 shadow",children:[(0,t.jsx)("div",{className:"text-2xl mb-1",children:""}),(0,t.jsx)("div",{className:"text-sm font-medium",children:"Production Lines"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg p-3 shadow",children:[(0,t.jsx)("div",{className:"text-2xl mb-1",children:""}),(0,t.jsx)("div",{className:"text-sm font-medium",children:"Warehouses"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg p-3 shadow",children:[(0,t.jsx)("div",{className:"text-2xl mb-1",children:""}),(0,t.jsx)("div",{className:"text-sm font-medium",children:"Quality Control"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg p-3 shadow",children:[(0,t.jsx)("div",{className:"text-2xl mb-1",children:""}),(0,t.jsx)("div",{className:"text-sm font-medium",children:"Administration"})]})]})]})})]})}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-xl p-6",children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-automotive-carbon mb-4",children:"Facility Status"}),(0,t.jsx)("div",{className:"space-y-4",children:r.slice(0,4).map(e=>(0,t.jsxs)(a.motion.div,{className:"p-3 rounded-lg border border-gray-200 cursor-pointer hover:bg-gray-50",whileHover:{scale:1.02},onClick:()=>console.log("Selected facility:",e.name),children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,t.jsx)("h5",{className:"font-medium text-automotive-carbon text-sm",children:e.name}),(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat((e=>{switch(e){case"active":return"bg-green-100 text-green-800 border-green-200";case"maintenance":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"idle":default:return"bg-gray-100 text-gray-800 border-gray-200";case"offline":return"bg-red-100 text-red-800 border-red-200"}})(e.status)),children:e.status.toUpperCase()})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-automotive-steel",children:"Utilization:"}),(0,t.jsxs)("span",{className:"font-medium",children:[e.utilization,"%"]})]}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:(0,t.jsx)("div",{className:"bg-primary-500 h-2 rounded-full transition-all duration-300",style:{width:"".concat(e.utilization,"%")}})})]},e.id))})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-xl p-6",children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-automotive-carbon mb-4",children:"Active Workflows"}),(0,t.jsx)("div",{className:"space-y-3",children:i.map(e=>(0,t.jsxs)("div",{className:"p-3 rounded-lg bg-gray-50",children:[(0,t.jsx)("div",{className:"text-sm font-medium text-automotive-carbon mb-1",children:e.name}),(0,t.jsxs)("div",{className:"text-xs text-automotive-steel mb-2",children:[e.duration," min duration"]}),(0,t.jsxs)("div",{className:"flex justify-between text-xs mb-1",children:[(0,t.jsx)("span",{className:"text-automotive-steel",children:"Progress:"}),(0,t.jsxs)("span",{className:"font-medium",children:[e.progress,"%"]})]}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-1",children:(0,t.jsx)("div",{className:"h-1 rounded-full transition-all duration-300 ".concat("active"===e.status?"bg-blue-500":"completed"===e.status?"bg-green-500":"bg-gray-400"),style:{width:"".concat(e.progress,"%")}})})]},e.id))})]}),(0,t.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl p-6 text-center",children:[(0,t.jsx)("div",{className:"text-3xl mb-2",children:""}),(0,t.jsx)("h4",{className:"font-semibold text-automotive-carbon mb-2",children:"Interactive Controls"}),(0,t.jsx)("p",{className:"text-sm text-automotive-steel",children:"Click and drag to rotate  Scroll to zoom  Click facilities for details"})]})]})]})]})})}},50022,e=>{"use strict";e.s(["default",()=>s]);var t=e.i(43476),n=e.i(71645),a=e.i(46932);let r=[{id:"material-intake",name:"Material Intake",description:"Raw materials received and inspected",duration:15,status:"completed",progress:100,position:{x:-30,y:0,z:0},connections:["pre-processing"]},{id:"pre-processing",name:"Pre-Processing",description:"Material preparation and sorting",duration:20,status:"completed",progress:100,position:{x:-15,y:0,z:0},connections:["machining","assembly-prep"]},{id:"machining",name:"CNC Machining",description:"Precision machining operations",duration:45,status:"active",progress:65,position:{x:0,y:0,z:-15},connections:["quality-check-1"]},{id:"assembly-prep",name:"Assembly Preparation",description:"Component preparation for assembly",duration:25,status:"active",progress:40,position:{x:0,y:0,z:15},connections:["final-assembly"]},{id:"quality-check-1",name:"Quality Check 1",description:"Initial quality inspection",duration:15,status:"pending",progress:0,position:{x:15,y:0,z:-15},connections:["final-assembly"]},{id:"final-assembly",name:"Final Assembly",description:"Complete product assembly",duration:35,status:"pending",progress:0,position:{x:30,y:0,z:0},connections:["final-inspection"]},{id:"final-inspection",name:"Final Inspection",description:"Comprehensive quality validation",duration:20,status:"pending",progress:0,position:{x:45,y:0,z:0},connections:[]}],i=e=>{switch(e){case"completed":return"bg-green-100 text-green-800 border-green-200";case"active":return"bg-blue-100 text-blue-800 border-blue-200";case"pending":default:return"bg-gray-100 text-gray-800 border-gray-200";case"blocked":return"bg-red-100 text-red-800 border-red-200"}};function s(){let[e,s]=(0,n.useState)(null),[o,l]=(0,n.useState)({speed:1,showPaths:!0,showLabels:!0,autoRotate:!0}),[c,u]=(0,n.useState)(!0);return(0,t.jsx)("section",{className:"py-16 bg-gradient-to-br from-slate-900 to-blue-900",children:(0,t.jsxs)("div",{className:"container mx-auto px-4",children:[(0,t.jsxs)(a.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-12",children:[(0,t.jsx)("h2",{className:"text-4xl font-bold text-white mb-4",children:"Manufacturing Workflow Animation"}),(0,t.jsx)("p",{className:"text-xl text-blue-100 max-w-3xl mx-auto",children:"Real-time 3D visualization of production processes with interactive workflow control"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[(0,t.jsx)("div",{className:"lg:col-span-2",children:(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-xl overflow-hidden",children:[(0,t.jsxs)("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-automotive-carbon",children:"3D Workflow Animation"}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("button",{onClick:()=>u(!c),className:"px-4 py-2 rounded-lg font-medium transition-colors ".concat(c?"bg-red-500 text-white hover:bg-red-600":"bg-green-500 text-white hover:bg-green-600"),children:c?"Pause":"Play"}),(0,t.jsx)("button",{className:"bg-primary-500 text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors",children:"Reset"})]})]}),(0,t.jsx)("div",{className:"w-full h-96 lg:h-[500px] bg-gradient-to-br from-indigo-100 to-purple-100 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-6xl mb-4",children:""}),(0,t.jsx)("h4",{className:"text-2xl font-bold text-automotive-carbon mb-2",children:"Manufacturing Workflow Animation"}),(0,t.jsx)("p",{className:"text-automotive-steel mb-4",children:"Real-time 3D visualization of production processes"}),(0,t.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg p-3 shadow",children:[(0,t.jsx)("div",{className:"text-lg font-semibold text-green-600",children:"2 Active"}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Processes"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg p-3 shadow",children:[(0,t.jsx)("div",{className:"text-lg font-semibold text-blue-600",children:"65%"}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Progress"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg p-3 shadow",children:[(0,t.jsx)("div",{className:"text-lg font-semibold text-purple-600",children:"7"}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Steps"})]})]})]})})]})}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-xl p-6",children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-automotive-carbon mb-4",children:"Animation Controls"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-automotive-steel mb-2",children:"Animation Speed"}),(0,t.jsx)("input",{type:"range",min:"0.25",max:"4",step:"0.25",value:o.speed,onChange:e=>l({...o,speed:parseFloat(e.target.value)}),className:"w-full"}),(0,t.jsxs)("div",{className:"text-sm text-automotive-steel mt-1",children:[o.speed,"x"]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("label",{className:"flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",checked:o.showPaths,onChange:e=>l({...o,showPaths:e.target.checked}),className:"mr-2"}),(0,t.jsx)("span",{className:"text-sm text-automotive-steel",children:"Show Workflow Paths"})]}),(0,t.jsxs)("label",{className:"flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",checked:o.showLabels,onChange:e=>l({...o,showLabels:e.target.checked}),className:"mr-2"}),(0,t.jsx)("span",{className:"text-sm text-automotive-steel",children:"Show Step Labels"})]}),(0,t.jsxs)("label",{className:"flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",checked:o.autoRotate,onChange:e=>l({...o,autoRotate:e.target.checked}),className:"mr-2"}),(0,t.jsx)("span",{className:"text-sm text-automotive-steel",children:"Auto Rotate Camera"})]})]})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-xl p-6",children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-automotive-carbon mb-4",children:"Workflow Steps"}),(0,t.jsx)("div",{className:"space-y-3",children:r.map(n=>(0,t.jsxs)(a.motion.div,{className:"p-3 rounded-lg border cursor-pointer transition-colors ".concat((null==e?void 0:e.id)===n.id?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300"),onClick:()=>s(n),whileHover:{scale:1.02},whileTap:{scale:.98},children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,t.jsx)("h5",{className:"font-medium text-automotive-carbon",children:n.name}),(0,t.jsx)("span",{className:"px-2 py-1 text-xs rounded-full border ".concat(i(n.status)),children:n.status})]}),(0,t.jsx)("p",{className:"text-sm text-automotive-steel mb-2",children:n.description}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("span",{className:"text-xs text-automotive-steel",children:["Duration: ",n.duration,"min"]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:(0,t.jsx)("div",{className:"bg-primary-500 h-2 rounded-full transition-all duration-300",style:{width:"".concat(n.progress,"%")}})}),(0,t.jsxs)("span",{className:"text-xs text-automotive-steel",children:[n.progress,"%"]})]})]})]},n.id))})]}),e&&(0,t.jsxs)(a.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl shadow-xl p-6",children:[(0,t.jsxs)("h4",{className:"text-lg font-semibold text-automotive-carbon mb-4",children:["Step Details: ",e.name]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm font-medium text-automotive-steel",children:"Status:"}),(0,t.jsx)("span",{className:"ml-2 px-2 py-1 text-xs rounded-full border ".concat(i(e.status)),children:e.status})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm font-medium text-automotive-steel",children:"Progress:"}),(0,t.jsxs)("span",{className:"ml-2 text-sm text-automotive-carbon",children:[e.progress,"%"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm font-medium text-automotive-steel",children:"Duration:"}),(0,t.jsxs)("span",{className:"ml-2 text-sm text-automotive-carbon",children:[e.duration," minutes"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm font-medium text-automotive-steel",children:"Position:"}),(0,t.jsxs)("span",{className:"ml-2 text-sm text-automotive-carbon",children:["X: ",e.position.x,", Y: ",e.position.y,", Z: ",e.position.z]})]}),e.connections.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm font-medium text-automotive-steel",children:"Connections:"}),(0,t.jsx)("div",{className:"mt-1 space-y-1",children:e.connections.map(e=>{let n=r.find(t=>t.id===e);return n?(0,t.jsxs)("div",{className:"text-sm text-automotive-carbon ml-2",children:[" ",n.name]},e):null})})]})]})]})]})]})]})})}},37554,e=>{"use strict";e.s(["default",()=>i]);var t=e.i(43476),n=e.i(71645),a=e.i(46932);let r=[{id:"fps",name:"Frame Rate",category:"rendering",value:58,target:60,unit:"fps",status:"optimal",trend:"stable"},{id:"gpu-usage",name:"GPU Utilization",category:"gpu",value:72,target:80,unit:"%",status:"optimal",trend:"up"},{id:"memory",name:"Memory Usage",category:"memory",value:245,target:512,unit:"MB",status:"optimal",trend:"stable"},{id:"draw-calls",name:"Draw Calls",category:"rendering",value:156,target:200,unit:"calls",status:"optimal",trend:"down"}];function i(){let[e,i]=(0,n.useState)(r),[s,o]=(0,n.useState)(2),[l,c]=(0,n.useState)(!0),[u,h]=(0,n.useState)(!0);return(0,n.useEffect)(()=>{let e=setInterval(()=>{i(e=>e.map(e=>({...e,value:e.value+(Math.random()-.5)*5})))},2e3);return()=>clearInterval(e)},[]),(0,t.jsx)("section",{className:"py-16 bg-gradient-to-br from-slate-900 to-indigo-900",children:(0,t.jsxs)("div",{className:"container mx-auto px-4",children:[(0,t.jsxs)(a.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center mb-12",children:[(0,t.jsx)("h2",{className:"text-4xl font-bold text-white mb-4",children:"3D Performance Optimization"}),(0,t.jsx)("p",{className:"text-xl text-blue-100 max-w-3xl mx-auto",children:"Real-time performance monitoring and GPU optimization for complex 3D automotive visualizations"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,t.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,t.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-white mb-6",children:"Performance Metrics"}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.map(e=>(0,t.jsxs)(a.motion.div,{className:"bg-slate-700 rounded-lg p-4",whileHover:{scale:1.02},children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,t.jsx)("h4",{className:"font-medium text-white",children:e.name}),(0,t.jsx)("span",{className:"px-2 py-1 rounded text-xs ".concat((e=>{switch(e){case"optimal":return"text-green-400 bg-green-900/20";case"warning":return"text-yellow-400 bg-yellow-900/20";case"critical":return"text-red-400 bg-red-900/20";default:return"text-gray-400 bg-gray-900/20"}})(e.status)),children:e.status})]}),(0,t.jsxs)("div",{className:"flex items-end space-x-2 mb-2",children:[(0,t.jsx)("span",{className:"text-2xl font-bold text-blue-400",children:Math.round(e.value)}),(0,t.jsx)("span",{className:"text-sm text-slate-300",children:e.unit}),(0,t.jsxs)("span",{className:"text-xs text-slate-400",children:["/ ",e.target," ",e.unit]})]}),(0,t.jsx)("div",{className:"w-full bg-slate-600 rounded-full h-2",children:(0,t.jsx)("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:"".concat(Math.min(e.value/e.target*100,100),"%")}})})]},e.id))})]}),(0,t.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-white mb-6",children:"Optimization Techniques"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h4",{className:"font-medium text-blue-400",children:"Level of Detail (LOD)"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-slate-300",children:"Detail Level"}),(0,t.jsxs)("span",{className:"text-white",children:[s,"/5"]})]}),(0,t.jsx)("input",{type:"range",min:"1",max:"5",value:s,onChange:e=>o(parseInt(e.target.value)),className:"w-full"}),(0,t.jsx)("p",{className:"text-xs text-slate-400",children:"Higher levels show more detail but reduce performance"})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h4",{className:"font-medium text-blue-400",children:"Rendering Options"}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("label",{className:"flex items-center space-x-3",children:[(0,t.jsx)("input",{type:"checkbox",checked:l,onChange:e=>c(e.target.checked),className:"rounded"}),(0,t.jsx)("span",{className:"text-slate-300",children:"Enable Shadows"})]}),(0,t.jsxs)("label",{className:"flex items-center space-x-3",children:[(0,t.jsx)("input",{type:"checkbox",checked:u,onChange:e=>h(e.target.checked),className:"rounded"}),(0,t.jsx)("span",{className:"text-slate-300",children:"Anti-aliasing"})]})]})]})]})]})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6",children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-white mb-4",children:"Auto-Optimization"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("button",{className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors",children:"Optimize for Performance"}),(0,t.jsx)("button",{className:"w-full bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition-colors",children:"Optimize for Quality"}),(0,t.jsx)("button",{className:"w-full bg-purple-600 text-white py-2 px-4 rounded-lg hover:bg-purple-700 transition-colors",children:"Balanced Mode"})]})]}),(0,t.jsxs)("div",{className:"bg-slate-800 rounded-xl p-6",children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-white mb-4",children:"System Info"}),(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-slate-300",children:"GPU:"}),(0,t.jsx)("span",{className:"text-white",children:"RTX 4080"})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-slate-300",children:"VRAM:"}),(0,t.jsx)("span",{className:"text-white",children:"16GB"})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-slate-300",children:"WebGL:"}),(0,t.jsx)("span",{className:"text-green-400",children:"2.0"})]})]})]})]})]})]})})}},98666,e=>{"use strict";e.s(["default",()=>o]);var t=e.i(43476),n=e.i(71645),a=e.i(46932);let r=[{id:"ds-001",name:"John Mueller",email:"j.mueller@automotive-corp.de",consentStatus:"granted",dataCategories:["Personal Data","Professional Data","Communication Preferences"],lastActivity:"2024-01-15",retentionPeriod:"7 years",requests:[{id:"req-001",type:"access",status:"completed",requestDate:"2024-01-10",completionDate:"2024-01-12",description:"Request for personal data access under Article 15 GDPR"}]},{id:"ds-002",name:"Marie Dubois",email:"m.dubois@supply-chain.fr",consentStatus:"pending",dataCategories:["Personal Data","Business Data"],lastActivity:"2024-01-14",retentionPeriod:"5 years",requests:[{id:"req-002",type:"portability",status:"processing",requestDate:"2024-01-13",description:"Data portability request under Article 20 GDPR"}]},{id:"ds-003",name:"Hans Schmidt",email:"h.schmidt@quality-systems.de",consentStatus:"withdrawn",dataCategories:["Personal Data"],lastActivity:"2024-01-12",retentionPeriod:"3 years",requests:[{id:"req-003",type:"erasure",status:"pending",requestDate:"2024-01-14",description:"Right to be forgotten request under Article 17 GDPR"}]}],i=[{id:"consent-001",purpose:"Marketing Communications",legalBasis:"consent",status:"active",grantedDate:"2023-06-15",expiryDate:"2025-06-15"},{id:"consent-002",purpose:"Data Processing for Service Delivery",legalBasis:"contract",status:"active",grantedDate:"2023-08-20"},{id:"consent-003",purpose:"Analytics and Performance Monitoring",legalBasis:"legitimate_interests",status:"withdrawn",grantedDate:"2023-05-10",withdrawnDate:"2024-01-05"}],s=e=>{switch(e){case"granted":case"active":case"completed":return"bg-green-100 text-green-800 border-green-200";case"pending":case"processing":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"withdrawn":case"rejected":case"expired":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};function o(){let[e,o]=(0,n.useState)("subjects"),l=[{id:"subjects",label:"Data Subjects",icon:"",count:r.length},{id:"requests",label:"Data Requests",icon:"",count:r.reduce((e,t)=>e+t.requests.length,0)},{id:"consent",label:"Consent Management",icon:"",count:i.length},{id:"reports",label:"Compliance Reports",icon:"",count:5}];return(0,t.jsx)("section",{className:"py-16 bg-gradient-to-br from-blue-50 to-indigo-50",children:(0,t.jsxs)("div",{className:"container mx-auto px-4",children:[(0,t.jsxs)(a.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-12",children:[(0,t.jsx)("h2",{className:"text-4xl font-bold text-automotive-carbon mb-4",children:"GDPR Compliance Management"}),(0,t.jsx)("p",{className:"text-xl text-automotive-steel max-w-3xl mx-auto",children:"Comprehensive data protection and privacy compliance system for EU automotive operations"})]}),(0,t.jsx)("div",{className:"flex justify-center mb-8",children:(0,t.jsx)("div",{className:"bg-white rounded-lg p-1 shadow-lg",children:l.map(n=>(0,t.jsxs)("button",{onClick:()=>o(n.id),className:"px-6 py-3 rounded-md font-medium transition-all duration-300 ".concat(e===n.id?"bg-primary-500 text-white shadow-md":"text-automotive-steel hover:bg-gray-50"),children:[(0,t.jsx)("span",{className:"mr-2",children:n.icon}),n.label,(0,t.jsx)("span",{className:"ml-2 px-2 py-1 bg-gray-200 text-gray-700 rounded-full text-xs",children:n.count})]},n.id))})}),(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-xl overflow-hidden",children:["subjects"===e&&(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-automotive-carbon",children:"Data Subjects Registry"}),(0,t.jsx)("button",{className:"bg-primary-500 text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors",children:"Add New Subject"})]}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-gray-200",children:[(0,t.jsx)("th",{className:"text-left py-3 px-4 font-medium text-automotive-carbon",children:"Name"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-medium text-automotive-carbon",children:"Email"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-medium text-automotive-carbon",children:"Consent Status"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-medium text-automotive-carbon",children:"Data Categories"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-medium text-automotive-carbon",children:"Last Activity"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-medium text-automotive-carbon",children:"Actions"})]})}),(0,t.jsx)("tbody",{children:r.map(e=>(0,t.jsxs)(a.motion.tr,{className:"border-b border-gray-100 hover:bg-gray-50",whileHover:{backgroundColor:"#f9fafb"},children:[(0,t.jsx)("td",{className:"py-3 px-4 font-medium text-automotive-carbon",children:e.name}),(0,t.jsx)("td",{className:"py-3 px-4 text-automotive-steel",children:e.email}),(0,t.jsx)("td",{className:"py-3 px-4",children:(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat(s(e.consentStatus)),children:e.consentStatus.toUpperCase()})}),(0,t.jsx)("td",{className:"py-3 px-4",children:(0,t.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.dataCategories.slice(0,2).map(e=>(0,t.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs",children:e},e)),e.dataCategories.length>2&&(0,t.jsxs)("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 rounded text-xs",children:["+",e.dataCategories.length-2]})]})}),(0,t.jsx)("td",{className:"py-3 px-4 text-automotive-steel",children:e.lastActivity}),(0,t.jsx)("td",{className:"py-3 px-4",children:(0,t.jsx)("button",{onClick:()=>console.log("Selected subject:",e.name),className:"text-primary-500 hover:text-primary-600 font-medium",children:"View Details"})})]},e.id))})]})})]}),"requests"===e&&(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-automotive-carbon",children:"Data Subject Requests"}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsxs)("select",{className:"border border-gray-300 rounded-lg px-3 py-2",children:[(0,t.jsx)("option",{children:"All Requests"}),(0,t.jsx)("option",{children:"Pending"}),(0,t.jsx)("option",{children:"Processing"}),(0,t.jsx)("option",{children:"Completed"})]}),(0,t.jsx)("button",{className:"bg-primary-500 text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors",children:"New Request"})]})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.flatMap(e=>e.requests.map(n=>(0,t.jsxs)(a.motion.div,{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",whileHover:{scale:1.02},children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,t.jsxs)("h4",{className:"font-medium text-automotive-carbon capitalize",children:[n.type.replace("_"," ")," Request"]}),(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat(s(n.status)),children:n.status.toUpperCase()})]}),(0,t.jsx)("p",{className:"text-sm text-automotive-steel mb-3",children:n.description}),(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:[(0,t.jsxs)("div",{children:["Requested: ",n.requestDate]}),n.completionDate&&(0,t.jsxs)("div",{children:["Completed: ",n.completionDate]})]}),(0,t.jsx)("div",{className:"mt-3 pt-3 border-t border-gray-200",children:(0,t.jsxs)("span",{className:"text-xs text-gray-600",children:["Subject: ",e.name]})})]},n.id)))})]}),"consent"===e&&(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-automotive-carbon",children:"Consent Records"}),(0,t.jsx)("button",{className:"bg-primary-500 text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors",children:"Record Consent"})]}),(0,t.jsx)("div",{className:"space-y-4",children:i.map(e=>{var n;return(0,t.jsxs)(a.motion.div,{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",whileHover:{backgroundColor:"#f3f4f6"},children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-automotive-carbon",children:e.purpose}),(0,t.jsx)("p",{className:"text-sm text-automotive-steel",children:{consent:"Consent (Art. 6(1)(a))",contract:"Contract (Art. 6(1)(b))",legal_obligation:"Legal Obligation (Art. 6(1)(c))",vital_interests:"Vital Interests (Art. 6(1)(d))",public_task:"Public Task (Art. 6(1)(e))",legitimate_interests:"Legitimate Interests (Art. 6(1)(f))"}[n=e.legalBasis]||n})]}),(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat(s(e.status)),children:e.status.toUpperCase()})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-500",children:"Granted:"}),(0,t.jsx)("div",{className:"font-medium",children:e.grantedDate})]}),e.expiryDate&&(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-500",children:"Expires:"}),(0,t.jsx)("div",{className:"font-medium",children:e.expiryDate})]}),e.withdrawnDate&&(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-500",children:"Withdrawn:"}),(0,t.jsx)("div",{className:"font-medium",children:e.withdrawnDate})]}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("button",{className:"text-primary-500 hover:text-primary-600 text-sm",children:"Edit"}),(0,t.jsx)("button",{className:"text-red-500 hover:text-red-600 text-sm",children:"Withdraw"})]})]})]},e.id)})})]}),"reports"===e&&(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-automotive-carbon mb-6",children:"Compliance Reports"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[(0,t.jsxs)(a.motion.div,{className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg p-6 text-white",whileHover:{scale:1.05},children:[(0,t.jsx)("h4",{className:"text-lg font-semibold mb-2",children:"Data Subject Rights"}),(0,t.jsx)("div",{className:"text-3xl font-bold mb-2",children:"98.5%"}),(0,t.jsx)("p",{className:"text-blue-100",children:"Requests processed within 30 days"})]}),(0,t.jsxs)(a.motion.div,{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-lg p-6 text-white",whileHover:{scale:1.05},children:[(0,t.jsx)("h4",{className:"text-lg font-semibold mb-2",children:"Consent Rate"}),(0,t.jsx)("div",{className:"text-3xl font-bold mb-2",children:"87.2%"}),(0,t.jsx)("p",{className:"text-green-100",children:"Active consent records"})]}),(0,t.jsxs)(a.motion.div,{className:"bg-gradient-to-r from-purple-500 to-purple-600 rounded-lg p-6 text-white",whileHover:{scale:1.05},children:[(0,t.jsx)("h4",{className:"text-lg font-semibold mb-2",children:"Data Breaches"}),(0,t.jsx)("div",{className:"text-3xl font-bold mb-2",children:"0"}),(0,t.jsx)("p",{className:"text-purple-100",children:"Reported in last 12 months"})]})]}),(0,t.jsxs)("div",{className:"mt-8",children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-automotive-carbon mb-4",children:"Generate Reports"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("button",{className:"bg-white border border-gray-300 rounded-lg p-4 text-left hover:bg-gray-50 transition-colors",children:[(0,t.jsx)("h5",{className:"font-medium text-automotive-carbon",children:"Monthly Compliance Report"}),(0,t.jsx)("p",{className:"text-sm text-automotive-steel",children:"Comprehensive GDPR compliance status"})]}),(0,t.jsxs)("button",{className:"bg-white border border-gray-300 rounded-lg p-4 text-left hover:bg-gray-50 transition-colors",children:[(0,t.jsx)("h5",{className:"font-medium text-automotive-carbon",children:"Data Processing Activities"}),(0,t.jsx)("p",{className:"text-sm text-automotive-steel",children:"Article 30 GDPR record of processing"})]}),(0,t.jsxs)("button",{className:"bg-white border border-gray-300 rounded-lg p-4 text-left hover:bg-gray-50 transition-colors",children:[(0,t.jsx)("h5",{className:"font-medium text-automotive-carbon",children:"Consent Audit Trail"}),(0,t.jsx)("p",{className:"text-sm text-automotive-steel",children:"Complete consent history and changes"})]}),(0,t.jsxs)("button",{className:"bg-white border border-gray-300 rounded-lg p-4 text-left hover:bg-gray-50 transition-colors",children:[(0,t.jsx)("h5",{className:"font-medium text-automotive-carbon",children:"Data Subject Requests Log"}),(0,t.jsx)("p",{className:"text-sm text-automotive-steel",children:"All requests and response times"})]})]})]})]})]})]})})}},54979,e=>{"use strict";e.s(["default",()=>o]);var t=e.i(43476),n=e.i(71645),a=e.i(46932);let r=[{id:"essential",category:"Essential",name:"Essential Cookies & Data",description:"Required for basic website functionality and security",enabled:!0,required:!0,dataTypes:["Session Data","Security Tokens","Authentication"],retentionPeriod:"Session"},{id:"analytics",category:"Analytics",name:"Analytics & Performance",description:"Help us improve our services by analyzing usage patterns",enabled:!0,required:!1,dataTypes:["Usage Statistics","Performance Metrics","Error Logs"],retentionPeriod:"2 years"},{id:"marketing",category:"Marketing",name:"Marketing Communications",description:"Receive updates about our products and services",enabled:!1,required:!1,dataTypes:["Email Address","Communication Preferences","Interaction History"],retentionPeriod:"3 years"},{id:"personalization",category:"Personalization",name:"Content Personalization",description:"Customize content and recommendations based on your preferences",enabled:!0,required:!1,dataTypes:["Preferences","Browsing History","Content Interactions"],retentionPeriod:"1 year"}],i=[{id:"service-delivery",purpose:"Service Delivery",description:"Process your data to provide our automotive supply chain services",consented:!0,mandatory:!0,lastUpdated:"2024-01-15"},{id:"quality-improvement",purpose:"Quality Improvement",description:"Use your feedback and usage data to improve our services",consented:!0,mandatory:!1,lastUpdated:"2024-01-10",expiryDate:"2025-01-10"},{id:"research-development",purpose:"Research & Development",description:"Analyze aggregated data for automotive industry research",consented:!1,mandatory:!1,lastUpdated:"2024-01-05",expiryDate:"2025-01-05"}],s=[{id:"export-001",requestType:"export",status:"ready",requestDate:"2024-01-10",completionDate:"2024-01-12",dataCategories:["Personal Data","Usage History","Preferences"],format:"json",size:"2.4 MB"},{id:"delete-001",requestType:"delete",status:"processing",requestDate:"2024-01-14",dataCategories:["Marketing Data","Communication History"],format:"json"}];function o(){let[e,o]=(0,n.useState)("settings"),[l,c]=(0,n.useState)(r),[u,h]=(0,n.useState)(i);return(0,t.jsx)("section",{className:"py-16 bg-gradient-to-br from-slate-50 to-blue-50",children:(0,t.jsxs)("div",{className:"container mx-auto px-4",children:[(0,t.jsxs)(a.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-12",children:[(0,t.jsx)("h2",{className:"text-4xl font-bold text-automotive-carbon mb-4",children:"Data Privacy Controls"}),(0,t.jsx)("p",{className:"text-xl text-automotive-steel max-w-3xl mx-auto",children:"Manage your data privacy preferences and exercise your rights under GDPR and other privacy regulations"})]}),(0,t.jsx)("div",{className:"flex justify-center mb-8",children:(0,t.jsx)("div",{className:"bg-white rounded-lg p-1 shadow-lg",children:[{id:"settings",label:"Privacy Settings",icon:""},{id:"consent",label:"Consent Management",icon:""},{id:"portability",label:"Data Portability",icon:""},{id:"rights",label:"Your Rights",icon:""}].map(n=>(0,t.jsxs)("button",{onClick:()=>o(n.id),className:"px-6 py-3 rounded-md font-medium transition-all duration-300 ".concat(e===n.id?"bg-primary-500 text-white shadow-md":"text-automotive-steel hover:bg-gray-50"),children:[(0,t.jsx)("span",{className:"mr-2",children:n.icon}),n.label]},n.id))})}),(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-xl overflow-hidden",children:["settings"===e&&(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-automotive-carbon mb-6",children:"Privacy Settings"}),(0,t.jsx)("div",{className:"space-y-6",children:l.map(e=>(0,t.jsx)(a.motion.div,{className:"border border-gray-200 rounded-lg p-4",whileHover:{backgroundColor:"#f9fafb"},children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center mb-2",children:[(0,t.jsx)("h4",{className:"font-medium text-automotive-carbon",children:e.name}),e.required&&(0,t.jsx)("span",{className:"ml-2 px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs",children:"Required"})]}),(0,t.jsx)("p",{className:"text-sm text-automotive-steel mb-3",children:e.description}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-500",children:"Data Types:"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:e.dataTypes.map(e=>(0,t.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs",children:e},e))})]}),e.retentionPeriod&&(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-500",children:"Retention Period:"}),(0,t.jsx)("div",{className:"font-medium",children:e.retentionPeriod})]})]})]}),(0,t.jsx)("div",{className:"ml-4",children:(0,t.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",checked:e.enabled,onChange:()=>{var t;return t=e.id,void c(e=>e.map(e=>e.id!==t||e.required?e:{...e,enabled:!e.enabled}))},disabled:e.required,className:"sr-only peer"}),(0,t.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600 ".concat(e.required?"opacity-50 cursor-not-allowed":"")})]})})]})},e.id))}),(0,t.jsxs)("div",{className:"mt-8 p-4 bg-blue-50 rounded-lg",children:[(0,t.jsx)("h4",{className:"font-medium text-automotive-carbon mb-2",children:" Privacy Tip"}),(0,t.jsx)("p",{className:"text-sm text-automotive-steel",children:"You can change these settings at any time. Essential cookies are required for the website to function properly and cannot be disabled."})]})]}),"consent"===e&&(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-automotive-carbon mb-6",children:"Consent Management"}),(0,t.jsx)("div",{className:"space-y-4",children:u.map(e=>(0,t.jsx)(a.motion.div,{className:"border border-gray-200 rounded-lg p-4",whileHover:{backgroundColor:"#f9fafb"},children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center mb-2",children:[(0,t.jsx)("h4",{className:"font-medium text-automotive-carbon",children:e.purpose}),e.mandatory&&(0,t.jsx)("span",{className:"ml-2 px-2 py-1 bg-orange-100 text-orange-800 rounded-full text-xs",children:"Mandatory"})]}),(0,t.jsx)("p",{className:"text-sm text-automotive-steel mb-3",children:e.description}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-500",children:"Last Updated:"}),(0,t.jsx)("div",{className:"font-medium",children:e.lastUpdated})]}),e.expiryDate&&(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-500",children:"Expires:"}),(0,t.jsx)("div",{className:"font-medium",children:e.expiryDate})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-500",children:"Status:"}),(0,t.jsx)("div",{className:"font-medium ".concat(e.consented?"text-green-600":"text-red-600"),children:e.consented?"Consented":"Not Consented"})]})]})]}),(0,t.jsx)("div",{className:"ml-4",children:(0,t.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",checked:e.consented,onChange:()=>{var t;return t=e.id,void h(e=>e.map(e=>e.id!==t||e.mandatory?e:{...e,consented:!e.consented,lastUpdated:new Date().toISOString().split("T")[0]}))},disabled:e.mandatory,className:"sr-only peer"}),(0,t.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600 ".concat(e.mandatory?"opacity-50 cursor-not-allowed":"")})]})})]})},e.id))}),(0,t.jsx)("div",{className:"mt-8 flex justify-center",children:(0,t.jsx)("button",{className:"bg-primary-500 text-white px-6 py-3 rounded-lg hover:bg-primary-600 transition-colors",children:"Save Consent Preferences"})})]}),"portability"===e&&(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-automotive-carbon mb-6",children:"Data Portability"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,t.jsxs)(a.motion.div,{className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg p-6 text-white cursor-pointer",whileHover:{scale:1.05},children:[(0,t.jsx)("div",{className:"text-2xl mb-2",children:""}),(0,t.jsx)("h4",{className:"font-semibold mb-2",children:"Export Your Data"}),(0,t.jsx)("p",{className:"text-sm text-blue-100",children:"Download a copy of all your personal data"})]}),(0,t.jsxs)(a.motion.div,{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-lg p-6 text-white cursor-pointer",whileHover:{scale:1.05},children:[(0,t.jsx)("div",{className:"text-2xl mb-2",children:""}),(0,t.jsx)("h4",{className:"font-semibold mb-2",children:"Transfer Data"}),(0,t.jsx)("p",{className:"text-sm text-green-100",children:"Move your data to another service provider"})]}),(0,t.jsxs)(a.motion.div,{className:"bg-gradient-to-r from-red-500 to-red-600 rounded-lg p-6 text-white cursor-pointer",whileHover:{scale:1.05},children:[(0,t.jsx)("div",{className:"text-2xl mb-2",children:""}),(0,t.jsx)("h4",{className:"font-semibold mb-2",children:"Delete Data"}),(0,t.jsx)("p",{className:"text-sm text-red-100",children:"Request deletion of your personal data"})]})]}),(0,t.jsx)("h4",{className:"text-lg font-semibold text-automotive-carbon mb-4",children:"Recent Requests"}),(0,t.jsx)("div",{className:"space-y-4",children:s.map(e=>(0,t.jsxs)(a.motion.div,{className:"border border-gray-200 rounded-lg p-4",whileHover:{backgroundColor:"#f9fafb"},children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h5",{className:"font-medium text-automotive-carbon capitalize",children:[e.requestType," Request"]}),(0,t.jsxs)("p",{className:"text-sm text-automotive-steel",children:["Requested on ",e.requestDate]})]}),(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat((e=>{switch(e){case"ready":case"completed":return"bg-green-100 text-green-800 border-green-200";case"processing":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"pending":return"bg-blue-100 text-blue-800 border-blue-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(e.status)),children:e.status.toUpperCase()})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-500",children:"Data Categories:"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:e.dataCategories.map(e=>(0,t.jsx)("span",{className:"px-2 py-1 bg-gray-100 text-gray-800 rounded text-xs",children:e},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-500",children:"Format:"}),(0,t.jsx)("div",{className:"font-medium uppercase",children:e.format})]}),e.size&&(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-500",children:"Size:"}),(0,t.jsx)("div",{className:"font-medium",children:e.size})]})]}),"ready"===e.status&&(0,t.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:(0,t.jsx)("button",{className:"bg-primary-500 text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors",children:"Download Data"})})]},e.id))})]}),"rights"===e&&(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-automotive-carbon mb-6",children:"Your Data Protection Rights"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,t.jsx)("h4",{className:"font-medium text-automotive-carbon mb-2",children:" Right to Access"}),(0,t.jsx)("p",{className:"text-sm text-automotive-steel mb-3",children:"You have the right to know what personal data we hold about you and how we use it."}),(0,t.jsx)("button",{className:"text-primary-500 hover:text-primary-600 font-medium",children:"Request Access"})]}),(0,t.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,t.jsx)("h4",{className:"font-medium text-automotive-carbon mb-2",children:" Right to Rectification"}),(0,t.jsx)("p",{className:"text-sm text-automotive-steel mb-3",children:"You can ask us to correct any inaccurate or incomplete personal data."}),(0,t.jsx)("button",{className:"text-primary-500 hover:text-primary-600 font-medium",children:"Request Correction"})]}),(0,t.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,t.jsx)("h4",{className:"font-medium text-automotive-carbon mb-2",children:" Right to Erasure"}),(0,t.jsx)("p",{className:"text-sm text-automotive-steel mb-3",children:"You can request deletion of your personal data in certain circumstances."}),(0,t.jsx)("button",{className:"text-primary-500 hover:text-primary-600 font-medium",children:"Request Deletion"})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,t.jsx)("h4",{className:"font-medium text-automotive-carbon mb-2",children:" Right to Data Portability"}),(0,t.jsx)("p",{className:"text-sm text-automotive-steel mb-3",children:"You can request a copy of your data in a machine-readable format."}),(0,t.jsx)("button",{className:"text-primary-500 hover:text-primary-600 font-medium",children:"Export Data"})]}),(0,t.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,t.jsx)("h4",{className:"font-medium text-automotive-carbon mb-2",children:" Right to Restrict Processing"}),(0,t.jsx)("p",{className:"text-sm text-automotive-steel mb-3",children:"You can ask us to limit how we use your personal data in certain situations."}),(0,t.jsx)("button",{className:"text-primary-500 hover:text-primary-600 font-medium",children:"Request Restriction"})]}),(0,t.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,t.jsx)("h4",{className:"font-medium text-automotive-carbon mb-2",children:" Right to Object"}),(0,t.jsx)("p",{className:"text-sm text-automotive-steel mb-3",children:"You can object to processing based on legitimate interests or direct marketing."}),(0,t.jsx)("button",{className:"text-primary-500 hover:text-primary-600 font-medium",children:"Object to Processing"})]})]})]}),(0,t.jsxs)("div",{className:"mt-8 p-4 bg-yellow-50 rounded-lg",children:[(0,t.jsx)("h4",{className:"font-medium text-automotive-carbon mb-2",children:" Need Help?"}),(0,t.jsx)("p",{className:"text-sm text-automotive-steel mb-2",children:"If you have questions about your rights or need assistance with a request, contact our Data Protection Officer:"}),(0,t.jsxs)("div",{className:"text-sm",children:[(0,t.jsx)("div",{children:"Email: dpo@nkj-development.com"}),(0,t.jsx)("div",{children:"Phone: +49 (0) 123 456 789"}),(0,t.jsx)("div",{children:"Response time: Within 30 days"})]})]})]})]})]})})}},36858,e=>{"use strict";e.s(["default",()=>l]);var t=e.i(43476),n=e.i(71645),a=e.i(46932),r=e.i(56125);let i=[{id:"encryption-coverage",name:"Data Encryption Coverage",value:99.8,target:100,unit:"%",status:"secure",trend:"up",category:"encryption"},{id:"access-control",name:"Access Control Compliance",value:97.5,target:98,unit:"%",status:"secure",trend:"stable",category:"access"},{id:"threat-detection",name:"Threat Detection Rate",value:99.2,target:99,unit:"%",status:"secure",trend:"up",category:"monitoring"},{id:"incident-response",name:"Incident Response Time",value:12,target:15,unit:"min",status:"secure",trend:"down",category:"monitoring"},{id:"vulnerability-patching",name:"Vulnerability Patching",value:94.8,target:95,unit:"%",status:"warning",trend:"up",category:"compliance"},{id:"user-training",name:"Security Training Completion",value:89.3,target:95,unit:"%",status:"warning",trend:"up",category:"compliance"}],s=[{id:"inc-001",type:"breach_attempt",severity:"high",status:"resolved",timestamp:"2024-01-15T14:30:00Z",description:"Attempted SQL injection on production database",affectedSystems:["Production DB","Web Application"],responseTime:8},{id:"inc-002",type:"unauthorized_access",severity:"medium",status:"investigating",timestamp:"2024-01-14T09:15:00Z",description:"Multiple failed login attempts from suspicious IP",affectedSystems:["Authentication Service"],responseTime:15},{id:"inc-003",type:"phishing",severity:"low",status:"contained",timestamp:"2024-01-13T16:45:00Z",description:"Phishing email detected and quarantined",affectedSystems:["Email System"],responseTime:5}],o=[{id:"iso-27001",name:"ISO 27001",description:"Information Security Management System",compliance:96.5,lastAudit:"2023-11-15",nextAudit:"2024-11-15",status:"compliant",requirements:{total:114,met:110,pending:4}},{id:"gdpr",name:"GDPR",description:"General Data Protection Regulation",compliance:94.2,lastAudit:"2023-12-01",nextAudit:"2024-06-01",status:"compliant",requirements:{total:99,met:93,pending:6}},{id:"soc2",name:"SOC 2 Type II",description:"Service Organization Control 2",compliance:91.8,lastAudit:"2023-10-20",nextAudit:"2024-10-20",status:"partial",requirements:{total:64,met:59,pending:5}}];function l(){let[e,l]=(0,n.useState)("overview"),[c,u]=(0,n.useState)(i);(0,n.useEffect)(()=>{let e=setInterval(()=>{u(e=>e.map(e=>({...e,value:e.value+(Math.random()-.5)*.5})))},5e3);return()=>clearInterval(e)},[]);let h=e=>{switch(e){case"secure":case"compliant":case"resolved":case"contained":return"bg-green-100 text-green-800 border-green-200";case"warning":case"partial":case"investigating":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"critical":case"non_compliant":case"detected":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};return(0,t.jsx)("section",{className:"py-16 bg-gradient-to-br from-slate-900 to-blue-900",children:(0,t.jsxs)("div",{className:"container mx-auto px-4",children:[(0,t.jsxs)(a.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-12",children:[(0,t.jsx)("h2",{className:"text-4xl font-bold text-white mb-4",children:"Security & Encryption Dashboard"}),(0,t.jsx)("p",{className:"text-xl text-blue-100 max-w-3xl mx-auto",children:"Comprehensive security monitoring, threat detection, and compliance management for automotive data protection"})]}),(0,t.jsx)("div",{className:"flex justify-center mb-8",children:(0,t.jsx)("div",{className:"bg-slate-800 rounded-lg p-1 shadow-lg",children:[{id:"overview",label:"Security Overview",icon:""},{id:"incidents",label:"Security Incidents",icon:""},{id:"compliance",label:"Compliance Status",icon:""},{id:"encryption",label:"Encryption & Keys",icon:""}].map(n=>(0,t.jsxs)("button",{onClick:()=>l(n.id),className:"px-6 py-3 rounded-md font-medium transition-all duration-300 ".concat(e===n.id?"bg-blue-600 text-white shadow-md":"text-slate-300 hover:bg-slate-700"),children:[(0,t.jsx)("span",{className:"mr-2",children:n.icon}),n.label]},n.id))})}),(0,t.jsxs)("div",{className:"bg-slate-800 rounded-xl shadow-2xl overflow-hidden",children:["overview"===e&&(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-white mb-6",children:"Security Metrics Overview"}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:c.map(e=>(0,t.jsxs)(a.motion.div,{className:"bg-slate-700 rounded-lg p-6",whileHover:{scale:1.02},children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,t.jsx)("h4",{className:"font-medium text-white",children:e.name}),(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat(h(e.status)),children:e.status.toUpperCase()})]}),(0,t.jsxs)("div",{className:"flex items-end space-x-2 mb-4",children:[(0,t.jsx)(r.default,{end:e.value,decimals:+("%"===e.unit),suffix:e.unit,className:"text-3xl font-bold text-blue-400"}),(0,t.jsxs)("span",{className:"text-sm text-slate-300",children:["/ ",e.target," ",e.unit]})]}),(0,t.jsx)("div",{className:"w-full bg-slate-600 rounded-full h-2",children:(0,t.jsx)("div",{className:"h-2 rounded-full transition-all duration-300 ".concat("secure"===e.status?"bg-green-500":"warning"===e.status?"bg-yellow-500":"bg-red-500"),style:{width:"".concat(Math.min(e.value/e.target*100,100),"%")}})})]},e.id))}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,t.jsxs)("div",{className:"bg-slate-700 rounded-lg p-6",children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-white mb-4",children:"Security Status"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-slate-300",children:"Overall Security Score"}),(0,t.jsx)("span",{className:"text-2xl font-bold text-green-400",children:"A+"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-slate-300",children:"Active Threats"}),(0,t.jsx)("span",{className:"text-xl font-bold text-yellow-400",children:"2"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-slate-300",children:"Systems Protected"}),(0,t.jsx)("span",{className:"text-xl font-bold text-blue-400",children:"47"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-slate-300",children:"Last Security Scan"}),(0,t.jsx)("span",{className:"text-sm text-slate-300",children:"2 hours ago"})]})]})]}),(0,t.jsxs)("div",{className:"bg-slate-700 rounded-lg p-6",children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-white mb-4",children:"Recent Activity"}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-green-400 rounded-full"}),(0,t.jsx)("span",{className:"text-sm text-slate-300",children:"Firewall rules updated"}),(0,t.jsx)("span",{className:"text-xs text-slate-400",children:"5 min ago"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-blue-400 rounded-full"}),(0,t.jsx)("span",{className:"text-sm text-slate-300",children:"SSL certificates renewed"}),(0,t.jsx)("span",{className:"text-xs text-slate-400",children:"1 hour ago"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-yellow-400 rounded-full"}),(0,t.jsx)("span",{className:"text-sm text-slate-300",children:"Security scan completed"}),(0,t.jsx)("span",{className:"text-xs text-slate-400",children:"2 hours ago"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-red-400 rounded-full"}),(0,t.jsx)("span",{className:"text-sm text-slate-300",children:"Threat detected and blocked"}),(0,t.jsx)("span",{className:"text-xs text-slate-400",children:"4 hours ago"})]})]})]})]})]}),"incidents"===e&&(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-white",children:"Security Incidents"}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsxs)("select",{className:"bg-slate-700 text-white border border-slate-600 rounded-lg px-3 py-2",children:[(0,t.jsx)("option",{children:"All Incidents"}),(0,t.jsx)("option",{children:"Critical"}),(0,t.jsx)("option",{children:"High"}),(0,t.jsx)("option",{children:"Medium"}),(0,t.jsx)("option",{children:"Low"})]}),(0,t.jsx)("button",{className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Report Incident"})]})]}),(0,t.jsx)("div",{className:"space-y-4",children:s.map(e=>(0,t.jsxs)(a.motion.div,{className:"bg-slate-700 rounded-lg p-4",whileHover:{backgroundColor:"#475569"},children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-white capitalize",children:e.type.replace("_"," ")}),(0,t.jsx)("p",{className:"text-sm text-slate-300",children:e.description})]}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat((e=>{switch(e){case"low":return"bg-blue-100 text-blue-800 border-blue-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"critical":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(e.severity)),children:e.severity.toUpperCase()}),(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat(h(e.status)),children:e.status.toUpperCase()})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-slate-400",children:"Timestamp:"}),(0,t.jsx)("div",{className:"text-slate-300",children:new Date(e.timestamp).toLocaleString()})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-slate-400",children:"Response Time:"}),(0,t.jsxs)("div",{className:"text-slate-300",children:[e.responseTime," minutes"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-slate-400",children:"Affected Systems:"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:e.affectedSystems.map(e=>(0,t.jsx)("span",{className:"px-2 py-1 bg-slate-600 text-slate-300 rounded text-xs",children:e},e))})]})]})]},e.id))})]}),"compliance"===e&&(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-white mb-6",children:"Compliance Standards"}),(0,t.jsx)("div",{className:"space-y-6",children:o.map(e=>(0,t.jsxs)(a.motion.div,{className:"bg-slate-700 rounded-lg p-6",whileHover:{backgroundColor:"#475569"},children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-white text-lg",children:e.name}),(0,t.jsx)("p",{className:"text-sm text-slate-300",children:e.description})]}),(0,t.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium border ".concat(h(e.status)),children:e.status.replace("_"," ").toUpperCase()})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-3xl font-bold text-blue-400 mb-1",children:(0,t.jsx)(r.default,{end:e.compliance,decimals:1,suffix:"%"})}),(0,t.jsx)("div",{className:"text-sm text-slate-400",children:"Compliance"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-green-400 mb-1",children:e.requirements.met}),(0,t.jsx)("div",{className:"text-sm text-slate-400",children:"Requirements Met"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-yellow-400 mb-1",children:e.requirements.pending}),(0,t.jsx)("div",{className:"text-sm text-slate-400",children:"Pending"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-sm text-slate-300 mb-1",children:"Next Audit"}),(0,t.jsx)("div",{className:"text-sm text-slate-400",children:e.nextAudit})]})]}),(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)("div",{className:"w-full bg-slate-600 rounded-full h-2",children:(0,t.jsx)("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:"".concat(e.compliance,"%")}})})})]},e.id))})]}),"encryption"===e&&(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-white mb-6",children:"Encryption & Key Management"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"bg-slate-700 rounded-lg p-6",children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-white mb-4",children:"Encryption Status"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-slate-300",children:"Data at Rest"}),(0,t.jsx)("span",{className:"text-green-400 font-medium",children:"AES-256 "})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-slate-300",children:"Data in Transit"}),(0,t.jsx)("span",{className:"text-green-400 font-medium",children:"TLS 1.3 "})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-slate-300",children:"Database Encryption"}),(0,t.jsx)("span",{className:"text-green-400 font-medium",children:"Enabled "})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-slate-300",children:"Backup Encryption"}),(0,t.jsx)("span",{className:"text-green-400 font-medium",children:"AES-256 "})]})]})]}),(0,t.jsxs)("div",{className:"bg-slate-700 rounded-lg p-6",children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-white mb-4",children:"Key Management"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-slate-300",children:"Active Keys"}),(0,t.jsx)("span",{className:"text-blue-400 font-medium",children:"24"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-slate-300",children:"Keys Expiring Soon"}),(0,t.jsx)("span",{className:"text-yellow-400 font-medium",children:"3"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-slate-300",children:"Key Rotation Frequency"}),(0,t.jsx)("span",{className:"text-slate-300",children:"90 days"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-slate-300",children:"HSM Status"}),(0,t.jsx)("span",{className:"text-green-400 font-medium",children:"Online "})]})]})]})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"bg-slate-700 rounded-lg p-6",children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-white mb-4",children:"Certificate Management"}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center p-3 bg-slate-600 rounded",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-white font-medium",children:"*.nkj-development.com"}),(0,t.jsx)("div",{className:"text-sm text-slate-400",children:"Expires: 2024-12-15"})]}),(0,t.jsx)("span",{className:"text-green-400",children:"Valid"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center p-3 bg-slate-600 rounded",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-white font-medium",children:"api.nkj-development.com"}),(0,t.jsx)("div",{className:"text-sm text-slate-400",children:"Expires: 2024-08-20"})]}),(0,t.jsx)("span",{className:"text-yellow-400",children:"Expiring Soon"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center p-3 bg-slate-600 rounded",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-white font-medium",children:"admin.nkj-development.com"}),(0,t.jsx)("div",{className:"text-sm text-slate-400",children:"Expires: 2025-03-10"})]}),(0,t.jsx)("span",{className:"text-green-400",children:"Valid"})]})]})]}),(0,t.jsxs)("div",{className:"bg-slate-700 rounded-lg p-6",children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-white mb-4",children:"Security Actions"}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("button",{className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors",children:"Rotate Encryption Keys"}),(0,t.jsx)("button",{className:"w-full bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition-colors",children:"Renew Certificates"}),(0,t.jsx)("button",{className:"w-full bg-purple-600 text-white py-2 px-4 rounded-lg hover:bg-purple-700 transition-colors",children:"Generate Security Report"}),(0,t.jsx)("button",{className:"w-full bg-orange-600 text-white py-2 px-4 rounded-lg hover:bg-orange-700 transition-colors",children:"Run Security Audit"})]})]})]})]})]})]})]})})}}]);